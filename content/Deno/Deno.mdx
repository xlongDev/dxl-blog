---
type: "Post"
title: "èŠèŠ Denoï¼šä»å‰ç«¯è§†è§’çœ‹æœªæ¥çš„å¼€å‘ä¹‹é“ ğŸ¦•"
date: "2024-02-17"
description: "æ·±å…¥å‰–æ Deno çš„æ ¸å¿ƒç‰¹æ€§ã€è¿è¡ŒåŸç†ä¸å‰ç«¯å¼€å‘å®è·µï¼Œæ¢è®¨å…¶å¦‚ä½•é‡å¡‘ç°ä»£å¼€å‘ä½“éªŒï¼Œç»“åˆå“²å­¦æ€è€ƒä¸å®ç”¨æ¡ˆä¾‹ï¼Œä¸ºå‰ç«¯å¼€å‘è€…æä¾›å…¨é¢æŒ‡å—ã€‚"
keywords: "Deno, Node.js, TypeScript, JavaScript, å‰ç«¯å¼€å‘, è¿è¡Œæ—¶, Web æ ‡å‡†, å®‰å…¨æ²™ç®±, æœ€ä½³å®è·µ"
author: "Sousuke"
image: "/images/hero/deno-hero.jpg"
tags: ["Deno", "TypeScript", "JavaScript", "å‰ç«¯å¼€å‘", "è¿è¡Œæ—¶"]
category: "Deno"
---

> â€œä»£ç æ˜¯è¯—ï¼Œè¿è¡Œæ—¶æ˜¯èˆå°ï¼Œå¼€å‘è€…åˆ™æ˜¯åŸå”±æœªæ¥çš„è¯—äººã€‚â€  
> â€”â€” çµæ„Ÿæºè‡ªã€Šé»‘å®¢ä¸ç”»å®¶ã€‹

åœ¨å‰ç«¯å¼€å‘çš„æµ©ç€šæ˜Ÿæµ·ä¸­ï¼ŒNode.js æ›¾å¦‚ä¸€é¢—è€€çœ¼çš„æ’æ˜Ÿï¼Œç…§äº®äº† JavaScript å…¨æ ˆå¼€å‘çš„é“è·¯ã€‚ç„¶è€Œï¼Œæ’æ˜Ÿä¹Ÿæœ‰ç”Ÿå‘½å‘¨æœŸï¼Œå½“æ–°çš„å…‰èŠ’å‡èµ·ï¼Œæˆ‘ä»¬æ˜¯å¦å‡†å¤‡å¥½è¿æ¥ï¼ŸDenoï¼Œè¿™ä½ç”± Node.js ä¹‹çˆ¶ Ryan Dahl äº²æ‰‹æ‰“é€ çš„â€œåæµªâ€ï¼Œå¸¦ç€ TypeScript åŸç”Ÿæ”¯æŒã€å®‰å…¨æ²™ç®±å’Œå¯¹ Web æ ‡å‡†çš„æ‹¥æŠ±ï¼Œæ­£ä»¥ä¼˜é›…çš„å§¿æ€æŒ‘æˆ˜ä¼ ç»Ÿï¼Œè¯•å›¾ä¸ºæˆ‘ä»¬æç»˜ä¸€ä¸ªæ›´å®‰å…¨ã€æ›´ç°ä»£çš„å¼€å‘æœªæ¥ã€‚

ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œä½ æ˜¯å¦æ›¾åœ¨ npm ä¾èµ–åœ°ç‹±ä¸­è¿·å¤±ï¼Ÿæ˜¯å¦ä¸º Node.js çš„å†å²åŒ…è¢±æ„Ÿåˆ°ç–²æƒ«ï¼Ÿæ˜¯å¦æœŸå¾…ä¸€ä¸ªæ›´ç¬¦åˆç°ä»£ Web ç†å¿µçš„è¿è¡Œæ—¶ï¼Ÿå¦‚æœç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°†å¸¦ä½ èµ°è¿› Deno çš„ä¸–ç•Œâ€”â€”ä»å®ƒçš„å“²å­¦å†…æ ¸åˆ°æŠ€æœ¯ç»†èŠ‚ï¼Œä»ä»£ç ç¤ºä¾‹åˆ°æœ€ä½³å®è·µï¼Œä»å·¥å…·é“¾åˆ°äººç”Ÿæ€è€ƒã€‚è®©æˆ‘ä»¬ä¸€èµ·ï¼Œä»¥ä»£ç ä¸ºèˆŸï¼Œä¹˜é£ç ´æµªï¼Œæ¢ç´¢ Deno çš„è¯—æ„ä¸åŠ›é‡ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦ Denoï¼Ÿä» Node.js çš„â€œåŸç½ªâ€è¯´èµ·

Node.js çš„æˆåŠŸæ¯‹åº¸ç½®ç–‘ï¼Œå®ƒè®© JavaScript è·³å‡ºæµè§ˆå™¨ï¼Œèµ‹äºˆäº†å¼€å‘è€…æ„å»ºæœåŠ¡å™¨ã€CLI å·¥å…·ç”šè‡³æ¡Œé¢åº”ç”¨çš„æ— é™å¯èƒ½ã€‚ç„¶è€Œï¼ŒæˆåŠŸå¾€å¾€ä¼´éšç€å¦¥åã€‚Node.js çš„è®¾è®¡å§‹äº 2009 å¹´ï¼Œé‚£æ˜¯ä¸€ä¸ª npm è¿˜æœªç»Ÿæ²»å‰ç«¯ã€ES Module å°šæœªè¯ç”Ÿçš„å¹´ä»£ã€‚å®ƒçš„â€œåŸç½ªâ€åŒ…æ‹¬ï¼š

- **ä¾èµ–ç®¡ç†çš„æ··ä¹±**ï¼šnpm çš„ `node_modules` å¦‚åŒä¸€ä¸ªé»‘æ´ï¼Œç¨ä¸ç•™ç¥å°±åå™¬ç¡¬ç›˜ç©ºé—´ï¼Œ`package.json` çš„ç‰ˆæœ¬å†²çªè®©äººæŠ“ç‹‚ã€‚
- **å†å²åŒ…è¢±**ï¼šCommonJS æ¨¡å—ç³»ç»Ÿçš„é—ç•™é—®é¢˜ã€å›è°ƒåœ°ç‹±ã€ä»¥åŠå¯¹ TypeScript çš„â€œåå¤©æ”¯æŒâ€è®©ä»£ç ç»´æŠ¤æˆæœ¬é£™å‡ã€‚
- **å®‰å…¨éšæ‚£**ï¼šNode.js é»˜è®¤ç»™äºˆè„šæœ¬å¯¹æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œçš„å®Œå…¨è®¿é—®æƒé™ï¼Œä¸€ä¸ªæ¶æ„ä¾èµ–å¯èƒ½æ¯æ‰æ•´ä¸ªé¡¹ç›®ã€‚

Deno çš„è¯ç”Ÿï¼Œæ­£æ˜¯ Ryan Dahl å¯¹è¿™äº›é—®é¢˜çš„æ·±åˆ»åæ€ã€‚ä»–åœ¨ 2018 å¹´çš„ JSConf EU ä¸Šå‘è¡¨äº†ã€ŠNode.js çš„åå¤§é—æ†¾ã€‹ï¼Œå¦è¨€å¦‚æœé‡æ¥ä¸€æ¬¡ï¼Œä»–ä¼šåšå‡ºä¸åŒçš„é€‰æ‹©ã€‚Deno ä¸æ˜¯ Node.js çš„â€œ2.0 ç‰ˆâ€ï¼Œè€Œæ˜¯ä¸€ä¸ªå…¨æ–°çš„è¿è¡Œæ—¶ï¼Œæ—¨åœ¨ä¿®æ­£è¿‡å»ã€æ‹¥æŠ±æœªæ¥ã€‚

> â€œæˆ‘ä»¬æ— æ³•æ”¹å˜è¿‡å»ï¼Œä½†å¯ä»¥å¡‘é€ æœªæ¥ã€‚â€  
> â€”â€” æ”¹ç¼–è‡ªã€Šæ˜Ÿé™…ç©¿è¶Šã€‹

Deno çš„æ ¸å¿ƒç†å¿µå¯ä»¥ç”¨ä¸‰ä¸ªè¯æ¦‚æ‹¬ï¼š**å®‰å…¨**ã€**ç®€å•**ã€**ç°ä»£**ã€‚å®ƒæŠ›å¼ƒäº† npm å’Œ `node_modules`ï¼Œæ‹¥æŠ± URL å¯¼å…¥å’Œ ES Moduleï¼›å®ƒé»˜è®¤è¿è¡Œåœ¨å®‰å…¨æ²™ç®±ä¸­ï¼Œæƒé™éœ€æ˜¾å¼å£°æ˜ï¼›å®ƒåŸç”Ÿæ”¯æŒ TypeScript å’Œ Web æ ‡å‡† APIï¼Œè®©å¼€å‘è€…ä»¿ä½›åœ¨æµè§ˆå™¨ä¸­ç¼–ç¨‹ã€‚è¿™ä¸€åˆ‡ï¼Œéƒ½ä¸å‰ç«¯å¼€å‘è€…çš„éœ€æ±‚é«˜åº¦å¥‘åˆã€‚

*Tipsï¼šDeno çš„å“²å­¦å¯å‘æˆ‘ä»¬ï¼ŒæŠ€æœ¯é€‰æ‹©ä¸ä»…æ˜¯å·¥å…·çš„å–èˆï¼Œæ›´æ˜¯ä»·å€¼è§‚çš„ä½“ç°ã€‚é€‰æ‹© Denoï¼Œå°±æ˜¯é€‰æ‹©æ‹¥æŠ±ç°ä»£ Web çš„å¼€æ”¾ä¸è‡ªç”±ã€‚*

## Deno çš„æ ¸å¿ƒç‰¹æ€§ï¼šæŠ€æœ¯ä¸è¯—æ„çš„äº¤å“

Deno çš„ç‰¹æ€§å¦‚åŒä¸€é¦–ç²¾å¿ƒç¼–æ’çš„äº¤å“ä¹ï¼Œæ¯ä¸€ä¸ªéŸ³ç¬¦éƒ½ç»è¿‡æ·±æ€ç†Ÿè™‘ã€‚ä»¥ä¸‹æ˜¯å®ƒçš„æ ¸å¿ƒç‰¹æ€§ï¼Œè¾…ä»¥è¯¦ç»†è§£æå’Œä»£ç ç¤ºä¾‹ã€‚

### 1. åŸç”Ÿ TypeScript æ”¯æŒï¼šå‘Šåˆ«ç¼–è¯‘çš„çƒ¦æ¼

Deno æ˜¯ç¬¬ä¸€ä¸ªåŸç”Ÿæ”¯æŒ TypeScript çš„è¿è¡Œæ—¶ï¼Œæ— éœ€ `tsconfig.json` æˆ–é¢å¤–çš„ç¼–è¯‘æ­¥éª¤ã€‚å¼€å‘è€…å¯ä»¥ç›´æ¥è¿è¡Œ `.ts` æ–‡ä»¶ï¼ŒDeno çš„å†…éƒ¨ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†ç±»å‹æ£€æŸ¥å’Œè½¬è¯‘ã€‚

```typescript
// hello.ts
function greet(name: string): string {
  return `Hello, ${name}! Welcome to Deno ğŸ¦•`;
}

console.log(greet("Sousuke"));
```

è¿è¡Œå‘½ä»¤ï¼š

```bash
deno run hello.ts
```

è¾“å‡ºï¼š

```
Hello, Sousuke! Welcome to Deno ğŸ¦•
```

**åŸç†æ­ç§˜**ï¼šDeno ä½¿ç”¨ Rust ç¼–å†™çš„ V8 å¼•æ“ï¼Œé›†æˆäº† TypeScript ç¼–è¯‘å™¨ã€‚å½“ä½ è¿è¡Œ `.ts` æ–‡ä»¶æ—¶ï¼ŒDeno ä¼šå…ˆå°†ä»£ç ç¼–è¯‘ä¸º JavaScriptï¼Œç¼“å­˜åˆ°æœ¬åœ°ï¼ˆ`~/.cache/deno`ï¼‰ï¼Œåç»­è¿è¡Œç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œæ€§èƒ½å‡ ä¹ä¸çº¯ JavaScript æ— å¼‚ã€‚

**æœ€ä½³å®è·µ**ï¼š  
- *å–„ç”¨ç±»å‹æ¨æ–­*ï¼šDeno çš„ TypeScript æ”¯æŒéå¸¸æ™ºèƒ½ï¼Œå°½é‡å‡å°‘æ˜¾å¼ç±»å‹æ³¨è§£ï¼Œè®©ä»£ç æ›´ç®€æ´ã€‚  
  *Tipsï¼šé¿å…è¿‡åº¦ä½¿ç”¨ `any` ç±»å‹ï¼Œä¿æŒç±»å‹å®‰å…¨æ˜¯ Deno çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚*

- *åˆ©ç”¨ Deno çš„ lint å·¥å…·*ï¼šè¿è¡Œ `deno lint` æ£€æŸ¥ä»£ç è§„èŒƒï¼Œç¡®ä¿ç±»å‹ä¸€è‡´æ€§ã€‚  
  *Tipsï¼šå°† `deno lint` é›†æˆåˆ° CI/CD æµç¨‹ï¼Œç¡®ä¿å›¢é˜Ÿä»£ç è´¨é‡ã€‚*

### 2. å®‰å…¨æ²™ç®±ï¼šä»£ç çš„â€œé“å¾·çº¦æŸâ€

Deno é»˜è®¤è¿è¡Œåœ¨å®‰å…¨æ²™ç®±ä¸­ï¼Œè„šæœ¬æ— æƒè®¿é—®æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œæˆ–ç¯å¢ƒå˜é‡ï¼Œé™¤éæ˜¾å¼æˆäºˆæƒé™ã€‚è¿™ç§è®¾è®¡çµæ„Ÿæ¥æºäºæµè§ˆå™¨çš„å®‰å…¨æ¨¡å‹ï¼Œæå¤§åœ°é™ä½äº†æ¶æ„ä»£ç çš„é£é™©ã€‚

```typescript
// read_file.ts
const content = await Deno.readTextFile("./example.txt");
console.log(content);
```

è¿è¡Œæ—¶éœ€æ·»åŠ æƒé™ï¼š

```bash
deno run --allow-read read_file.ts
```

å¦‚æœæœªæä¾› `--allow-read`ï¼ŒDeno ä¼šæŠ›å‡º `PermissionDenied` é”™è¯¯ã€‚

**ç±»æ¯”**ï¼šDeno çš„å®‰å…¨æ¨¡å‹å°±åƒç»™ä»£ç æˆ´ä¸Šäº†ä¸€å‰¯â€œé“å¾·æ‰‹é“â€ï¼Œå®ƒä¸ä¼šå·å·ç¿»ä½ çš„æŠ½å±‰ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰æˆ–æ‰“ç”µè¯ç»™é™Œç”Ÿäººï¼ˆç½‘ç»œè¯·æ±‚ï¼‰ï¼Œé™¤éä½ æ˜ç¡®å…è®¸ã€‚è¿™ç§çº¦æŸä¸ä»…æ˜¯æŠ€æœ¯çš„è¿›æ­¥ï¼Œæ›´æ˜¯å¯¹å¼€å‘è€…è´£ä»»æ„Ÿçš„æé†’ã€‚

**æœ€ä½³å®è·µ**ï¼š  
- *æœ€å°æƒé™åŸåˆ™*ï¼šä»…æˆäºˆè„šæœ¬å¿…è¦æƒé™ï¼Œä¾‹å¦‚åªè¯»æ–‡ä»¶æ—¶ä½¿ç”¨ `--allow-read`ï¼Œé¿å… `--allow-all`ã€‚  
  *Tipsï¼šå°†æƒé™å£°æ˜å†™å…¥ `deno.json` çš„ `permissions` å­—æ®µï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œå’Œæƒé™ç®¡ç†ã€‚*

- *ä½¿ç”¨ `--watch` è°ƒè¯•*ï¼šå¼€å‘æ—¶ç»“åˆ `--allow-read --allow-write` å’Œ `--watch`ï¼Œè‡ªåŠ¨é‡è½½ä»£ç ã€‚  
  *Tipsï¼šè°ƒè¯•å®Œæˆåç§»é™¤ä¸å¿…è¦çš„æƒé™ï¼Œä¿æŒç”Ÿäº§ç¯å¢ƒå®‰å…¨ã€‚*

### 3. URL å¯¼å…¥ä¸å»ä¸­å¿ƒåŒ–ä¾èµ–

Deno æŠ›å¼ƒäº† npm å’Œ `node_modules`ï¼Œé‡‡ç”¨ URL å¯¼å…¥æœºåˆ¶ï¼Œä¾èµ–ç›´æ¥ä»ç½‘ç»œåŠ è½½ï¼Œæ”¯æŒå»ä¸­å¿ƒåŒ–çš„æ¨¡å—ç®¡ç†ã€‚

```typescript
// server.ts
import { serve } from "https://deno.land/std@0.224.0/http/server.ts";

const handler = (req: Request): Response => {
  return new Response("Hello from Deno!", { status: 200 });
};

await serve(handler, { port: 8000 });
```

è¿è¡Œï¼š

```bash
deno run --allow-net server.ts
```

è®¿é—® `http://localhost:8000`ï¼Œä½ å°†çœ‹åˆ° `Hello from Deno!`ã€‚

**åŸç†æ­ç§˜**ï¼šDeno çš„ä¾èµ–ç®¡ç†çµæ„Ÿæ¥æºäºæµè§ˆå™¨çš„ `<script src>`ã€‚æ¨¡å—ä» URL ä¸‹è½½åç¼“å­˜åˆ°æœ¬åœ°ï¼Œæ”¯æŒç‰ˆæœ¬é”å®šï¼ˆé€šè¿‡ URL ä¸­çš„ç‰ˆæœ¬å·ï¼‰ã€‚Deno è¿˜æä¾›äº† `deno.land/x` ä½œä¸ºç¤¾åŒºæ¨¡å—æ‰˜ç®¡å¹³å°ï¼Œç±»ä¼¼ npm ä½†æ›´è½»é‡ã€‚

**ç±»æ¯”**ï¼šå¦‚æœè¯´ npm æ˜¯ä¸€ä¸ªä¸­å¤®é›†æƒçš„â€œå¸å›½å›¾ä¹¦é¦†â€ï¼ŒDeno çš„ URL å¯¼å…¥åˆ™åƒä¸€ä¸ªå¼€æ”¾çš„â€œæ˜Ÿé™…ç½‘ç»œâ€ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹æ˜Ÿçƒï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±æ¢ç´¢ã€‚

**æœ€ä½³å®è·µ**ï¼š  
- *ç‰ˆæœ¬é”å®š*ï¼šå§‹ç»ˆåœ¨ URL ä¸­æŒ‡å®šæ¨¡å—ç‰ˆæœ¬ï¼Œä¾‹å¦‚ `std@0.224.0`ï¼Œé¿å…æ„å¤–å‡çº§å¯¼è‡´å…¼å®¹æ€§é—®é¢˜ã€‚  
  *Tipsï¼šä½¿ç”¨ `deno.json` çš„ `imports` å­—æ®µæ˜ å°„æ¨¡å—åˆ«åï¼Œç®€åŒ–ä»£ç ä¸­çš„ URLã€‚*

- *ç¦»çº¿ç¼“å­˜*ï¼šè¿è¡Œ `deno cache script.ts` é¢„ç¼“å­˜ä¾èµ–ï¼Œé¿å…ç½‘ç»œä¸ç¨³å®šå½±å“å¼€å‘ã€‚  
  *Tipsï¼šå®šæœŸæ¸…ç†ç¼“å­˜ï¼ˆ`deno cache --clean`ï¼‰ï¼Œä¿æŒæœ¬åœ°å­˜å‚¨æ•´æ´ã€‚*

### 4. Web æ ‡å‡† APIï¼šæµè§ˆå™¨ä¸æœåŠ¡å™¨çš„ç»Ÿä¸€

Deno å¤§é‡å¤ç”¨äº† Web æ ‡å‡† APIï¼Œä¾‹å¦‚ `fetch`ã€`Request`ã€`Response` å’Œ `WebSocket`ï¼Œè®©å‰ç«¯å¼€å‘è€…æ„Ÿåˆ°å¦‚é±¼å¾—æ°´ã€‚

```typescript
// fetch_example.ts
const response = await fetch("https://api.example.com/data");
const data = await response.json();
console.log(data);
```

è¿è¡Œï¼š

```bash
deno run --allow-net fetch_example.ts
```

**ç±»æ¯”**ï¼šDeno çš„ Web æ ‡å‡† API å°±åƒä¸€åº§è¿æ¥æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„â€œæ—¶ç©ºä¹‹æ¡¥â€ï¼Œå¼€å‘è€…æ— éœ€åˆ‡æ¢æ€ç»´æ¨¡å¼ï¼Œä»£ç é£æ ¼é«˜åº¦ä¸€è‡´ï¼Œä»¿ä½›åœ¨åŒä¸€ä¸ªå®‡å®™ä¸­ç¼–ç¨‹ã€‚

**æœ€ä½³å®è·µ**ï¼š  
- *ä¼˜å…ˆä½¿ç”¨ fetch*ï¼šç›¸æ¯” Node.js çš„ `http` æ¨¡å—ï¼Œ`fetch` æ›´ç®€æ´ä¸”ç¬¦åˆç°ä»£ Web å¼€å‘ä¹ æƒ¯ã€‚  
  *Tipsï¼šå°è£… `fetch` ä¸ºå¯å¤ç”¨çš„å·¥å…·å‡½æ•°ï¼Œç»Ÿä¸€å¤„ç†é”™è¯¯å’Œè¶…æ—¶é€»è¾‘ã€‚*

- *åˆ©ç”¨ WebSocket*ï¼šDeno åŸç”Ÿæ”¯æŒ `WebSocket`ï¼Œé€‚åˆå®æ—¶åº”ç”¨åœºæ™¯ã€‚  
  *Tipsï¼šä½¿ç”¨ `deno.land/x` çš„ WebSocket å¢å¼ºåº“ï¼Œç®€åŒ–å¤æ‚åœºæ™¯çš„å®ç°ã€‚*

### 5. å†…ç½®å·¥å…·é“¾ï¼šä¸€ç«™å¼å¼€å‘ä½“éªŒ

Deno å†…ç½®äº†æ ¼å¼åŒ–ã€æµ‹è¯•ã€Lint å’Œæ‰“åŒ…å·¥å…·ï¼Œæ— éœ€é¢å¤–çš„é…ç½®ï¼Œå¼€ç®±å³ç”¨ã€‚

#### æ ¼å¼åŒ–ä»£ç 

```bash
deno fmt
```

#### è¿è¡Œæµ‹è¯•

```typescript
// math.test.ts
import { assertEquals } from "https://deno.land/std@0.224.0/assert/mod.ts";

Deno.test("addition works", () => {
  assertEquals(1 + 1, 2);
});
```

è¿è¡Œï¼š

```bash
deno test
```

#### æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶

```bash
deno compile --allow-net server.ts
```

**ç±»æ¯”**ï¼šDeno çš„å†…ç½®å·¥å…·é“¾å°±åƒä¸€ä¸ªå…¨èƒ½çš„â€œç‘å£«å†›åˆ€â€ï¼Œå¼€å‘è€…æ— éœ€å››å¤„å¯»æ‰¾å·¥å…·ï¼Œä¸“æ³¨äºåˆ›ä½œä»£ç çš„è‰ºæœ¯ã€‚

**æœ€ä½³å®è·µ**ï¼š  
- *è‡ªåŠ¨åŒ–æ ¼å¼åŒ–*ï¼šå°† `deno fmt` é›†æˆåˆ°ç¼–è¾‘å™¨æˆ– Git é’©å­ï¼Œä¿æŒä»£ç é£æ ¼ä¸€è‡´ã€‚  
  *Tipsï¼šä½¿ç”¨ `deno fmt --check` æ£€æŸ¥æ ¼å¼åŒ–é—®é¢˜ï¼Œé¿å…æäº¤ä¸è§„èŒƒçš„ä»£ç ã€‚*

- *æµ‹è¯•é©±åŠ¨å¼€å‘*ï¼šåˆ©ç”¨ Deno çš„æµ‹è¯•æ¡†æ¶ï¼Œç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿ä»£ç å¥å£®æ€§ã€‚  
  *Tipsï¼šç»“åˆ `deno coverage` ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼Œä¼˜åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚*

## Deno çš„ç”Ÿæ€ä¸å·¥å…·ï¼šä» Deno KV åˆ° Fresh

Deno çš„ç”Ÿæ€è™½ç„¶å¹´è½»ï¼Œä½†å‘å±•è¿…é€Ÿã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®å·¥å…·å’Œæ¡†æ¶ï¼Œå€¼å¾—å‰ç«¯å¼€å‘è€…å…³æ³¨ã€‚

### 1. Deno KVï¼šè½»é‡çº§æ•°æ®åº“

Deno KV æ˜¯ä¸€ä¸ªå†…ç½®çš„é”®å€¼å­˜å‚¨æ•°æ®åº“ï¼Œé€‚åˆå°å‹åº”ç”¨æˆ–åŸå‹å¼€å‘ã€‚

```typescript
// kv_example.ts
const kv = await Deno.openKv();
await kv.set(["users", "sousuke"], { name: "Sousuke", role: "Developer" });
const result = await kv.get(["users", "sousuke"]);
console.log(result.value);
```

è¿è¡Œï¼š

```bash
deno run --allow-read --allow-write kv_example.ts
```

**æœ€ä½³å®è·µ**ï¼š  
- *ç”¨ä½œç¼“å­˜*ï¼šDeno KV é€‚åˆå­˜å‚¨ä¸´æ—¶æ•°æ®ï¼Œå¦‚ç”¨æˆ·ä¼šè¯æˆ– API å“åº”ç¼“å­˜ã€‚  
  *Tipsï¼šå®šæœŸæ¸…ç†è¿‡æœŸé”®å€¼å¯¹ï¼Œé¿å…æ•°æ®åº“è†¨èƒ€ã€‚*

### 2. Freshï¼šä¸‹ä¸€ä»£ Web æ¡†æ¶

Fresh æ˜¯ Deno ç”Ÿæ€çš„æ˜æ˜Ÿæ¡†æ¶ï¼Œä¸“æ³¨äºæ€§èƒ½å’Œç®€å•æ€§ï¼Œæ”¯æŒæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰å’Œé™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰ã€‚

```typescript
// routes/index.tsx
import { Handlers, PageProps } from "$fresh/server.ts";

export const handler: Handlers = {
  GET(_req, ctx) {
    return ctx.render({ message: "Welcome to Fresh!" });
  },
};

export default function Home({ data }: PageProps) {
  return <h1>{data.message}</h1>;
}
```

è¿è¡Œï¼š

```bash
deno run -A dev.ts
```

**æœ€ä½³å®è·µ**ï¼š  
- *æ‹¥æŠ± Islands æ¶æ„*ï¼šFresh çš„ Islands æ¶æ„è®©å®¢æˆ·ç«¯ JavaScript æŒ‰éœ€åŠ è½½ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚  
  *Tipsï¼šå°†éäº¤äº’ç»„ä»¶ä¿æŒä¸ºé™æ€å†…å®¹ï¼Œå‡å°‘å®¢æˆ·ç«¯è´Ÿæ‹…ã€‚*

## Deno vs Node.jsï¼šä¸€åœºæŠ€æœ¯ä¸å“²å­¦çš„å¯¹è¯

ä»¥ä¸‹æ˜¯å¯¹æ¯”è¡¨æ ¼ï¼Œç›´è§‚å±•ç¤º Deno å’Œ Node.js çš„å·®å¼‚ï¼š

| **ç‰¹æ€§**                | **Deno**                                                                 | **Node.js**                                                             |
|-------------------------|--------------------------------------------------------------------------|-------------------------------------------------------------------------|
| **æ¨¡å—ç³»ç»Ÿ**            | ES Moduleï¼ŒåŸç”Ÿæ”¯æŒ URL å¯¼å…¥                                             | CommonJS + ES Moduleï¼ˆéƒ¨åˆ†æ”¯æŒï¼‰                                        |
| **ä¾èµ–ç®¡ç†**            | æ—  `node_modules`ï¼Œä¾èµ–ä» URL åŠ è½½                                       | npm/yarn/pnpmï¼Œä¾èµ–å­˜å‚¨åœ¨ `node_modules`                                |
| **TypeScript æ”¯æŒ**     | åŸç”Ÿæ”¯æŒï¼Œæ— éœ€ç¼–è¯‘é…ç½®                                                   | éœ€è¦ `ts-node` æˆ– `tsc` ç­‰é¢å¤–å·¥å…·                                      |
| **å®‰å…¨æ¨¡å‹**            | å®‰å…¨æ²™ç®±ï¼Œé»˜è®¤æ— æƒé™ï¼Œéœ€æ˜¾å¼æˆäºˆ                                         | é»˜è®¤å…¨æƒè®¿é—®æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œ                                              |
| **å†…ç½®å·¥å…·**            | æ ¼å¼åŒ–ã€Lintã€æµ‹è¯•ã€æ‰“åŒ…ç­‰ä¸€åº”ä¿±å…¨                                       | éœ€ä¾èµ– ESLintã€Prettierã€Jest ç­‰ç¬¬ä¸‰æ–¹å·¥å…·                               |
| **Web æ ‡å‡† API**        | æ”¯æŒ `fetch`ã€`WebSocket` ç­‰ï¼Œæ¥è¿‘æµè§ˆå™¨ API                             | è‡ªå®šä¹‰ APIï¼ˆå¦‚ `http`ï¼‰ï¼Œéœ€é€‚é…                                         |
| **ç”Ÿæ€æˆç†Ÿåº¦**          | å¹´è½»ä½†å¿«é€Ÿå¢é•¿ï¼ˆFreshã€Deno KV ç­‰ï¼‰                                      | æˆç†Ÿï¼Œæ‹¥æœ‰åºå¤§çš„ npm ç”Ÿæ€                                               |

**å“²å­¦æ€è€ƒ**ï¼šDeno å’Œ Node.js çš„å¯¹æ¯”ä¸ä»…æ˜¯æŠ€æœ¯çš„è¾ƒé‡ï¼Œæ›´æ˜¯ä¸¤ç§ä¸–ç•Œè§‚çš„ç¢°æ’ã€‚Node.js ä»£è¡¨å®ç”¨ä¸»ä¹‰ï¼ŒåŒ…å®¹å†å²åŒ…è¢±ä»¥æ¢å–ç”Ÿæ€çš„ç¹è£ï¼›Deno åˆ™è¿½æ±‚æç®€ä¸çº¯ç²¹ï¼Œå®æ„¿ä»å¤´å¼€å§‹ä¹Ÿè¦ç¬¦åˆç°ä»£ Web çš„ç†æƒ³ã€‚è¿™è®©æˆ‘ä»¬æ€è€ƒï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬æ˜¯åœ¨è¿½é€çœ¼å‰çš„æ•ˆç‡ï¼Œè¿˜æ˜¯æ„¿æ„ä¸ºæœªæ¥çš„ä¼˜é›…è€ŒåŠªåŠ›ï¼Ÿ

> â€œæŠ€æœ¯æ˜¯çŸ­æš‚çš„ï¼Œç†å¿µæ˜¯æ°¸æ’çš„ã€‚â€  
> â€”â€” çµæ„Ÿæºè‡ªã€Šç¦…ä¸æ‘©æ‰˜è½¦ç»´ä¿®è‰ºæœ¯ã€‹

## æœ€ä½³å®è·µï¼šè®© Deno æˆä¸ºä½ çš„å¾—åŠ›åŠ©æ‰‹

ä»¥ä¸‹æ˜¯é’ˆå¯¹å‰ç«¯å¼€å‘è€…çš„ Deno æœ€ä½³å®è·µï¼Œç»“åˆå®é™…æ¡ˆä¾‹ï¼Œç¡®ä¿å®ç”¨æ€§å’Œå¯æ“ä½œæ€§ã€‚

1. **é¡¹ç›®åˆå§‹åŒ–**  
   ä½¿ç”¨ `deno init` å¿«é€Ÿåˆ›å»ºé¡¹ç›®ï¼Œç”Ÿæˆ `deno.json` å’ŒåŸºæœ¬æ–‡ä»¶ç»“æ„ã€‚  
   *Tipsï¼šå°† `deno.json` çš„ `tasks` å­—æ®µç”¨äºå®šä¹‰å¸¸ç”¨è„šæœ¬ï¼Œå¦‚ `deno task dev` è¿è¡Œå¼€å‘æœåŠ¡å™¨ã€‚*

2. **æ¨¡å—ç®¡ç†**  
   åˆ›å»º `import_map.json` ç®€åŒ– URL å¯¼å…¥ï¼š

   ```json
   {
     "imports": {
       "std/": "https://deno.land/std@0.224.0/"
     }
   }
   ```

   ç„¶ååœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

   ```typescript
   import { serve } from "std/http/server.ts";
   ```

   *Tipsï¼šå®šæœŸæ›´æ–° `import_map.json` ä¸­çš„ç‰ˆæœ¬å·ï¼Œç¡®ä¿ä¾èµ–å®‰å…¨ã€‚*

3. **é”™è¯¯å¤„ç†**  
   å°è£…å…¨å±€é”™è¯¯å¤„ç†é€»è¾‘ï¼š

   ```typescript
   async function fetchWithRetry(url: string, retries = 3): Promise<Response> {
     for (let i = 0; i < retries; i++) {
       try {
         return await fetch(url);
       } catch (error) {
         if (i === retries - 1) throw error;
         await new Promise((resolve) => setTimeout(resolve, 1000));
       }
     }
     throw new Error("Max retries reached");
   }
   ```

   *Tipsï¼šå°†é”™è¯¯æ—¥å¿—å†™å…¥æ–‡ä»¶ï¼ˆéœ€ `--allow-write`ï¼‰ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§ã€‚*

4. **æ€§èƒ½ä¼˜åŒ–**  
   ä½¿ç”¨ Deno çš„ `--inspect` åˆ†ææ€§èƒ½ç“¶é¢ˆï¼š

   ```bash
   deno run --inspect server.ts
   ```

   *Tipsï¼šç»“åˆ Chrome DevTools çš„ Profilerï¼Œå®šä½ CPU å¯†é›†å‹ä»£ç ã€‚*

## Deno çš„æœªæ¥ï¼šä»æŠ€æœ¯åˆ°äººç”Ÿçš„å¯ç¤º

Deno ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ï¼Œå®ƒè¿˜æ‰¿è½½äº†ä¸€ç§å¯¹æŠ€æœ¯æœªæ¥çš„æƒ³è±¡ã€‚å®ƒçš„å®‰å…¨æ¨¡å‹æé†’æˆ‘ä»¬ï¼Œè‡ªç”±éœ€è¦è¾¹ç•Œï¼›å®ƒçš„ Web æ ‡å‡†æ”¯æŒå‘Šè¯‰æˆ‘ä»¬ï¼Œç»Ÿä¸€çš„åŠ›é‡å¯ä»¥è·¨è¶Šå¹³å°ï¼›å®ƒçš„å»ä¸­å¿ƒåŒ–ä¾èµ–ç®¡ç†å¯å‘æˆ‘ä»¬ï¼Œå¼€æ”¾çš„ç”Ÿæ€æ¯”å°é—­çš„å„æ–­æ›´æœ‰ç”Ÿå‘½åŠ›ã€‚

ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬æ¯å¤©éƒ½åœ¨ä¸ä»£ç ã€å·¥å…·å’Œæ¡†æ¶æ‰“äº¤é“ï¼Œä½†æŠ€æœ¯åªæ˜¯æ‰‹æ®µï¼ŒçœŸæ­£çš„ç›®çš„æ˜¯åˆ›é€ ä»·å€¼ã€‚Deno çš„ä¼˜é›…ä¸çº¯ç²¹ï¼Œè®©æˆ‘æƒ³èµ·äº†ã€Šç“¦å°”ç™»æ¹–ã€‹ä¸­æ¢­ç½—çš„é‚£å¥è¯ï¼š

> â€œæˆ‘æ­¥å…¥ä¸›æ—ï¼Œå› ä¸ºæˆ‘å¸Œæœ›ç”Ÿæ´»å¾—æœ‰æ„ä¹‰â€¦â€¦æˆ‘å¸Œæœ›æ±²å–ç”Ÿæ´»çš„ç²¾é«“ã€‚â€

åœ¨ä»£ç çš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬ä½•å°ä¸æ˜¯åœ¨å¯»æ‰¾é‚£ä»½â€œç²¾é«“â€ï¼ŸDeno æ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œå®ƒé¼“åŠ±æˆ‘ä»¬æŠ›å¼ƒå†—ä½™ï¼Œè¿½æ±‚ç®€å•ï¼Œæ‹¥æŠ±æœªæ¥ã€‚æˆ–è®¸ï¼Œå†™ä»£ç å°±åƒå†™è¯—ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯å¯¹ä¸–ç•Œçš„è¯ é‡Šï¼Œæ¯ä¸€ä¸ªé¡¹ç›®éƒ½æ˜¯å¯¹è‡ªæˆ‘çš„æ¢ç´¢ã€‚

## ç»“è¯­ï¼šä»¥ Deno ä¸ºèˆŸï¼Œé©¶å‘æ˜Ÿè¾°å¤§æµ·

äº²çˆ±çš„ Sousukeï¼ŒDeno æ˜¯ä¸€ä¸ªå€¼å¾—ä½ æ·±å…¥æ¢ç´¢çš„è¿è¡Œæ—¶ã€‚å®ƒä¸ä»…èƒ½æå‡ä½ çš„å¼€å‘æ•ˆç‡ï¼Œè¿˜èƒ½è®©ä½ é‡æ–°æ€è€ƒæŠ€æœ¯çš„æ„ä¹‰ã€‚æ— è®ºæ˜¯æ„å»ºä¸€ä¸ªç®€å•çš„ API æœåŠ¡å™¨ï¼Œè¿˜æ˜¯å¼€å‘ä¸€ä¸ªå¤æ‚çš„ Web åº”ç”¨ï¼ŒDeno éƒ½èƒ½ä»¥å®ƒç‹¬ç‰¹çš„æ–¹å¼é™ªä¼´ä½ ã€‚

> â€œç”Ÿæ´»æ˜¯ä¸€åœºå†’é™©ï¼Œä»£ç æ˜¯ä½ çš„åœ°å›¾ã€‚â€  
> â€”â€” åŸåˆ›

æ„¿ä½ åœ¨ Deno çš„ä¸–ç•Œé‡Œï¼Œæ‰¾åˆ°å±äºè‡ªå·±çš„è¯—æ„ä¸åŠ›é‡ã€‚è®©æˆ‘ä»¬ä¸€èµ·ï¼Œä»¥ä»£ç ä¸ºèˆŸï¼Œé©¶å‘é‚£ç‰‡å±äºå‰ç«¯å¼€å‘è€…çš„æ˜Ÿè¾°å¤§æµ·ï¼ğŸŒŒ

---