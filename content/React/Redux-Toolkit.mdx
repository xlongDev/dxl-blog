---
title: "ä»€ä¹ˆæ˜¯ Redux Toolkitï¼Ÿ"
date: "2022-12-18"
description: "æ·±å…¥è§£æ Redux Toolkit çš„æ ¸å¿ƒæ¦‚å¿µã€ä½¿ç”¨åœºæ™¯ä¸å®ç°åŸç†ï¼Œå¸¦ä½ ä»å…¥é—¨åˆ°ç²¾é€šè¿™ä¸ªç°ä»£å‰ç«¯çŠ¶æ€ç®¡ç†ç¥å™¨ã€‚"
keywords: "Redux Toolkit, Redux, çŠ¶æ€ç®¡ç†, React, å‰ç«¯å¼€å‘, JavaScript, RTK Query"
author: "æ™“é¾™"
image: "/images/hero/redux-toolkit.jpg"
tags: ["Redux", "React", "çŠ¶æ€ç®¡ç†", "å‰ç«¯å¼€å‘"]
category: "JavaScript"
---

å˜¿ï¼Œå‰ç«¯çš„å°ä¼™ä¼´ä»¬ ğŸ‘‹ï¼Œä½ æœ‰æ²¡æœ‰åœ¨é¡¹ç›®ä¸­è¢«çŠ¶æ€ç®¡ç†æå¾—ç„¦å¤´çƒ‚é¢ï¼Ÿå…¨å±€çŠ¶æ€ä¹±é£ï¼Œç»„ä»¶ä¹‹é—´ä¼ å‚åƒæ¥åŠ›èµ›è·‘ï¼Œè°ƒè¯•çš„æ—¶å€™æ¨ä¸å¾—æŠŠç”µè„‘ç ¸äº†ï¼Ÿåˆ«æ€¥ï¼Œä»Šå¤©æˆ‘ä»¬è¦èŠèŠ **Redux Toolkit**â€”â€”è¿™ä¸ªå·ç§°â€œRedux å®˜æ–¹äº²å„¿å­â€çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚å®ƒä¸ä»…èƒ½æ‹¯æ•‘ä½ çš„ä»£ç ï¼Œè¿˜èƒ½è®©ä½ çš„å¼€å‘ä½“éªŒä»â€œåœ°ç‹±æ¨¡å¼â€åˆ‡æ¢åˆ°â€œåº¦å‡æ¨¡å¼â€ ğŸŒ´ã€‚

Redux Toolkitï¼ˆç®€ç§° RTKï¼‰æ˜¯ Redux çš„å®˜æ–¹æ¨èå·¥å…·é›†ï¼Œæ—¨åœ¨ç®€åŒ– Redux çš„ä½¿ç”¨æµç¨‹ï¼Œå‡å°‘æ ·æ¿ä»£ç ï¼ŒåŒæ—¶ä¿ç•™ Redux çš„æ ¸å¿ƒä¼˜åŠ¿ï¼šå¯é¢„æµ‹çš„çŠ¶æ€ç®¡ç†å’Œå¼ºå¤§çš„è°ƒè¯•èƒ½åŠ›ã€‚å®ƒçš„ slogan æ˜¯ï¼šâ€œThe official, opinionated, batteries-included toolset for efficient Redux developmentâ€ï¼ˆå®˜æ–¹çš„ã€æœ‰æ€åº¦çš„ã€å¼€ç®±å³ç”¨çš„ Redux å¼€å‘å·¥å…·é›†ï¼‰ã€‚å¬èµ·æ¥æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒç‘å£«å†›åˆ€çš„æ„Ÿè§‰ï¼ŸğŸ”§

è¿™ç¯‡æ–‡ç« æˆ‘ä¼šå¸¦ä½ ä»é›¶å¼€å§‹ï¼Œæ·±å…¥å‰–æ Redux Toolkit çš„æ ¸å¿ƒåŠŸèƒ½ã€å®ç°åŸç†ï¼Œè¿˜æœ‰ä¸€äº›å®æˆ˜æŠ€å·§å’Œæœ€ä½³å®è·µã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·è·³è¿›è¿™ä¸ªçŠ¶æ€ç®¡ç†çš„æ·±æµ·å§ï¼ğŸ³

## Redux Toolkit è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ

åœ¨èŠ RTK ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆææ¸…æ¥š Redux çš„â€œåŸç½ªâ€ã€‚ä¼ ç»Ÿ Redux è™½ç„¶å¼ºå¤§ï¼Œä½†ç”¨èµ·æ¥å°±åƒåœ¨ç»„è£…ä¸€å°è€å¼æ”¶éŸ³æœºï¼šä¸€å †é›¶ä»¶ï¼ˆaction creatorsã€reducersã€store é…ç½®ï¼‰ï¼Œè¿˜å¾—è‡ªå·±åŠ¨æ‰‹ç„Šæ¥ï¼ˆæ‰‹åŠ¨åˆå¹¶ reducerã€é…ç½® middlewareï¼‰ã€‚ç»“æœå‘¢ï¼Ÿä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨åŠŸèƒ½ï¼Œå¯èƒ½å¾—å†™ 50 è¡Œä»£ç ï¼Œè°ƒè¯•çš„æ—¶å€™è¿˜å¾—ç¥ˆç¥·è‡ªå·±æ²¡å†™é”™ `type` çš„æ‹¼å†™ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œç»å…¸ Redux çš„è®¡æ•°å™¨å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š

```javascript
// actions.js
const INCREMENT = "INCREMENT";
const DECREMENT = "DECREMENT";

export const increment = () => ({ type: INCREMENT });
export const decrement = () => ({ type: DECREMENT });

// reducer.js
const initialState = { count: 0 };

export const counterReducer = (state = initialState, action) => {
  switch (action.type) {
    case INCREMENT:
      return { ...state, count: state.count + 1 };
    case DECREMENT:
      return { ...state, count: state.count - 1 };
    default:
      return state;
  }
};

// store.js
import { createStore } from "redux";
import { counterReducer } from "./reducer";

export const store = createStore(counterReducer);
```

çœ‹åˆ°æ²¡ï¼Ÿå°±ä¸ºäº†å®ç°ä¸ªåŠ å‡åŠŸèƒ½ï¼Œå¾—å†™è¿™ä¹ˆå¤šä»£ç ï¼Œè¿˜è¦æ‰‹åŠ¨ç®¡ç†æ–‡ä»¶ç»“æ„ã€‚ç¨å¾®å¤æ‚ä¸€ç‚¹çš„é¡¹ç›®ï¼Œä»£ç é‡ç›´æ¥èµ·é£ âœˆï¸ã€‚æ›´åˆ«æä»€ä¹ˆ immutable æ›´æ–°ã€å¼‚æ­¥æ“ä½œï¼ˆéœ€è¦ `redux-thunk` æˆ– `redux-saga`ï¼‰ï¼Œç®€ç›´æ˜¯å‰ç«¯å¼€å‘è€…çš„å™©æ¢¦ã€‚

Redux Toolkit å°±åƒæ˜¯ç»™ä½ é€æ¥äº†ä¸€å°é¢„è£…å¥½ç³»ç»Ÿçš„ç”µè„‘ï¼šå¼€ç®±å³ç”¨ï¼Œçœå»ç¹ççš„é…ç½®ï¼Œè¿˜é™„å¸¦ä¸€å †å®ç”¨æ’ä»¶ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³é—®é¢˜ï¼š

1. **å‡å°‘æ ·æ¿ä»£ç **ï¼šç”¨ `createSlice` ä¸€æ¬¡æ€§æå®š actions å’Œ reducersã€‚
2. **å†…ç½® immutable å·¥å…·**ï¼šåŸºäº Immerï¼Œè®©çŠ¶æ€æ›´æ–°æ›´ç›´è§‚ã€‚
3. **å¼€ç®±å³ç”¨çš„é»˜è®¤é…ç½®**ï¼šé»˜è®¤é›†æˆ thunk å’Œ DevToolsã€‚
4. **RTK Query**ï¼šä¸€ä¸ªå¼ºå¤§çš„æ•°æ®è·å–å’Œç¼“å­˜å·¥å…·ï¼Œå ªç§°â€œå‰ç«¯åç«¯æ²Ÿé€šçš„æ•‘æ˜Ÿâ€ã€‚

## Redux Toolkit çš„æ ¸å¿ƒåŠŸèƒ½

å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šå¹²è´§ã€‚RTK çš„æ ¸å¿ƒåŠŸèƒ½å¯ä»¥åˆ†æˆå‡ ä¸ªæ¨¡å—ï¼Œä¸‹é¢æˆ‘é€ä¸€æ‹†è§£ã€‚

### 1. `createSlice`ï¼šä¸€ç«™å¼çŠ¶æ€ç®¡ç†

`createSlice` æ˜¯ RTK çš„æ˜æ˜ŸåŠŸèƒ½ï¼Œå®ƒæŠŠ action typesã€action creators å’Œ reducers æ‰“åŒ…æˆä¸€ä¸ªå‡½æ•°ã€‚ç”¨å®ƒå†™ä»£ç å°±åƒç‚¹å¤–å–ï¼šå‘Šè¯‰å®ƒä½ æƒ³è¦å•¥ï¼ˆstate å’Œé€»è¾‘ï¼‰ï¼Œå®ƒç›´æ¥ç»™ä½ åšå¥½é€ä¸Šé—¨ã€‚

æ¥çœ‹ä¸ªä¾‹å­ï¼š

```javascript
import { createSlice } from "@reduxjs/toolkit";

const counterSlice = createSlice({
  name: "counter", // slice çš„å‘½åç©ºé—´
  initialState: { count: 0 },
  reducers: {
    increment: (state) => {
      state.count += 1; // ç›´æ¥æ”¹ï¼ä¸ç”¨ ...state
    },
    decrement: (state) => {
      state.count -= 1;
    },
    incrementByAmount: (state, action) => {
      state.count += action.payload;
    },
  },
});

export const { increment, decrement, incrementByAmount } = counterSlice.actions;
export default counterSlice.reducer;
```

æ˜¯ä¸æ˜¯ç®€å•åˆ°é£èµ·ï¼Ÿâœ¨ è¿™é‡Œæœ‰å‡ ä¸ªäº®ç‚¹ï¼š

- **è‡ªåŠ¨ç”Ÿæˆ action creators**ï¼šä½ ä¸ç”¨å†æ‰‹å†™ `type` å’Œ `return { type, payload }`ã€‚
- **å†…ç½® Immer**ï¼šå¯ä»¥ç›´æ¥ä¿®æ”¹ `state`ï¼ŒèƒŒåç”¨ Immer ä¿è¯ immutableã€‚
- **å‘½åç©ºé—´**ï¼š`name` ä¼šä½œä¸º action type çš„å‰ç¼€ï¼Œæ¯”å¦‚ `counter/increment`ã€‚

ç±»æ¯”ä¸€ä¸‹ï¼Œ`createSlice` å°±åƒæ˜¯ä½ çš„ç§äººå¨å¸ˆï¼šä½ å‘Šè¯‰ä»–èœå•ï¼ˆreducersï¼‰ï¼Œä»–å¸®ä½ æŠŠèœï¼ˆactions å’Œ reducerï¼‰åšå¥½ç«¯ä¸Šæ¥ã€‚

### 2. `configureStore`ï¼šçœå¿ƒçš„ Store é…ç½®

ä¼ ç»Ÿ Redux çš„ `createStore` éœ€è¦ä½ æ‰‹åŠ¨é…ç½® middlewareã€reducer åˆå¹¶ã€DevTools é›†æˆã€‚RTK çš„ `configureStore` ç›´æ¥ç»™ä½ ä¸€ä¸ªâ€œå…¨å®¶æ¡¶â€ï¼š

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./counterSlice";

const store = configureStore({
  reducer: {
    counter: counterReducer,
  },
});

export default store;
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåŒ…å«äº† `redux-thunk` å’Œ Redux DevTools æ”¯æŒã€‚å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰ middlewareï¼Œä¹Ÿå¯ä»¥è½»æ¾æ‰©å±•ï¼š

```javascript
const store = configureStore({
  reducer: {
    counter: counterReducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(myCustomMiddleware),
});
```

è¿™å°±åƒä¹°äº†ä¸ªæ™ºèƒ½å®¶å±…ç³»ç»Ÿï¼šæ’ä¸Šç”µå°±èƒ½ç”¨ï¼Œè¿˜èƒ½æŒ‰éœ€åŠ è£…é…ä»¶ã€‚

### 3. `createAsyncThunk`ï¼šå¼‚æ­¥æ“ä½œçš„å¾—åŠ›åŠ©æ‰‹

å¤„ç†å¼‚æ­¥é€»è¾‘æ˜¯çŠ¶æ€ç®¡ç†çš„é‡å¤´æˆã€‚RTK æä¾›äº† `createAsyncThunk`ï¼Œè®©å¼‚æ­¥æ“ä½œå˜å¾—ä¼˜é›…åˆå¯æ§ã€‚

å‡è®¾æˆ‘ä»¬è¦ä» API è·å–ç”¨æˆ·ä¿¡æ¯ï¼š

```javascript
import { createAsyncThunk, createSlice } from "@reduxjs/toolkit";

export const fetchUser = createAsyncThunk("user/fetch", async (userId) => {
  const response = await fetch(`https://api.example.com/users/${userId}`);
  return response.json();
});

const userSlice = createSlice({
  name: "user",
  initialState: { data: null, loading: false, error: null },
  extraReducers: (builder) => {
    builder
      .addCase(fetchUser.pending, (state) => {
        state.loading = true;
      })
      .addCase(fetchUser.fulfilled, (state, action) => {
        state.loading = false;
        state.data = action.payload;
      })
      .addCase(fetchUser.rejected, (state, action) => {
        state.loading = false;
        state.error = action.error.message;
      });
  },
});

export default userSlice.reducer;
```

`createAsyncThunk` ä¼šç”Ÿæˆä¸‰ä¸ª action typesï¼š`pending`ã€`fulfilled` å’Œ `rejected`ï¼Œå¯¹åº”å¼‚æ­¥è¯·æ±‚çš„ä¸‰ä¸ªçŠ¶æ€ã€‚ä½ å¯ä»¥åœ¨ `extraReducers` é‡Œå¤„ç†è¿™äº›çŠ¶æ€ï¼Œç®€ç›´æ˜¯å¼‚æ­¥ç®¡ç†çš„â€œå‚»ç“œå¼æ•™ç¨‹â€ã€‚

### 4. RTK Queryï¼šæ•°æ®è·å–çš„ç»ˆææ­¦å™¨

RTK Query æ˜¯ RTK çš„â€œéšè—å½©è›‹â€ï¼Œä¸€ä¸ªå†…ç½®çš„æ•°æ®è·å–å’Œç¼“å­˜å·¥å…·ã€‚å®ƒèƒ½å¸®ä½ å¤„ç† API è¯·æ±‚ã€ç¼“å­˜æ•°æ®ã€è‡ªåŠ¨é‡è¯•ï¼Œç”šè‡³è¿˜èƒ½è·Ÿ UI çŠ¶æ€åŒæ­¥ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œè·å–ç”¨æˆ·åˆ—è¡¨ï¼š

```javascript
import { createApi, fetchBaseQuery } from "@reduxjs/toolkit/query/react";

export const userApi = createApi({
  reducerPath: "userApi",
  baseQuery: fetchBaseQuery({ baseUrl: "https://api.example.com/" }),
  endpoints: (builder) => ({
    getUsers: builder.query({
      query: () => "users",
    }),
    getUserById: builder.query({
      query: (id) => `users/${id}`,
    }),
  }),
});

export const { useGetUsersQuery, useGetUserByIdQuery } = userApi;
```

ç„¶ååœ¨ç»„ä»¶é‡Œç”¨ hooks è°ƒç”¨ï¼š

```javascript
import { useGetUsersQuery } from "./userApi";

function UserList() {
  const { data, error, isLoading } = useGetUsersQuery();

  if (isLoading) return <div>åŠ è½½ä¸­...</div>;
  if (error) return <div>å‡ºé”™å•¦: {error.message}</div>;

  return (
    <ul>
      {data.map((user) => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
}
```

RTK Query è‡ªå¸¦ç¼“å­˜ã€è‡ªåŠ¨é‡æ–°è·å–ï¼ˆrefetchï¼‰ã€ä¹è§‚æ›´æ–°ç­‰åŠŸèƒ½ï¼Œç®€ç›´æ˜¯â€œå‰ç«¯ç¨‹åºå‘˜çš„æ‡’äººç¦éŸ³â€ ğŸ˜‚ã€‚

## æ·±å…¥åŸç†ï¼šRTK æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

RTK çš„é­”æ³•èƒŒåå…¶å®æ²¡é‚£ä¹ˆç¥ç§˜ï¼Œä¸»è¦é è¿™å‡ ä¸ªæ”¯æŸ±ï¼š

1. **Immer**ï¼šRTK ç”¨ Immer æ¥å¤„ç†çŠ¶æ€çš„ä¸å¯å˜æ€§ã€‚ä½ å†™çš„â€œå¯å˜â€ä»£ç ï¼ˆ`state.count += 1`ï¼‰ä¼šè¢« Immer è½¬æ¢æˆ immutable æ“ä½œï¼ˆ`{ ...state, count: state.count + 1 }`ï¼‰ï¼Œæ—¢ç›´è§‚åˆå®‰å…¨ã€‚
2. **Proxy**ï¼šImmer ç”¨ Proxy æ‹¦æˆªä½ çš„çŠ¶æ€ä¿®æ”¹ï¼Œç”Ÿæˆæ–°çš„çŠ¶æ€æ ‘ã€‚
3. **Action Creator ç”Ÿæˆå™¨**ï¼š`createSlice` é€šè¿‡å­—ç¬¦ä¸²æ¨¡æ¿åŠ¨æ€ç”Ÿæˆ action types å’Œ creatorsï¼Œå‡å°‘æ‰‹åŠ¨å·¥ä½œã€‚
4. **Thunk ä¸­é—´ä»¶**ï¼šé»˜è®¤é›†æˆ `redux-thunk`ï¼Œè®©å¼‚æ­¥é€»è¾‘æ›´ç®€å•ã€‚
5. **RTK Query çš„ç¼“å­˜æœºåˆ¶**ï¼šåŸºäºè§„èŒƒåŒ–ç¼“å­˜ï¼ˆnormalized cacheï¼‰ï¼Œé€šè¿‡ endpoint å’Œå‚æ•°ç”Ÿæˆå”¯ä¸€ keyï¼Œé¿å…é‡å¤è¯·æ±‚ã€‚

ç±»æ¯”ä¸€ä¸‹ï¼ŒRTK å°±åƒä¸ªé«˜æ•ˆçš„å·¥å‚ï¼šä½ ä¸¢è¿›å»åŸææ–™ï¼ˆstate å’Œé€»è¾‘ï¼‰ï¼Œå®ƒå¸®ä½ åŠ å·¥æˆæˆå“ï¼ˆaction å’Œ reducerï¼‰ï¼Œè¿˜é™„å¸¦è´¨æ£€ï¼ˆimmutableï¼‰å’Œç‰©æµï¼ˆstoreï¼‰æœåŠ¡ã€‚

## æœ€ä½³å®è·µï¼šå¦‚ä½•ç”¨å¥½ RTKï¼Ÿ

å…‰çŸ¥é“æ€ä¹ˆç”¨è¿˜ä¸å¤Ÿï¼Œä¸‹é¢æ˜¯ä¸€äº›å®æˆ˜ç»éªŒï¼Œå¸®ä½ åœ¨é¡¹ç›®é‡ŒæŠŠ RTK ç”¨å¾—é£èµ·ï¼š

### 1. åˆç†åˆ’åˆ† Slice
åˆ«æŠŠæ‰€æœ‰çŠ¶æ€å¡åˆ°ä¸€ä¸ª slice é‡Œï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ã€‚æ¯”å¦‚ç”¨æˆ·ç›¸å…³çŠ¶æ€æ”¾ `userSlice`ï¼Œè´­ç‰©è½¦æ”¾ `cartSlice`ï¼Œè¿™æ ·ä»£ç æ›´æ¸…æ™°ï¼Œç»´æŠ¤ä¹Ÿæ–¹ä¾¿ã€‚

### 2. ç”¨ RTK Query æ›¿ä»£æ‰‹åŠ¨ fetch
å¦‚æœä½ çš„é¡¹ç›®æ¶‰åŠå¤§é‡ API è°ƒç”¨ï¼Œåˆ«å†æ‰‹å†™ `fetch` äº†ï¼Œç›´æ¥ä¸Š RTK Queryã€‚å®ƒèƒ½å¸®ä½ çœä¸‹ç®¡ç† loadingã€error çš„éº»çƒ¦ï¼Œè¿˜èƒ½ä¼˜åŒ–æ€§èƒ½ã€‚

### 3. å–„ç”¨ `select` å‡½æ•°
ä» store é‡Œå–æ•°æ®æ—¶ï¼Œç”¨ `createSelector`ï¼ˆRTK è‡ªå¸¦ Reselectï¼‰åš memoizationï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—ï¼š

```javascript
import { createSelector } from "@reduxjs/toolkit";

const selectCounter = (state) => state.counter.count;
export const selectDoubleCount = createSelector(selectCounter, (count) => count * 2);
```

### 4. ä¿æŒ action ç®€æ´
action çš„ payload å°½é‡åªä¼ å¿…è¦æ•°æ®ï¼Œåˆ«æŠŠæ•´ä¸ªå¯¹è±¡ä¸¢è¿›å»ã€‚æ¯”å¦‚ `incrementByAmount(5)` æ¯” `incrementByAmount({ amount: 5, timestamp: Date.now() })` æ›´ç®€æ´ã€‚

### 5. è°ƒè¯•ç”¨å¥½ DevTools
RTK é»˜è®¤æ”¯æŒ Redux DevToolsï¼Œè°ƒè¯•æ—¶å¯ä»¥æŸ¥çœ‹æ¯ä¸ª action çš„ diffï¼Œå¿«é€Ÿå®šä½é—®é¢˜ã€‚

## ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼šTodo List

æˆ‘ä»¬ç”¨ RTK å®ç°ä¸€ä¸ªç®€å•çš„ Todo Listï¼Œå±•ç¤ºå®ƒçš„å¨åŠ›ï¼š

```javascript
import { createSlice } from "@reduxjs/toolkit";

const todoSlice = createSlice({
  name: "todos",
  initialState: {
    items: [],
    filter: "all", // all, completed, active
  },
  reducers: {
    addTodo: (state, action) => {
      state.items.push({ id: Date.now(), text: action.payload, completed: false });
    },
    toggleTodo: (state, action) => {
      const todo = state.items.find((t) => t.id === action.payload);
      if (todo) todo.completed = !todo.completed;
    },
    setFilter: (state, action) => {
      state.filter = action.payload;
    },
  },
});

export const { addTodo, toggleTodo, setFilter } = todoSlice.actions;
export default todoSlice.reducer;

// selectors
export const selectFilteredTodos = (state) => {
  const { items, filter } = state.todos;
  if (filter === "completed") return items.filter((t) => t.completed);
  if (filter === "active") return items.filter((t) => !t.completed);
  return items;
};

// store
import { configureStore } from "@reduxjs/toolkit";
import todoReducer from "./todoSlice";

export const store = configureStore({
  reducer: {
    todos: todoReducer,
  },
});

// React ç»„ä»¶
import { useDispatch, useSelector } from "react-redux";
import { addTodo, toggleTodo, setFilter, selectFilteredTodos } from "./todoSlice";

function TodoApp() {
  const dispatch = useDispatch();
  const todos = useSelector(selectFilteredTodos);

  return (
    <div>
      <input
        onKeyDown={(e) => {
          if (e.key === "Enter") {
            dispatch(addTodo(e.target.value));
            e.target.value = "";
          }
        }}
      />
      <ul>
        {todos.map((todo) => (
          <li
            key={todo.id}
            onClick={() => dispatch(toggleTodo(todo.id))}
            style={{ textDecoration: todo.completed ? "line-through" : "none" }}
          >
            {todo.text}
          </li>
        ))}
      </ul>
      <div>
        <button onClick={() => dispatch(setFilter("all"))}>å…¨éƒ¨</button>
        <button onClick={() => dispatch(setFilter("active"))}>æœªå®Œæˆ</button>
        <button onClick={() => dispatch(setFilter("completed"))}>å·²å®Œæˆ</button>
      </div>
    </div>
  );
}
```

è¿™ä¸ªä¾‹å­å±•ç¤ºäº† RTK çš„æ ¸å¿ƒåŠŸèƒ½ï¼šç®€æ´çš„ slice å®šä¹‰ã€ç›´æ¥çš„çŠ¶æ€ä¿®æ”¹ã€selectors çš„çµæ´»æ€§ã€‚ç”¨èµ·æ¥æ˜¯ä¸æ˜¯æ¯”ä¼ ç»Ÿ Redux çˆ½å¤šäº†ï¼ŸğŸ˜

## æ€»ç»“ï¼šRTK å€¼å¾—å­¦å—ï¼Ÿ

Redux Toolkit ç»å¯¹æ˜¯ç°ä»£å‰ç«¯å¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚å®ƒä¸ä»…è®© Redux çš„å­¦ä¹ æ›²çº¿å˜å¾—å¹³ç¼“ï¼Œè¿˜åœ¨æ€§èƒ½ã€è°ƒè¯•å’Œä»£ç ç»„ç»‡ä¸Šæä¾›äº†å·¨å¤§æå‡ã€‚å¦‚æœä½ è¿˜åœ¨çŠ¹è±«è¦ä¸è¦ç”¨ RTKï¼Œæˆ‘æƒ³è¯´ï¼šåˆ«çŠ¹è±«äº†ï¼Œèµ¶ç´§ä¸Šè½¦å§ï¼ğŸš€

å½“ç„¶ï¼ŒRTK ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ã€‚å¦‚æœä½ çš„é¡¹ç›®çŠ¶æ€ç®¡ç†éœ€æ±‚å¾ˆç®€å•ï¼Œå¯èƒ½ç”¨ Context + useReducer å°±å¤Ÿäº†ã€‚ä½†ä¸€æ—¦é¡¹ç›®è§„æ¨¡å˜å¤§ï¼Œæ¶‰åŠå¤æ‚çš„çŠ¶æ€é€»è¾‘å’Œå¼‚æ­¥æ“ä½œï¼ŒRTK å°±æ˜¯ä½ çš„æœ€ä½³æ‹æ¡£ã€‚

æœ€åï¼Œé€ä½ ä¸€å¥è¯ï¼š**â€œRedux Toolkit ä¸æ˜¯ Redux çš„æ›¿ä»£å“ï¼Œè€Œæ˜¯ Redux çš„è¿›åŒ–ç‰ˆã€‚â€** å®ƒä¿ç•™äº† Redux çš„ç²¾é«“ï¼ˆå¯é¢„æµ‹æ€§ã€å•ä¸€æ•°æ®æºï¼‰ï¼Œåˆç”¨ç°ä»£åŒ–çš„æ–¹å¼è®©å®ƒç„•å‘æ–°ç”Ÿã€‚è¯•è¯•çœ‹ï¼Œä¹Ÿè®¸ä½ ä¼šçˆ±ä¸Šè¿™ç§â€œæœ‰ç»„ç»‡çš„çŠ¶æ€ç®¡ç†ç”Ÿæ´»â€ï¼

æœ‰ä»€ä¹ˆé—®é¢˜æˆ–è€…æƒ³èŠèŠ RTK çš„ä½¿ç”¨å¿ƒå¾—ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºæ‰¾æˆ‘å” å—‘ï¼ğŸ‘‡

---