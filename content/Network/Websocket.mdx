---
title: "WebSocketæ¼«è°ˆï¼šä»HTTPå•è¡Œé“åˆ°å®æ—¶åŒè½¦é“çš„è·ƒè¿ ğŸš€"
date: "2024-04-10"
description: "æ·±å…¥å‰–æ WebSocket çš„åŸç†ã€åº”ç”¨ä¸å®è·µï¼Œæ¢ç´¢å…¶ä» HTTP å•å‘é€šä¿¡åˆ°å®æ—¶åŒå‘é€šä¿¡çš„é©å‘½æ€§è½¬å˜ï¼Œé€‚åˆå‰ç«¯å¼€å‘è€…æ·±å…¥å­¦ä¹ ã€‚"
keywords: "WebSocket, å®æ—¶é€šä¿¡, HTTP, å‰ç«¯å¼€å‘, ç½‘ç»œåè®®, å®æ—¶åº”ç”¨, åŒå‘é€šä¿¡"
author: "æ™“é¾™"
image: "/images/hero/websocket.jpg"
tags: ["WebSocket", "å®æ—¶é€šä¿¡", "å‰ç«¯å¼€å‘", "ç½‘ç»œåè®®"]
category: "Network"
---

> â€œå‡¡æ˜¯è¿‡å¾€ï¼Œçš†ä¸ºåºç« ã€‚â€ â€”â€” èå£«æ¯”äºšã€Šæš´é£é›¨ã€‹

åœ¨Webå¼€å‘çš„æµ©ç€šæ˜Ÿæµ·ä¸­ï¼ŒHTTPæ›¾æ˜¯æˆ‘ä»¬å”¯ä¸€çš„ç¯å¡”ï¼ŒæŒ‡å¼•ç€æ•°æ®åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„å•è¡Œé“ä¸Šå·æµä¸æ¯ã€‚ç„¶è€Œï¼Œæ—¶ä»£åœ¨å˜ï¼Œåº”ç”¨çš„å¤æ‚æ€§ä¸ç”¨æˆ·å¯¹å®æ—¶äº¤äº’çš„æ¸´æ±‚ï¼Œè®©HTTPçš„å•å‘é€šä¿¡æ˜¾å¾—æœ‰äº›åŠ›ä¸ä»å¿ƒã€‚WebSocketåº”è¿è€Œç”Ÿï¼Œå®ƒå¦‚åŒä¸€åº§è·¨è¶Šæ•°æ®å­¤å²›çš„æ¡¥æ¢ï¼Œå°†å•è¡Œé“å‡çº§ä¸ºå®æ—¶åŒè½¦é“ï¼Œè®©ä¿¡æ¯æµç•…åœ°åŒå‘å¥”è…¾ã€‚

æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥WebSocketçš„ä¸–ç•Œï¼Œä»å®ƒçš„è¯ç”ŸèƒŒæ™¯åˆ°æ ¸å¿ƒåŸç†ï¼Œä»å®é™…åº”ç”¨åˆ°æœ€ä½³å®è·µï¼Œå±‚å±‚é€’è¿›ï¼Œå¨“å¨“é“æ¥ã€‚æ— è®ºä½ æ˜¯åˆšå…¥è¡Œçš„æ–°æ‰‹ï¼Œè¿˜æ˜¯èº«ç»ç™¾æˆ˜çš„è€å…µï¼Œè¿™é‡Œæ€»æœ‰èƒ½è®©ä½ ä¼šå¿ƒä¸€ç¬‘æˆ–é†é†çŒé¡¶çš„å†…å®¹ã€‚è®©æˆ‘ä»¬ä¸€èµ·ï¼Œä¹˜ç€WebSocketçš„ä¸œé£ï¼Œæ¢ç´¢å®æ—¶é€šä¿¡çš„è¯—æ„ä¸å“²å­¦ï¼ğŸŒŒ

---

## ç›®å½•

1. **å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦WebSocketï¼Ÿ**
2. **ä»HTTPåˆ°WebSocketï¼šä¸€åœºé€šä¿¡çš„é©å‘½**
   - HTTPçš„å•è¡Œé“
   - WebSocketçš„åŒè½¦é“
   - åè®®å¯¹æ¯”ï¼šHTTP vs WebSocket
3. **WebSocketçš„æ ¸å¿ƒåŸç†**
   - æ¡æ‰‹è¿‡ç¨‹ï¼šä»HTTPåˆ°WebSocketçš„æ¡¥æ¢
   - å¸§ç»“æ„ï¼šæ•°æ®ä¼ è¾“çš„åŸºçŸ³
   - å¿ƒè·³æœºåˆ¶ä¸è¿æ¥ä¿æŒ
4. **WebSocketçš„åº”ç”¨åœºæ™¯**
   - å®æ—¶èŠå¤©ï¼šä»IMåˆ°ç¤¾äº¤å¹³å°
   - åœ¨çº¿åä½œï¼šæ–‡æ¡£ã€ç”»æ¿ä¸ç™½æ¿
   - å®æ—¶æ•°æ®æ¨é€ï¼šé‡‘èã€ä½“è‚²ä¸ç‰©è”ç½‘
5. **WebSocketçš„å®ç°ï¼šä»å‰ç«¯åˆ°åç«¯**
   - å‰ç«¯ï¼šåŸç”ŸWebSocket APIä¸åº“
   - åç«¯ï¼šNode.jsã€Pythonä¸Javaçš„å®ç°
   - ç¤ºä¾‹ï¼šä¸€ä¸ªç®€å•çš„å®æ—¶èŠå¤©å®¤
6. **WebSocketçš„æœ€ä½³å®è·µ**
   - è¿æ¥ç®¡ç†ï¼šä¼˜é›…åœ°å»ºç«‹ä¸æ–­å¼€
   - é”™è¯¯å¤„ç†ï¼šä»æ‰çº¿åˆ°é‡è¿
   - å®‰å…¨æ€§ï¼šè®¤è¯ã€åŠ å¯†ä¸é˜²å¾¡
   - æ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘å»¶è¿Ÿä¸èµ„æºå ç”¨
7. **WebSocketçš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ**
   - å…¼å®¹æ€§ä¸é™çº§ç­–ç•¥
   - è´Ÿè½½å‡è¡¡ä¸åˆ†å¸ƒå¼éƒ¨ç½²
   - è°ƒè¯•ä¸ç›‘æ§
8. **WebSocketçš„æœªæ¥ï¼šä»åè®®åˆ°ç”Ÿæ€**
   - WebSocketä¸WebRTCçš„å¯¹æ¯”
   - ä¸‹ä¸€ä»£åè®®ï¼šWebTransportçš„æ½œåŠ›
   - å®æ—¶é€šä¿¡çš„æ¶æ„å“²å­¦
9. **æ€»ç»“ï¼šWebSocketçš„è¯—æ„ä¸åŠ›é‡**

---

## 1. å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦WebSocketï¼Ÿ ğŸ¤”

åœ¨Webå¼€å‘çš„æ—©æœŸï¼ŒHTTPåè®®ä»¥å…¶ç®€å•ã€å¯é çš„ç‰¹ç‚¹ï¼Œæˆä¸ºäº†äº’è”ç½‘çš„åŸºçŸ³ã€‚æ— è®ºæ˜¯æµè§ˆç½‘é¡µã€æäº¤è¡¨å•ï¼Œè¿˜æ˜¯åŠ è½½å›¾ç‰‡ï¼ŒHTTPçš„è¯·æ±‚-å“åº”æ¨¡å‹éƒ½æ¸¸åˆƒæœ‰ä½™ã€‚ç„¶è€Œï¼Œéšç€Webåº”ç”¨çš„å¤æ‚åº¦é£™å‡ï¼Œç”¨æˆ·å¯¹å®æ—¶æ€§çš„éœ€æ±‚å˜å¾—æ„ˆå‘è¿«åˆ‡ã€‚

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨ç”¨ä¸€ä¸ªèŠå¤©åº”ç”¨ï¼Œå‘é€ä¸€æ¡æ¶ˆæ¯åéœ€è¦æ‰‹åŠ¨åˆ·æ–°é¡µé¢æ‰èƒ½çœ‹åˆ°å¯¹æ–¹çš„å›å¤â€”â€”è¿™å°±åƒåœ¨é«˜é€Ÿå…¬è·¯ä¸Šéª‘è‡ªè¡Œè½¦ï¼Œæ•ˆç‡ä½å¾—è®©äººæŠ“ç‹‚ï¼ğŸ˜… åˆæˆ–è€…ï¼Œä½ åœ¨å…³æ³¨è‚¡ç¥¨è¡Œæƒ…ï¼Œæ•°æ®æ¯éš”å‡ ç§’æ‰æ›´æ–°ä¸€æ¬¡ï¼Œé”™è¿‡äº†å…³é”®çš„ä¹°å–æ—¶æœºï¼Œè¿™ç®€ç›´æ˜¯é‡‘èç•Œçš„â€œé¾Ÿé€Ÿæ‚²å‰§â€ã€‚

WebSocketçš„å‡ºç°ï¼Œæ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›ç—›ç‚¹ã€‚å®ƒä¸ä»…è®©å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å¯ä»¥åŒå‘é€šä¿¡ï¼Œè¿˜èƒ½åœ¨è¿æ¥å»ºç«‹åä»¥æä½çš„å¼€é”€æŒç»­æ¨é€æ•°æ®ã€‚å°±åƒä»ä¸€æ¡å•è¡Œé“å‡çº§åˆ°åŒå‘é«˜é€Ÿè·¯ï¼ŒWebSocketè®©å®æ—¶äº¤äº’å˜å¾—å¦‚ä¸èˆ¬é¡ºæ»‘ã€‚

> â€œæ¬²é€Ÿåˆ™ä¸è¾¾ï¼Œè§å°åˆ©åˆ™å¤§äº‹ä¸æˆã€‚â€ â€”â€” ã€Šè®ºè¯­ã€‹  
> ä½†åœ¨WebSocketçš„ä¸–ç•Œé‡Œï¼Œé€Ÿåº¦ä¸å¤§äº‹å…¼å¾—ï¼âš¡

---

## 2. ä»HTTPåˆ°WebSocketï¼šä¸€åœºé€šä¿¡çš„é©å‘½

### 2.1 HTTPçš„å•è¡Œé“ ğŸš¶â€â™‚ï¸

HTTPæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·ï¼ŒæœåŠ¡ç«¯è¢«åŠ¨å“åº”ã€‚è¿™ç§æ¨¡å¼åœ¨é™æ€ç½‘é¡µæ—¶ä»£å ªç§°å®Œç¾ï¼Œä½†åœ¨å®æ—¶åº”ç”¨ä¸­å´æ˜¾å¾—æ‰è¥è§è‚˜ã€‚ä¸ºäº†æ¨¡æ‹Ÿå®æ—¶æ•ˆæœï¼Œå‰ç«¯å¼€å‘è€…ä»¬ä½¿å‡ºäº†æµ‘èº«è§£æ•°ï¼š

- **è½®è¯¢ï¼ˆPollingï¼‰**ï¼šå®¢æˆ·ç«¯æ¯éš”å‡ ç§’å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¯¢é—®æœåŠ¡ç«¯æ˜¯å¦æœ‰æ–°æ•°æ®ã€‚  
  *ç¼ºç‚¹*ï¼šé¢‘ç¹è¯·æ±‚å¯¼è‡´æœåŠ¡å™¨å‹åŠ›å·¨å¤§ï¼Œå»¶è¿Ÿé«˜ï¼Œèµ„æºæµªè´¹ä¸¥é‡ã€‚å°±åƒä½ æ¯éš”ä¸€åˆ†é’Ÿé—®æœ‹å‹â€œåˆ°å“ªå„¿äº†ï¼Ÿâ€ï¼Œæ—¢çƒ¦äººåˆä½æ•ˆã€‚

- **é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰**ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚åï¼ŒæœåŠ¡ç«¯æŒ‚èµ·è¿æ¥ï¼Œç›´åˆ°æœ‰æ–°æ•°æ®æ‰è¿”å›ã€‚  
  *ç¼ºç‚¹*ï¼šè™½ç„¶å‡å°‘äº†è¯·æ±‚æ¬¡æ•°ï¼Œä½†ä¾ç„¶æ˜¯HTTPçš„å•å‘æ¨¡å¼ï¼Œè¿æ¥ç®¡ç†å¤æ‚ï¼Œä¸”ä¸é€‚åˆé«˜é¢‘æ›´æ–°åœºæ™¯ã€‚

- **Server-Sent Eventsï¼ˆSSEï¼‰**ï¼šæœåŠ¡ç«¯å¯ä»¥å•å‘æ¨é€æ•°æ®ï¼Œé€‚åˆå®æ—¶é€šçŸ¥åœºæ™¯ã€‚  
  *ç¼ºç‚¹*ï¼šä¾ç„¶åŸºäºHTTPï¼Œæ— æ³•å®ç°å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„ä¸»åŠ¨æ¨é€ã€‚

è¿™äº›æ–¹æ³•å°±åƒåœ¨å•è¡Œé“ä¸ŠåŠ è£…ä¿¡å·ç¯ï¼Œè™½ç„¶ç¼“è§£äº†æ‹¥å µï¼Œä½†æœ¬è´¨ä¸Šä»æ˜¯å•å‘é€šè¡Œã€‚

### 2.2 WebSocketçš„åŒè½¦é“ ğŸ›£ï¸

WebSocketåˆ™å®Œå…¨ä¸åŒã€‚å®ƒåŸºäºTCPåè®®ï¼Œé€šè¿‡ä¸€æ¬¡HTTPæ¡æ‰‹å»ºç«‹æŒä¹…è¿æ¥ï¼Œä¹‹åå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å¯ä»¥éšæ—¶åŒå‘å‘é€æ•°æ®ã€‚å®ƒçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š

- **å…¨åŒå·¥é€šä¿¡**ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ï¼Œå‘Šåˆ«â€œè½®è¯¢â€çš„ä½æ•ˆã€‚
- **ä½å¼€é”€**ï¼šæ¡æ‰‹å®Œæˆåï¼Œæ•°æ®é€šè¿‡è½»é‡çº§å¸§ä¼ è¾“ï¼Œç›¸æ¯”HTTPçš„å¤´éƒ¨å¼€é”€å°å¾—å¤šã€‚
- **æŒä¹…è¿æ¥**ï¼šä¸€æ¬¡è¿æ¥å¯é•¿æœŸä¿æŒï¼Œé€‚åˆé«˜é¢‘ã€å®æ—¶åœºæ™¯ã€‚

ç”¨ä¸€ä¸ªæ¯”å–»æ¥è¯´ï¼ŒHTTPåƒæ˜¯å¯„ä¿¡ï¼Œæ¯æ¬¡éƒ½è¦å†™ä¿¡å°ã€è´´é‚®ç¥¨ã€ç­‰å›ä¿¡ï¼›è€ŒWebSocketåƒæ˜¯æ¥é€šäº†ç”µè¯ï¼ŒåŒæ–¹å¯ä»¥éšæ—¶ç•…èŠï¼Œæ¯«æ— å»¶è¿Ÿã€‚

### 2.3 åè®®å¯¹æ¯”ï¼šHTTP vs WebSocket

ä»¥ä¸‹æ˜¯ä¸¤è€…çš„æ ¸å¿ƒå·®å¼‚ï¼Œæ¸…æ™°å‘ˆç°äºè¡¨æ ¼ä¸­ï¼š

| **ç‰¹æ€§**                | **HTTP**                              | **WebSocket**                        |
|-------------------------|---------------------------------------|--------------------------------------|
| **é€šä¿¡æ¨¡å¼**            | è¯·æ±‚-å“åº”ï¼ˆå•å‘ï¼‰                    | å…¨åŒå·¥ï¼ˆåŒå‘ï¼‰                      |
| **è¿æ¥ç±»å‹**            | çŸ­è¿æ¥ï¼ˆæ¯æ¬¡è¯·æ±‚æ–°å»ºï¼‰               | æŒä¹…è¿æ¥ï¼ˆä¸€æ¬¡æ¡æ‰‹ï¼Œé•¿æœŸå¤ç”¨ï¼‰      |
| **åè®®**                | HTTP/1.1, HTTP/2                     | ws:// æˆ– wss://ï¼ˆåŸºäºTCPï¼‰          |
| **æ•°æ®æ ¼å¼**            | æ–‡æœ¬ã€JSONã€è¡¨å•ç­‰                   | å¸§ï¼ˆæ–‡æœ¬ã€äºŒè¿›åˆ¶ç­‰ï¼‰                |
| **å¼€é”€**                | æ¯æ¬¡è¯·æ±‚åŒ…å«å¤§é‡å¤´éƒ¨                 | æ¡æ‰‹åå¸§å¤´æå°                      |
| **é€‚ç”¨åœºæ™¯**            | é™æ€é¡µé¢ã€è¡¨å•æäº¤                   | å®æ—¶èŠå¤©ã€åä½œå·¥å…·ã€æ•°æ®æ¨é€        |
| **å»¶è¿Ÿ**                | é«˜ï¼ˆè½®è¯¢æˆ–é•¿è½®è¯¢ï¼‰                   | ä½ï¼ˆå®æ—¶ä¼ è¾“ï¼‰                      |
| **å¤æ‚åº¦**              | ç®€å•ï¼ˆæ— çŠ¶æ€ï¼‰                       | ç¨å¤æ‚ï¼ˆéœ€ç®¡ç†è¿æ¥ï¼‰                |

*Tipsï¼šé€‰æ‹©åè®®æ—¶ï¼Œå…ˆæ˜ç¡®åœºæ™¯éœ€æ±‚ã€‚é™æ€å†…å®¹ç”¨HTTPï¼Œå®æ—¶äº¤äº’é€‰WebSocketã€‚*

---

## 3. WebSocketçš„æ ¸å¿ƒåŸç† ğŸ› ï¸

è¦çœŸæ­£æŒæ¡WebSocketï¼Œç†è§£å…¶åº•å±‚åŸç†è‡³å…³é‡è¦ã€‚ä»¥ä¸‹ä»æ¡æ‰‹ã€å¸§ç»“æ„åˆ°å¿ƒè·³æœºåˆ¶ï¼Œå¸¦ä½ ä¸€çª¥å…¶å†…æ ¸ã€‚

### 3.1 æ¡æ‰‹è¿‡ç¨‹ï¼šä»HTTPåˆ°WebSocketçš„æ¡¥æ¢

WebSocketçš„è¿æ¥å§‹äºä¸€æ¬¡ç‰¹æ®Šçš„HTTPè¯·æ±‚ï¼Œç§°ä¸ºâ€œå‡çº§è¯·æ±‚â€ã€‚å®¢æˆ·ç«¯å‘é€å¸¦æœ‰`Upgrade: websocket`å¤´çš„HTTPè¯·æ±‚ï¼ŒæœåŠ¡ç«¯å“åº”`101 Switching Protocols`ï¼Œå®Œæˆåè®®åˆ‡æ¢ã€‚

**æ¡æ‰‹æµç¨‹**ï¼š
1. å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚ï¼š
   ```http
   GET /chat HTTP/1.1
   Host: example.com
   Upgrade: websocket
   Connection: Upgrade
   Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==
   Sec-WebSocket-Version: 13
   ```
2. æœåŠ¡ç«¯éªŒè¯`Sec-WebSocket-Key`ï¼Œç”Ÿæˆ`Sec-WebSocket-Accept`å¹¶è¿”å›ï¼š
   ```http
   HTTP/1.1 101 Switching Protocols
   Upgrade: websocket
   Connection: Upgrade
   Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
   ```
3. æ¡æ‰‹æˆåŠŸï¼Œè¿æ¥åˆ‡æ¢ä¸ºWebSocketåè®®ï¼ŒåŒæ–¹è¿›å…¥å…¨åŒå·¥æ¨¡å¼ã€‚

*Tipsï¼šç¡®ä¿æœåŠ¡ç«¯æ­£ç¡®å¤„ç†`Sec-WebSocket-Key`ï¼Œå¦åˆ™æ¡æ‰‹å¤±è´¥ä¼šå¯¼è‡´è¿æ¥ä¸­æ–­ã€‚*

### 3.2 å¸§ç»“æ„ï¼šæ•°æ®ä¼ è¾“çš„åŸºçŸ³

WebSocketçš„æ•°æ®ä¼ è¾“ä»¥â€œå¸§â€ä¸ºå•ä½ï¼Œæ¯ä¸ªå¸§åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
- **FIN**ï¼šè¡¨ç¤ºæ˜¯å¦ä¸ºæ¶ˆæ¯çš„æœ€åä¸€å¸§ã€‚
- **Opcode**ï¼šå®šä¹‰å¸§ç±»å‹ï¼ˆå¦‚æ–‡æœ¬ã€äºŒè¿›åˆ¶ã€å…³é—­ç­‰ï¼‰ã€‚
- **Mask**ï¼šå®¢æˆ·ç«¯å‘é€çš„å¸§å¿…é¡»æ©ç ï¼ŒæœåŠ¡ç«¯æ— éœ€ã€‚
- **Payload**ï¼šå®é™…æ•°æ®å†…å®¹ã€‚

å¸§ç»“æ„è®©WebSocketæ—¢è½»é‡åˆçµæ´»ï¼Œæ”¯æŒæ–‡æœ¬ã€äºŒè¿›åˆ¶ç”šè‡³è‡ªå®šä¹‰æ ¼å¼çš„æ•°æ®ä¼ è¾“ã€‚

*Tipsï¼šå¤„ç†å¤§æ¶ˆæ¯æ—¶ï¼Œå»ºè®®åˆ†å¸§ä¼ è¾“ï¼Œé¿å…ä¸€æ¬¡æ€§å‘é€è¿‡å¤§æ•°æ®å¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚*

### 3.3 å¿ƒè·³æœºåˆ¶ä¸è¿æ¥ä¿æŒ â¤ï¸

WebSocketè¿æ¥æ˜¯æŒä¹…çš„ï¼Œä½†ç½‘ç»œç¯å¢ƒå¤æ‚ï¼Œè¿æ¥å¯èƒ½å› è¶…æ—¶æˆ–å¼‚å¸¸æ–­å¼€ã€‚å¿ƒè·³æœºåˆ¶é€šè¿‡å®šæœŸå‘é€`Ping/Pong`å¸§ï¼Œæ£€æµ‹è¿æ¥æ˜¯å¦å­˜æ´»ã€‚

**å®ç°æ–¹å¼**ï¼š
- å®¢æˆ·ç«¯æ¯éš”30ç§’å‘é€`Ping`å¸§ã€‚
- æœåŠ¡ç«¯å“åº”`Pong`å¸§ï¼Œæˆ–ä¸»åŠ¨å‘é€`Ping`ã€‚
- è‹¥ä¸€å®šæ—¶é—´å†…æœªæ”¶åˆ°å“åº”ï¼Œåˆ™è®¤ä¸ºè¿æ¥æ–­å¼€ï¼Œè§¦å‘é‡è¿ã€‚

*Tipsï¼šå¿ƒè·³é—´éš”ä¸å®œè¿‡çŸ­ï¼Œä»¥å…å¢åŠ æœåŠ¡å™¨è´Ÿæ‹…ï¼›ä¹Ÿä¸å®œè¿‡é•¿ï¼Œä»¥å…å»¶è¿Ÿæ£€æµ‹æ–­è¿ã€‚*

---

## 4. WebSocketçš„åº”ç”¨åœºæ™¯ ğŸŒ

WebSocketçš„èˆå°æ— æ¯”å¹¿é˜”ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå…¸å‹åœºæ™¯åŠå…¶å®ç°æ€è·¯ã€‚

### 4.1 å®æ—¶èŠå¤©ï¼šä»IMåˆ°ç¤¾äº¤å¹³å°

ä»å¾®ä¿¡åˆ°Slackï¼Œå®æ—¶èŠå¤©æ˜¯WebSocketçš„ç»å…¸åº”ç”¨ã€‚ç”¨æˆ·å‘é€æ¶ˆæ¯åï¼ŒæœåŠ¡ç«¯é€šè¿‡WebSocketå³æ—¶æ¨é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚

**ç¤ºä¾‹**ï¼šä¸€ä¸ªç®€å•çš„ç¾¤èŠç³»ç»Ÿï¼š
- å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯åˆ°æœåŠ¡ç«¯ã€‚
- æœåŠ¡ç«¯å¹¿æ’­æ¶ˆæ¯åˆ°æ‰€æœ‰åœ¨çº¿ç”¨æˆ·ã€‚
- æ¯ä¸ªå®¢æˆ·ç«¯é€šè¿‡WebSocketæ¥æ”¶å¹¶æ¸²æŸ“æ¶ˆæ¯ã€‚

*Tipsï¼šä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…å”¯ä¸€IDï¼ŒæœåŠ¡ç«¯ç»´æŠ¤ç”¨æˆ·-è¿æ¥æ˜ å°„ï¼Œä¼˜åŒ–æ¶ˆæ¯åˆ†å‘æ•ˆç‡ã€‚*

### 4.2 åœ¨çº¿åä½œï¼šæ–‡æ¡£ã€ç”»æ¿ä¸ç™½æ¿

åƒGoogle Docsã€Figmaè¿™æ ·çš„å·¥å…·ï¼Œä¾èµ–WebSocketå®ç°å¤šäººå®æ—¶åä½œã€‚ç”¨æˆ·ç¼–è¾‘å†…å®¹æ—¶ï¼ŒæœåŠ¡ç«¯é€šè¿‡WebSocketåŒæ­¥å¢é‡æ›´æ–°ã€‚

**ç¤ºä¾‹**ï¼šå¤šäººç”»æ¿ï¼š
- ç”¨æˆ·ç»˜åˆ¶çº¿æ¡ï¼Œå®¢æˆ·ç«¯å‘é€åæ ‡æ•°æ®ã€‚
- æœåŠ¡ç«¯å¹¿æ’­åæ ‡åˆ°å…¶ä»–ç”¨æˆ·ï¼Œå®æ—¶é‡ç»˜ã€‚

*Tipsï¼šä½¿ç”¨æ“ä½œè½¬æ¢ï¼ˆOperational Transformationï¼‰æˆ–CRDTç®—æ³•ï¼Œè§£å†³å¹¶å‘ç¼–è¾‘å†²çªã€‚*

### 4.3 å®æ—¶æ•°æ®æ¨é€ï¼šé‡‘èã€ä½“è‚²ä¸ç‰©è”ç½‘

è‚¡ç¥¨è¡Œæƒ…ã€ä½“è‚²æ¯”åˆ†ã€ä¼ æ„Ÿå™¨æ•°æ®ç­‰åœºæ™¯éœ€è¦é«˜é¢‘æ›´æ–°ï¼ŒWebSocketæ˜¯ç†æƒ³é€‰æ‹©ã€‚

**ç¤ºä¾‹**ï¼šè‚¡ç¥¨è¡Œæƒ…æ¨é€ï¼š
- æœåŠ¡ç«¯æ¯ç§’æ¨é€æœ€æ–°è‚¡ä»·ã€‚
- å®¢æˆ·ç«¯é€šè¿‡WebSocketæ¥æ”¶å¹¶æ›´æ–°å›¾è¡¨ã€‚

*Tipsï¼šå¯¹é«˜é¢‘æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼ˆå¦‚Protocol Buffersï¼‰ï¼Œå‡å°‘ä¼ è¾“ä½“ç§¯ã€‚*

---

## 5. WebSocketçš„å®ç°ï¼šä»å‰ç«¯åˆ°åç«¯ ğŸ–¥ï¸

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„å®æ—¶èŠå¤©å®¤ç¤ºä¾‹ï¼Œå±•ç¤ºWebSocketçš„å‰åç«¯å®ç°ã€‚

### 5.1 å‰ç«¯ï¼šåŸç”ŸWebSocket APIä¸åº“

åŸç”ŸWebSocket APIç®€å•æ˜“ç”¨ï¼š
```javascript
const socket = new WebSocket('ws://example.com/chat');

socket.onopen = () => console.log('è¿æ¥æˆåŠŸï¼ğŸ‰');
socket.onmessage = (event) => console.log('æ”¶åˆ°æ¶ˆæ¯ï¼š', event.data);
socket.onclose = () => console.log('è¿æ¥å…³é—­ğŸ˜¢');
socket.onerror = (error) => console.error('å‡ºé”™ï¼š', error);

socket.send('Hello, WebSocket!');
```

å¯¹äºå¤æ‚åœºæ™¯ï¼Œæ¨èä½¿ç”¨åº“å¦‚`Socket.IO`ï¼Œå®ƒæä¾›è‡ªåŠ¨é‡è¿ã€æˆ¿é—´ç®¡ç†ç­‰åŠŸèƒ½ã€‚

*Tipsï¼šä½¿ç”¨`Socket.IO`æ—¶ï¼Œæ³¨æ„å…¶é»˜è®¤ä½¿ç”¨é•¿è½®è¯¢ä½œä¸ºé™çº§æ–¹æ¡ˆï¼Œå¯èƒ½å¢åŠ å»¶è¿Ÿã€‚*

### 5.2 åç«¯ï¼šNode.jså®ç°

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„Node.js WebSocketæœåŠ¡ï¼Œä½¿ç”¨`ws`åº“ï¼š
```javascript
const WebSocket = require('ws');
const server = new WebSocket.Server({ port: 8080 });

server.on('connection', (ws) => {
  console.log('æ–°ç”¨æˆ·è¿æ¥ï¼');
  ws.on('message', (message) => {
    server.clients.forEach((client) => {
      if (client.readyState === WebSocket.OPEN) {
        client.send(message.toString());
      }
    });
  });
  ws.on('close', () => console.log('ç”¨æˆ·æ–­å¼€'));
});
```

*Tipsï¼šæœåŠ¡ç«¯éœ€éªŒè¯å®¢æˆ·ç«¯æ¥æºï¼Œé˜²æ­¢æœªç»æˆæƒçš„è¿æ¥ã€‚*

### 5.3 ç¤ºä¾‹ï¼šå®æ—¶èŠå¤©å®¤

ä»¥ä¸‹æ˜¯å®Œæ•´çš„èŠå¤©å®¤å®ç°ï¼Œå‰ç«¯ä¸åç«¯ç»“åˆï¼š

**å‰ç«¯ï¼ˆindex.htmlï¼‰**ï¼š
```html
<!DOCTYPE html>
<html>
<head>
  <title>å®æ—¶èŠå¤©å®¤</title>
  <style>
    #chat { height: 300px; overflow-y: scroll; border: 1px solid #ccc; }
    #input { width: 300px; }
  </style>
</head>
<body>
  <div id="chat"></div>
  <input id="input" type="text" placeholder="è¾“å…¥æ¶ˆæ¯...">
  <button onclick="sendMessage()">å‘é€</button>

  <script>
    const ws = new WebSocket('ws://localhost:8080');
    const chat = document.getElementById('chat');
    const input = document.getElementById('input');

    ws.onmessage = (event) => {
      const msg = document.createElement('div');
      msg.textContent = event.data;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    };

    function sendMessage() {
      if (input.value) {
        ws.send(input.value);
        input.value = '';
      }
    }
  </script>
</body>
</html>
```

**åç«¯ï¼ˆserver.jsï¼‰**ï¼š
```javascript
const WebSocket = require('ws');
const server = new WebSocket.Server({ port: 8080 });

server.on('connection', (ws) => {
  ws.on('message', (message) => {
    server.clients.forEach((client) => {
      if (client.readyState === WebSocket.OPEN) {
        client.send(message.toString());
      }
    });
  });
});
```

è¿è¡Œåï¼Œç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨è¾“å…¥æ¶ˆæ¯ï¼Œæ‰€æœ‰è¿æ¥çš„ç”¨æˆ·å°†å®æ—¶çœ‹åˆ°æ¶ˆæ¯ã€‚

*Tipsï¼šä¸ºèŠå¤©å®¤æ·»åŠ ç”¨æˆ·è®¤è¯å’Œæ¶ˆæ¯è¿‡æ»¤ï¼Œæå‡å®‰å…¨æ€§ä¸ä½“éªŒã€‚*

---

## 6. WebSocketçš„æœ€ä½³å®è·µ ğŸŒŸ

ä»¥ä¸‹æ˜¯WebSocketå¼€å‘ä¸­çš„å®ç”¨å»ºè®®ï¼ŒåŠ©ä½ æ‰“é€ å¥å£®çš„å®æ—¶åº”ç”¨ã€‚

### 6.1 è¿æ¥ç®¡ç†ï¼šä¼˜é›…åœ°å»ºç«‹ä¸æ–­å¼€

- **å»¶è¿Ÿè¿æ¥**ï¼šé¡µé¢åŠ è½½åå»¶è¿Ÿå‡ ç§’å»ºç«‹è¿æ¥ï¼Œé¿å…æœåŠ¡å™¨ç¬æ—¶å‹åŠ›ã€‚
- **ä¼˜é›…å…³é—­**ï¼šæ–­å¼€è¿æ¥æ—¶è°ƒç”¨`socket.close()`ï¼Œå¹¶ç›‘å¬`onclose`äº‹ä»¶ã€‚

*Tipsï¼šä¸ºè¿æ¥è®¾ç½®è¶…æ—¶ï¼Œè‹¥æ¡æ‰‹æœªåœ¨5ç§’å†…å®Œæˆï¼Œè‡ªåŠ¨é‡è¯•ã€‚*

### 6.2 é”™è¯¯å¤„ç†ï¼šä»æ‰çº¿åˆ°é‡è¿

- **è‡ªåŠ¨é‡è¿**ï¼šæ£€æµ‹åˆ°è¿æ¥æ–­å¼€åï¼Œä½¿ç”¨æŒ‡æ•°é€€é¿ç®—æ³•é‡è¿ã€‚
- **é”™è¯¯æç¤º**ï¼šå‘ç”¨æˆ·æ˜¾ç¤ºå‹å¥½æç¤ºï¼Œå¦‚â€œç½‘ç»œæ–­å¼€ï¼Œæ­£åœ¨é‡è¿...â€ã€‚

*Tipsï¼šè®°å½•é‡è¿æ¬¡æ•°ï¼Œè¶…è¿‡é˜ˆå€¼åæç¤ºç”¨æˆ·æ£€æŸ¥ç½‘ç»œã€‚*

### 6.3 å®‰å…¨æ€§ï¼šè®¤è¯ã€åŠ å¯†ä¸é˜²å¾¡

- **ä½¿ç”¨WSS**ï¼šå§‹ç»ˆä½¿ç”¨`wss://`åè®®ï¼Œç¡®ä¿æ•°æ®åŠ å¯†ã€‚
- **è®¤è¯**ï¼šæ¡æ‰‹åéªŒè¯ç”¨æˆ·èº«ä»½ï¼Œå¦‚é€šè¿‡Tokenã€‚
- **é˜²å¾¡XSS**ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè½¬ä¹‰ï¼Œé˜²æ­¢è„šæœ¬æ³¨å…¥ã€‚

*Tipsï¼šä¸ºæ•æ„Ÿæ“ä½œï¼ˆå¦‚ç®¡ç†å‘˜å¹¿æ’­ï¼‰æ·»åŠ é¢å¤–çš„æƒé™æ ¡éªŒã€‚*

### 6.4 æ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘å»¶è¿Ÿä¸èµ„æºå ç”¨

- **å‹ç¼©æ•°æ®**ï¼šå¯¹å¤§æ•°æ®ä½¿ç”¨Gzipæˆ–è‡ªå®šä¹‰å‹ç¼©ç®—æ³•ã€‚
- **æ‰¹é‡å‘é€**ï¼šå°†å¤šæ¬¡å°æ›´æ–°åˆå¹¶ä¸ºå•æ¬¡å‘é€ï¼Œå‡å°‘å¸§å¼€é”€ã€‚
- **é™åˆ¶è¿æ¥æ•°**ï¼šæœåŠ¡ç«¯è®¾ç½®æœ€å¤§è¿æ¥æ•°ï¼Œé˜²æ­¢è¿‡è½½ã€‚

*Tipsï¼šç›‘æ§å®¢æˆ·ç«¯çš„å¸§æ¥æ”¶é¢‘ç‡ï¼Œè‹¥è¿‡é«˜åˆ™ä¼˜åŒ–æ¶ˆæ¯é¢‘ç‡ã€‚*

---

## 7. WebSocketçš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ âš ï¸

å°½ç®¡WebSocketå¼ºå¤§ï¼Œä½†å®é™…éƒ¨ç½²ä¸­ä»é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ã€‚

### 7.1 å…¼å®¹æ€§ä¸é™çº§ç­–ç•¥

è€æ—§æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒWebSocketï¼Œéœ€æä¾›é™çº§æ–¹æ¡ˆï¼š
- ä½¿ç”¨`Socket.IO`è‡ªåŠ¨é™çº§åˆ°é•¿è½®è¯¢ã€‚
- å¯¹äºä¸æ”¯æŒWebSocketçš„åœºæ™¯ï¼Œæç¤ºç”¨æˆ·å‡çº§æµè§ˆå™¨ã€‚

*Tipsï¼šæµ‹è¯•ä¸»æµæµè§ˆå™¨çš„WebSocketå…¼å®¹æ€§ï¼Œç¡®ä¿æ— ç¼ä½“éªŒã€‚*

### 7.2 è´Ÿè½½å‡è¡¡ä¸åˆ†å¸ƒå¼éƒ¨ç½²

åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒWebSocketçš„æŒä¹…è¿æ¥éœ€è¦ç‰¹æ®Šå¤„ç†ï¼š
- **ç²˜æ€§ä¼šè¯**ï¼šç¡®ä¿åŒä¸€å®¢æˆ·ç«¯å§‹ç»ˆè¿æ¥åˆ°åŒä¸€æœåŠ¡å™¨ã€‚
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šä½¿ç”¨Redisæˆ–Kafkaå¹¿æ’­æ¶ˆæ¯åˆ°å¤šå°æœåŠ¡å™¨ã€‚

*Tipsï¼šéƒ¨ç½²æ—¶ä½¿ç”¨Nginxæ”¯æŒWebSocketçš„åå‘ä»£ç†ï¼Œé…ç½®`Upgrade`å’Œ`Connection`å¤´ã€‚*

### 7.3 è°ƒè¯•ä¸ç›‘æ§

WebSocketçš„è°ƒè¯•è¾ƒä¸ºå¤æ‚ï¼Œæ¨èå·¥å…·ï¼š
- **Chrome DevTools**ï¼šæŸ¥çœ‹WebSocketå¸§ä¸æ¡æ‰‹ä¿¡æ¯ã€‚
- **Wireshark**ï¼šæ•è·åº•å±‚TCPæ•°æ®åŒ…ã€‚
- **ç›‘æ§**ï¼šè®°å½•è¿æ¥æ•°ã€æ¶ˆæ¯é¢‘ç‡ä¸é”™è¯¯ç‡ã€‚

*Tipsï¼šä¸ºæœåŠ¡ç«¯æ·»åŠ æ—¥å¿—ï¼Œè®°å½•æ¯ä¸ªè¿æ¥çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¾¿äºæ’æŸ¥é—®é¢˜ã€‚*

---

## 8. WebSocketçš„æœªæ¥ï¼šä»åè®®åˆ°ç”Ÿæ€ ğŸ”®

WebSocketå¹¶éå®æ—¶é€šä¿¡çš„ç»ˆç‚¹ï¼Œæœªæ¥è¿˜æœ‰æ›´å¤šå¯èƒ½æ€§ã€‚

### 8.1 WebSocketä¸WebRTCçš„å¯¹æ¯”

WebRTCä¸“æ³¨äºç‚¹å¯¹ç‚¹éŸ³è§†é¢‘é€šä¿¡ï¼Œè€ŒWebSocketæ›´é€‚åˆé€šç”¨æ•°æ®ä¼ è¾“ã€‚ä¸¤è€…å¯ç»“åˆä½¿ç”¨ï¼Œå¦‚WebSocketç”¨äºä¿¡ä»¤ï¼ŒWebRTCä¼ è¾“åª’ä½“æµã€‚

*Tipsï¼šè‹¥åªéœ€æ•°æ®ä¼ è¾“ï¼ŒWebSocketæ¯”WebRTCæ›´å½¼æ­¤è½»æ¨ *Tipsï¼šä¼˜å…ˆé€‰æ‹©WebSocketï¼Œé™¤ééœ€è¦éŸ³è§†é¢‘ã€‚*

### 8.2 ä¸‹ä¸€ä»£åè®®ï¼šWebTransportçš„æ½œåŠ›

WebTransportæ˜¯HTTP/3çš„æ‰©å±•ï¼Œæ”¯æŒåŒå‘é€šä¿¡ä¸å¤šè·¯å¤ç”¨ï¼Œå¯èƒ½æˆä¸ºWebSocketçš„ç»§ä»»è€…ã€‚

*Tipsï¼šå…³æ³¨WebTransportçš„æµè§ˆå™¨æ”¯æŒï¼Œæœªæ¥å¯ä½œä¸ºWebSocketçš„æ›¿ä»£ã€‚*

### 8.3 å®æ—¶é€šä¿¡çš„æ¶æ„å“²å­¦

WebSocketçš„å‡ºç°ï¼Œä¸ä»…æ˜¯æŠ€æœ¯è¿›æ­¥ï¼Œæ›´æ˜¯æ¶æ„æ€ç»´çš„è·ƒè¿ã€‚å®ƒè®©æˆ‘ä»¬ä»â€œè¯·æ±‚-å“åº”â€çš„è¢«åŠ¨æ¨¡å¼ï¼Œè½¬å˜ä¸ºâ€œäº‹ä»¶é©±åŠ¨â€çš„ä¸»åŠ¨æ¨¡å¼ã€‚è¿™ç§æ€ç»´é€‚ç”¨äºå¾®æœåŠ¡ã€äº‹ä»¶æº¯æºç­‰ç°ä»£æ¶æ„ã€‚

> â€œä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œã€‚â€ â€”â€” ã€Šè€å­Â·åŠå­¦ã€‹  
> WebSocketçš„æ¯ä¸€æ¬¡æ¶ˆæ¯ï¼Œéƒ½æ˜¯å®æ—¶äº¤äº’çš„ä¸€å°æ­¥ï¼Œç´¯ç§¯æˆç”¨æˆ·ä½“éªŒçš„åƒé‡Œä¹‹è¡Œã€‚

---

## 9. æ€»ç»“ï¼šWebSocketçš„è¯—æ„ä¸åŠ›é‡ ğŸŒŸ

WebSocketä¸ä»…æ˜¯ä¸€ä¸ªåè®®ï¼Œæ›´æ˜¯ä¸€ç§è¿æ¥çš„è‰ºæœ¯ã€‚å®ƒè®©æˆ‘ä»¬ä»HTTPçš„å•è¡Œé“ï¼Œè¿ˆå‘å®æ—¶åŒè½¦é“ï¼Œè®©ä¿¡æ¯å¦‚é£èˆ¬è‡ªç”±æµåŠ¨ã€‚å®ƒæ˜¯æŠ€æœ¯çš„è¯—ç¯‡ï¼Œæ˜¯æ¶æ„çš„å“²å­¦ï¼Œæ˜¯ç”¨æˆ·ä½“éªŒçš„çµé­‚ã€‚

> â€œæˆ‘æœ‰ä¸€æ‰€æˆ¿å­ï¼Œé¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€ã€‚â€ â€”â€” æµ·å­  
> åœ¨WebSocketçš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬çš„æˆ¿å­é¢æœå®æ—¶çš„æ•°æ®ä¹‹æµ·ï¼Œæ˜¥æš–èŠ±å¼€ï¼Œç”¨æˆ·æ¬¢ç¬‘ã€‚

æ„¿ä½ ç”¨WebSocketï¼Œä¹¦å†™å±äºè‡ªå·±çš„å®æ—¶ä¼ å¥‡ï¼ğŸš€

---