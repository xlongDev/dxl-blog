---
title: "Vue3 ç«Ÿç„¶å¯ä»¥é€šè¿‡é«˜é˜¶ç»„ä»¶é€ä¼ æ•°æ®ï¼ŸğŸ¤¯"
date: "2024-02-18"
description: "æ·±å…¥æ¢è®¨ Vue3 é«˜é˜¶ç»„ä»¶å¦‚ä½•å®ç°æ•°æ®é€ä¼ ï¼Œæ­ç§˜å…¶åº•å±‚åŸç†ï¼Œç»“åˆå®æˆ˜æ¡ˆä¾‹ä¸æœ€ä½³å®è·µï¼Œå¸¦ä½ ç©è½¬ç»„ä»¶åŒ–å¼€å‘ï¼"
keywords: "Vue3, é«˜é˜¶ç»„ä»¶, æ•°æ®é€ä¼ , ç»„ä»¶åŒ–, å‰ç«¯å¼€å‘, Vue Composition API, Vue Slots"
author: "æ™“é¾™"
image: "/images/hero/vue3-hoc.jpg"
tags: ["Vue3", "JavaScript", "å‰ç«¯å¼€å‘", "ç»„ä»¶åŒ–"]
category: "Vue.js"
---

Vue3 ä½œä¸ºå‰ç«¯å¼€å‘çš„â€œæ–°æ™‹é¡¶æµâ€ï¼Œå¸¦æ¥äº† Composition APIã€Teleportã€Fragments ç­‰è®©äººæ‹æ‰‹å«ç»çš„åŠŸèƒ½ã€‚ä½†ä»Šå¤©æˆ‘ä»¬è¦èŠçš„ï¼Œä¸æ˜¯è¿™äº›â€œæ˜¾çœ¼åŒ…â€ï¼Œè€Œæ˜¯ä¸€ä¸ªä½è°ƒå´åˆè®©äººæƒŠå¹çš„ç©æ³•â€”â€”**é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰åœ¨ Vue3 ä¸­å®ç°æ•°æ®é€ä¼ **ï¼ğŸš€

ä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œé«˜é˜¶ç»„ä»¶ï¼Ÿè¿™ä¸æ˜¯ React çš„è€æ¢—å—ï¼ŸVue3 ä¹Ÿèƒ½ç©è¿™ä¸€å‡ºï¼Ÿâ€åˆ«æ€¥ï¼ŒVue3 çš„ HOC ä¸ä»…èƒ½ç©ï¼Œè¿˜èƒ½ç©å‡ºèŠ±å„¿æ¥ï¼å®ƒä¸ä»…èƒ½å¸®ä½ ä¼˜é›…åœ°å¤ç”¨é€»è¾‘ï¼Œè¿˜èƒ½é€šè¿‡å·§å¦™çš„æ•°æ®é€ä¼ ï¼Œè®©ç»„ä»¶é—´çš„åä½œå¦‚ä¸èˆ¬é¡ºæ»‘ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»**æ¦‚å¿µåˆ°åŸç†**ï¼Œå†åˆ°**å®æˆ˜ä¸æœ€ä½³å®è·µ**ï¼Œå…¨æ–¹ä½è§£é” Vue3 HOC çš„é­…åŠ›ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·è·³è¿›è¿™ä¸ªâ€œç»„ä»¶åŒ–é­”æ³•ä¸–ç•Œâ€ï¼ğŸª„

## ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶ï¼ŸğŸ§

é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentï¼Œç®€ç§° HOCï¼‰æœ€æ—©åœ¨ React ç¤¾åŒºé£é¡ä¸€æ—¶ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ª**æ¥å—ç»„ä»¶ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶çš„å‡½æ•°**ã€‚å¬èµ·æ¥æœ‰ç‚¹åƒâ€œç»„ä»¶åŠ å·¥å‚â€ï¼šä½ é€è¿›å»ä¸€ä¸ªæ™®é€šç»„ä»¶ï¼Œç»è¿‡ HOC çš„â€œé­”æ³•æ”¹é€ â€ï¼Œå‡ºæ¥ä¸€ä¸ªåŠŸèƒ½æ›´å¼ºå¤§çš„æ–°ç»„ä»¶ã€‚

åœ¨ Vue3 ä¸­ï¼ŒHOC çš„æ¦‚å¿µç±»ä¼¼ï¼Œä½†å®ç°æ–¹å¼æ›´è´´åˆ Vue çš„å“åº”å¼å“²å­¦ã€‚Vue3 çš„ HOC é€šå¸¸é€šè¿‡**ç»„åˆå¼ APIï¼ˆComposition APIï¼‰**å’Œ**åŠ¨æ€ç»„ä»¶**å®ç°ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯**é€»è¾‘å¤ç”¨**å’Œ**åŠŸèƒ½å¢å¼º**ã€‚è€Œä»Šå¤©æˆ‘ä»¬è¦é‡ç‚¹æ¢è®¨çš„ï¼Œæ˜¯å¦‚ä½•é€šè¿‡ HOC å®ç°**æ•°æ®é€ä¼ **â€”â€”ä¸€ç§è®©çˆ¶å­ç»„ä»¶ã€ç”šè‡³è·¨å±‚çº§ç»„ä»¶â€œå¿ƒæœ‰çµçŠ€â€çš„æŠ€å·§ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šHOC å¹¶ä¸æ˜¯ Vue3 çš„â€œå®˜æ–¹æœ¯è¯­â€ï¼Œè€Œæ˜¯ç¤¾åŒºå¯¹è¿™ç§æ¨¡å¼çš„ç§°å‘¼ã€‚ç†è§£å®ƒçš„æœ¬è´¨ï¼ˆç»„ä»¶åŠ å·¥ï¼‰æ¯”çº ç»“åå­—æ›´é‡è¦ï¼*

---

## ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®é€ä¼ ï¼ŸğŸ¤”

åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­ï¼Œçˆ¶ç»„ä»¶å¾€å¾€éœ€è¦å‘å­ç»„ä»¶ï¼ˆç”šè‡³æ›´æ·±çš„å­™å­ç»„ä»¶ï¼‰ä¼ é€’æ•°æ®ã€‚Vue æä¾›äº†å¤šç§æ–¹å¼æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œæ¯”å¦‚ **props**ã€**provide/inject**ã€**äº‹ä»¶æ€»çº¿**ï¼Œç”šè‡³æ˜¯ **Pinia/Vuex** è¿™æ ·çš„çŠ¶æ€ç®¡ç†åº“ã€‚ä½†è¿™äº›æ–¹æ¡ˆå„æœ‰å±€é™ï¼š

- **Props**ï¼šé€å±‚ä¼ é€’ï¼Œå†™å¤šäº†å®¹æ˜“â€œæ‰‹æŠ½ç­‹â€ï¼Œç»´æŠ¤èµ·æ¥ä¹Ÿéº»çƒ¦ã€‚
- **Provide/Inject**ï¼šè™½ç„¶èƒ½è·¨å±‚çº§ä¼ é€’ï¼Œä½†ä¸å¤Ÿæ˜¾å¼ï¼Œè°ƒè¯•æ—¶å®¹æ˜“â€œæ‰¾ä¸ç€åŒ—â€ã€‚
- **äº‹ä»¶æ€»çº¿**ï¼šåœ¨å°å‹é¡¹ç›®ä¸­è¿˜è¡Œï¼Œä½†åœ¨å¤æ‚é¡¹ç›®ä¸­å®¹æ˜“å˜æˆâ€œäº‹ä»¶é»‘æ´â€ã€‚
- **çŠ¶æ€ç®¡ç†åº“**ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œä½†å¼•å…¥ä¸€ä¸ªå…¨å±€çŠ¶æ€ç®¡ç†åªæ˜¯ä¸ºäº†ä¼ é€’å‡ ä¸ªç®€å•æ•°æ®ï¼Œæ„Ÿè§‰åƒâ€œæ€é¸¡ç”¨ç‰›åˆ€â€ã€‚

è€Œé€šè¿‡**é«˜é˜¶ç»„ä»¶å®ç°æ•°æ®é€ä¼ **ï¼Œå°±åƒç»™ç»„ä»¶ç©¿ä¸Šäº†ä¸€ä»¶â€œéšå½¢æ–—ç¯·â€ï¼šå®ƒæ—¢èƒ½ä¼˜é›…åœ°ä¼ é€’æ•°æ®ï¼Œåˆèƒ½ä¿æŒç»„ä»¶çš„ç‹¬ç«‹æ€§å’Œå¤ç”¨æ€§ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒHOC è¿˜èƒ½åœ¨ä¼ é€’æ•°æ®çš„è¿‡ç¨‹ä¸­â€œé¡ºæ‰‹â€å¢å¼ºç»„ä»¶çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ æƒé™æ ¡éªŒã€æ—¥å¿—è®°å½•ï¼Œç”šè‡³åŠ¨æ€åˆ‡æ¢ UI æ ·å¼ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šé€‰æ‹©æ•°æ®é€ä¼ æ–¹æ¡ˆæ—¶ï¼Œå…ˆé—®è‡ªå·±ï¼šâ€œè¿™ä¸ªæ•°æ®éœ€è¦ä¼ å¤šè¿œï¼Ÿé€»è¾‘æœ‰å¤šå¤æ‚ï¼Ÿâ€å¦‚æœåªæ˜¯å±€éƒ¨ä¼ é€’ï¼ŒHOC å¯èƒ½æ˜¯æœ€è½»é‡ä¼˜é›…çš„é€‰æ‹©ã€‚*

---

## Vue3 ä¸­é«˜é˜¶ç»„ä»¶çš„å®ç°åŸç† ğŸ› ï¸

è¦ææ‡‚ Vue3 ä¸­ HOC å¦‚ä½•å®ç°æ•°æ®é€ä¼ ï¼Œæˆ‘ä»¬å¾—å…ˆä»å®ƒçš„å®ç°åŸç†å…¥æ‰‹ã€‚åˆ«æ…Œï¼Œæˆ‘ä»¬ä¼šç”¨æœ€â€œæ¥åœ°æ°”â€çš„æ–¹å¼ï¼ŒæŠŠåº•å±‚çš„â€œé­”æ³•â€æ‹†è§£å¾—ä¸€æ¸…äºŒæ¥šï¼ğŸ”

### 1. HOC çš„åŸºæœ¬å½¢æ€

åœ¨ Vue3 ä¸­ï¼ŒHOC é€šå¸¸æ˜¯ä¸€ä¸ªè¿”å›ç»„ä»¶çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªåŸºç¡€ç»„ä»¶ï¼ˆ`BaseComponent`ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼ˆ`EnhancedComponent`ï¼‰ã€‚æ–°ç»„ä»¶å¯ä»¥ï¼š

- **ç»§æ‰¿**åŸºç¡€ç»„ä»¶çš„æ¨¡æ¿å’ŒåŠŸèƒ½ã€‚
- **æ³¨å…¥**é¢å¤–çš„é€»è¾‘ï¼Œæ¯”å¦‚æ•°æ®ã€æ–¹æ³•ã€ç”šè‡³æ˜¯æ–°çš„ propsã€‚
- **åŒ…è£…**åŸºç¡€ç»„ä»¶ï¼Œæ§åˆ¶å®ƒçš„æ¸²æŸ“è¡Œä¸ºã€‚

ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```javascript
import { defineComponent, h } from 'vue';

const withData = (BaseComponent) => {
  return defineComponent({
    name: 'EnhancedComponent',
    setup(props, { slots }) {
      const enhancedData = { message: 'Hello from HOC!' }; // æ³¨å…¥çš„æ•°æ®
      return () => h(BaseComponent, { ...props, enhancedData }, slots);
    },
  });
};
```

è¿™é‡Œï¼Œ`withData` æ˜¯ä¸€ä¸ª HOCï¼Œå®ƒæ¥å—ä¸€ä¸ª `BaseComponent`ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ã€‚æ–°ç»„ä»¶é€šè¿‡ `h` å‡½æ•°ï¼ˆVue3 çš„æ¸²æŸ“å‡½æ•°ï¼‰æ¸²æŸ“ `BaseComponent`ï¼Œå¹¶å°† `enhancedData` ä½œä¸º props ä¼ é€’è¿›å»ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šVue3 çš„ `h` å‡½æ•°æ˜¯æ‰‹åŠ¨æ¸²æŸ“ç»„ä»¶çš„â€œç‘å£«å†›åˆ€â€ï¼Œç†Ÿç»ƒä½¿ç”¨å®ƒèƒ½è®©ä½ å¯¹ç»„ä»¶æ¸²æŸ“çš„æ§åˆ¶åŠ›ç¿»å€ï¼*

### 2. æ•°æ®é€ä¼ çš„æ ¸å¿ƒæœºåˆ¶

æ•°æ®é€ä¼ çš„æœ¬è´¨æ˜¯**åœ¨ HOC ä¸­åŠ¨æ€æ³¨å…¥æ•°æ®ï¼Œå¹¶ç¡®ä¿è¿™äº›æ•°æ®èƒ½è¢«åŸºç¡€ç»„ä»¶ï¼ˆä»¥åŠå®ƒçš„å­ç»„ä»¶ï¼‰è®¿é—®åˆ°**ã€‚åœ¨ Vue3 ä¸­ï¼Œè¿™é€šå¸¸é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼å®ç°ï¼š

- **Props æ³¨å…¥**ï¼šHOC å°†æ•°æ®ä½œä¸º props ä¼ é€’ç»™åŸºç¡€ç»„ä»¶ã€‚
- **Slots é€ä¼ **ï¼šé€šè¿‡ slots å°†æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶çš„æ’æ§½å†…å®¹ã€‚
- **Provide/Inject å¢å¼º**ï¼šHOC é€šè¿‡ `provide` æ³¨å…¥æ•°æ®ï¼Œå­ç»„ä»¶é€šè¿‡ `inject` è·å–ã€‚
- **ä¸Šä¸‹æ–‡ä¼ é€’**ï¼šåˆ©ç”¨ `setup` çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆæ¯”å¦‚ `attrs`ã€`emit`ï¼‰ï¼Œå®ç°æ›´çµæ´»çš„é€ä¼ ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»“åˆ props å’Œ provide çš„ä¾‹å­ï¼š

```javascript
import { defineComponent, h, provide } from 'vue';

const withUserData = (BaseComponent) => {
  return defineComponent({
    name: 'WithUserData',
    setup(props, { slots }) {
      const userData = {
        name: 'æ™“é¾™',
        role: 'Developer',
      };

      // é€šè¿‡ provide æ³¨å…¥æ•°æ®
      provide('userData', userData);

      return () => {
        // å°†æ•°æ®ä½œä¸º props ä¼ é€’
        return h(BaseComponent, { userData, ...props }, slots);
      };
    },
  });
};

// ä½¿ç”¨ HOC
const MyComponent = defineComponent({
  props: ['userData'],
  template: `
    <div>
      <h1>{{ userData.name }}</h1>
      <slot></slot>
    </div>
  `,
});

const EnhancedComponent = withUserData(MyComponent);
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`withUserData` HOC ä¸ä»…é€šè¿‡ props å°† `userData` ä¼ é€’ç»™äº† `MyComponent`ï¼Œè¿˜é€šè¿‡ `provide` è®©æ›´æ·±å±‚çš„å­ç»„ä»¶ä¹Ÿèƒ½è®¿é—®åˆ° `userData`ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šProps é€‚åˆæ˜¾å¼ä¼ é€’ï¼Œprovide/inject é€‚åˆéšå¼ä¼ é€’ã€‚ä¸¤è€…ç»“åˆï¼Œèƒ½è®©ä½ çš„ HOC æ—¢çµæ´»åˆå¯æ§ï¼*

### 3. å“åº”å¼æ•°æ®çš„å¤„ç†

Vue3 çš„å“åº”å¼ç³»ç»Ÿæ˜¯ HOC çš„â€œçµé­‚ä¼´ä¾£â€ã€‚é€šè¿‡ `ref` æˆ– `reactive`ï¼ŒHOC å¯ä»¥æ³¨å…¥åŠ¨æ€æ›´æ–°çš„æ•°æ®ï¼Œç¡®ä¿ç»„ä»¶åœ¨æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°æ¸²æŸ“ã€‚

```javascript
import { defineComponent, h, ref } from 'vue';

const withCounter = (BaseComponent) => {
  return defineComponent({
    name: 'WithCounter',
    setup(props, { slots }) {
      const count = ref(0);
      const increment = () => count.value++;

      return () => {
        return h(BaseComponent, {
          count: count.value,
          increment,
          ...props,
        }, slots);
      };
    },
  });
};

// ä½¿ç”¨ HOC
const CounterDisplay = defineComponent({
  props: ['count', 'increment'],
  template: `
    <div>
      <p>Count: {{ count }}</p>
      <button @click="increment">Add</button>
    </div>
  `,
});

const EnhancedCounter = withCounter(CounterDisplay);
```

è¿™é‡Œï¼Œ`withCounter` HOC æ³¨å…¥äº†ä¸€ä¸ªå“åº”å¼çš„ `count` å’Œä¸€ä¸ª `increment` æ–¹æ³•ï¼Œ`CounterDisplay` ç»„ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒä»¬ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šå“åº”å¼æ•°æ®æ˜¯ Vue3 HOC çš„â€œæ€æ‰‹é”â€ï¼Œä½†è¦å°å¿ƒé¿å…åœ¨ HOC ä¸­åˆ›å»ºè¿‡å¤šçš„ ref/reactive å¯¹è±¡ï¼Œä»¥å…å†…å­˜æ³„æ¼ï¼*

---

## å®æˆ˜æ¡ˆä¾‹ï¼šç”¨ HOC æ‰“é€ ä¸€ä¸ªé€šç”¨æƒé™ç»„ä»¶ ğŸ”

ç†è®ºè®²äº†ä¸€å †ï¼Œæ˜¯æ—¶å€™æ¥ç‚¹çœŸåˆ€çœŸæªçš„å®æˆ˜äº†ï¼å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€šç”¨çš„æƒé™æ§åˆ¶ç»„ä»¶ï¼Œåªæœ‰ç‰¹å®šè§’è‰²çš„ç”¨æˆ·æ‰èƒ½çœ‹åˆ°æŸäº›å†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ HOC æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶é€šè¿‡æ•°æ®é€ä¼ è®©å­ç»„ä»¶ä¹Ÿèƒ½è®¿é—®æƒé™ä¿¡æ¯ã€‚

### éœ€æ±‚åˆ†æ

- çˆ¶ç»„ä»¶ä¼ é€’ä¸€ä¸ª `user` å¯¹è±¡ï¼ŒåŒ…å« `role` å±æ€§ï¼ˆæ¯”å¦‚ `admin`ã€`editor`ã€`viewer`ï¼‰ã€‚
- HOC æ ¹æ® `role` å†³å®šæ˜¯å¦æ¸²æŸ“å­ç»„ä»¶ã€‚
- å­ç»„ä»¶å¯ä»¥é€šè¿‡ props æˆ– inject è®¿é—®æƒé™ç›¸å…³çš„æ•°æ®ã€‚

### å®ç°ä»£ç 

```javascript
import { defineComponent, h, provide } from 'vue';

const withPermission = (BaseComponent, requiredRole) => {
  return defineComponent({
    name: 'WithPermission',
    props: {
      user: {
        type: Object,
        required: true,
      },
    },
    setup(props, { slots }) {
      const hasPermission = props.user.role === requiredRole;

      // æä¾›æƒé™æ•°æ®ç»™å­ç»„ä»¶
      provide('permission', {
        hasPermission,
        user: props.user,
      });

      return () => {
        if (!hasPermission) {
          return h('div', { class: 'no-permission' }, 'æ— æƒé™è®¿é—®');
        }
        return h(BaseComponent, {
          user: props.user,
          hasPermission,
          ...props,
        }, slots);
      };
    },
  });
};

// ä½¿ç”¨ HOC
const AdminPanel = defineComponent({
  props: ['user', 'hasPermission'],
  inject: ['permission'],
  template: `
    <div>
      <h1>Admin Panel</h1>
      <p>Permission: {{ permission.hasPermission ? 'Granted' : 'Denied' }}</p>
      <slot></slot>
    </div>
  `,
});

const EnhancedAdminPanel = withPermission(AdminPanel, 'admin');

// åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨
const App = defineComponent({
  template: `
    <EnhancedAdminPanel :user="{ role: 'admin', name: 'æ™“é¾™' }">
      <p>åªæœ‰ç®¡ç†å‘˜èƒ½çœ‹åˆ°æˆ‘ï¼</p>
    </EnhancedAdminPanel>
  `,
  components: { EnhancedAdminPanel },
});
```

### ä»£ç è§£æ

1. **HOC é€»è¾‘**ï¼š`withPermission` HOC æ¥å—ä¸€ä¸ª `BaseComponent` å’Œ `requiredRole` å‚æ•°ï¼Œæ£€æŸ¥ `user.role` æ˜¯å¦åŒ¹é…ã€‚å¦‚æœä¸åŒ¹é…ï¼Œæ¸²æŸ“â€œæ— æƒé™â€æç¤ºï¼›å¦‚æœåŒ¹é…ï¼Œåˆ™æ¸²æŸ“ `BaseComponent`ï¼Œå¹¶é€šè¿‡ props å’Œ provide ä¼ é€’æƒé™æ•°æ®ã€‚
2. **æ•°æ®é€ä¼ **ï¼š`user` å’Œ `hasPermission` é€šè¿‡ props ä¼ é€’ç»™ `AdminPanel`ï¼ŒåŒæ—¶é€šè¿‡ `provide` æ³¨å…¥åˆ° `permission` é”®ï¼Œä¾›æ·±å±‚å­ç»„ä»¶ä½¿ç”¨ã€‚
3. **æ’æ§½æ”¯æŒ**ï¼šHOC ä¿ç•™äº† `slots`ï¼Œç¡®ä¿çˆ¶ç»„ä»¶çš„æ’æ§½å†…å®¹å¯ä»¥æ­£å¸¸æ¸²æŸ“ã€‚

è¿è¡Œè¿™æ®µä»£ç ï¼Œå¦‚æœ `user.role` æ˜¯ `admin`ï¼Œä½ ä¼šçœ‹åˆ°å®Œæ•´çš„ `AdminPanel` å’Œæ’æ§½å†…å®¹ï¼›å¦åˆ™ï¼Œåªä¼šçœ‹åˆ°â€œæ— æƒé™è®¿é—®â€çš„æç¤ºã€‚

> *ğŸ’¡ å°è´´å£«ï¼šåœ¨æƒé™æ§åˆ¶åœºæ™¯ä¸­ï¼ŒHOC ä¸ä»…èƒ½å‡å°‘é‡å¤ä»£ç ï¼Œè¿˜èƒ½è®©æƒé™é€»è¾‘é›†ä¸­ç®¡ç†ã€‚è®°å¾—åœ¨ HOC ä¸­æ·»åŠ æ—¥å¿—è®°å½•ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼*

---

## é«˜çº§ç©æ³•ï¼šåŠ¨æ€ HOC ä¸ç»„åˆå¼é€ä¼  ğŸ¨

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ HOC å·²ç»å¾ˆå¼ºå¤§äº†ï¼Œä½†è¿˜èƒ½æ›´â€œéªšâ€ä¸€ç‚¹ï¼æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥èŠèŠä¸¤ç§é«˜çº§ç©æ³•ï¼š**åŠ¨æ€ HOC** å’Œ **ç»„åˆå¼æ•°æ®é€ä¼ **ã€‚

### 1. åŠ¨æ€ HOC

åŠ¨æ€ HOC æ˜¯æŒ‡æ ¹æ®è¿è¡Œæ—¶æ¡ä»¶ç”Ÿæˆä¸åŒçš„ HOC é€»è¾‘ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç”¨æˆ·çš„è¯­è¨€åå¥½ï¼ŒåŠ¨æ€æ³¨å…¥ä¸åŒçš„ä¸»é¢˜æ ·å¼ã€‚

```javascript
import { defineComponent, h, computed } from 'vue';

const withDynamicTheme = (BaseComponent) => {
  return defineComponent({
    props: {
      user: {
        type: Object,
        required: true,
      },
    },
    setup(props, { slots }) {
      const theme = computed(() => {
        return props.user.language === 'zh' ? 'dark' : 'light';
      });

      return () => {
        return h(BaseComponent, {
          theme: theme.value,
          ...props,
        }, slots);
      };
    },
  });
};

const ThemedComponent = defineComponent({
  props: ['theme'],
  template: `
    <div :class="theme">
      <slot></slot>
    </div>
  `,
});

const EnhancedThemedComponent = withDynamicTheme(ThemedComponent);
```

è¿™é‡Œï¼Œ`withDynamicTheme` HOC æ ¹æ® `user.language` åŠ¨æ€è®¡ç®— `theme`ï¼Œå¹¶å°†å…¶é€ä¼ ç»™å­ç»„ä»¶ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šåŠ¨æ€ HOC é€‚åˆéœ€è¦è¿è¡Œæ—¶å†³ç­–çš„åœºæ™¯ï¼Œä½†è¦é¿å…é€»è¾‘è¿‡äºå¤æ‚ï¼Œå¦åˆ™è°ƒè¯•ä¼šå˜æˆâ€œæ‰¾èŒ¬æ¸¸æˆâ€ï¼*

### 2. ç»„åˆå¼æ•°æ®é€ä¼ 

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¤šä¸ª HOC ååŒå·¥ä½œï¼Œæ¯”å¦‚ä¸€ä¸ª HOC è´Ÿè´£æƒé™ï¼Œä¸€ä¸ªè´Ÿè´£ä¸»é¢˜ï¼Œä¸€ä¸ªè´Ÿè´£æ—¥å¿—ã€‚è¿™æ—¶ï¼Œå¯ä»¥é€šè¿‡**HOC ç»„åˆ**æ¥å®ç°ã€‚

```javascript
import { defineComponent, h } from 'vue';

const withLogger = (BaseComponent) => {
  return defineComponent({
    setup(props, { slots }) {
      console.log('Component rendered with props:', props);
      return () => h(BaseComponent, props, slots);
    },
  });
};

const withTheme = (BaseComponent) => {
  return defineComponent({
    setup(props, { slots }) {
      const theme = 'dark';
      return () => h(BaseComponent, { theme, ...props }, slots);
    },
  });
};

// ç»„åˆ HOC
const withEnhanced = (BaseComponent) => {
  return withLogger(withTheme(BaseComponent));
};

const MyComponent = defineComponent({
  props: ['theme'],
  template: `
    <div :class="theme">
      <slot></slot>
    </div>
  `,
});

const EnhancedComponent = withEnhanced(MyComponent);
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`withEnhanced` å°† `withLogger` å’Œ `withTheme` ç»„åˆèµ·æ¥ï¼Œå­ç»„ä»¶å¯ä»¥åŒæ—¶è·å¾—ä¸»é¢˜æ ·å¼å’Œæ—¥å¿—åŠŸèƒ½ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šHOC ç»„åˆè™½ç„¶å¼ºå¤§ï¼Œä½†è¦æ§åˆ¶å±‚çº§æ·±åº¦ï¼Œé¿å…â€œä¿„ç½—æ–¯å¥—å¨ƒâ€å¼çš„ä»£ç ç»“æ„ï¼*

---

## æœ€ä½³å®è·µï¼šå¦‚ä½•å†™å‡ºä¼˜é›…çš„ HOC âœ¨

å†™ HOC å°±åƒçƒ¹é¥ªä¸€é“å¤§é¤ï¼šé£Ÿæï¼ˆé€»è¾‘ï¼‰è¦æ–°é²œï¼Œæ­é…ï¼ˆç»“æ„ï¼‰è¦åˆç†ï¼Œå‘ˆç°ï¼ˆä»£ç ï¼‰è¦ç¾è§‚ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€ä½³å®è·µï¼ŒåŠ©ä½ æˆä¸º HOC çš„â€œç±³å…¶æ—å¤§å¨â€ï¼š

### 1. ä¿æŒ HOC çš„å•ä¸€èŒè´£

æ¯ä¸ª HOC åº”è¯¥åªå…³æ³¨ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚æƒé™æ§åˆ¶ã€æ•°æ®æ³¨å…¥ã€æˆ–æ—¥å¿—è®°å½•ã€‚ä¸è¦æŠŠæ‰€æœ‰é€»è¾‘å¡è¿›ä¸€ä¸ª HOCï¼Œå¦åˆ™ç»´æŠ¤èµ·æ¥å°±åƒâ€œè§£ä¹è¿ç¯â€ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šå¦‚æœ HOC çš„ä»£ç è¶…è¿‡ 50 è¡Œï¼Œè€ƒè™‘æ‹†åˆ†æˆå¤šä¸ªå° HOCï¼Œæ¸…æ™°åˆæ˜“æµ‹è¯•ï¼*

### 2. æ˜¾å¼ä¼ é€’ props å’Œ slots

HOC åº”è¯¥å°½å¯èƒ½ä¿ç•™åŸå§‹ç»„ä»¶çš„ props å’Œ slotsï¼Œé¿å…â€œå·åƒâ€ç”¨æˆ·ä¼ å…¥çš„å†…å®¹ã€‚ä½¿ç”¨ `{ ...props }` å’Œ `slots` ç¡®ä¿é€ä¼ å®Œæ•´ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šåœ¨ HOC ä¸­æ·»åŠ æ³¨é‡Šï¼Œè¯´æ˜å“ªäº› props æ˜¯æ–°å¢çš„ï¼Œå“ªäº›æ˜¯é€ä¼ çš„ï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œï¼*

### 3. å–„ç”¨å“åº”å¼ç³»ç»Ÿ

Vue3 çš„å“åº”å¼ç³»ç»Ÿæ˜¯ HOC çš„â€œæ ¸æ­¦å™¨â€ã€‚ç”¨ `ref` å’Œ `reactive` åŒ…è£…æ•°æ®ï¼Œç¡®ä¿æ•°æ®å˜åŒ–èƒ½è§¦å‘ç»„ä»¶æ›´æ–°ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šå¯¹äºå¤æ‚æ•°æ®ç»“æ„ï¼Œä¼˜å…ˆä½¿ç”¨ `reactive`ï¼Œå®ƒæ¯”å¤šä¸ª `ref` æ›´æ˜“ç®¡ç†ï¼*

### 4. æä¾›è°ƒè¯•ä¿¡æ¯

åœ¨ HOC ä¸­æ·»åŠ é€‚å½“çš„æ—¥å¿—æˆ–é”™è¯¯æç¤ºï¼Œæ¯”å¦‚å½“æƒé™æ ¡éªŒå¤±è´¥æ—¶ï¼Œè¾“å‡ºå…·ä½“çš„é”™è¯¯åŸå› ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸­å¼€å¯è¯¦ç»†æ—¥å¿—ï¼Œç”Ÿäº§ç¯å¢ƒå…³é—­ï¼Œå…¼é¡¾è°ƒè¯•å’Œæ€§èƒ½ï¼*

### 5. æµ‹è¯• HOC çš„ç‹¬ç«‹æ€§

HOC åº”è¯¥åƒâ€œä¹é«˜ç§¯æœ¨â€ä¸€æ ·ï¼Œå¯ä»¥ç‹¬ç«‹æµ‹è¯•ã€‚ä½¿ç”¨ Vitest æˆ– Jest ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿ HOC çš„é€»è¾‘æ­£ç¡®ã€‚

> *ğŸ’¡ å°è´´å£«ï¼šä¸ºæ¯ä¸ª HOC ç¼–å†™è‡³å°‘ä¸€ä¸ªâ€œå¿«ä¹è·¯å¾„â€å’Œä¸€ä¸ªâ€œé”™è¯¯è·¯å¾„â€çš„æµ‹è¯•ç”¨ä¾‹ï¼*

---

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ ğŸ™‹â€â™‚ï¸

å³ä½¿æ˜¯ HOC é«˜æ‰‹ï¼Œä¹Ÿéš¾å…ä¼šé‡åˆ°ä¸€äº›â€œå‘â€ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼š

### 1. Props å†²çªæ€ä¹ˆåŠï¼Ÿ

å¦‚æœ HOC æ³¨å…¥çš„ props å’ŒåŸå§‹ç»„ä»¶çš„ props åŒåï¼Œä¼šå¯¼è‡´å†²çªã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å‘½åç©ºé—´ï¼Œæ¯”å¦‚å°† HOC çš„ props å‰ç¼€ä¸º `hoc_`ã€‚

```javascript
return h(BaseComponent, {
  hoc_data: enhancedData,
  ...props,
}, slots);
```

> *ğŸ’¡ å°è´´å£«ï¼šProps å†²çªæ˜¯ HOC çš„â€œç»å…¸é™·é˜±â€ï¼Œæå‰çº¦å®šå‘½åè§„èŒƒèƒ½çœä¸å°‘å¿ƒï¼*

### 2. æ€§èƒ½é—®é¢˜å¦‚ä½•ä¼˜åŒ–ï¼Ÿ

HOC å¯èƒ½ä¼šå¢åŠ æ¸²æŸ“å±‚çº§ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚å¯ä»¥é€šè¿‡**è®°å¿†åŒ–**ï¼ˆå¦‚ `computed`ï¼‰æˆ–**æ¡ä»¶æ¸²æŸ“**å‡å°‘ä¸å¿…è¦çš„è®¡ç®—ã€‚

```javascript
const cachedData = computed(() => expensiveCalculation());
```

> *ğŸ’¡ å°è´´å£«ï¼šç”¨ Vue DevTools åˆ†æç»„ä»¶æ¸²æŸ“æ—¶é—´ï¼Œæ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆå†ä¼˜åŒ–ï¼*

### 3. å¦‚ä½•è°ƒè¯•å¤æ‚çš„ HOCï¼Ÿ

å½“ HOC åµŒå¥—è¿‡å¤šæ—¶ï¼Œè°ƒè¯•å¯èƒ½ä¼šå˜æˆâ€œå¯»å®æ¸¸æˆâ€ã€‚å»ºè®®åœ¨æ¯ä¸ª HOC ä¸­æ·»åŠ  `name` å±æ€§ï¼Œæ–¹ä¾¿åœ¨ Vue DevTools ä¸­å®šä½ã€‚

```javascript
return defineComponent({
  name: 'WithSomeFeature',
  // ...
});
```

> *ğŸ’¡ å°è´´å£«ï¼šVue DevTools æ˜¯ HOC è°ƒè¯•çš„â€œæ˜¾å¾®é•œâ€ï¼Œå–„ç”¨å®ƒèƒ½äº‹åŠåŠŸå€ï¼*

---

## æ€»ç»“ï¼šHOC æ˜¯ Vue3 çš„â€œé­”æ³•æ£’â€ ğŸª„

é€šè¿‡è¿™ç¯‡è¶…é•¿ï¼ˆä½†å¸Œæœ›ä¸æ¯ç‡¥ï¼‰çš„åšå®¢ï¼Œæˆ‘ä»¬ä»**æ¦‚å¿µ**åˆ°**åŸç†**ï¼Œå†åˆ°**å®æˆ˜**å’Œ**æœ€ä½³å®è·µ**ï¼Œå…¨é¢æ¢ç´¢äº† Vue3 ä¸­é«˜é˜¶ç»„ä»¶å¦‚ä½•å®ç°æ•°æ®é€ä¼ ã€‚HOC ä¸ä»…æ˜¯ä¸€ä¸ªå¤ç”¨é€»è¾‘çš„å·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ªè®©ç»„ä»¶åä½œæ›´ä¼˜é›…ã€ä»£ç æ›´æ¸…æ™°çš„â€œé­”æ³•æ£’â€ã€‚æ— è®ºæ˜¯æƒé™æ§åˆ¶ã€ä¸»é¢˜åˆ‡æ¢ï¼Œè¿˜æ˜¯åŠ¨æ€æ•°æ®æ³¨å…¥ï¼ŒHOC éƒ½èƒ½è®©ä½ äº‹åŠåŠŸå€ã€‚

å½“ç„¶ï¼ŒHOC å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åœ¨éœ€è¦å…¨å±€çŠ¶æ€ç®¡ç†æˆ–å¤æ‚è·¨ç»„ä»¶é€šä¿¡æ—¶ï¼ŒPinia æˆ– Vuex å¯èƒ½æ›´åˆé€‚ã€‚ä½†åœ¨å±€éƒ¨é€»è¾‘å¤ç”¨å’Œæ•°æ®é€ä¼ çš„åœºæ™¯ä¸‹ï¼ŒHOC ç»å¯¹æ˜¯ä½ å·¥å…·ç®±é‡Œçš„â€œç‘å£«å†›åˆ€â€ã€‚

å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ å¯¹ Vue3 çš„ HOC æœ‰æ›´æ·±çš„ç†è§£ï¼Œä¹Ÿå¸Œæœ›ä½ èƒ½åœ¨é¡¹ç›®ä¸­å¤§èƒ†å°è¯•ï¼Œå†™å‡ºæ›´ä¼˜é›…ã€æ›´é«˜æ•ˆçš„ä»£ç ï¼å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºâ€œæ‰”ç –å¤´â€ï¼Œæˆ‘ä»¬ä¸€èµ·æ¢è®¨ï¼ğŸ˜œ

> *ğŸ’¡ å°è´´å£«ï¼šå‰ç«¯å¼€å‘å°±åƒä¸€åœºé­”æ³•å†’é™©ï¼ŒHOC æ˜¯ä½ çš„é­”æ³•é“å…·ä¹‹ä¸€ã€‚å‹‡æ•¢å°è¯•ï¼Œåˆ›é€ å±äºä½ çš„ç»„ä»¶é­”æ³•å§ï¼*

---