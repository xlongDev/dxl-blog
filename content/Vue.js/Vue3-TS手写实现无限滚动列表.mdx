---

type: "Post"
title: "Vue3+TS æ‰‹å†™å®ç°æ— é™æ»šåŠ¨åˆ—è¡¨ï¼šä»é›¶åˆ°ä¸æ»‘ï¼Œè§£é”å‰ç«¯æ–°å§¿åŠ¿"
date: "2023-04-27"
description: "æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨ Vue3 å’Œ TypeScript å®ç°ä¸€ä¸ªé«˜æ€§èƒ½çš„æ— é™æ»šåŠ¨åˆ—è¡¨ï¼Œæ·±å…¥åŸç†ï¼Œé™„å¸¦ä¼˜åŒ–æŠ€å·§å’Œå®æˆ˜æ¡ˆä¾‹ã€‚"
keywords: "Vue3, TypeScript, æ— é™æ»šåŠ¨, IntersectionObserver, å‰ç«¯æ€§èƒ½ä¼˜åŒ–, è™šæ‹Ÿåˆ—è¡¨, ç»„ä»¶å°è£…"
author: "æ™“é¾™"
image: "/images/hero/infinite-scroll.jpg"
tags: ["Vue3", "TypeScript", "å‰ç«¯å¼€å‘", "æ€§èƒ½ä¼˜åŒ–"]
category: "Vue.js"

---

å˜¿ï¼Œå‰ç«¯å°ä¼™ä¼´ä»¬ï¼ğŸ‘‹ ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·å¹²ä¸€ä»¶å¾ˆæœ‰æ„æ€çš„äº‹â€”â€”ç”¨ Vue3 å’Œ TypeScript æ‰‹å†™ä¸€ä¸ªæ— é™æ»šåŠ¨åˆ—è¡¨ã€‚å¬èµ·æ¥æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒâ€œè‡ªå·±åŠ¨æ‰‹æ­ä¸ªè¿‡å±±è½¦â€ï¼Ÿåˆ«æ…Œï¼Œæˆ‘ä»¬ä¼šä»é›¶å¼€å§‹ï¼Œä¸€æ­¥æ­¥æ‹†è§£åŸç†ï¼Œå¸¦ä½ ä»â€œæ‡µåœˆâ€èµ°å‘â€œä¸æ»‘â€ï¼Œè¿˜èƒ½é¡ºæ‰‹è§£é”ä¸€äº›å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–°å§¿åŠ¿ã€‚æ— è®ºä½ æ˜¯æƒ³æå‡æŠ€æœ¯æ·±åº¦ï¼Œè¿˜æ˜¯æƒ³åœ¨é¢è¯•ä¸­ç§€ä¸€æ³¢éªšæ“ä½œï¼Œè¿™ç¯‡æ–‡ç« éƒ½å°†æ˜¯ä½ çš„â€œç§˜å¯†æ­¦å™¨â€ã€‚

æ— é™æ»šåŠ¨ï¼ˆInfinite Scrollï¼‰åœ¨ç°ä»£ Web å¼€å‘ä¸­æ— å¤„ä¸åœ¨ï¼Œæ¯”å¦‚ Twitter çš„åŠ¨æ€æµã€B ç«™çš„è§†é¢‘åˆ—è¡¨ï¼Œç”šè‡³æ˜¯æŸå®çš„å•†å“é¡µã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šç”¨æˆ·æ»‘åˆ°åº•éƒ¨æ—¶ï¼Œè‡ªåŠ¨åŠ è½½æ›´å¤šæ•°æ®ï¼Œæ—¢èŠ‚çœæµé‡ï¼Œåˆæå‡ä½“éªŒã€‚ä½†è¦å®ç°ä¸€ä¸ªé«˜æ€§èƒ½çš„æ— é™æ»šåŠ¨åˆ—è¡¨ï¼Œå¯ä¸æ˜¯ç®€å•ç›‘å¬ä¸ª `scroll` äº‹ä»¶å°±å®Œäº‹äº†ã€‚æˆ‘ä»¬å¾—èŠèŠ IntersectionObserverã€è™šæ‹Ÿåˆ—è¡¨ã€Vue3 çš„ Composition APIï¼Œè¿˜æœ‰ä¸€äº› TypeScript çš„ç±»å‹é­”æ³•ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿå¿«ç³»ä¸Šå®‰å…¨å¸¦ï¼Œå’±ä»¬å¼€æ•´ï¼ğŸš€

## ä»€ä¹ˆæ˜¯æ— é™æ»šåŠ¨ï¼Ÿå…ˆææ‡‚éœ€æ±‚

åœ¨åŠ¨æ‰‹ä¹‹å‰ï¼Œå’±ä»¬å¾—å…ˆæ˜ç™½â€œæ— é™æ»šåŠ¨â€åˆ°åº•æ˜¯ä¸ªå•¥ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ç§åŠ¨æ€åŠ è½½æ•°æ®çš„æ¨¡å¼ï¼šå½“ç”¨æˆ·æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨ï¼ˆæˆ–æŸä¸ªè§¦å‘åŒºåŸŸï¼‰æ—¶ï¼Œè‡ªåŠ¨è¯·æ±‚ä¸‹ä¸€é¡µæ•°æ®å¹¶è¿½åŠ åˆ°åˆ—è¡¨ä¸­ã€‚å¬èµ·æ¥ç®€å•ï¼Œä½†å®ç°èµ·æ¥æœ‰å‡ ä¸ªå…³é”®ç‚¹å¾—æ³¨æ„ï¼š

1. **è§¦å‘æ—¶æœº**ï¼šä»€ä¹ˆæ—¶å€™åŠ è½½æ–°æ•°æ®ï¼Ÿå¤ªæ—©æµªè´¹æµé‡ï¼Œå¤ªæ™šç”¨æˆ·éª‚å¨˜ã€‚
2. **æ€§èƒ½**ï¼šå¦‚æœåˆ—è¡¨æœ‰å‡ åƒæ¡æ•°æ®ï¼ŒDOM èŠ‚ç‚¹å¤šäº†ä¼šå¡åˆ°æ€€ç–‘äººç”Ÿã€‚
3. **ç”¨æˆ·ä½“éªŒ**ï¼šåŠ è½½æ—¶çš„æç¤ºã€é”™è¯¯å¤„ç†ã€æ•°æ®ä¸ºç©ºæ€ä¹ˆåŠï¼Ÿ

æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”¨ Vue3 å’Œ TS å†™ä¸€ä¸ªæ—¢ä¼˜é›…åˆé«˜æ•ˆçš„æ— é™æ»šåŠ¨ç»„ä»¶ï¼Œè¿˜è¦èƒ½åº”å¯¹å„ç§è¾¹ç•Œæƒ…å†µã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šå¸¦ä½ ä»åŸºç¡€å®ç°åˆ°é«˜çº§ä¼˜åŒ–ï¼Œé€æ­¥è¿›é˜¶ã€‚

---

## åŸºç¡€å®ç°ï¼šç”¨ IntersectionObserver ç›‘å¬åº•éƒ¨

è€æ´¾çš„å‰ç«¯å¯èƒ½ä¼šç”¨ `scroll` äº‹ä»¶ç›‘å¬é¡µé¢ä½ç½®ï¼Œä½†é‚£å°±åƒéª‘ç€è‡ªè¡Œè½¦å»é£™è½¦â€”â€”è´¹åŠ›è¿˜ä¸å¤Ÿé…·ã€‚ç°åœ¨çš„ä¸»æµæ–¹æ¡ˆæ˜¯ `IntersectionObserver`ï¼Œå®ƒèƒ½ä¼˜é›…åœ°å‘Šè¯‰ä½ æŸä¸ªå…ƒç´ æ˜¯å¦è¿›å…¥äº†è§†å£ã€‚å’±ä»¬å°±ç”¨å®ƒæ¥å®ç°æ— é™æ»šåŠ¨çš„æ ¸å¿ƒé€»è¾‘ã€‚

### Step 1ï¼šæ­å»ºåŸºæœ¬ç»“æ„

å…ˆåˆ›å»ºä¸€ä¸ª Vue ç»„ä»¶ `InfiniteScroll.vue`ï¼Œç”¨ Composition API å’Œ TS æ¥å†™ã€‚å‡è®¾æˆ‘ä»¬ä»åç«¯æ‹¿åˆ°çš„æ•°æ®æ˜¯ä¸€ä¸ªåˆ†é¡µçš„åˆ—è¡¨æ¥å£ã€‚

```vue
<template>
  <div class="infinite-scroll-container">
    <ul>
      <li v-for="item in list" :key="item.id">{{ item.name }}</li>
    </ul>
    <div ref="loadMoreTrigger" class="load-more-trigger">
      <span v-if="loading">åŠ è½½ä¸­...</span>
      <span v-else-if="hasMore">æ»šåŠ¨åŠ è½½æ›´å¤š</span>
      <span v-else>æ²¡æœ‰æ›´å¤šæ•°æ®å•¦</span>
    </div>
  </div>
</template>

<script lang="ts">
import { defineComponent, ref, onMounted, onUnmounted } from 'vue';

export default defineComponent({
  name: 'InfiniteScroll',
  setup() {
    const list = ref<{ id: number; name: string }[]>([]); // æ•°æ®åˆ—è¡¨
    const loading = ref(false); // åŠ è½½çŠ¶æ€
    const hasMore = ref(true); // æ˜¯å¦è¿˜æœ‰æ›´å¤šæ•°æ®
    const page = ref(1); // å½“å‰é¡µç 
    const loadMoreTrigger = ref<HTMLElement | null>(null); // è§¦å‘åŠ è½½çš„å…ƒç´ 
    let observer: IntersectionObserver | null = null;

    // æ¨¡æ‹Ÿæ¥å£è¯·æ±‚
    const fetchData = async () => {
      if (loading.value || !hasMore.value) return;
      loading.value = true;
      try {
        const res = await new Promise<{ id: number; name: string }[]>((resolve) => {
          setTimeout(() => {
            const newItems = Array.from({ length: 10 }, (_, i) => ({
              id: (page.value - 1) * 10 + i + 1,
              name: `Item ${page.value * 10 + i + 1}`,
            }));
            resolve(newItems);
          }, 1000);
        });
        list.value.push(...res);
        page.value++;
        if (res.length < 10) hasMore.value = false; // å‡è®¾æ¯é¡µ10æ¡ï¼Œå°‘äº10æ¡è¯´æ˜åˆ°å¤´äº†
      } catch (error) {
        console.error('åŠ è½½å¤±è´¥:', error);
      } finally {
        loading.value = false;
      }
    };

    // åˆå§‹åŒ– IntersectionObserver
    const initObserver = () => {
      observer = new IntersectionObserver(
        (entries) => {
          if (entries[0].isIntersecting && !loading.value) {
            fetchData();
          }
        },
        { threshold: 0.1 } // è§¦å‘åŒºåŸŸéœ²å‡º 10% æ—¶åŠ è½½
      );
      if (loadMoreTrigger.value) {
        observer.observe(loadMoreTrigger.value);
      }
    };

    onMounted(() => {
      fetchData(); // é¦–æ¬¡åŠ è½½
      initObserver();
    });

    onUnmounted(() => {
      if (observer && loadMoreTrigger.value) {
        observer.unobserve(loadMoreTrigger.value);
      }
    });

    return { list, loading, hasMore, loadMoreTrigger };
  },
});
</script>

<style scoped>
.infinite-scroll-container {
  max-height: 500px;
  overflow-y: auto;
}
.load-more-trigger {
  text-align: center;
  padding: 10px;
  color: #666;
}
</style>
```

#### ä»£ç è§£æ

1. **æ¨¡æ¿**ï¼šä¸€ä¸ªç®€å•çš„åˆ—è¡¨ï¼Œå¤–åŠ ä¸€ä¸ªè§¦å‘åŠ è½½çš„ `<div>`ï¼Œé€šè¿‡ `ref` ç»‘å®šã€‚
2. **çŠ¶æ€ç®¡ç†**ï¼šç”¨ `ref` å®šä¹‰äº† `list`ï¼ˆåˆ—è¡¨æ•°æ®ï¼‰ã€`loading`ï¼ˆåŠ è½½çŠ¶æ€ï¼‰ã€`hasMore`ï¼ˆæ˜¯å¦æœ‰æ›´å¤šæ•°æ®ï¼‰å’Œ `page`ï¼ˆå½“å‰é¡µç ï¼‰ã€‚
3. **IntersectionObserver**ï¼šç›‘å¬ `loadMoreTrigger` å…ƒç´ ï¼Œå½“å®ƒè¿›å…¥è§†å£æ—¶è°ƒç”¨ `fetchData`ã€‚
4. **ç”Ÿå‘½å‘¨æœŸ**ï¼š`onMounted` åŠ è½½é¦–å±æ•°æ®å¹¶åˆå§‹åŒ– Observerï¼Œ`onUnmounted` æ¸…ç†ç›‘å¬ã€‚

**Tips** ğŸ’¡ï¼šç”¨ `threshold: 0.1` å¯ä»¥è®©åŠ è½½è§¦å‘å¾—æ›´è‡ªç„¶ï¼Œé¿å…ç”¨æˆ·æ»‘åˆ°åº•æ‰åŠ è½½çš„å°´å°¬ã€‚è¯•è¯•è°ƒæ•´è¿™ä¸ªå€¼ï¼Œæ„Ÿå—ä¸åŒçš„ä½“éªŒï¼

---

## è¿›é˜¶ï¼šåŠ ç‚¹ TypeScript çš„ç±»å‹é­”æ³•

ä¸Šé¢çš„ä»£ç å·²ç»èƒ½è·‘äº†ï¼Œä½†ä½œä¸ºä¸€ä¸ªæœ‰è¿½æ±‚çš„å‰ç«¯ï¼Œæˆ‘ä»¬å¾—è®©å®ƒæ›´â€œç±»å‹å®‰å…¨â€ã€‚ç”¨ TS å®šä¹‰æ¥å£å’Œç±»å‹ï¼Œèƒ½è®©ä»£ç æ›´å¥å£®ï¼Œä¹Ÿæ–¹ä¾¿å›¢é˜Ÿåä½œã€‚

### Step 2ï¼šä¼˜åŒ–ç±»å‹å®šä¹‰

```ts
interface ListItem {
  id: number;
  name: string;
}

type FetchDataResponse = ListItem[];

const fetchData = async (): Promise<void> => {
  if (loading.value || !hasMore.value) return;
  loading.value = true;
  try {
    const res: FetchDataResponse = await new Promise((resolve) => {
      setTimeout(() => {
        const newItems = Array.from({ length: 10 }, (_, i) => ({
          id: (page.value - 1) * 10 + i + 1,
          name: `Item ${page.value * 10 + i + 1}`,
        }));
        resolve(newItems);
      }, 1000);
    });
    list.value.push(...res);
    page.value++;
    if (res.length < 10) hasMore.value = false;
  } catch (error) {
    console.error('åŠ è½½å¤±è´¥:', error as Error);
  } finally {
    loading.value = false;
  }
};
```

#### ç±»å‹åŒ–çš„å¥½å¤„

- `ListItem` å®šä¹‰äº†æ•°æ®ç»“æ„ï¼ŒIDE ä¼šè‡ªåŠ¨æç¤ºå±æ€§ã€‚
- `FetchDataResponse` æ˜ç¡®äº†æ¥å£è¿”å›ç±»å‹ï¼Œé¿å…æ‰‹æ»‘å†™é”™ã€‚
- `error as Error` è®© TS çŸ¥é“ `error` æ˜¯ä¸ªé”™è¯¯å¯¹è±¡ï¼Œè€Œä¸æ˜¯ `unknown`ã€‚

**Tips** ğŸ’¡ï¼šåˆ«å¿˜äº†ç»™å¼‚æ­¥å‡½æ•°åŠ ä¸Š `Promise<void>` è¿”å›ç±»å‹ï¼Œè¿™æ ·è°ƒç”¨è€…çŸ¥é“å®ƒä¸ä¼šæœ‰è¿”å›å€¼ï¼Œé¿å…ä¸å¿…è¦çš„ `await` è¯¯ç”¨ã€‚

---

## æ€§èƒ½ä¼˜åŒ–ï¼šè™šæ‹Ÿåˆ—è¡¨æ¥æ•‘åœº

åŸºç¡€ç‰ˆå·²ç»å¾ˆä¸é”™äº†ï¼Œä½†å¦‚æœåˆ—è¡¨æ•°æ®è¾¾åˆ°å‡ åƒæ¡ï¼ŒDOM èŠ‚ç‚¹ä¼šå¤šåˆ°è®©æµè§ˆå™¨å–˜ä¸è¿‡æ°”ã€‚è¿™æ—¶å€™ï¼Œè™šæ‹Ÿåˆ—è¡¨ï¼ˆVirtual Listï¼‰å°±è¯¥ç™»åœºäº†ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**åªæ¸²æŸ“å¯è§†åŒºåŸŸçš„èŠ‚ç‚¹ï¼Œå…¶ä»–çš„å‡è£…ä¸å­˜åœ¨**ã€‚å°±åƒä½ åœ¨é£Ÿå ‚æ’é˜Ÿï¼Œåªç«¯è‡ªå·±é‚£ç›˜èœï¼Œå…¶ä»–äººçš„é¥­ä½ ç®¡ä¸ç€ã€‚

### Step 3ï¼šå®ç°è™šæ‹Ÿåˆ—è¡¨

æˆ‘ä»¬éœ€è¦è®¡ç®—å¯è§†åŒºåŸŸå†…çš„å…ƒç´ ï¼Œå¹¶åŠ¨æ€æ›´æ–°æ¸²æŸ“å†…å®¹ã€‚ä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„ä»£ç ï¼š

```vue
<template>
  <div class="infinite-scroll-container" ref="container" @scroll="handleScroll">
    <div :style="{ height: `${totalHeight}px` }" class="virtual-list">
      <ul :style="{ transform: `translateY(${offset}px)` }">
        <li
          v-for="item in visibleItems"
          :key="item.id"
          :style="{ height: `${itemHeight}px` }"
        >
          {{ item.name }}
        </li>
      </ul>
    </div>
    <div ref="loadMoreTrigger" class="load-more-trigger">
      <span v-if="loading">åŠ è½½ä¸­...</span>
      <span v-else-if="hasMore">æ»šåŠ¨åŠ è½½æ›´å¤š</span>
      <span v-else>æ²¡æœ‰æ›´å¤šæ•°æ®å•¦</span>
    </div>
  </div>
</template>

<script lang="ts">
import { defineComponent, ref, computed, onMounted, onUnmounted } from 'vue';

interface ListItem {
  id: number;
  name: string;
}

export default defineComponent({
  name: 'InfiniteScrollVirtual',
  setup() {
    const container = ref<HTMLElement | null>(null);
    const loadMoreTrigger = ref<HTMLElement | null>(null);
    const list = ref<ListItem[]>([]);
    const loading = ref(false);
    const hasMore = ref(true);
    const page = ref(1);
    const itemHeight = 50; // æ¯é¡¹å›ºå®šé«˜åº¦
    const totalHeight = computed(() => list.value.length * itemHeight);

    // å¯è§†åŒºåŸŸè®¡ç®—
    const visibleCount = computed(() =>
      container.value ? Math.ceil(container.value.clientHeight / itemHeight) + 2 : 10
    );
    const scrollTop = ref(0);
    const startIndex = computed(() => Math.floor(scrollTop.value / itemHeight));
    const visibleItems = computed(() =>
      list.value.slice(startIndex.value, startIndex.value + visibleCount.value)
    );
    const offset = computed(() => startIndex.value * itemHeight);

    const fetchData = async () => {
      if (loading.value || !hasMore.value) return;
      loading.value = true;
      try {
        const res = await new Promise<ListItem[]>((resolve) => {
          setTimeout(() => {
            const newItems = Array.from({ length: 10 }, (_, i) => ({
              id: (page.value - 1) * 10 + i + 1,
              name: `Item ${page.value * 10 + i + 1}`,
            }));
            resolve(newItems);
          }, 1000);
        });
        list.value.push(...res);
        page.value++;
        if (res.length < 10) hasMore.value = false;
      } finally {
        loading.value = false;
      }
    };

    const handleScroll = () => {
      if (container.value) {
        scrollTop.value = container.value.scrollTop;
      }
    };

    const initObserver = () => {
      const observer = new IntersectionObserver(
        (entries) => {
          if (entries[0].isIntersecting && !loading.value) {
            fetchData();
          }
        },
        { threshold: 0.1 }
      );
      if (loadMoreTrigger.value) {
        observer.observe(loadMoreTrigger.value);
      }
      return observer;
    };

    let observer: IntersectionObserver | null = null;
    onMounted(() => {
      fetchData();
      observer = initObserver();
    });

    onUnmounted(() => {
      if (observer && loadMoreTrigger.value) {
        observer.unobserve(loadMoreTrigger.value);
      }
    });

    return {
      container,
      loadMoreTrigger,
      list,
      loading,
      hasMore,
      totalHeight,
      visibleItems,
      offset,
      itemHeight,
      handleScroll,
    };
  },
});
</script>

<style scoped>
.infinite-scroll-container {
  max-height: 500px;
  overflow-y: auto;
  position: relative;
}
.virtual-list {
  position: relative;
}
.virtual-list ul {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
}
.virtual-list li {
  border-bottom: 1px solid #eee;
}
.load-more-trigger {
  text-align: center;
  padding: 10px;
  color: #666;
}
</style>
```

#### è™šæ‹Ÿåˆ—è¡¨çš„åŸç†

1. **æ€»é«˜åº¦**ï¼šç”¨ `totalHeight` æ’‘å¼€å®¹å™¨ï¼Œæ¨¡æ‹Ÿå®Œæ•´åˆ—è¡¨çš„é«˜åº¦ã€‚
2. **å¯è§†åŒºåŸŸ**ï¼šæ ¹æ® `scrollTop` å’Œ `itemHeight` è®¡ç®—å½“å‰æ˜¾ç¤ºçš„èµ·å§‹ç´¢å¼•ï¼ˆ`startIndex`ï¼‰å’Œç»“æŸç´¢å¼•ã€‚
3. **åç§»é‡**ï¼šç”¨ `translateY` è°ƒæ•´æ¸²æŸ“å†…å®¹çš„åç§»ï¼Œé¿å…æ¸²æŸ“æ‰€æœ‰èŠ‚ç‚¹ã€‚

**Tips** ğŸ’¡ï¼šå¦‚æœåˆ—è¡¨é¡¹é«˜åº¦ä¸å›ºå®šï¼Œå¯ä»¥ç”¨ `getBoundingClientRect` åŠ¨æ€è®¡ç®—ï¼Œä½†å¾—æ³¨æ„æ€§èƒ½å¼€é”€ã€‚å›ºå®šé«˜åº¦æ˜¯è™šæ‹Ÿåˆ—è¡¨çš„â€œæœ€ä½³æ‹æ¡£â€ï¼

---

## æœ€ä½³å®è·µï¼šè®©æ— é™æ»šåŠ¨æ›´â€œäººæ€§åŒ–â€

å®ç°åˆ°è¿™å„¿å·²ç»å¾ˆç¡¬æ ¸äº†ï¼Œä½†ä½œä¸ºä¸€ä¸ªæœ‰æ¸©åº¦çš„å‰ç«¯ï¼Œæˆ‘ä»¬è¿˜å¾—è€ƒè™‘ç”¨æˆ·ä½“éªŒå’Œä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå®ç”¨å»ºè®®ï¼š

### 1. é˜²æŠ–åŠ è½½è¯·æ±‚
é¢‘ç¹è§¦å‘ `fetchData` ä¼šè®©åç«¯å‹åŠ›å±±å¤§ã€‚ç”¨é˜²æŠ–ï¼ˆdebounceï¼‰ä¼˜åŒ–ä¸€ä¸‹ï¼š

```ts
import { debounce } from 'lodash';

const fetchDataDebounced = debounce(fetchData, 300);
```

**Tips** ğŸ’¡ï¼š300ms æ˜¯ç”¨æˆ·æ„ŸçŸ¥çš„â€œèˆ’é€‚åŒºâ€ï¼Œå¤ªçŸ­æµªè´¹è¯·æ±‚ï¼Œå¤ªé•¿å½±å“ä½“éªŒã€‚

### 2. åŠ è½½åŠ¨ç”»
åŠ ä¸ªæ—‹è½¬çš„å°å›¾æ ‡ï¼Œè®©ç”¨æˆ·çŸ¥é“æ•°æ®åœ¨åŠ è½½ï¼š

```vue
<span v-if="loading" class="spinner">â³ åŠ è½½ä¸­...</span>

<style scoped>
.spinner {
  animation: spin 1s linear infinite;
}
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
</style>
```

### 3. é”™è¯¯é‡è¯•
æ¥å£æŒ‚äº†æ€ä¹ˆåŠï¼ŸåŠ ä¸ªé‡è¯•æŒ‰é’®ï¼š

```vue
<span v-else-if="error" @click="retry">åŠ è½½å¤±è´¥ï¼Œç‚¹å‡»é‡è¯•</span>

<script lang="ts">
const error = ref(false);
const retry = () => {
  error.value = false;
  fetchData();
};
</script>
```

**Tips** ğŸ’¡ï¼šå¯ä»¥ç”¨ `setTimeout` åŠ ä¸ªè‡ªåŠ¨é‡è¯•ï¼Œä½†åˆ«å¤ªé¢‘ç¹ï¼Œä¸ç„¶ç”¨æˆ·ä¼šè§‰å¾—ä½ åœ¨â€œåˆ·å­˜åœ¨æ„Ÿâ€ã€‚

### 4. ç¼“å­˜æ•°æ®
ç”¨ `localStorage` ç¼“å­˜å·²åŠ è½½çš„æ•°æ®ï¼Œæå‡äºŒæ¬¡è®¿é—®ä½“éªŒï¼š

```ts
const loadCachedData = () => {
  const cached = localStorage.getItem('infinite-scroll-cache');
  if (cached) {
    list.value = JSON.parse(cached);
    page.value = Math.floor(list.value.length / 10) + 1;
  }
};
const saveCache = () => {
  localStorage.setItem('infinite-scroll-cache', JSON.stringify(list.value));
};
fetchData = async () => {
  // ... åŸæœ‰é€»è¾‘
  saveCache();
};
onMounted(() => {
  loadCachedData();
  fetchData();
});
```

---

## æ€»ç»“ï¼šä»â€œä¼šç”¨â€åˆ°â€œç²¾é€šâ€

æ­å–œä½ åšæŒåˆ°æœ€åï¼ğŸ‰ æˆ‘ä»¬ä»åŸºç¡€çš„ IntersectionObserver å®ç°ï¼Œåˆ°è™šæ‹Ÿåˆ—è¡¨çš„æ€§èƒ½ä¼˜åŒ–ï¼Œå†åˆ°äººæ€§åŒ–çš„æœ€ä½³å®è·µï¼Œå®Œæ•´èµ°äº†ä¸€éæ— é™æ»šåŠ¨çš„å®ç°æµç¨‹ã€‚è¿™ä¸ä»…æ˜¯ä¸€ä¸ªåŠŸèƒ½çš„å®ç°ï¼Œæ›´æ˜¯ä¸€ä¸ªå‰ç«¯æ€ç»´çš„é”»ç‚¼â€”â€”ä»éœ€æ±‚åˆ†æåˆ°æŠ€æœ¯é€‰å‹ï¼Œå†åˆ°ä»£ç ä¼˜åŒ–ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰å€¼å¾—æ·±æŒ–çš„åœ°æ–¹ã€‚

ç”¨ Vue3 çš„ Composition API å’Œ TS çš„ç±»å‹ç³»ç»Ÿï¼Œæˆ‘ä»¬è®©ä»£ç æ—¢çµæ´»åˆå®‰å…¨ï¼›é€šè¿‡è™šæ‹Ÿåˆ—è¡¨ï¼Œæˆ‘ä»¬æŠŠæ€§èƒ½æ‹‰æ»¡ï¼›åŠ ä¸Šé˜²æŠ–ã€åŠ¨ç”»å’Œç¼“å­˜ï¼Œä½“éªŒä¹Ÿæ›´è´´å¿ƒã€‚å¸Œæœ›ä½ èƒ½æŠŠè¿™äº›æ€è·¯å¸¦åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œç”šè‡³åœ¨ä¸‹æ¬¡é¢è¯•æ—¶ï¼Œç¬‘ç€è·Ÿé¢è¯•å®˜è¯´ï¼šâ€œæ— é™æ»šåŠ¨ï¼Ÿæˆ‘æ‰‹å†™è¿‡ï¼Œå¸¦è™šæ‹Ÿåˆ—è¡¨çš„é‚£ç§ï¼â€ğŸ˜

æœ‰ä»€ä¹ˆé—®é¢˜æˆ–è€…æ›´å¥½çš„æƒ³æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºèŠèŠï¼Œå’±ä»¬ä¸€èµ·è¿›æ­¥ï¼ğŸ‘‡

--- 