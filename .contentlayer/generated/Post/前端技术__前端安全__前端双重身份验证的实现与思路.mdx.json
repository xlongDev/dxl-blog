{
  "title": "å‰ç«¯åŒé‡èº«ä»½éªŒè¯ï¼ˆDouble Tokenï¼‰ï¼šä»åŸç†åˆ°å®è·µçš„æ·±åº¦è§£æ",
  "date": "2023-12-02T00:00:00.000Z",
  "description": "æ·±å…¥æ¢è®¨å‰ç«¯åŒé‡èº«ä»½éªŒè¯ï¼ˆDouble Tokenï¼‰çš„å®ç°åŸç†ã€è®¾è®¡æ€è·¯ä¸æœ€ä½³å®è·µï¼Œç»“åˆä»£ç ç¤ºä¾‹ã€è¡¨æ ¼åˆ†æå’Œå“²å­¦æ€è€ƒï¼Œä¸ºå‰ç«¯å¼€å‘è€…æä¾›å…¨é¢æŒ‡å¯¼ã€‚",
  "keywords": "åŒé‡èº«ä»½éªŒè¯, Double Token, JWT, Refresh Token, å‰ç«¯å®‰å…¨, èº«ä»½éªŒè¯, Web å¼€å‘, å®‰å…¨å®è·µ",
  "author": "æ™“é¾™",
  "image": "/images/hero/double-token-auth.jpg",
  "tags": [
    "å‰ç«¯å¼€å‘",
    "Web å®‰å…¨",
    "èº«ä»½éªŒè¯",
    "JWT"
  ],
  "views": 0,
  "likes": 0,
  "category": "å‰ç«¯æŠ€æœ¯",
  "body": {
    "raw": "\n> â€œä¿¡ä»»æ˜¯æ˜‚è´µçš„å¥¢ä¾ˆå“ï¼ŒéªŒè¯æ˜¯å®‰å…¨çš„åŸºçŸ³ã€‚â€ â€”â€” æŸä½ä¸æ„¿é€éœ²å§“åçš„å‰ç«¯å¼€å‘è€… ğŸ˜\n\nåœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œèº«ä»½éªŒè¯ï¼ˆAuthenticationï¼‰æ—©å·²ä¸æ˜¯ç®€å•çš„ç”¨æˆ·åå¯†ç æ ¡éªŒï¼Œè€Œæ˜¯æ¼”å˜ä¸ºä¸€åœºæŠ€æœ¯å’Œä¿¡ä»»çš„åšå¼ˆã€‚åŒé‡èº«ä»½éªŒè¯ï¼ˆDouble Tokenï¼‰ï¼Œä½œä¸ºä¸€ç§åœ¨ JWTï¼ˆJSON Web Tokenï¼‰ä½“ç³»ä¸­å¹¿æ³›åº”ç”¨çš„æœºåˆ¶ï¼Œä»¥å…¶ä¼˜é›…çš„è®¾è®¡å’Œé«˜å®‰å…¨æ€§ï¼Œæˆä¸ºå‰ç«¯å¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚ğŸ”’\n\næœ¬æ–‡å°†å¸¦ä½ ä»**åŸç†åˆ°å®è·µ**ï¼Œæ·±å…¥å‰–æ Double Token çš„å®ç°æ€è·¯ï¼Œç»“åˆä»£ç ç¤ºä¾‹ã€æœ€ä½³å®è·µå’Œå“²å­¦æ€è€ƒï¼Œä¸ºä½ å‘ˆç°ä¸€å¹…å‰ç«¯å®‰å…¨çš„å®ä¼Ÿç”»å·ã€‚æ— è®ºä½ æ˜¯åˆšå…¥è¡Œçš„æ–°æ‰‹ï¼Œè¿˜æ˜¯èº«ç»ç™¾æˆ˜çš„è€å…µï¼Œè¿™ç¯‡åšå®¢éƒ½å°†ä¸ºä½ æä¾›å¯å‘ä¸å¹²è´§ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹è¿™åœºå…³äºä¿¡ä»»ä¸æŠ€æœ¯çš„æ—…ç¨‹å§ï¼ğŸš€\n\n## æ–‡ç« ç»“æ„ï¼šæ€ç»´é“¾æ¦‚è§ˆ\n\nä¸ºäº†è®©å†…å®¹æ¸…æ™°æ˜“æ‡‚ï¼Œæœ¬æ–‡å°†æŒ‰ç…§ä»¥ä¸‹ç»“æ„å±•å¼€ï¼š\n\n1. **ä»€ä¹ˆæ˜¯ Double Tokenï¼Ÿ**  \n   - å®šä¹‰ä¸èƒŒæ™¯ï¼Œç±»æ¯”ç°å®ä¸–ç•Œçš„â€œåŒé’¥åŒ™â€æœºåˆ¶ã€‚  \n2. **ä¸ºä»€ä¹ˆéœ€è¦ Double Tokenï¼Ÿ**  \n   - å• Token ä½“ç³»çš„å±€é™æ€§ä¸å®‰å…¨éšæ‚£ã€‚  \n3. **Double Token çš„æ ¸å¿ƒåŸç†**  \n   - Access Token å’Œ Refresh Token çš„åˆ†å·¥ä¸åä½œã€‚  \n   - ç”Ÿå‘½å‘¨æœŸã€åŠ å¯†æœºåˆ¶ä¸å­˜å‚¨æ–¹å¼ã€‚  \n4. **å®ç° Double Token çš„æŠ€æœ¯ç»†èŠ‚**  \n   - åç«¯è®¾è®¡ï¼šç”Ÿæˆä¸éªŒè¯ Tokenã€‚  \n   - å‰ç«¯é›†æˆï¼šAxios æ‹¦æˆªå™¨ä¸ Token ç®¡ç†ã€‚  \n   - ä»£ç ç¤ºä¾‹ï¼šReact + Node.js å®ç°å®Œæ•´æµç¨‹ã€‚  \n5. **æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹**  \n   - å®‰å…¨å­˜å‚¨ã€Token å¤±æ•ˆå¤„ç†ã€é”™è¯¯é‡è¯•æœºåˆ¶ç­‰ã€‚  \n6. **é«˜çº§è¯é¢˜ä¸æ‰©å±•**  \n   - è·¨åŸŸåœºæ™¯ã€OAuth 2.0 é›†æˆã€å¾®æœåŠ¡ä¸‹çš„ Token ç®¡ç†ã€‚  \n7. **å“²å­¦æ€è€ƒï¼šä¿¡ä»»ä¸æŠ€æœ¯çš„å¹³è¡¡**  \n   - ä» Double Token çœ‹å‰ç«¯å¼€å‘è€…çš„è´£ä»»ä¸ä½¿å‘½ã€‚  \n8. **æ€»ç»“ä¸å±•æœ›**  \n   - Double Token çš„æœªæ¥ä¸ Web å®‰å…¨è¶‹åŠ¿ã€‚\n\n---\n\n## 1. ä»€ä¹ˆæ˜¯ Double Tokenï¼Ÿ\n\nDouble Tokenï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯æŒ‡åœ¨èº«ä»½éªŒè¯ä½“ç³»ä¸­ä½¿ç”¨**ä¸¤ç§ Token**ï¼ˆé€šå¸¸æ˜¯ **Access Token** å’Œ **Refresh Token**ï¼‰æ¥å®ç°ç”¨æˆ·è®¤è¯ä¸ä¼šè¯ç®¡ç†çš„æœºåˆ¶ã€‚å®ƒå°±åƒç°å®ä¸–ç•Œä¸­çš„â€œåŒé’¥åŒ™â€ä¿é™©ç®±ï¼šä¸€é’¥åŒ™ï¼ˆAccess Tokenï¼‰ç”¨äºæ—¥å¸¸æ“ä½œï¼Œå¦ä¸€é’¥åŒ™ï¼ˆRefresh Tokenï¼‰ç”¨äºåœ¨å¿…è¦æ—¶é‡æ–°è·å–æƒé™ã€‚ğŸ”‘ğŸ”\n\n### å®šä¹‰ä¸èƒŒæ™¯\n\nåœ¨ä¼ ç»Ÿçš„å• Token ä½“ç³»ä¸­ï¼Œä¸€ä¸ª JWT æ‰¿è½½äº†ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯å’Œæƒé™ï¼Œå®¢æˆ·ç«¯é€šè¿‡å®ƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªè‡´å‘½é—®é¢˜ï¼š**Token çš„æœ‰æ•ˆæœŸä¸å®‰å…¨æ€§ä¸å¯å…¼å¾—**ã€‚çŸ­ç”Ÿå‘½å‘¨æœŸçš„ Token é¢‘ç¹è¿‡æœŸï¼Œç”¨æˆ·ä½“éªŒå·®ï¼›é•¿ç”Ÿå‘½å‘¨æœŸçš„ Token åˆ™å¢åŠ äº†è¢«ç›—ç”¨çš„é£é™©ã€‚Double Token åº”è¿è€Œç”Ÿï¼Œé€šè¿‡**çŸ­æœŸ Access Token** å’Œ**é•¿æœŸ Refresh Token** çš„ç»„åˆï¼Œè§£å†³äº†è¿™ä¸€çŸ›ç›¾ã€‚\n\n### ç±»æ¯”ï¼šç°å®ä¸–ç•Œçš„åŒé’¥åŒ™\n\næƒ³è±¡ä½ æ˜¯ä¸€ä¸ªé“¶è¡Œé‡‘åº“çš„ç®¡ç†å‘˜ï¼š\n- **Access Token** å°±åƒä½ æ¯å¤©ç”¨æ¥å¼€é—¨çš„ç”µå­å¡ï¼ŒçŸ­æ—¶é—´å†…æœ‰æ•ˆï¼Œä¸¢å¤±äº†ä¹Ÿä¸è‡³äºè®©æ•´ä¸ªé‡‘åº“å¤±å®ˆã€‚\n- **Refresh Token** æ˜¯é‡‘åº“æ·±å¤„çš„æ€»é’¥åŒ™ï¼Œåªæœ‰åœ¨ç”µå­å¡å¤±æ•ˆæ—¶ï¼Œä½ æ‰ä¼šå°å¿ƒç¿¼ç¿¼åœ°ç”¨å®ƒé‡æ–°ç”Ÿæˆä¸€å¼ æ–°å¡ã€‚\n\nè¿™ç§æœºåˆ¶ä¸ä»…æé«˜äº†å®‰å…¨æ€§ï¼Œè¿˜è®©ç”¨æˆ·ä½“éªŒæ›´åŠ æµç•…ã€‚ğŸ˜Š\n\n_*Tips: åœ¨è®¾è®¡èº«ä»½éªŒè¯æ—¶ï¼Œå§‹ç»ˆå°†ç”¨æˆ·ä½“éªŒä¸å®‰å…¨æ€§æ”¾åœ¨åŒç­‰é‡è¦çš„ä½ç½®ã€‚Double Token çš„æ ¸å¿ƒä»·å€¼åœ¨äºå¹³è¡¡è¿™ä¸¤è€…ã€‚*_\n\n---\n\n## 2. ä¸ºä»€ä¹ˆéœ€è¦ Double Tokenï¼Ÿ\n\nè¦ç†è§£ Double Token çš„å¿…è¦æ€§ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹å• Token ä½“ç³»çš„å±€é™æ€§ã€‚\n\n### å• Token ä½“ç³»çš„ç—›ç‚¹\n\n| **é—®é¢˜**                     | **æè¿°**                                                                 | **å½±å“**                           |\n|------------------------------|--------------------------------------------------------------------------|------------------------------------|\n| **æœ‰æ•ˆæœŸå›°å¢ƒ**              | Token æœ‰æ•ˆæœŸçŸ­ï¼Œéœ€é¢‘ç¹ç™»å½•ï¼›æœ‰æ•ˆæœŸé•¿ï¼Œå®‰å…¨é£é™©é«˜ã€‚                       | ç”¨æˆ·ä½“éªŒå·®æˆ–å®‰å…¨éšæ‚£ã€‚             |\n| **æ— ç»­æœŸæœºåˆ¶**              | Token è¿‡æœŸåï¼Œç”¨æˆ·å¿…é¡»é‡æ–°ç™»å½•ï¼Œä½“éªŒå‰²è£‚ã€‚                               | æµå¤±ç”¨æˆ·ï¼Œå¢åŠ åç«¯å‹åŠ›ã€‚           |\n| **éš¾ä»¥æ’¤é”€**                | å• Token è¢«ç›—åï¼Œéš¾ä»¥å¿«é€Ÿå¤±æ•ˆï¼Œæ”»å‡»è€…å¯é•¿æœŸåˆ©ç”¨ã€‚                       | æ•°æ®æ³„éœ²ï¼Œç³»ç»Ÿä¿¡ä»»å´©å¡Œã€‚           |\n| **æƒé™ç®¡ç†å¤æ‚**            | å• Token éš¾ä»¥åŠ¨æ€è°ƒæ•´æƒé™ï¼ˆå¦‚ä¸´æ—¶æå‡æƒé™æˆ–é™çº§ï¼‰ã€‚                     | æƒé™ç®¡ç†åƒµåŒ–ï¼Œç»´æŠ¤æˆæœ¬é«˜ã€‚         |\n\n### Double Token çš„ä¼˜åŠ¿\n\nDouble Token é€šè¿‡å¼•å…¥ Refresh Tokenï¼Œè§£å†³äº†ä¸Šè¿°é—®é¢˜ï¼š\n\n1. **å®‰å…¨æ€§æå‡**ï¼šAccess Token çŸ­æœŸæœ‰æ•ˆï¼ˆé€šå¸¸ 15 åˆ†é’Ÿåˆ° 1 å°æ—¶ï¼‰ï¼Œå³ä½¿è¢«ç›—ï¼Œå½±å“èŒƒå›´æœ‰é™ã€‚\n2. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šRefresh Token é•¿æœŸæœ‰æ•ˆï¼ˆå‡ å¤©åˆ°å‡ ä¸ªæœˆï¼‰ï¼Œç”¨æˆ·æ— éœ€é¢‘ç¹ç™»å½•ã€‚\n3. **çµæ´»æ€§å¢å¼º**ï¼šRefresh Token å¯ç”¨äºåŠ¨æ€ç»­æœŸæˆ–æ’¤é”€ï¼Œæƒé™ç®¡ç†æ›´ç²¾ç»†ã€‚\n4. **é˜²å¾¡èƒ½åŠ›æ›´å¼º**ï¼šé€šè¿‡é»‘åå•ã€IP æ£€æµ‹ç­‰æœºåˆ¶ï¼ŒRefresh Token çš„æ»¥ç”¨å¯è¢«å¿«é€Ÿè¯†åˆ«ã€‚\n\n_*Tips: åœ¨é€‰æ‹© Token æœ‰æ•ˆæœŸæ—¶ï¼Œéµå¾ªâ€œæœ€å°æƒé™åŸåˆ™â€ï¼šAccess Token å°½å¯èƒ½çŸ­ï¼ŒRefresh Token æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°¨æ…å»¶é•¿ã€‚*_\n\n---\n\n## 3. Double Token çš„æ ¸å¿ƒåŸç†\n\nDouble Token çš„æ ¸å¿ƒåœ¨äº **Access Token** å’Œ **Refresh Token** çš„åˆ†å·¥ä¸åä½œã€‚è®©æˆ‘ä»¬æ·±å…¥å‰–æå®ƒä»¬çš„è¿ä½œæœºåˆ¶ã€‚\n\n### 3.1 Access Token vs. Refresh Token\n\n| **ç‰¹æ€§**             | **Access Token**                              | **Refresh Token**                              |\n|----------------------|-----------------------------------------------|-----------------------------------------------|\n| **ç”¨é€”**            | ç”¨äºè®¿é—®å—ä¿æŠ¤çš„ API èµ„æºã€‚                   | ç”¨äºåœ¨ Access Token è¿‡æœŸæ—¶è·å–æ–°çš„ Access Tokenã€‚ |\n| **æœ‰æ•ˆæœŸ**          | çŸ­ï¼ˆ15 åˆ†é’Ÿ ~ 1 å°æ—¶ï¼‰ã€‚                     | é•¿ï¼ˆ1 å¤© ~ æ•°æœˆï¼‰ã€‚                          |\n| **å­˜å‚¨ä½ç½®**        | é€šå¸¸å­˜å‚¨åœ¨å†…å­˜æˆ– HttpOnly Cookie ä¸­ã€‚        | é€šå¸¸å­˜å‚¨åœ¨ HttpOnly Cookie æˆ–å®‰å…¨æ•°æ®åº“ä¸­ã€‚   |\n| **å®‰å…¨æ€§è¦æ±‚**      | é«˜ï¼Œéœ€é˜²æ­¢ XSS æ”»å‡»ã€‚                        | æ›´é«˜ï¼Œéœ€é˜²æ­¢ CSRF å’Œæ•°æ®åº“æ³„éœ²ã€‚             |\n| **æ˜¯å¦å¯æ’¤é”€**      | é€šå¸¸ä¸å¯æ’¤é”€ï¼Œä¾èµ–çŸ­ç”Ÿå‘½å‘¨æœŸã€‚               | å¯é€šè¿‡é»‘åå•æˆ–æ•°æ®åº“æ’¤é”€ã€‚                   |\n\n### 3.2 å·¥ä½œæµç¨‹\n\n1. **ç”¨æˆ·ç™»å½•**ï¼šç”¨æˆ·æäº¤ç”¨æˆ·åå’Œå¯†ç ï¼Œåç«¯éªŒè¯é€šè¿‡åç”Ÿæˆ Access Token å’Œ Refresh Tokenï¼Œè¿”å›ç»™å‰ç«¯ã€‚\n2. **è®¿é—®èµ„æº**ï¼šå‰ç«¯å°† Access Token æ”¾å…¥ HTTP è¯·æ±‚å¤´ï¼ˆ`Authorization: Bearer <token>`ï¼‰ï¼Œè®¿é—®å—ä¿æŠ¤çš„ APIã€‚\n3. **Token è¿‡æœŸ**ï¼šå½“ Access Token è¿‡æœŸï¼ˆè¿”å› 401 çŠ¶æ€ç ï¼‰ï¼Œå‰ç«¯ä½¿ç”¨ Refresh Token è¯·æ±‚æ–°çš„ Access Tokenã€‚\n4. **ç»­æœŸæˆåŠŸ**ï¼šåç«¯éªŒè¯ Refresh Token æœ‰æ•ˆæ€§ï¼Œç”Ÿæˆæ–°çš„ Access Tokenï¼ˆæœ‰æ—¶ä¹Ÿæ›´æ–° Refresh Tokenï¼‰ã€‚\n5. **å¼‚å¸¸å¤„ç†**ï¼šè‹¥ Refresh Token æ— æ•ˆæˆ–è¢«æ’¤é”€ï¼Œç”¨æˆ·éœ€é‡æ–°ç™»å½•ã€‚\n\n### 3.3 åŠ å¯†ä¸å­˜å‚¨\n\n- **Access Token**ï¼šé€šå¸¸æ˜¯ JWTï¼ŒåŒ…å«ç”¨æˆ· IDã€è§’è‰²ã€è¿‡æœŸæ—¶é—´ç­‰ä¿¡æ¯ï¼Œé€šè¿‡ HMAC æˆ– RSA ç­¾åã€‚\n- **Refresh Token**ï¼šå¯ä»¥æ˜¯ JWT æˆ–éšæœºå­—ç¬¦ä¸²ï¼Œå­˜å‚¨åœ¨åç«¯æ•°æ®åº“ï¼Œéœ€ä¸ç”¨æˆ· ID å’Œè®¾å¤‡ä¿¡æ¯ç»‘å®šã€‚\n- **å­˜å‚¨æ–¹å¼**ï¼š\n  - **å‰ç«¯**ï¼šAccess Token å¯å­˜äºå†…å­˜ï¼ŒRefresh Token æ¨èä½¿ç”¨ HttpOnlyã€Secure çš„ Cookieã€‚\n  - **åç«¯**ï¼šRefresh Token å­˜å‚¨åœ¨æ•°æ®åº“ï¼ˆå¦‚ Redisï¼‰ï¼Œæ”¯æŒå¿«é€ŸæŸ¥è¯¢ä¸æ’¤é”€ã€‚\n\n_*Tips: æ°¸è¿œä¸è¦å°† Token å­˜å‚¨åœ¨ localStorage ä¸­ï¼ŒXSS æ”»å‡»ä¼šè®©ä½ çš„åŠªåŠ›åŒ–ä¸ºä¹Œæœ‰ã€‚ä½¿ç”¨ HttpOnly Cookie æ˜¯æ›´å®‰å…¨çš„é€‰æ‹©ã€‚*_\n\n---\n\n## 4. å®ç° Double Token çš„æŠ€æœ¯ç»†èŠ‚\n\nè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª **React + Node.js** çš„æ¡ˆä¾‹ï¼Œå±•ç¤º Double Token çš„å®Œæ•´å®ç°ã€‚ä»¥ä¸‹ä»£ç å°†æ¶µç›–åç«¯ç”Ÿæˆ Tokenã€å‰ç«¯ç®¡ç† Token çš„å…¨æµç¨‹ã€‚\n\n### 4.1 åç«¯è®¾è®¡ï¼ˆNode.js + Expressï¼‰\n\nåç«¯è´Ÿè´£ç”Ÿæˆå’ŒéªŒè¯ Tokenï¼Œä½¿ç”¨ `jsonwebtoken` åº“å’Œ Redis å­˜å‚¨ Refresh Tokenã€‚\n\n```mdx\nconst express = require('express');\nconst jwt = require('jsonwebtoken');\nconst redis = require('redis');\nconst cookieParser = require('cookie-parser');\nconst app = express();\n\napp.use(express.json());\napp.use(cookieParser());\n\n// Redis å®¢æˆ·ç«¯\nconst redisClient = redis.createClient({ url: 'redis://localhost:6379' });\nredisClient.connect();\n\n// å¯†é’¥\nconst ACCESS_TOKEN_SECRET = 'your-access-token-secret';\nconst REFRESH_TOKEN_SECRET = 'your-refresh-token-secret';\n\n// ç™»å½•æ¥å£\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n  // å‡è®¾éªŒè¯é€šè¿‡\n  if (username === 'admin' && password === 'password') {\n    const userId = 'user123';\n    \n    // ç”Ÿæˆ Access Token\n    const accessToken = jwt.sign({ userId }, ACCESS_TOKEN_SECRET, { expiresIn: '15m' });\n    \n    // ç”Ÿæˆ Refresh Token\n    const refreshToken = jwt.sign({ userId }, REFRESH_TOKEN_SECRET, { expiresIn: '7d' });\n    \n    // å­˜å‚¨ Refresh Token åˆ° Redis\n    await redisClient.set(`refresh:${userId}`, refreshToken, { EX: 7 * 24 * 60 * 60 });\n    \n    // è®¾ç½® HttpOnly Cookie\n    res.cookie('refreshToken', refreshToken, { httpOnly: true, secure: true, sameSite: 'strict' });\n    \n    res.json({ accessToken });\n  } else {\n    res.status(401).json({ message: 'Invalid credentials' });\n  }\n});\n\n// åˆ·æ–° Token æ¥å£\napp.post('/refresh', async (req, res) => {\n  const refreshToken = req.cookies.refreshToken;\n  if (!refreshToken) return res.status(401).json({ message: 'No refresh token' });\n  \n  try {\n    // éªŒè¯ Refresh Token\n    const payload = jwt.verify(refreshToken, REFRESH_TOKEN_SECRET);\n    const storedToken = await redisClient.get(`refresh:${payload.userId}`);\n    \n    if (storedToken !== refreshToken) {\n      return res.status(403).json({ message: 'Invalid refresh token' });\n    }\n    \n    // ç”Ÿæˆæ–°çš„ Access Token\n    const newAccessToken = jwt.sign({ userId: payload.userId }, ACCESS_TOKEN_SECRET, { expiresIn: '15m' });\n    \n    res.json({ accessToken: newAccessToken });\n  } catch (err) {\n    res.status(403).json({ message: 'Invalid refresh token' });\n  }\n});\n\n// å—ä¿æŠ¤çš„æ¥å£\napp.get('/protected', (req, res) => {\n  const authHeader = req.headers['authorization'];\n  const token = authHeader && authHeader.split(' ')[1];\n  \n  if (!token) return res.status(401).json({ message: 'No token provided' });\n  \n  jwt.verify(token, ACCESS_TOKEN_SECRET, (err, payload) => {\n    if (err) return res.status(403).json({ message: 'Invalid token' });\n    res.json({ message: 'Access granted', userId: payload.userId });\n  });\n});\n\napp.listen(3000, () => console.log('Server running on port 3000'));\n```\n\n### 4.2 å‰ç«¯é›†æˆï¼ˆReact + Axiosï¼‰\n\nå‰ç«¯ä½¿ç”¨ Axios æ‹¦æˆªå™¨è‡ªåŠ¨å¤„ç† Token è¿‡æœŸä¸åˆ·æ–°ã€‚\n\n```javascript\nimport axios from 'axios';\n\nconst api = axios.create({\n  baseURL: 'http://localhost:3000',\n  withCredentials: true, // å…è®¸å‘é€ Cookie\n});\n\n// å­˜å‚¨ Access Token\nlet accessToken = null;\n\nexport const setAccessToken = (token) => {\n  accessToken = token;\n};\n\n// è¯·æ±‚æ‹¦æˆªå™¨\napi.interceptors.request.use(\n  (config) => {\n    if (accessToken) {\n      config.headers['Authorization'] = `Bearer ${accessToken}`;\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\n// å“åº”æ‹¦æˆªå™¨\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n    \n    // å¤„ç† 401 é”™è¯¯ï¼ˆAccess Token è¿‡æœŸï¼‰\n    if (error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      \n      try {\n        // è¯·æ±‚åˆ·æ–° Token\n        const { data } = await api.post('/refresh');\n        accessToken = data.accessToken;\n        setAccessToken(accessToken);\n        \n        // é‡è¯•åŸå§‹è¯·æ±‚\n        originalRequest.headers['Authorization'] = `Bearer ${accessToken}`;\n        return api(originalRequest);\n      } catch (refreshError) {\n        // åˆ·æ–°å¤±è´¥ï¼Œè·³è½¬ç™»å½•\n        window.location.href = '/login';\n        return Promise.reject(refreshError);\n      }\n    }\n    \n    return Promise.reject(error);\n  }\n);\n\n// ç™»å½•æ–¹æ³•\nexport const login = async (username, password) => {\n  const { data } = await api.post('/login', { username, password });\n  setAccessToken(data.accessToken);\n  return data;\n};\n\n// è°ƒç”¨å—ä¿æŠ¤æ¥å£\nexport const fetchProtectedData = async () => {\n  const { data } = await api.get('/protected');\n  return data;\n};\n```\n\n### 4.3 React ç»„ä»¶ç¤ºä¾‹\n\nä»¥ä¸‹æ˜¯ç™»å½•é¡µé¢å’Œå—ä¿æŠ¤èµ„æºçš„ç®€å•å®ç°ã€‚\n\n```jsx\nimport React, { useState } from 'react';\nimport { login, fetchProtectedData } from './auth';\n\nconst Login = () => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [message, setMessage] = useState('');\n\n  const handleLogin = async () => {\n    try {\n      await login(username, password);\n      setMessage('Login successful!');\n    } catch (err) {\n      setMessage('Login failed.');\n    }\n  };\n\n  const handleFetchData = async () => {\n    try {\n      const data = await fetchProtectedData();\n      setMessage(data.message);\n    } catch (err) {\n      setMessage('Failed to fetch data.');\n    }\n  };\n\n  return (\n    <div className=\"p-4\">\n      <h1 className=\"text-2xl\">Login</h1>\n      <input\n        type=\"text\"\n        value={username}\n        onChange={(e) => setUsername(e.target.value)}\n        placeholder=\"Username\"\n        className=\"border p-2 m-2\"\n      />\n      <input\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n        className=\"border p-2 m-2\"\n      />\n      <button onClick={handleLogin} className=\"bg-blue-500 text-white p-2 m-2\">\n        Login\n      </button>\n      <button onClick={handleFetchData} className=\"bg-green-500 text-white p-2 m-2\">\n        Fetch Protected Data\n      </button>\n      <p>{message}</p>\n    </div>\n  );\n};\n\nexport default Login;\n```\n\n_*Tips: åœ¨å‰ç«¯å®ç°ä¸­ï¼Œå§‹ç»ˆä¸º Axios æ‹¦æˆªå™¨è®¾ç½®é‡è¯•æ ‡å¿—ï¼ˆ_retryï¼‰ï¼Œé¿å…æ— é™å¾ªç¯åˆ·æ–° Tokenã€‚*_\n\n---\n\n## 5. æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹\n\nä»¥ä¸‹æ˜¯å®ç° Double Token æ—¶çš„ä¸€äº›æœ€ä½³å®è·µï¼ŒåŠ©ä½ æ‰“é€ æ›´å®‰å…¨ã€æ›´å¥å£®çš„ç³»ç»Ÿã€‚\n\n### 5.1 å®‰å…¨å­˜å‚¨\n\n- **å‰ç«¯**ï¼šå°† Access Token å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼ŒRefresh Token ä½¿ç”¨ HttpOnlyã€Secureã€SameSite=strict çš„ Cookieã€‚\n- **åç«¯**ï¼šRefresh Token å­˜å‚¨åœ¨ Redis æˆ–æ•°æ®åº“ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¹¶ä¸ç”¨æˆ· IDã€è®¾å¤‡ä¿¡æ¯ç»‘å®šã€‚\n- **é˜²å¾¡ XSS**ï¼šä½¿ç”¨ CSPï¼ˆContent Security Policyï¼‰é™åˆ¶è„šæœ¬æ‰§è¡Œï¼Œé˜²æ­¢ Token è¢«çªƒå–ã€‚\n\n_*Tips: å®šæœŸå®¡æŸ¥ Cookie çš„å®‰å…¨é…ç½®ï¼Œç¡®ä¿ SameSite å’Œ Secure å±æ€§æœªè¢«é—æ¼ã€‚*_\n\n### 5.2 Token å¤±æ•ˆå¤„ç†\n\n- **é»‘åå•æœºåˆ¶**ï¼šå°†å¤±æ•ˆçš„ Refresh Token åŠ å…¥é»‘åå•ï¼Œé˜²æ­¢è¢«æ»¥ç”¨ã€‚\n- **åŠ¨æ€æ’¤é”€**ï¼šæ”¯æŒç”¨æˆ·æ‰‹åŠ¨æ³¨é”€æˆ–åœ¨å¼‚å¸¸ç™»å½•æ—¶æ’¤é”€æ‰€æœ‰ Tokenã€‚\n- **é”™è¯¯æç¤º**ï¼šå½“ Token å¤±æ•ˆæ—¶ï¼Œè¿”å›æ¸…æ™°çš„é”™è¯¯ç å’Œæç¤ºï¼Œå¼•å¯¼ç”¨æˆ·é‡æ–°ç™»å½•ã€‚\n\n_*Tips: åœ¨åç«¯è®¾è®¡é»‘åå•æ—¶ï¼Œä½¿ç”¨ Redis çš„ SET æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢æ•ˆç‡æ›´é«˜ã€‚*_\n\n### 5.3 é”™è¯¯é‡è¯•æœºåˆ¶\n\n- **æŒ‡æ•°é€€é¿**ï¼šåœ¨åˆ·æ–° Token å¤±è´¥æ—¶ï¼Œä½¿ç”¨æŒ‡æ•°é€€é¿ç®—æ³•é‡è¯•ï¼Œé¿å…æœåŠ¡å™¨è¿‡è½½ã€‚\n- **ç”¨æˆ·ä½“éªŒ**ï¼šåœ¨é‡è¯•æœŸé—´æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Œé¿å…ç”¨æˆ·é‡å¤æ“ä½œã€‚\n\n_*Tips: ä¸ºé‡è¯•æœºåˆ¶è®¾ç½®æœ€å¤§å°è¯•æ¬¡æ•°ï¼ˆå¦‚ 3 æ¬¡ï¼‰ï¼Œé˜²æ­¢æ— é™è¯·æ±‚ã€‚*_\n\n### 5.4 æ—¥å¿—ä¸ç›‘æ§\n\n- **è®°å½•å¼‚å¸¸**ï¼šè®°å½• Token åˆ·æ–°å¤±è´¥ã€éªŒè¯å¤±è´¥çš„æ—¥å¿—ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜ã€‚\n- **ç›‘æ§æŒ‡æ ‡**ï¼šç›‘æ§ Token åˆ·æ–°é¢‘ç‡ã€401 é”™è¯¯ç‡ï¼Œå‘ç°æ½œåœ¨æ”»å‡»ã€‚\n\n_*Tips: ä½¿ç”¨ Sentry æˆ–è‡ªå»ºæ—¥å¿—ç³»ç»Ÿï¼Œå®æ—¶æ•è· Token ç›¸å…³çš„å¼‚å¸¸ã€‚*_\n\n---\n\n## 6. é«˜çº§è¯é¢˜ä¸æ‰©å±•\n\n### 6.1 è·¨åŸŸåœºæ™¯\n\nåœ¨è·¨åŸŸåœºæ™¯ä¸‹ï¼ŒDouble Token çš„å®ç°éœ€è¦é¢å¤–æ³¨æ„ï¼š\n\n- **CORS é…ç½®**ï¼šç¡®ä¿åç«¯æ­£ç¡®è®¾ç½® `Access-Control-Allow-Credentials` å’Œ `Access-Control-Allow-Origin`ã€‚\n- **Cookie è·¨åŸŸ**ï¼šRefresh Token çš„ Cookie éœ€è®¾ç½® `SameSite=none` å’Œ `Secure`ã€‚\n- **é˜²å¾¡ CSRF**ï¼šä½¿ç”¨ CSRF Token æˆ–éªŒè¯ Origin å¤´ã€‚\n\n_*Tips: åœ¨è·¨åŸŸåœºæ™¯ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ POST è¯·æ±‚åˆ·æ–° Tokenï¼Œé™ä½ CSRF é£é™©ã€‚*_\n\n### 6.2 OAuth 2.0 é›†æˆ\n\nDouble Token å¸¸ä¸ OAuth 2.0 ç»“åˆä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ç¬¬ä¸‰æ–¹ç™»å½•åœºæ™¯ä¸­ï¼š\n\n- **Access Token**ï¼šç”± OAuth æä¾›å•†é¢å‘ï¼Œç”¨äºè®¿é—®ç”¨æˆ·èµ„æºã€‚\n- **Refresh Token**ï¼šç”¨äºè·å–æ–°çš„ Access Tokenï¼Œéœ€å¦¥å–„å­˜å‚¨ã€‚\n- **å‰ç«¯å¤„ç†**ï¼šåœ¨å‰ç«¯å®ç° OAuth å›è°ƒï¼Œè§£æå¹¶å­˜å‚¨ Tokenã€‚\n\n_*Tips: ä½¿ç”¨ OAuth æ—¶ï¼Œä¼˜å…ˆé€‰æ‹© PKCE æµç¨‹ï¼Œå¢å¼ºç§»åŠ¨ç«¯å®‰å…¨æ€§ã€‚*_\n\n### 6.3 å¾®æœåŠ¡ä¸‹çš„ Token ç®¡ç†\n\nåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒToken éªŒè¯éœ€åˆ†å¸ƒå¼å¤„ç†ï¼š\n\n- **ç½‘å…³éªŒè¯**ï¼šåœ¨ API ç½‘å…³ï¼ˆå¦‚ Kongï¼‰éªŒè¯ Access Tokenï¼Œå‡å°‘æœåŠ¡é—´è€¦åˆã€‚\n- **å…±äº«å¯†é’¥**ï¼šä½¿ç”¨ç»Ÿä¸€çš„å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆå¦‚ Vaultï¼‰åˆ†å‘ JWT ç­¾åå¯†é’¥ã€‚\n- **Refresh Token åŒæ­¥**ï¼šé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ Kafkaï¼‰åŒæ­¥ Refresh Token çš„çŠ¶æ€ã€‚\n\n_*Tips: åœ¨å¾®æœåŠ¡ä¸­ï¼Œä½¿ç”¨çŸ­ç”Ÿå‘½å‘¨æœŸçš„ Access Tokenï¼Œé™ä½ç½‘å…³éªŒè¯çš„æ€§èƒ½å¼€é”€ã€‚*_\n\n---\n\n## 7. å“²å­¦æ€è€ƒï¼šä¿¡ä»»ä¸æŠ€æœ¯çš„å¹³è¡¡\n\n> â€œæŠ€æœ¯æ˜¯ä¿¡ä»»çš„å»¶ä¼¸ï¼Œä½†ä¿¡ä»»æ°¸è¿œéœ€è¦éªŒè¯ã€‚â€ â€”â€” æ™“é¾™\n\nDouble Token çš„è®¾è®¡ä¸ä»…ä»…æ˜¯æŠ€æœ¯çš„å †ç Œï¼Œå®ƒèƒŒåæ˜¯å¯¹ä¿¡ä»»çš„æ·±åˆ»æ€è€ƒã€‚åœ¨ Web ä¸–ç•Œä¸­ï¼Œç”¨æˆ·ä¿¡ä»»æˆ‘ä»¬ä¿æŠ¤ä»–ä»¬çš„æ•°æ®ï¼Œå¼€å‘è€…ä¿¡ä»»ç³»ç»Ÿæä¾›ç¨³å®šçš„ä½“éªŒï¼Œè€Œç³»ç»Ÿæœ¬èº«åˆ™ä¾èµ–ç®—æ³•å’Œåè®®æ¥éªŒè¯æ¯ä¸€æ–¹ã€‚ğŸ”\n\nä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬çš„ä»£ç ä¸ä»…æ˜¯åŠŸèƒ½çš„å®ç°ï¼Œæ›´æ˜¯ä¿¡ä»»çš„ä¼ é€’ã€‚æ¯ä¸€è¡Œä»£ç éƒ½åœ¨å›ç­”ä¸€ä¸ªé—®é¢˜ï¼š**æˆ‘ä»¬å¦‚ä½•åœ¨å¼€æ”¾çš„äº’è”ç½‘ä¸­å»ºç«‹å®‰å…¨çš„å ¡å’ï¼Ÿ** Double Token æ˜¯ä¸€ä¸ªç­”æ¡ˆï¼Œä½†å®ƒä¹Ÿæé†’æˆ‘ä»¬ï¼Œå®‰å…¨ä»æ¥ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯ä¸€åœºæ°¸æ— æ­¢å¢ƒçš„æ—…ç¨‹ã€‚\n\nä»å“²å­¦è§’åº¦çœ‹ï¼ŒDouble Token çš„çŸ­æœŸä¸é•¿æœŸ Token å°±åƒäººç”Ÿçš„çŸ­æœŸç›®æ ‡ä¸é•¿æœŸæ„¿æ™¯ï¼šçŸ­æœŸçš„åŠªåŠ›ä¸ºæˆ‘ä»¬èµ¢å¾—çœ¼å‰çš„æˆæœï¼Œè€Œé•¿æœŸçš„åšæŒè®©æˆ‘ä»¬èµ°å‘æ›´è¿œçš„æœªæ¥ã€‚ğŸŒŸ åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿™ç§åŒé‡æ€ç»´ï¼šæ—¢è¦å…³æ³¨ç»†èŠ‚çš„ä¸¥è°¨ï¼Œä¹Ÿè¦æ”¾çœ¼ç³»ç»Ÿçš„å…¨å±€ã€‚\n\n_*Tips: åœ¨å¼€å‘ä¸­ï¼Œå®šæœŸåæ€ä½ çš„ä»£ç æ˜¯å¦åœ¨â€œä¿¡ä»»â€ä¸â€œæ•ˆç‡â€ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ï¼Œè¿™æ˜¯æˆä¸ºä¼˜ç§€å¼€å‘è€…çš„å…³é”®ã€‚*_\n\n---\n\n## 8. æ€»ç»“ä¸å±•æœ›\n\nDouble Token æ˜¯ä¸€ç§ä¼˜é›…è€Œå®ç”¨çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œå®ƒé€šè¿‡ Access Token å’Œ Refresh Token çš„åä½œï¼Œå¹³è¡¡äº†å®‰å…¨æ€§ä¸ç”¨æˆ·ä½“éªŒã€‚ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼ŒæŒæ¡ Double Token çš„åŸç†ä¸å®è·µï¼Œä¸ä»…èƒ½æå‡ä½ çš„æŠ€æœ¯èƒ½åŠ›ï¼Œè¿˜èƒ½è®©ä½ åœ¨å®‰å…¨é¢†åŸŸæ›´å…·æ´å¯ŸåŠ›ã€‚\n\næœªæ¥ï¼Œéšç€ Web3ã€é›¶ä¿¡ä»»æ¶æ„å’Œé‡å­è®¡ç®—çš„å‘å±•ï¼Œèº«ä»½éªŒè¯æœºåˆ¶å°†è¿æ¥æ–°çš„æŒ‘æˆ˜ã€‚Double Token æˆ–è®¸ä¼šæ¼”å˜ä¸ºæ›´å¤æ‚çš„å¤š Token ä½“ç³»ï¼Œæˆ–ä¸ç”Ÿç‰©è¯†åˆ«ã€åŒºå—é“¾æŠ€æœ¯ç»“åˆã€‚æ— è®ºå¦‚ä½•ï¼Œä¿¡ä»»ä¸éªŒè¯çš„æœ¬è´¨ä¸ä¼šæ”¹å˜ï¼Œè€Œæˆ‘ä»¬ä½œä¸ºå¼€å‘è€…çš„ä½¿å‘½ï¼Œå§‹ç»ˆæ˜¯ä¸ºç”¨æˆ·æ„å»ºæ›´å®‰å…¨ã€æ›´ä¾¿æ·çš„æ•°å­—ä¸–ç•Œã€‚ğŸŒ\n\n> â€œä»£ç æ˜¯è¯—ï¼Œå®‰å…¨æ˜¯éŸµã€‚â€ â€”â€” è®©æˆ‘ä»¬ç”¨ä¼˜é›…çš„ä»£ç ï¼Œä¹¦å†™å®‰å…¨çš„æœªæ¥ï¼\n\n---\n\n**å‚è€ƒèµ„æ–™**  \n- [JWT å®˜æ–¹æ–‡æ¡£](https://jwt.io/)  \n- [OAuth 2.0 è§„èŒƒ](https://oauth.net/2/)  \n- [OWASP å®‰å…¨æŒ‡å—](https://owasp.org/)  \n\nå¸Œæœ›è¿™ç¯‡åšå®¢èƒ½ä¸ºä½ å¸¦æ¥å¯å‘ï¼å¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµã€‚ğŸ˜„\n\n---",
    "code": "var Component=(()=>{var E=Object.create;var s=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var u=(l,n)=>()=>(n||l((n={exports:{}}).exports,n),n.exports),T=(l,n)=>{for(var r in n)s(l,r,{get:n[r],enumerable:!0})},i=(l,n,r,o)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let c of y(n))!k.call(l,c)&&c!==r&&s(l,c,{get:()=>n[c],enumerable:!(o=p(n,c))||o.enumerable});return l};var g=(l,n,r)=>(r=l!=null?E(F(l)):{},i(n||!l||!l.__esModule?s(r,\"default\",{value:l,enumerable:!0}):r,l)),B=l=>i(s({},\"__esModule\",{value:!0}),l);var d=u((b,a)=>{a.exports=_jsx_runtime});var C={};T(C,{default:()=>h,frontmatter:()=>f});var e=g(d()),f={type:\"Post\",title:\"\\u524D\\u7AEF\\u53CC\\u91CD\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\uFF08Double Token\\uFF09\\uFF1A\\u4ECE\\u539F\\u7406\\u5230\\u5B9E\\u8DF5\\u7684\\u6DF1\\u5EA6\\u89E3\\u6790\",date:\"2023-12-02\",description:\"\\u6DF1\\u5165\\u63A2\\u8BA8\\u524D\\u7AEF\\u53CC\\u91CD\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\uFF08Double Token\\uFF09\\u7684\\u5B9E\\u73B0\\u539F\\u7406\\u3001\\u8BBE\\u8BA1\\u601D\\u8DEF\\u4E0E\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF0C\\u7ED3\\u5408\\u4EE3\\u7801\\u793A\\u4F8B\\u3001\\u8868\\u683C\\u5206\\u6790\\u548C\\u54F2\\u5B66\\u601D\\u8003\\uFF0C\\u4E3A\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u63D0\\u4F9B\\u5168\\u9762\\u6307\\u5BFC\\u3002\",keywords:\"\\u53CC\\u91CD\\u8EAB\\u4EFD\\u9A8C\\u8BC1, Double Token, JWT, Refresh Token, \\u524D\\u7AEF\\u5B89\\u5168, \\u8EAB\\u4EFD\\u9A8C\\u8BC1, Web \\u5F00\\u53D1, \\u5B89\\u5168\\u5B9E\\u8DF5\",author:\"\\u6653\\u9F99\",image:\"/images/hero/double-token-auth.jpg\",tags:[\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"Web \\u5B89\\u5168\",\"\\u8EAB\\u4EFD\\u9A8C\\u8BC1\",\"JWT\"],category:\"\\u524D\\u7AEF\\u6280\\u672F\"};function t(l){let n={a:\"a\",blockquote:\"blockquote\",code:\"code\",em:\"em\",figure:\"figure\",h2:\"h2\",h3:\"h3\",hr:\"hr\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...l.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u201C\\u4FE1\\u4EFB\\u662F\\u6602\\u8D35\\u7684\\u5962\\u4F88\\u54C1\\uFF0C\\u9A8C\\u8BC1\\u662F\\u5B89\\u5168\\u7684\\u57FA\\u77F3\\u3002\\u201D \\u2014\\u2014 \\u67D0\\u4F4D\\u4E0D\\u613F\\u900F\\u9732\\u59D3\\u540D\\u7684\\u524D\\u7AEF\\u5F00\\u53D1\\u8005 \\u{1F60E}\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5728\\u73B0\\u4EE3 Web \\u5F00\\u53D1\\u4E2D\\uFF0C\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\uFF08Authentication\\uFF09\\u65E9\\u5DF2\\u4E0D\\u662F\\u7B80\\u5355\\u7684\\u7528\\u6237\\u540D\\u5BC6\\u7801\\u6821\\u9A8C\\uFF0C\\u800C\\u662F\\u6F14\\u53D8\\u4E3A\\u4E00\\u573A\\u6280\\u672F\\u548C\\u4FE1\\u4EFB\\u7684\\u535A\\u5F08\\u3002\\u53CC\\u91CD\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\uFF08Double Token\\uFF09\\uFF0C\\u4F5C\\u4E3A\\u4E00\\u79CD\\u5728 JWT\\uFF08JSON Web Token\\uFF09\\u4F53\\u7CFB\\u4E2D\\u5E7F\\u6CDB\\u5E94\\u7528\\u7684\\u673A\\u5236\\uFF0C\\u4EE5\\u5176\\u4F18\\u96C5\\u7684\\u8BBE\\u8BA1\\u548C\\u9AD8\\u5B89\\u5168\\u6027\\uFF0C\\u6210\\u4E3A\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u7684\\u5FC5\\u5907\\u6280\\u80FD\\u3002\\u{1F512}\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u672C\\u6587\\u5C06\\u5E26\\u4F60\\u4ECE\",(0,e.jsx)(n.strong,{children:\"\\u539F\\u7406\\u5230\\u5B9E\\u8DF5\"}),\"\\uFF0C\\u6DF1\\u5165\\u5256\\u6790 Double Token \\u7684\\u5B9E\\u73B0\\u601D\\u8DEF\\uFF0C\\u7ED3\\u5408\\u4EE3\\u7801\\u793A\\u4F8B\\u3001\\u6700\\u4F73\\u5B9E\\u8DF5\\u548C\\u54F2\\u5B66\\u601D\\u8003\\uFF0C\\u4E3A\\u4F60\\u5448\\u73B0\\u4E00\\u5E45\\u524D\\u7AEF\\u5B89\\u5168\\u7684\\u5B8F\\u4F1F\\u753B\\u5377\\u3002\\u65E0\\u8BBA\\u4F60\\u662F\\u521A\\u5165\\u884C\\u7684\\u65B0\\u624B\\uFF0C\\u8FD8\\u662F\\u8EAB\\u7ECF\\u767E\\u6218\\u7684\\u8001\\u5175\\uFF0C\\u8FD9\\u7BC7\\u535A\\u5BA2\\u90FD\\u5C06\\u4E3A\\u4F60\\u63D0\\u4F9B\\u542F\\u53D1\\u4E0E\\u5E72\\u8D27\\u3002\\u51C6\\u5907\\u597D\\u4E86\\u5417\\uFF1F\\u8BA9\\u6211\\u4EEC\\u5F00\\u59CB\\u8FD9\\u573A\\u5173\\u4E8E\\u4FE1\\u4EFB\\u4E0E\\u6280\\u672F\\u7684\\u65C5\\u7A0B\\u5427\\uFF01\\u{1F680}\"]}),`\n`,(0,e.jsx)(n.h2,{id:\"\\u6587\\u7AE0\\u7ED3\\u6784\\u601D\\u7EF4\\u94FE\\u6982\\u89C8\",children:(0,e.jsx)(n.a,{href:\"#\\u6587\\u7AE0\\u7ED3\\u6784\\u601D\\u7EF4\\u94FE\\u6982\\u89C8\",children:\"\\u6587\\u7AE0\\u7ED3\\u6784\\uFF1A\\u601D\\u7EF4\\u94FE\\u6982\\u89C8\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4E3A\\u4E86\\u8BA9\\u5185\\u5BB9\\u6E05\\u6670\\u6613\\u61C2\\uFF0C\\u672C\\u6587\\u5C06\\u6309\\u7167\\u4EE5\\u4E0B\\u7ED3\\u6784\\u5C55\\u5F00\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u4EC0\\u4E48\\u662F Double Token\\uFF1F\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u5B9A\\u4E49\\u4E0E\\u80CC\\u666F\\uFF0C\\u7C7B\\u6BD4\\u73B0\\u5B9E\\u4E16\\u754C\\u7684\\u201C\\u53CC\\u94A5\\u5319\\u201D\\u673A\\u5236\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981 Double Token\\uFF1F\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u5355 Token \\u4F53\\u7CFB\\u7684\\u5C40\\u9650\\u6027\\u4E0E\\u5B89\\u5168\\u9690\\u60A3\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Double Token \\u7684\\u6838\\u5FC3\\u539F\\u7406\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Access Token \\u548C Refresh Token \\u7684\\u5206\\u5DE5\\u4E0E\\u534F\\u4F5C\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u751F\\u547D\\u5468\\u671F\\u3001\\u52A0\\u5BC6\\u673A\\u5236\\u4E0E\\u5B58\\u50A8\\u65B9\\u5F0F\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5B9E\\u73B0 Double Token \\u7684\\u6280\\u672F\\u7EC6\\u8282\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u540E\\u7AEF\\u8BBE\\u8BA1\\uFF1A\\u751F\\u6210\\u4E0E\\u9A8C\\u8BC1 Token\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u524D\\u7AEF\\u96C6\\u6210\\uFF1AAxios \\u62E6\\u622A\\u5668\\u4E0E Token \\u7BA1\\u7406\\u3002\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u4EE3\\u7801\\u793A\\u4F8B\\uFF1AReact + Node.js \\u5B9E\\u73B0\\u5B8C\\u6574\\u6D41\\u7A0B\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u5B89\\u5168\\u5B58\\u50A8\\u3001Token \\u5931\\u6548\\u5904\\u7406\\u3001\\u9519\\u8BEF\\u91CD\\u8BD5\\u673A\\u5236\\u7B49\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u9AD8\\u7EA7\\u8BDD\\u9898\\u4E0E\\u6269\\u5C55\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u8DE8\\u57DF\\u573A\\u666F\\u3001OAuth 2.0 \\u96C6\\u6210\\u3001\\u5FAE\\u670D\\u52A1\\u4E0B\\u7684 Token \\u7BA1\\u7406\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u54F2\\u5B66\\u601D\\u8003\\uFF1A\\u4FE1\\u4EFB\\u4E0E\\u6280\\u672F\\u7684\\u5E73\\u8861\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u4ECE Double Token \\u770B\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u7684\\u8D23\\u4EFB\\u4E0E\\u4F7F\\u547D\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u603B\\u7ED3\\u4E0E\\u5C55\\u671B\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Double Token \\u7684\\u672A\\u6765\\u4E0E Web \\u5B89\\u5168\\u8D8B\\u52BF\\u3002\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"1-\\u4EC0\\u4E48\\u662F-double-token\",children:(0,e.jsx)(n.a,{href:\"#1-\\u4EC0\\u4E48\\u662F-double-token\",children:\"1. \\u4EC0\\u4E48\\u662F Double Token\\uFF1F\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Double Token\\uFF0C\\u987E\\u540D\\u601D\\u4E49\\uFF0C\\u662F\\u6307\\u5728\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u4F53\\u7CFB\\u4E2D\\u4F7F\\u7528\",(0,e.jsx)(n.strong,{children:\"\\u4E24\\u79CD Token\"}),\"\\uFF08\\u901A\\u5E38\\u662F \",(0,e.jsx)(n.strong,{children:\"Access Token\"}),\" \\u548C \",(0,e.jsx)(n.strong,{children:\"Refresh Token\"}),\"\\uFF09\\u6765\\u5B9E\\u73B0\\u7528\\u6237\\u8BA4\\u8BC1\\u4E0E\\u4F1A\\u8BDD\\u7BA1\\u7406\\u7684\\u673A\\u5236\\u3002\\u5B83\\u5C31\\u50CF\\u73B0\\u5B9E\\u4E16\\u754C\\u4E2D\\u7684\\u201C\\u53CC\\u94A5\\u5319\\u201D\\u4FDD\\u9669\\u7BB1\\uFF1A\\u4E00\\u94A5\\u5319\\uFF08Access Token\\uFF09\\u7528\\u4E8E\\u65E5\\u5E38\\u64CD\\u4F5C\\uFF0C\\u53E6\\u4E00\\u94A5\\u5319\\uFF08Refresh Token\\uFF09\\u7528\\u4E8E\\u5728\\u5FC5\\u8981\\u65F6\\u91CD\\u65B0\\u83B7\\u53D6\\u6743\\u9650\\u3002\\u{1F511}\\u{1F510}\"]}),`\n`,(0,e.jsx)(n.h3,{id:\"\\u5B9A\\u4E49\\u4E0E\\u80CC\\u666F\",children:(0,e.jsx)(n.a,{href:\"#\\u5B9A\\u4E49\\u4E0E\\u80CC\\u666F\",children:\"\\u5B9A\\u4E49\\u4E0E\\u80CC\\u666F\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u5728\\u4F20\\u7EDF\\u7684\\u5355 Token \\u4F53\\u7CFB\\u4E2D\\uFF0C\\u4E00\\u4E2A JWT \\u627F\\u8F7D\\u4E86\\u7528\\u6237\\u7684\\u8EAB\\u4EFD\\u4FE1\\u606F\\u548C\\u6743\\u9650\\uFF0C\\u5BA2\\u6237\\u7AEF\\u901A\\u8FC7\\u5B83\\u8BBF\\u95EE\\u53D7\\u4FDD\\u62A4\\u7684\\u8D44\\u6E90\\u3002\\u7136\\u800C\\uFF0C\\u8FD9\\u79CD\\u65B9\\u5F0F\\u5B58\\u5728\\u4E00\\u4E2A\\u81F4\\u547D\\u95EE\\u9898\\uFF1A\",(0,e.jsx)(n.strong,{children:\"Token \\u7684\\u6709\\u6548\\u671F\\u4E0E\\u5B89\\u5168\\u6027\\u4E0D\\u53EF\\u517C\\u5F97\"}),\"\\u3002\\u77ED\\u751F\\u547D\\u5468\\u671F\\u7684 Token \\u9891\\u7E41\\u8FC7\\u671F\\uFF0C\\u7528\\u6237\\u4F53\\u9A8C\\u5DEE\\uFF1B\\u957F\\u751F\\u547D\\u5468\\u671F\\u7684 Token \\u5219\\u589E\\u52A0\\u4E86\\u88AB\\u76D7\\u7528\\u7684\\u98CE\\u9669\\u3002Double Token \\u5E94\\u8FD0\\u800C\\u751F\\uFF0C\\u901A\\u8FC7\",(0,e.jsx)(n.strong,{children:\"\\u77ED\\u671F Access Token\"}),\" \\u548C\",(0,e.jsx)(n.strong,{children:\"\\u957F\\u671F Refresh Token\"}),\" \\u7684\\u7EC4\\u5408\\uFF0C\\u89E3\\u51B3\\u4E86\\u8FD9\\u4E00\\u77DB\\u76FE\\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{id:\"\\u7C7B\\u6BD4\\u73B0\\u5B9E\\u4E16\\u754C\\u7684\\u53CC\\u94A5\\u5319\",children:(0,e.jsx)(n.a,{href:\"#\\u7C7B\\u6BD4\\u73B0\\u5B9E\\u4E16\\u754C\\u7684\\u53CC\\u94A5\\u5319\",children:\"\\u7C7B\\u6BD4\\uFF1A\\u73B0\\u5B9E\\u4E16\\u754C\\u7684\\u53CC\\u94A5\\u5319\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u60F3\\u8C61\\u4F60\\u662F\\u4E00\\u4E2A\\u94F6\\u884C\\u91D1\\u5E93\\u7684\\u7BA1\\u7406\\u5458\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Access Token\"}),\" \\u5C31\\u50CF\\u4F60\\u6BCF\\u5929\\u7528\\u6765\\u5F00\\u95E8\\u7684\\u7535\\u5B50\\u5361\\uFF0C\\u77ED\\u65F6\\u95F4\\u5185\\u6709\\u6548\\uFF0C\\u4E22\\u5931\\u4E86\\u4E5F\\u4E0D\\u81F3\\u4E8E\\u8BA9\\u6574\\u4E2A\\u91D1\\u5E93\\u5931\\u5B88\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Refresh Token\"}),\" \\u662F\\u91D1\\u5E93\\u6DF1\\u5904\\u7684\\u603B\\u94A5\\u5319\\uFF0C\\u53EA\\u6709\\u5728\\u7535\\u5B50\\u5361\\u5931\\u6548\\u65F6\\uFF0C\\u4F60\\u624D\\u4F1A\\u5C0F\\u5FC3\\u7FFC\\u7FFC\\u5730\\u7528\\u5B83\\u91CD\\u65B0\\u751F\\u6210\\u4E00\\u5F20\\u65B0\\u5361\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u8FD9\\u79CD\\u673A\\u5236\\u4E0D\\u4EC5\\u63D0\\u9AD8\\u4E86\\u5B89\\u5168\\u6027\\uFF0C\\u8FD8\\u8BA9\\u7528\\u6237\\u4F53\\u9A8C\\u66F4\\u52A0\\u6D41\\u7545\\u3002\\u{1F60A}\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u8BBE\\u8BA1\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u65F6\\uFF0C\\u59CB\\u7EC8\\u5C06\\u7528\\u6237\\u4F53\\u9A8C\\u4E0E\\u5B89\\u5168\\u6027\\u653E\\u5728\\u540C\\u7B49\\u91CD\\u8981\\u7684\\u4F4D\\u7F6E\\u3002Double Token \\u7684\\u6838\\u5FC3\\u4EF7\\u503C\\u5728\\u4E8E\\u5E73\\u8861\\u8FD9\\u4E24\\u8005\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"2-\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981-double-token\",children:(0,e.jsx)(n.a,{href:\"#2-\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981-double-token\",children:\"2. \\u4E3A\\u4EC0\\u4E48\\u9700\\u8981 Double Token\\uFF1F\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u8981\\u7406\\u89E3 Double Token \\u7684\\u5FC5\\u8981\\u6027\\uFF0C\\u6211\\u4EEC\\u5148\\u6765\\u770B\\u5355 Token \\u4F53\\u7CFB\\u7684\\u5C40\\u9650\\u6027\\u3002\"}),`\n`,(0,e.jsx)(n.h3,{id:\"\\u5355-token-\\u4F53\\u7CFB\\u7684\\u75DB\\u70B9\",children:(0,e.jsx)(n.a,{href:\"#\\u5355-token-\\u4F53\\u7CFB\\u7684\\u75DB\\u70B9\",children:\"\\u5355 Token \\u4F53\\u7CFB\\u7684\\u75DB\\u70B9\"})}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:(0,e.jsx)(n.strong,{children:\"\\u95EE\\u9898\"})}),(0,e.jsx)(n.th,{children:(0,e.jsx)(n.strong,{children:\"\\u63CF\\u8FF0\"})}),(0,e.jsx)(n.th,{children:(0,e.jsx)(n.strong,{children:\"\\u5F71\\u54CD\"})})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u6709\\u6548\\u671F\\u56F0\\u5883\"})}),(0,e.jsx)(n.td,{children:\"Token \\u6709\\u6548\\u671F\\u77ED\\uFF0C\\u9700\\u9891\\u7E41\\u767B\\u5F55\\uFF1B\\u6709\\u6548\\u671F\\u957F\\uFF0C\\u5B89\\u5168\\u98CE\\u9669\\u9AD8\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u7528\\u6237\\u4F53\\u9A8C\\u5DEE\\u6216\\u5B89\\u5168\\u9690\\u60A3\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u65E0\\u7EED\\u671F\\u673A\\u5236\"})}),(0,e.jsx)(n.td,{children:\"Token \\u8FC7\\u671F\\u540E\\uFF0C\\u7528\\u6237\\u5FC5\\u987B\\u91CD\\u65B0\\u767B\\u5F55\\uFF0C\\u4F53\\u9A8C\\u5272\\u88C2\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u6D41\\u5931\\u7528\\u6237\\uFF0C\\u589E\\u52A0\\u540E\\u7AEF\\u538B\\u529B\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u96BE\\u4EE5\\u64A4\\u9500\"})}),(0,e.jsx)(n.td,{children:\"\\u5355 Token \\u88AB\\u76D7\\u540E\\uFF0C\\u96BE\\u4EE5\\u5FEB\\u901F\\u5931\\u6548\\uFF0C\\u653B\\u51FB\\u8005\\u53EF\\u957F\\u671F\\u5229\\u7528\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u6570\\u636E\\u6CC4\\u9732\\uFF0C\\u7CFB\\u7EDF\\u4FE1\\u4EFB\\u5D29\\u584C\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u6743\\u9650\\u7BA1\\u7406\\u590D\\u6742\"})}),(0,e.jsx)(n.td,{children:\"\\u5355 Token \\u96BE\\u4EE5\\u52A8\\u6001\\u8C03\\u6574\\u6743\\u9650\\uFF08\\u5982\\u4E34\\u65F6\\u63D0\\u5347\\u6743\\u9650\\u6216\\u964D\\u7EA7\\uFF09\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u6743\\u9650\\u7BA1\\u7406\\u50F5\\u5316\\uFF0C\\u7EF4\\u62A4\\u6210\\u672C\\u9AD8\\u3002\"})]})]})]}),`\n`,(0,e.jsx)(n.h3,{id:\"double-token-\\u7684\\u4F18\\u52BF\",children:(0,e.jsx)(n.a,{href:\"#double-token-\\u7684\\u4F18\\u52BF\",children:\"Double Token \\u7684\\u4F18\\u52BF\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Double Token \\u901A\\u8FC7\\u5F15\\u5165 Refresh Token\\uFF0C\\u89E3\\u51B3\\u4E86\\u4E0A\\u8FF0\\u95EE\\u9898\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5B89\\u5168\\u6027\\u63D0\\u5347\"}),\"\\uFF1AAccess Token \\u77ED\\u671F\\u6709\\u6548\\uFF08\\u901A\\u5E38 15 \\u5206\\u949F\\u5230 1 \\u5C0F\\u65F6\\uFF09\\uFF0C\\u5373\\u4F7F\\u88AB\\u76D7\\uFF0C\\u5F71\\u54CD\\u8303\\u56F4\\u6709\\u9650\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u7528\\u6237\\u4F53\\u9A8C\\u4F18\\u5316\"}),\"\\uFF1ARefresh Token \\u957F\\u671F\\u6709\\u6548\\uFF08\\u51E0\\u5929\\u5230\\u51E0\\u4E2A\\u6708\\uFF09\\uFF0C\\u7528\\u6237\\u65E0\\u9700\\u9891\\u7E41\\u767B\\u5F55\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u7075\\u6D3B\\u6027\\u589E\\u5F3A\"}),\"\\uFF1ARefresh Token \\u53EF\\u7528\\u4E8E\\u52A8\\u6001\\u7EED\\u671F\\u6216\\u64A4\\u9500\\uFF0C\\u6743\\u9650\\u7BA1\\u7406\\u66F4\\u7CBE\\u7EC6\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u9632\\u5FA1\\u80FD\\u529B\\u66F4\\u5F3A\"}),\"\\uFF1A\\u901A\\u8FC7\\u9ED1\\u540D\\u5355\\u3001IP \\u68C0\\u6D4B\\u7B49\\u673A\\u5236\\uFF0CRefresh Token \\u7684\\u6EE5\\u7528\\u53EF\\u88AB\\u5FEB\\u901F\\u8BC6\\u522B\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u9009\\u62E9 Token \\u6709\\u6548\\u671F\\u65F6\\uFF0C\\u9075\\u5FAA\\u201C\\u6700\\u5C0F\\u6743\\u9650\\u539F\\u5219\\u201D\\uFF1AAccess Token \\u5C3D\\u53EF\\u80FD\\u77ED\\uFF0CRefresh Token \\u6839\\u636E\\u4E1A\\u52A1\\u9700\\u6C42\\u8C28\\u614E\\u5EF6\\u957F\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"3-double-token-\\u7684\\u6838\\u5FC3\\u539F\\u7406\",children:(0,e.jsx)(n.a,{href:\"#3-double-token-\\u7684\\u6838\\u5FC3\\u539F\\u7406\",children:\"3. Double Token \\u7684\\u6838\\u5FC3\\u539F\\u7406\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Double Token \\u7684\\u6838\\u5FC3\\u5728\\u4E8E \",(0,e.jsx)(n.strong,{children:\"Access Token\"}),\" \\u548C \",(0,e.jsx)(n.strong,{children:\"Refresh Token\"}),\" \\u7684\\u5206\\u5DE5\\u4E0E\\u534F\\u4F5C\\u3002\\u8BA9\\u6211\\u4EEC\\u6DF1\\u5165\\u5256\\u6790\\u5B83\\u4EEC\\u7684\\u8FD0\\u4F5C\\u673A\\u5236\\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{id:\"31-access-token-vs-refresh-token\",children:(0,e.jsx)(n.a,{href:\"#31-access-token-vs-refresh-token\",children:\"3.1 Access Token vs. Refresh Token\"})}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:(0,e.jsx)(n.strong,{children:\"\\u7279\\u6027\"})}),(0,e.jsx)(n.th,{children:(0,e.jsx)(n.strong,{children:\"Access Token\"})}),(0,e.jsx)(n.th,{children:(0,e.jsx)(n.strong,{children:\"Refresh Token\"})})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u7528\\u9014\"})}),(0,e.jsx)(n.td,{children:\"\\u7528\\u4E8E\\u8BBF\\u95EE\\u53D7\\u4FDD\\u62A4\\u7684 API \\u8D44\\u6E90\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u7528\\u4E8E\\u5728 Access Token \\u8FC7\\u671F\\u65F6\\u83B7\\u53D6\\u65B0\\u7684 Access Token\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u6709\\u6548\\u671F\"})}),(0,e.jsx)(n.td,{children:\"\\u77ED\\uFF0815 \\u5206\\u949F ~ 1 \\u5C0F\\u65F6\\uFF09\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u957F\\uFF081 \\u5929 ~ \\u6570\\u6708\\uFF09\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u5B58\\u50A8\\u4F4D\\u7F6E\"})}),(0,e.jsx)(n.td,{children:\"\\u901A\\u5E38\\u5B58\\u50A8\\u5728\\u5185\\u5B58\\u6216 HttpOnly Cookie \\u4E2D\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u901A\\u5E38\\u5B58\\u50A8\\u5728 HttpOnly Cookie \\u6216\\u5B89\\u5168\\u6570\\u636E\\u5E93\\u4E2D\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u5B89\\u5168\\u6027\\u8981\\u6C42\"})}),(0,e.jsx)(n.td,{children:\"\\u9AD8\\uFF0C\\u9700\\u9632\\u6B62 XSS \\u653B\\u51FB\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u66F4\\u9AD8\\uFF0C\\u9700\\u9632\\u6B62 CSRF \\u548C\\u6570\\u636E\\u5E93\\u6CC4\\u9732\\u3002\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"\\u662F\\u5426\\u53EF\\u64A4\\u9500\"})}),(0,e.jsx)(n.td,{children:\"\\u901A\\u5E38\\u4E0D\\u53EF\\u64A4\\u9500\\uFF0C\\u4F9D\\u8D56\\u77ED\\u751F\\u547D\\u5468\\u671F\\u3002\"}),(0,e.jsx)(n.td,{children:\"\\u53EF\\u901A\\u8FC7\\u9ED1\\u540D\\u5355\\u6216\\u6570\\u636E\\u5E93\\u64A4\\u9500\\u3002\"})]})]})]}),`\n`,(0,e.jsx)(n.h3,{id:\"32-\\u5DE5\\u4F5C\\u6D41\\u7A0B\",children:(0,e.jsx)(n.a,{href:\"#32-\\u5DE5\\u4F5C\\u6D41\\u7A0B\",children:\"3.2 \\u5DE5\\u4F5C\\u6D41\\u7A0B\"})}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u7528\\u6237\\u767B\\u5F55\"}),\"\\uFF1A\\u7528\\u6237\\u63D0\\u4EA4\\u7528\\u6237\\u540D\\u548C\\u5BC6\\u7801\\uFF0C\\u540E\\u7AEF\\u9A8C\\u8BC1\\u901A\\u8FC7\\u540E\\u751F\\u6210 Access Token \\u548C Refresh Token\\uFF0C\\u8FD4\\u56DE\\u7ED9\\u524D\\u7AEF\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u8BBF\\u95EE\\u8D44\\u6E90\"}),\"\\uFF1A\\u524D\\u7AEF\\u5C06 Access Token \\u653E\\u5165 HTTP \\u8BF7\\u6C42\\u5934\\uFF08\",(0,e.jsx)(n.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{children:\"Authorization: Bearer <token>\"})})})}),\"\\uFF09\\uFF0C\\u8BBF\\u95EE\\u53D7\\u4FDD\\u62A4\\u7684 API\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Token \\u8FC7\\u671F\"}),\"\\uFF1A\\u5F53 Access Token \\u8FC7\\u671F\\uFF08\\u8FD4\\u56DE 401 \\u72B6\\u6001\\u7801\\uFF09\\uFF0C\\u524D\\u7AEF\\u4F7F\\u7528 Refresh Token \\u8BF7\\u6C42\\u65B0\\u7684 Access Token\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u7EED\\u671F\\u6210\\u529F\"}),\"\\uFF1A\\u540E\\u7AEF\\u9A8C\\u8BC1 Refresh Token \\u6709\\u6548\\u6027\\uFF0C\\u751F\\u6210\\u65B0\\u7684 Access Token\\uFF08\\u6709\\u65F6\\u4E5F\\u66F4\\u65B0 Refresh Token\\uFF09\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5F02\\u5E38\\u5904\\u7406\"}),\"\\uFF1A\\u82E5 Refresh Token \\u65E0\\u6548\\u6216\\u88AB\\u64A4\\u9500\\uFF0C\\u7528\\u6237\\u9700\\u91CD\\u65B0\\u767B\\u5F55\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.h3,{id:\"33-\\u52A0\\u5BC6\\u4E0E\\u5B58\\u50A8\",children:(0,e.jsx)(n.a,{href:\"#33-\\u52A0\\u5BC6\\u4E0E\\u5B58\\u50A8\",children:\"3.3 \\u52A0\\u5BC6\\u4E0E\\u5B58\\u50A8\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Access Token\"}),\"\\uFF1A\\u901A\\u5E38\\u662F JWT\\uFF0C\\u5305\\u542B\\u7528\\u6237 ID\\u3001\\u89D2\\u8272\\u3001\\u8FC7\\u671F\\u65F6\\u95F4\\u7B49\\u4FE1\\u606F\\uFF0C\\u901A\\u8FC7 HMAC \\u6216 RSA \\u7B7E\\u540D\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Refresh Token\"}),\"\\uFF1A\\u53EF\\u4EE5\\u662F JWT \\u6216\\u968F\\u673A\\u5B57\\u7B26\\u4E32\\uFF0C\\u5B58\\u50A8\\u5728\\u540E\\u7AEF\\u6570\\u636E\\u5E93\\uFF0C\\u9700\\u4E0E\\u7528\\u6237 ID \\u548C\\u8BBE\\u5907\\u4FE1\\u606F\\u7ED1\\u5B9A\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5B58\\u50A8\\u65B9\\u5F0F\"}),\"\\uFF1A\",`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u524D\\u7AEF\"}),\"\\uFF1AAccess Token \\u53EF\\u5B58\\u4E8E\\u5185\\u5B58\\uFF0CRefresh Token \\u63A8\\u8350\\u4F7F\\u7528 HttpOnly\\u3001Secure \\u7684 Cookie\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u540E\\u7AEF\"}),\"\\uFF1ARefresh Token \\u5B58\\u50A8\\u5728\\u6570\\u636E\\u5E93\\uFF08\\u5982 Redis\\uFF09\\uFF0C\\u652F\\u6301\\u5FEB\\u901F\\u67E5\\u8BE2\\u4E0E\\u64A4\\u9500\\u3002\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u6C38\\u8FDC\\u4E0D\\u8981\\u5C06 Token \\u5B58\\u50A8\\u5728 localStorage \\u4E2D\\uFF0CXSS \\u653B\\u51FB\\u4F1A\\u8BA9\\u4F60\\u7684\\u52AA\\u529B\\u5316\\u4E3A\\u4E4C\\u6709\\u3002\\u4F7F\\u7528 HttpOnly Cookie \\u662F\\u66F4\\u5B89\\u5168\\u7684\\u9009\\u62E9\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"4-\\u5B9E\\u73B0-double-token-\\u7684\\u6280\\u672F\\u7EC6\\u8282\",children:(0,e.jsx)(n.a,{href:\"#4-\\u5B9E\\u73B0-double-token-\\u7684\\u6280\\u672F\\u7EC6\\u8282\",children:\"4. \\u5B9E\\u73B0 Double Token \\u7684\\u6280\\u672F\\u7EC6\\u8282\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u8BA9\\u6211\\u4EEC\\u901A\\u8FC7\\u4E00\\u4E2A \",(0,e.jsx)(n.strong,{children:\"React + Node.js\"}),\" \\u7684\\u6848\\u4F8B\\uFF0C\\u5C55\\u793A Double Token \\u7684\\u5B8C\\u6574\\u5B9E\\u73B0\\u3002\\u4EE5\\u4E0B\\u4EE3\\u7801\\u5C06\\u6DB5\\u76D6\\u540E\\u7AEF\\u751F\\u6210 Token\\u3001\\u524D\\u7AEF\\u7BA1\\u7406 Token \\u7684\\u5168\\u6D41\\u7A0B\\u3002\"]}),`\n`,(0,e.jsx)(n.h3,{id:\"41-\\u540E\\u7AEF\\u8BBE\\u8BA1nodejs--express\",children:(0,e.jsx)(n.a,{href:\"#41-\\u540E\\u7AEF\\u8BBE\\u8BA1nodejs--express\",children:\"4.1 \\u540E\\u7AEF\\u8BBE\\u8BA1\\uFF08Node.js + Express\\uFF09\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u540E\\u7AEF\\u8D1F\\u8D23\\u751F\\u6210\\u548C\\u9A8C\\u8BC1 Token\\uFF0C\\u4F7F\\u7528 \",(0,e.jsx)(n.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{children:\"jsonwebtoken\"})})})}),\" \\u5E93\\u548C Redis \\u5B58\\u50A8 Refresh Token\\u3002\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{tabIndex:\"0\",\"data-language\":\"mdx\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"mdx\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const express = require('express');\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const jwt = require('jsonwebtoken');\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const redis = require('redis');\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const cookieParser = require('cookie-parser');\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const app = express();\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"app.use(express.json());\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"app.use(cookieParser());\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"// Redis \\u5BA2\\u6237\\u7AEF\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const redisClient = redis.createClient(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" url: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'redis://localhost:6379'\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" }\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"redisClient.connect();\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"// \\u5BC6\\u94A5\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const ACCESS_TOKEN_SECRET = 'your-access-token-secret';\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"const REFRESH_TOKEN_SECRET = 'your-refresh-token-secret';\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"// \\u767B\\u5F55\\u63A5\\u53E3\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"app.post('/login', async (req, res) => \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  const \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" username, password \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"}\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" = req.body;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  // \\u5047\\u8BBE\\u9A8C\\u8BC1\\u901A\\u8FC7\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  if (username === 'admin' && password === 'password') \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    const userId \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" 'user123'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u751F\\u6210 Access Token\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    const accessToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" jwt.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"sign\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ userId }, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"ACCESS_TOKEN_SECRET\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", { expiresIn: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'15m'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u751F\\u6210 Refresh Token\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    const refreshToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" jwt.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"sign\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ userId }, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"REFRESH_TOKEN_SECRET\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", { expiresIn: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'7d'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u5B58\\u50A8 Refresh Token \\u5230 Redis\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    await\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" redisClient.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"set\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"`refresh:${\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"userId\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", refreshToken, { EX: \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 24\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 60\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 60\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u8BBE\\u7F6E HttpOnly Cookie\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"cookie\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'refreshToken'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", refreshToken, { httpOnly: \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", secure: \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", sameSite: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'strict'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ accessToken });\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  } else \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"401\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ message: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid credentials'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"// \\u5237\\u65B0 Token \\u63A5\\u53E3\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"app.post('/refresh', async (req, res) => \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  const refreshToken = req.cookies.refreshToken;\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  if (!refreshToken) return res.status(401).json(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" message: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'No refresh token'\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" }\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  try \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u9A8C\\u8BC1 Refresh Token\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    const payload \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" jwt.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"verify\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(refreshToken, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"REFRESH_TOKEN_SECRET\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    const storedToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" redisClient.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"`refresh:${\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"payload\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"userId\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"    if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (storedToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"!==\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" refreshToken) {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      return res.status(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"403\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").json({ \"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"message\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid refresh token'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u751F\\u6210\\u65B0\\u7684 Access Token\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    const newAccessToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" jwt.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"sign\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ userId: payload.userId }, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"ACCESS_TOKEN_SECRET\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", { expiresIn: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'15m'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ accessToken: newAccessToken });\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  } catch (err) \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"403\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ message: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid refresh token'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"// \\u53D7\\u4FDD\\u62A4\\u7684\\u63A5\\u53E3\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"app.get('/protected', (req, res) => \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  const authHeader = req.headers\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"[\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"'authorization'\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"]\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  const token = authHeader && authHeader.split(' ')\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"[\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"]\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  if (!token) return res.status(401).json(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" message: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'No token provided'\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" }\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  jwt.verify(token, ACCESS_TOKEN_SECRET, (err, payload) => \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"{\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"    if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (err) return res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"403\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ message: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid token'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({ message: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Access granted'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", userId: payload.userId });\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"app.listen(3000, () => console.log('Server running on port 3000'));\"})})]})})}),`\n`,(0,e.jsx)(n.h3,{id:\"42-\\u524D\\u7AEF\\u96C6\\u6210react--axios\",children:(0,e.jsx)(n.a,{href:\"#42-\\u524D\\u7AEF\\u96C6\\u6210react--axios\",children:\"4.2 \\u524D\\u7AEF\\u96C6\\u6210\\uFF08React + Axios\\uFF09\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u524D\\u7AEF\\u4F7F\\u7528 Axios \\u62E6\\u622A\\u5668\\u81EA\\u52A8\\u5904\\u7406 Token \\u8FC7\\u671F\\u4E0E\\u5237\\u65B0\\u3002\"}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" axios \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" 'axios'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" api\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" axios.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"create\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  baseURL: \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'http://localhost:3000'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  withCredentials: \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"// \\u5141\\u8BB8\\u53D1\\u9001 Cookie\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"// \\u5B58\\u50A8 Access Token\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" accessToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" null\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" const\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" setAccessToken\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"token\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  accessToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" token;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"// \\u8BF7\\u6C42\\u62E6\\u622A\\u5668\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"api.interceptors.request.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"use\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  (\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"config\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (accessToken) {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      config.headers[\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Authorization'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" `Bearer ${\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"accessToken\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" config;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  (\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"error\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"reject\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(error)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"// \\u54CD\\u5E94\\u62E6\\u622A\\u5668\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"api.interceptors.response.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"use\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  (\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"response\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" response,\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  async\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"error\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" originalRequest\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" error.config;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    // \\u5904\\u7406 401 \\u9519\\u8BEF\\uFF08Access Token \\u8FC7\\u671F\\uFF09\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (error.response.status \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"===\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 401\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" &&\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" !\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"originalRequest._retry) {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      originalRequest._retry \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" true\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"      try\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        // \\u8BF7\\u6C42\\u5237\\u65B0 Token\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        const\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"data\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" api.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"post\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'/refresh'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        accessToken \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" data.accessToken;\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        setAccessToken\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(accessToken);\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        // \\u91CD\\u8BD5\\u539F\\u59CB\\u8BF7\\u6C42\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        originalRequest.headers[\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Authorization'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" `Bearer ${\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"accessToken\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" api\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(originalRequest);\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (refreshError) {\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        // \\u5237\\u65B0\\u5931\\u8D25\\uFF0C\\u8DF3\\u8F6C\\u767B\\u5F55\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        window.location.href \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" '/login'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"reject\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(refreshError);\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"reject\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(error);\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"// \\u767B\\u5F55\\u65B9\\u6CD5\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" const\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" login\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"username\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"password\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"data\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" api.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"post\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'/login'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", { username, password });\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"  setAccessToken\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(data.accessToken);\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" data;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"// \\u8C03\\u7528\\u53D7\\u4FDD\\u62A4\\u63A5\\u53E3\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" const\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" fetchProtectedData\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"data\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" api.\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'/protected'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" data;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,e.jsx)(n.h3,{id:\"43-react-\\u7EC4\\u4EF6\\u793A\\u4F8B\",children:(0,e.jsx)(n.a,{href:\"#43-react-\\u7EC4\\u4EF6\\u793A\\u4F8B\",children:\"4.3 React \\u7EC4\\u4EF6\\u793A\\u4F8B\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4EE5\\u4E0B\\u662F\\u767B\\u5F55\\u9875\\u9762\\u548C\\u53D7\\u4FDD\\u62A4\\u8D44\\u6E90\\u7684\\u7B80\\u5355\\u5B9E\\u73B0\\u3002\"}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{tabIndex:\"0\",\"data-language\":\"jsx\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"jsx\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" React, { useState } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" 'react'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" { login, fetchProtectedData } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" './auth'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" Login\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"username\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"setUsername\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" useState\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"''\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"password\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"setPassword\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" useState\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"''\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"message\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"setMessage\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" useState\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"''\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" handleLogin\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    try\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"      await\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" login\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(username, password);\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"      setMessage\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Login successful!'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (err) {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"      setMessage\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Login failed.'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" handleFetchData\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    try\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"      const\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" data\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" fetchProtectedData\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"      setMessage\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(data.message);\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    } \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (err) {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"      setMessage\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'Failed to fetch data.'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"div\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" className\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"p-4\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"h1\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" className\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"text-2xl\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">Login</\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"h1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"input\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        type\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"text\"'})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        value\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"{username}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        onChange\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"{(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"e\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" setUsername\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(e.target.value)}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        placeholder\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"Username\"'})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        className\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"border p-2 m-2\"'})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      />\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"input\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        type\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"password\"'})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        value\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"{password}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        onChange\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"{(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"e\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" setPassword\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(e.target.value)}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        placeholder\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"Password\"'})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"        className\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"border p-2 m-2\"'})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      />\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" onClick\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"{handleLogin} \"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"className\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"bg-blue-500 text-white p-2 m-2\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        Login\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      </\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" onClick\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"{handleFetchData} \"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"className\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"bg-green-500 text-white p-2 m-2\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        Fetch Protected Data\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      </\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"p\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">{message}</\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"p\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    </\"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"div\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"  );\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Login;\"})]})]})})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u524D\\u7AEF\\u5B9E\\u73B0\\u4E2D\\uFF0C\\u59CB\\u7EC8\\u4E3A Axios \\u62E6\\u622A\\u5668\\u8BBE\\u7F6E\\u91CD\\u8BD5\\u6807\\u5FD7\\uFF08_retry\\uFF09\\uFF0C\\u907F\\u514D\\u65E0\\u9650\\u5FAA\\u73AF\\u5237\\u65B0 Token\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"5-\\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\",children:(0,e.jsx)(n.a,{href:\"#5-\\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\",children:\"5. \\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4EE5\\u4E0B\\u662F\\u5B9E\\u73B0 Double Token \\u65F6\\u7684\\u4E00\\u4E9B\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF0C\\u52A9\\u4F60\\u6253\\u9020\\u66F4\\u5B89\\u5168\\u3001\\u66F4\\u5065\\u58EE\\u7684\\u7CFB\\u7EDF\\u3002\"}),`\n`,(0,e.jsx)(n.h3,{id:\"51-\\u5B89\\u5168\\u5B58\\u50A8\",children:(0,e.jsx)(n.a,{href:\"#51-\\u5B89\\u5168\\u5B58\\u50A8\",children:\"5.1 \\u5B89\\u5168\\u5B58\\u50A8\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u524D\\u7AEF\"}),\"\\uFF1A\\u5C06 Access Token \\u5B58\\u50A8\\u5728\\u5185\\u5B58\\u4E2D\\uFF0CRefresh Token \\u4F7F\\u7528 HttpOnly\\u3001Secure\\u3001SameSite=strict \\u7684 Cookie\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u540E\\u7AEF\"}),\"\\uFF1ARefresh Token \\u5B58\\u50A8\\u5728 Redis \\u6216\\u6570\\u636E\\u5E93\\uFF0C\\u8BBE\\u7F6E\\u8FC7\\u671F\\u65F6\\u95F4\\uFF0C\\u5E76\\u4E0E\\u7528\\u6237 ID\\u3001\\u8BBE\\u5907\\u4FE1\\u606F\\u7ED1\\u5B9A\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u9632\\u5FA1 XSS\"}),\"\\uFF1A\\u4F7F\\u7528 CSP\\uFF08Content Security Policy\\uFF09\\u9650\\u5236\\u811A\\u672C\\u6267\\u884C\\uFF0C\\u9632\\u6B62 Token \\u88AB\\u7A83\\u53D6\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5B9A\\u671F\\u5BA1\\u67E5 Cookie \\u7684\\u5B89\\u5168\\u914D\\u7F6E\\uFF0C\\u786E\\u4FDD SameSite \\u548C Secure \\u5C5E\\u6027\\u672A\\u88AB\\u9057\\u6F0F\\u3002\"})})}),`\n`,(0,e.jsx)(n.h3,{id:\"52-token-\\u5931\\u6548\\u5904\\u7406\",children:(0,e.jsx)(n.a,{href:\"#52-token-\\u5931\\u6548\\u5904\\u7406\",children:\"5.2 Token \\u5931\\u6548\\u5904\\u7406\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u9ED1\\u540D\\u5355\\u673A\\u5236\"}),\"\\uFF1A\\u5C06\\u5931\\u6548\\u7684 Refresh Token \\u52A0\\u5165\\u9ED1\\u540D\\u5355\\uFF0C\\u9632\\u6B62\\u88AB\\u6EE5\\u7528\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u52A8\\u6001\\u64A4\\u9500\"}),\"\\uFF1A\\u652F\\u6301\\u7528\\u6237\\u624B\\u52A8\\u6CE8\\u9500\\u6216\\u5728\\u5F02\\u5E38\\u767B\\u5F55\\u65F6\\u64A4\\u9500\\u6240\\u6709 Token\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u9519\\u8BEF\\u63D0\\u793A\"}),\"\\uFF1A\\u5F53 Token \\u5931\\u6548\\u65F6\\uFF0C\\u8FD4\\u56DE\\u6E05\\u6670\\u7684\\u9519\\u8BEF\\u7801\\u548C\\u63D0\\u793A\\uFF0C\\u5F15\\u5BFC\\u7528\\u6237\\u91CD\\u65B0\\u767B\\u5F55\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u540E\\u7AEF\\u8BBE\\u8BA1\\u9ED1\\u540D\\u5355\\u65F6\\uFF0C\\u4F7F\\u7528 Redis \\u7684 SET \\u6570\\u636E\\u7ED3\\u6784\\uFF0C\\u67E5\\u8BE2\\u6548\\u7387\\u66F4\\u9AD8\\u3002\"})})}),`\n`,(0,e.jsx)(n.h3,{id:\"53-\\u9519\\u8BEF\\u91CD\\u8BD5\\u673A\\u5236\",children:(0,e.jsx)(n.a,{href:\"#53-\\u9519\\u8BEF\\u91CD\\u8BD5\\u673A\\u5236\",children:\"5.3 \\u9519\\u8BEF\\u91CD\\u8BD5\\u673A\\u5236\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u6307\\u6570\\u9000\\u907F\"}),\"\\uFF1A\\u5728\\u5237\\u65B0 Token \\u5931\\u8D25\\u65F6\\uFF0C\\u4F7F\\u7528\\u6307\\u6570\\u9000\\u907F\\u7B97\\u6CD5\\u91CD\\u8BD5\\uFF0C\\u907F\\u514D\\u670D\\u52A1\\u5668\\u8FC7\\u8F7D\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u7528\\u6237\\u4F53\\u9A8C\"}),\"\\uFF1A\\u5728\\u91CD\\u8BD5\\u671F\\u95F4\\u663E\\u793A\\u52A0\\u8F7D\\u72B6\\u6001\\uFF0C\\u907F\\u514D\\u7528\\u6237\\u91CD\\u590D\\u64CD\\u4F5C\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u4E3A\\u91CD\\u8BD5\\u673A\\u5236\\u8BBE\\u7F6E\\u6700\\u5927\\u5C1D\\u8BD5\\u6B21\\u6570\\uFF08\\u5982 3 \\u6B21\\uFF09\\uFF0C\\u9632\\u6B62\\u65E0\\u9650\\u8BF7\\u6C42\\u3002\"})})}),`\n`,(0,e.jsx)(n.h3,{id:\"54-\\u65E5\\u5FD7\\u4E0E\\u76D1\\u63A7\",children:(0,e.jsx)(n.a,{href:\"#54-\\u65E5\\u5FD7\\u4E0E\\u76D1\\u63A7\",children:\"5.4 \\u65E5\\u5FD7\\u4E0E\\u76D1\\u63A7\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u8BB0\\u5F55\\u5F02\\u5E38\"}),\"\\uFF1A\\u8BB0\\u5F55 Token \\u5237\\u65B0\\u5931\\u8D25\\u3001\\u9A8C\\u8BC1\\u5931\\u8D25\\u7684\\u65E5\\u5FD7\\uFF0C\\u4FBF\\u4E8E\\u6392\\u67E5\\u95EE\\u9898\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u76D1\\u63A7\\u6307\\u6807\"}),\"\\uFF1A\\u76D1\\u63A7 Token \\u5237\\u65B0\\u9891\\u7387\\u3001401 \\u9519\\u8BEF\\u7387\\uFF0C\\u53D1\\u73B0\\u6F5C\\u5728\\u653B\\u51FB\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u4F7F\\u7528 Sentry \\u6216\\u81EA\\u5EFA\\u65E5\\u5FD7\\u7CFB\\u7EDF\\uFF0C\\u5B9E\\u65F6\\u6355\\u83B7 Token \\u76F8\\u5173\\u7684\\u5F02\\u5E38\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"6-\\u9AD8\\u7EA7\\u8BDD\\u9898\\u4E0E\\u6269\\u5C55\",children:(0,e.jsx)(n.a,{href:\"#6-\\u9AD8\\u7EA7\\u8BDD\\u9898\\u4E0E\\u6269\\u5C55\",children:\"6. \\u9AD8\\u7EA7\\u8BDD\\u9898\\u4E0E\\u6269\\u5C55\"})}),`\n`,(0,e.jsx)(n.h3,{id:\"61-\\u8DE8\\u57DF\\u573A\\u666F\",children:(0,e.jsx)(n.a,{href:\"#61-\\u8DE8\\u57DF\\u573A\\u666F\",children:\"6.1 \\u8DE8\\u57DF\\u573A\\u666F\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5728\\u8DE8\\u57DF\\u573A\\u666F\\u4E0B\\uFF0CDouble Token \\u7684\\u5B9E\\u73B0\\u9700\\u8981\\u989D\\u5916\\u6CE8\\u610F\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"CORS \\u914D\\u7F6E\"}),\"\\uFF1A\\u786E\\u4FDD\\u540E\\u7AEF\\u6B63\\u786E\\u8BBE\\u7F6E \",(0,e.jsx)(n.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{children:\"Access-Control-Allow-Credentials\"})})})}),\" \\u548C \",(0,e.jsx)(n.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{children:\"Access-Control-Allow-Origin\"})})})}),\"\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Cookie \\u8DE8\\u57DF\"}),\"\\uFF1ARefresh Token \\u7684 Cookie \\u9700\\u8BBE\\u7F6E \",(0,e.jsx)(n.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{children:\"SameSite=none\"})})})}),\" \\u548C \",(0,e.jsx)(n.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{children:\"Secure\"})})})}),\"\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u9632\\u5FA1 CSRF\"}),\"\\uFF1A\\u4F7F\\u7528 CSRF Token \\u6216\\u9A8C\\u8BC1 Origin \\u5934\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u8DE8\\u57DF\\u573A\\u666F\\u4E2D\\uFF0C\\u4F18\\u5148\\u4F7F\\u7528 POST \\u8BF7\\u6C42\\u5237\\u65B0 Token\\uFF0C\\u964D\\u4F4E CSRF \\u98CE\\u9669\\u3002\"})})}),`\n`,(0,e.jsx)(n.h3,{id:\"62-oauth-20-\\u96C6\\u6210\",children:(0,e.jsx)(n.a,{href:\"#62-oauth-20-\\u96C6\\u6210\",children:\"6.2 OAuth 2.0 \\u96C6\\u6210\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Double Token \\u5E38\\u4E0E OAuth 2.0 \\u7ED3\\u5408\\u4F7F\\u7528\\uFF0C\\u7279\\u522B\\u662F\\u5728\\u7B2C\\u4E09\\u65B9\\u767B\\u5F55\\u573A\\u666F\\u4E2D\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Access Token\"}),\"\\uFF1A\\u7531 OAuth \\u63D0\\u4F9B\\u5546\\u9881\\u53D1\\uFF0C\\u7528\\u4E8E\\u8BBF\\u95EE\\u7528\\u6237\\u8D44\\u6E90\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Refresh Token\"}),\"\\uFF1A\\u7528\\u4E8E\\u83B7\\u53D6\\u65B0\\u7684 Access Token\\uFF0C\\u9700\\u59A5\\u5584\\u5B58\\u50A8\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u524D\\u7AEF\\u5904\\u7406\"}),\"\\uFF1A\\u5728\\u524D\\u7AEF\\u5B9E\\u73B0 OAuth \\u56DE\\u8C03\\uFF0C\\u89E3\\u6790\\u5E76\\u5B58\\u50A8 Token\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u4F7F\\u7528 OAuth \\u65F6\\uFF0C\\u4F18\\u5148\\u9009\\u62E9 PKCE \\u6D41\\u7A0B\\uFF0C\\u589E\\u5F3A\\u79FB\\u52A8\\u7AEF\\u5B89\\u5168\\u6027\\u3002\"})})}),`\n`,(0,e.jsx)(n.h3,{id:\"63-\\u5FAE\\u670D\\u52A1\\u4E0B\\u7684-token-\\u7BA1\\u7406\",children:(0,e.jsx)(n.a,{href:\"#63-\\u5FAE\\u670D\\u52A1\\u4E0B\\u7684-token-\\u7BA1\\u7406\",children:\"6.3 \\u5FAE\\u670D\\u52A1\\u4E0B\\u7684 Token \\u7BA1\\u7406\"})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5728\\u5FAE\\u670D\\u52A1\\u67B6\\u6784\\u4E2D\\uFF0CToken \\u9A8C\\u8BC1\\u9700\\u5206\\u5E03\\u5F0F\\u5904\\u7406\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u7F51\\u5173\\u9A8C\\u8BC1\"}),\"\\uFF1A\\u5728 API \\u7F51\\u5173\\uFF08\\u5982 Kong\\uFF09\\u9A8C\\u8BC1 Access Token\\uFF0C\\u51CF\\u5C11\\u670D\\u52A1\\u95F4\\u8026\\u5408\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5171\\u4EAB\\u5BC6\\u94A5\"}),\"\\uFF1A\\u4F7F\\u7528\\u7EDF\\u4E00\\u7684\\u5BC6\\u94A5\\u7BA1\\u7406\\u670D\\u52A1\\uFF08\\u5982 Vault\\uFF09\\u5206\\u53D1 JWT \\u7B7E\\u540D\\u5BC6\\u94A5\\u3002\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Refresh Token \\u540C\\u6B65\"}),\"\\uFF1A\\u901A\\u8FC7\\u6D88\\u606F\\u961F\\u5217\\uFF08\\u5982 Kafka\\uFF09\\u540C\\u6B65 Refresh Token \\u7684\\u72B6\\u6001\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u5FAE\\u670D\\u52A1\\u4E2D\\uFF0C\\u4F7F\\u7528\\u77ED\\u751F\\u547D\\u5468\\u671F\\u7684 Access Token\\uFF0C\\u964D\\u4F4E\\u7F51\\u5173\\u9A8C\\u8BC1\\u7684\\u6027\\u80FD\\u5F00\\u9500\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"7-\\u54F2\\u5B66\\u601D\\u8003\\u4FE1\\u4EFB\\u4E0E\\u6280\\u672F\\u7684\\u5E73\\u8861\",children:(0,e.jsx)(n.a,{href:\"#7-\\u54F2\\u5B66\\u601D\\u8003\\u4FE1\\u4EFB\\u4E0E\\u6280\\u672F\\u7684\\u5E73\\u8861\",children:\"7. \\u54F2\\u5B66\\u601D\\u8003\\uFF1A\\u4FE1\\u4EFB\\u4E0E\\u6280\\u672F\\u7684\\u5E73\\u8861\"})}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u201C\\u6280\\u672F\\u662F\\u4FE1\\u4EFB\\u7684\\u5EF6\\u4F38\\uFF0C\\u4F46\\u4FE1\\u4EFB\\u6C38\\u8FDC\\u9700\\u8981\\u9A8C\\u8BC1\\u3002\\u201D \\u2014\\u2014 \\u6653\\u9F99\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Double Token \\u7684\\u8BBE\\u8BA1\\u4E0D\\u4EC5\\u4EC5\\u662F\\u6280\\u672F\\u7684\\u5806\\u780C\\uFF0C\\u5B83\\u80CC\\u540E\\u662F\\u5BF9\\u4FE1\\u4EFB\\u7684\\u6DF1\\u523B\\u601D\\u8003\\u3002\\u5728 Web \\u4E16\\u754C\\u4E2D\\uFF0C\\u7528\\u6237\\u4FE1\\u4EFB\\u6211\\u4EEC\\u4FDD\\u62A4\\u4ED6\\u4EEC\\u7684\\u6570\\u636E\\uFF0C\\u5F00\\u53D1\\u8005\\u4FE1\\u4EFB\\u7CFB\\u7EDF\\u63D0\\u4F9B\\u7A33\\u5B9A\\u7684\\u4F53\\u9A8C\\uFF0C\\u800C\\u7CFB\\u7EDF\\u672C\\u8EAB\\u5219\\u4F9D\\u8D56\\u7B97\\u6CD5\\u548C\\u534F\\u8BAE\\u6765\\u9A8C\\u8BC1\\u6BCF\\u4E00\\u65B9\\u3002\\u{1F50D}\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u4F5C\\u4E3A\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\uFF0C\\u6211\\u4EEC\\u7684\\u4EE3\\u7801\\u4E0D\\u4EC5\\u662F\\u529F\\u80FD\\u7684\\u5B9E\\u73B0\\uFF0C\\u66F4\\u662F\\u4FE1\\u4EFB\\u7684\\u4F20\\u9012\\u3002\\u6BCF\\u4E00\\u884C\\u4EE3\\u7801\\u90FD\\u5728\\u56DE\\u7B54\\u4E00\\u4E2A\\u95EE\\u9898\\uFF1A\",(0,e.jsx)(n.strong,{children:\"\\u6211\\u4EEC\\u5982\\u4F55\\u5728\\u5F00\\u653E\\u7684\\u4E92\\u8054\\u7F51\\u4E2D\\u5EFA\\u7ACB\\u5B89\\u5168\\u7684\\u5821\\u5792\\uFF1F\"}),\" Double Token \\u662F\\u4E00\\u4E2A\\u7B54\\u6848\\uFF0C\\u4F46\\u5B83\\u4E5F\\u63D0\\u9192\\u6211\\u4EEC\\uFF0C\\u5B89\\u5168\\u4ECE\\u6765\\u4E0D\\u662F\\u7EC8\\u70B9\\uFF0C\\u800C\\u662F\\u4E00\\u573A\\u6C38\\u65E0\\u6B62\\u5883\\u7684\\u65C5\\u7A0B\\u3002\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4ECE\\u54F2\\u5B66\\u89D2\\u5EA6\\u770B\\uFF0CDouble Token \\u7684\\u77ED\\u671F\\u4E0E\\u957F\\u671F Token \\u5C31\\u50CF\\u4EBA\\u751F\\u7684\\u77ED\\u671F\\u76EE\\u6807\\u4E0E\\u957F\\u671F\\u613F\\u666F\\uFF1A\\u77ED\\u671F\\u7684\\u52AA\\u529B\\u4E3A\\u6211\\u4EEC\\u8D62\\u5F97\\u773C\\u524D\\u7684\\u6210\\u679C\\uFF0C\\u800C\\u957F\\u671F\\u7684\\u575A\\u6301\\u8BA9\\u6211\\u4EEC\\u8D70\\u5411\\u66F4\\u8FDC\\u7684\\u672A\\u6765\\u3002\\u{1F31F} \\u5728\\u524D\\u7AEF\\u5F00\\u53D1\\u4E2D\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u8FD9\\u79CD\\u53CC\\u91CD\\u601D\\u7EF4\\uFF1A\\u65E2\\u8981\\u5173\\u6CE8\\u7EC6\\u8282\\u7684\\u4E25\\u8C28\\uFF0C\\u4E5F\\u8981\\u653E\\u773C\\u7CFB\\u7EDF\\u7684\\u5168\\u5C40\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:(0,e.jsx)(n.em,{children:\"Tips: \\u5728\\u5F00\\u53D1\\u4E2D\\uFF0C\\u5B9A\\u671F\\u53CD\\u601D\\u4F60\\u7684\\u4EE3\\u7801\\u662F\\u5426\\u5728\\u201C\\u4FE1\\u4EFB\\u201D\\u4E0E\\u201C\\u6548\\u7387\\u201D\\u4E4B\\u95F4\\u627E\\u5230\\u5E73\\u8861\\uFF0C\\u8FD9\\u662F\\u6210\\u4E3A\\u4F18\\u79C0\\u5F00\\u53D1\\u8005\\u7684\\u5173\\u952E\\u3002\"})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{id:\"8-\\u603B\\u7ED3\\u4E0E\\u5C55\\u671B\",children:(0,e.jsx)(n.a,{href:\"#8-\\u603B\\u7ED3\\u4E0E\\u5C55\\u671B\",children:\"8. \\u603B\\u7ED3\\u4E0E\\u5C55\\u671B\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Double Token \\u662F\\u4E00\\u79CD\\u4F18\\u96C5\\u800C\\u5B9E\\u7528\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u673A\\u5236\\uFF0C\\u5B83\\u901A\\u8FC7 Access Token \\u548C Refresh Token \\u7684\\u534F\\u4F5C\\uFF0C\\u5E73\\u8861\\u4E86\\u5B89\\u5168\\u6027\\u4E0E\\u7528\\u6237\\u4F53\\u9A8C\\u3002\\u4F5C\\u4E3A\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\uFF0C\\u638C\\u63E1 Double Token \\u7684\\u539F\\u7406\\u4E0E\\u5B9E\\u8DF5\\uFF0C\\u4E0D\\u4EC5\\u80FD\\u63D0\\u5347\\u4F60\\u7684\\u6280\\u672F\\u80FD\\u529B\\uFF0C\\u8FD8\\u80FD\\u8BA9\\u4F60\\u5728\\u5B89\\u5168\\u9886\\u57DF\\u66F4\\u5177\\u6D1E\\u5BDF\\u529B\\u3002\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u672A\\u6765\\uFF0C\\u968F\\u7740 Web3\\u3001\\u96F6\\u4FE1\\u4EFB\\u67B6\\u6784\\u548C\\u91CF\\u5B50\\u8BA1\\u7B97\\u7684\\u53D1\\u5C55\\uFF0C\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u673A\\u5236\\u5C06\\u8FCE\\u6765\\u65B0\\u7684\\u6311\\u6218\\u3002Double Token \\u6216\\u8BB8\\u4F1A\\u6F14\\u53D8\\u4E3A\\u66F4\\u590D\\u6742\\u7684\\u591A Token \\u4F53\\u7CFB\\uFF0C\\u6216\\u4E0E\\u751F\\u7269\\u8BC6\\u522B\\u3001\\u533A\\u5757\\u94FE\\u6280\\u672F\\u7ED3\\u5408\\u3002\\u65E0\\u8BBA\\u5982\\u4F55\\uFF0C\\u4FE1\\u4EFB\\u4E0E\\u9A8C\\u8BC1\\u7684\\u672C\\u8D28\\u4E0D\\u4F1A\\u6539\\u53D8\\uFF0C\\u800C\\u6211\\u4EEC\\u4F5C\\u4E3A\\u5F00\\u53D1\\u8005\\u7684\\u4F7F\\u547D\\uFF0C\\u59CB\\u7EC8\\u662F\\u4E3A\\u7528\\u6237\\u6784\\u5EFA\\u66F4\\u5B89\\u5168\\u3001\\u66F4\\u4FBF\\u6377\\u7684\\u6570\\u5B57\\u4E16\\u754C\\u3002\\u{1F30D}\"}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u201C\\u4EE3\\u7801\\u662F\\u8BD7\\uFF0C\\u5B89\\u5168\\u662F\\u97F5\\u3002\\u201D \\u2014\\u2014 \\u8BA9\\u6211\\u4EEC\\u7528\\u4F18\\u96C5\\u7684\\u4EE3\\u7801\\uFF0C\\u4E66\\u5199\\u5B89\\u5168\\u7684\\u672A\\u6765\\uFF01\"}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u53C2\\u8003\\u8D44\\u6599\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://jwt.io/\",children:\"JWT \\u5B98\\u65B9\\u6587\\u6863\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://oauth.net/2/\",children:\"OAuth 2.0 \\u89C4\\u8303\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://owasp.org/\",children:\"OWASP \\u5B89\\u5168\\u6307\\u5357\"})}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5E0C\\u671B\\u8FD9\\u7BC7\\u535A\\u5BA2\\u80FD\\u4E3A\\u4F60\\u5E26\\u6765\\u542F\\u53D1\\uFF01\\u5982\\u679C\\u6709\\u4EFB\\u4F55\\u95EE\\u9898\\u6216\\u5EFA\\u8BAE\\uFF0C\\u6B22\\u8FCE\\u5728\\u8BC4\\u8BBA\\u533A\\u4EA4\\u6D41\\u3002\\u{1F604}\"}),`\n`,(0,e.jsx)(n.hr,{})]})}function h(l={}){let{wrapper:n}=l.components||{};return n?(0,e.jsx)(n,{...l,children:(0,e.jsx)(t,{...l})}):t(l)}return B(C);})();\n;return Component;"
  },
  "_id": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/å‰ç«¯åŒé‡èº«ä»½éªŒè¯çš„å®ç°ä¸æ€è·¯.mdx",
  "_raw": {
    "sourceFilePath": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/å‰ç«¯åŒé‡èº«ä»½éªŒè¯çš„å®ç°ä¸æ€è·¯.mdx",
    "sourceFileName": "å‰ç«¯åŒé‡èº«ä»½éªŒè¯çš„å®ç°ä¸æ€è·¯.mdx",
    "sourceFileDir": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨",
    "contentType": "mdx",
    "flattenedPath": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/å‰ç«¯åŒé‡èº«ä»½éªŒè¯çš„å®ç°ä¸æ€è·¯"
  },
  "type": "Post",
  "url": "/blog/å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/å‰ç«¯åŒé‡èº«ä»½éªŒè¯çš„å®ç°ä¸æ€è·¯"
}