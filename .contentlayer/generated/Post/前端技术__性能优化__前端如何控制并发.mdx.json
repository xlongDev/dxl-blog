{
  "title": "前端如何控制并发?",
  "date": "2024-02-26T00:00:00.000Z",
  "description": "深入探讨前端并发控制的多种方法与实践场景，涵盖 Promise、异步队列、Worker 等技术，结合实例解析如何优化性能与用户体验。",
  "keywords": "前端并发, Promise, 异步队列, Web Worker, 并发控制, JavaScript, 性能优化",
  "author": "晓龙",
  "image": "/images/hero/concurrency-control.jpg",
  "tags": [
    "JavaScript",
    "前端开发",
    "性能优化"
  ],
  "views": 0,
  "likes": 0,
  "category": "前端技术",
  "body": {
    "raw": "\n在现代前端开发中，随着应用的复杂度增加，前端需要处理的请求和任务越来越多。比如批量上传图片、调用多个 API 接口、处理大数据计算等场景，都可能涉及并发问题。如果不加以控制，无限制的并发可能会导致浏览器资源耗尽、性能下降，甚至服务器过载。那么，前端如何优雅地控制并发呢？这篇文章将带你从基础到进阶，全面解析前端并发控制的各种方法，并结合实例探讨它们的适用场景。\n\n## 什么是并发控制?\n\n并发控制，简单来说，就是在同一时间段内限制同时执行的任务数量。比如你需要发送 100 个网络请求，但浏览器或服务器的承载能力有限，你可能希望一次只发送 5 个，等这 5 个完成后，再处理下一批。这样的策略不仅能避免资源过度占用，还能提升应用的稳定性和用户体验。\n\n在前端，常见的并发场景包括：\n- **网络请求**：批量获取数据或上传文件。\n- **计算任务**：处理大量数据或复杂的 DOM 操作。\n- **用户交互**：响应多个用户操作但需要有序处理。\n\n接下来，我们将从基础方法入手，逐步深入探讨前端并发控制的实现方式。\n\n## 方法一：使用 Promise 手动控制\n\n`Promise` 是 JavaScript 异步编程的基石，通过它我们可以手动控制并发。最简单的方式是借助 `Promise.all`，但它无法限制并发数量，所有任务会同时执行。如果需要限制并发，我们可以自己封装一个工具函数。\n\n### 实例：限制并发的网络请求\n\n假设我们有 10 个 API 请求任务，但希望最多同时执行 3 个：\n\n```javascript\nconst tasks = Array.from({ length: 10 }, (_, i) => () =>\n  fetch(`https://api.example.com/data/${i}`).then(res => res.json())\n);\n\nasync function limitConcurrency(tasks, limit) {\n  const results = [];\n  const executing = new Set();\n\n  for (const task of tasks) {\n    const promise = task().then(result => {\n      executing.delete(promise);\n      return result;\n    });\n    executing.add(promise);\n    results.push(promise);\n\n    if (executing.size >= limit) {\n      await Promise.race(executing);\n    }\n  }\n\n  return Promise.all(results);\n}\n\n// 使用\nlimitConcurrency(tasks, 3).then(results => {\n  console.log(\"所有任务完成：\", results);\n});\n```\n\n**解析**：\n- `limitConcurrency` 函数接收任务数组和并发限制数 `limit`。\n- 用 `Set` 追踪当前执行中的任务，当达到限制时，通过 `Promise.race` 等待任意一个任务完成后再继续。\n- 这种方法简单直观，适合中小规模的并发控制。\n\n**适用场景**：批量请求数据、文件上传等。\n\n## 方法二：异步队列\n\n手动控制 Promise 虽然灵活，但代码复杂度较高。对于更结构化的并发管理，可以使用异步队列。队列的核心思想是按顺序处理任务，并限制并发的数量。\n\n### 实例：图片批量上传队列\n\n假设我们要上传 20 张图片，但希望限制为 2 个并发：\n\n```javascript\nclass AsyncQueue {\n  constructor(limit) {\n    this.limit = limit;\n    this.running = 0;\n    this.queue = [];\n  }\n\n  enqueue(task) {\n    return new Promise((resolve, reject) => {\n      this.queue.push({ task, resolve, reject });\n      this.run();\n    });\n  }\n\n  async run() {\n    if (this.running >= this.limit || this.queue.length === 0) return;\n\n    this.running++;\n    const { task, resolve, reject } = this.queue.shift();\n\n    try {\n      const result = await task();\n      resolve(result);\n    } catch (error) {\n      reject(error);\n    } finally {\n      this.running--;\n      this.run();\n    }\n  }\n}\n\nconst uploadImage = (file) =>\n  new Promise(resolve => setTimeout(() => resolve(`上传 ${file} 成功`), 1000));\n\nconst queue = new AsyncQueue(2);\nconst files = Array.from({ length: 20 }, (_, i) => `image${i}.jpg`);\n\nfiles.forEach(file => {\n  queue.enqueue(() => uploadImage(file)).then(console.log);\n});\n```\n\n**解析**：\n- `AsyncQueue` 类封装了一个任务队列，`limit` 控制最大并发数。\n- `enqueue` 添加任务到队列，`run` 方法自动调度任务执行。\n- 当一个任务完成时，`finally` 块会触发下一次调度。\n\n**适用场景**：需要严格顺序或优先级的任务，比如表单提交、日志上传。\n\n## 方法三：借助第三方库\n\n手写并发控制虽然能加深理解，但生产环境中我们往往更倾向于使用成熟的库，比如 `p-limit` 或 `async`。\n\n### 实例：使用 p-limit\n\n`p-limit` 是一个轻量级的并发控制库，安装后使用非常简单：\n\n```javascript\nimport pLimit from \"p-limit\";\n\nconst limit = pLimit(3);\nconst tasks = Array.from({ length: 10 }, (_, i) =>\n  limit(() => fetch(`https://api.example.com/data/${i}`).then(res => res.json()))\n);\n\nPromise.all(tasks).then(results => {\n  console.log(\"所有结果：\", results);\n});\n```\n\n**解析**：\n- `pLimit(3)` 创建一个最多 3 个并发的限制器。\n- 每个任务通过 `limit` 包装后自动受控。\n- 代码简洁，适合快速集成。\n\n**适用场景**：快速开发、不想自己实现底层逻辑时。\n\n## 方法四：利用 Web Worker\n\n对于计算密集型任务（比如图像处理、大数据计算），网络请求之外的并发控制可以通过 `Web Worker` 实现。它将任务放到独立线程运行，避免阻塞主线程。\n\n### 实例：并行处理数组计算\n\n假设我们要对一个大数组分片处理：\n\n```javascript\n// worker.js\nself.onmessage = function (e) {\n  const { data, start, end } = e.data;\n  const result = data.slice(start, end).reduce((sum, num) => sum + num, 0);\n  self.postMessage(result);\n};\n\n// 主线程\nconst data = Array.from({ length: 1000000 }, (_, i) => i);\nconst chunkSize = Math.ceil(data.length / 4);\nconst workers = [];\nconst results = [];\n\nfor (let i = 0; i < 4; i++) {\n  const worker = new Worker(\"worker.js\");\n  workers.push(worker);\n  worker.postMessage({\n    data,\n    start: i * chunkSize,\n    end: Math.min((i + 1) * chunkSize, data.length),\n  });\n  results.push(\n    new Promise(resolve => {\n      worker.onmessage = e => resolve(e.data);\n    })\n  );\n}\n\nPromise.all(results).then(sums => {\n  const total = sums.reduce((a, b) => a + b, 0);\n  console.log(\"总和：\", total);\n});\n```\n\n**解析**：\n- 主线程将数组分成 4 份，交给 4 个 Worker 并行计算。\n- Worker 完成后通过 `postMessage` 返回结果。\n- 这种方式充分利用多核 CPU，适合高计算任务。\n\n**适用场景**：大数据处理、图像/视频处理。\n\n## 方法五：结合实际场景优化\n\n并发控制不仅仅是技术实现，还要结合业务场景优化。比如：\n\n### 场景一：动态调整并发数\n\n在网络状况不佳时，可以动态降低并发数：\n\n```javascript\nlet concurrencyLimit = navigator.connection?.effectiveType === \"4g\" ? 5 : 2;\n```\n\n### 场景二：任务优先级\n\n高优先级任务插队执行，可以在队列中加入优先级字段并排序。\n\n### 场景三：错误重试\n\n为每个任务添加重试逻辑，提升容错性：\n\n```javascript\nasync function withRetry(task, retries = 3) {\n  for (let i = 0; i < retries; i++) {\n    try {\n      return await task();\n    } catch (e) {\n      if (i === retries - 1) throw e;\n      await new Promise(r => setTimeout(r, 1000 * Math.pow(2, i)));\n    }\n  }\n}\n```\n\n## 总结\n\n前端并发控制是一个需要权衡性能与复杂度的课题。从简单的 Promise 手动控制，到结构化的异步队列，再到借助 Web Worker 或第三方库，每种方法都有其适用场景。实际开发中，可以根据任务类型（网络请求还是计算）、规模（小型还是海量）、性能需求（实时还是容忍延迟）选择合适的方案。\n\n无论你是初学者还是资深开发者，理解并发控制的原理和实践都能让你的代码更健壮、应用更流畅。希望这篇文章能为你提供一些启发，下次遇到并发问题时，不妨试试这些方法，找到最适合自己的解决方案！\n\n--- ",
    "code": "var Component=(()=>{var p=Object.create;var s=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var B=(n,l)=>()=>(l||n((l={exports:{}}).exports,l),l.exports),g=(n,l)=>{for(var r in l)s(n,r,{get:l[r],enumerable:!0})},o=(n,l,r,a)=>{if(l&&typeof l==\"object\"||typeof l==\"function\")for(let c of y(l))!u.call(n,c)&&c!==r&&s(n,c,{get:()=>l[c],enumerable:!(a=E(l,c))||a.enumerable});return n};var m=(n,l,r)=>(r=n!=null?p(F(n)):{},o(l||!n||!n.__esModule?s(r,\"default\",{value:n,enumerable:!0}):r,n)),f=n=>o(s({},\"__esModule\",{value:!0}),n);var d=B((x,i)=>{i.exports=_jsx_runtime});var A={};g(A,{default:()=>h,frontmatter:()=>k});var e=m(d()),k={type:\"Post\",title:\"\\u524D\\u7AEF\\u5982\\u4F55\\u63A7\\u5236\\u5E76\\u53D1?\",date:\"2024-02-26\",description:\"\\u6DF1\\u5165\\u63A2\\u8BA8\\u524D\\u7AEF\\u5E76\\u53D1\\u63A7\\u5236\\u7684\\u591A\\u79CD\\u65B9\\u6CD5\\u4E0E\\u5B9E\\u8DF5\\u573A\\u666F\\uFF0C\\u6DB5\\u76D6 Promise\\u3001\\u5F02\\u6B65\\u961F\\u5217\\u3001Worker \\u7B49\\u6280\\u672F\\uFF0C\\u7ED3\\u5408\\u5B9E\\u4F8B\\u89E3\\u6790\\u5982\\u4F55\\u4F18\\u5316\\u6027\\u80FD\\u4E0E\\u7528\\u6237\\u4F53\\u9A8C\\u3002\",keywords:\"\\u524D\\u7AEF\\u5E76\\u53D1, Promise, \\u5F02\\u6B65\\u961F\\u5217, Web Worker, \\u5E76\\u53D1\\u63A7\\u5236, JavaScript, \\u6027\\u80FD\\u4F18\\u5316\",author:\"\\u6653\\u9F99\",image:\"/images/hero/concurrency-control.jpg\",tags:[\"JavaScript\",\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"\\u6027\\u80FD\\u4F18\\u5316\"],category:\"\\u524D\\u7AEF\\u6280\\u672F\"};function t(n){let l={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",hr:\"hr\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...n.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.p,{children:\"\\u5728\\u73B0\\u4EE3\\u524D\\u7AEF\\u5F00\\u53D1\\u4E2D\\uFF0C\\u968F\\u7740\\u5E94\\u7528\\u7684\\u590D\\u6742\\u5EA6\\u589E\\u52A0\\uFF0C\\u524D\\u7AEF\\u9700\\u8981\\u5904\\u7406\\u7684\\u8BF7\\u6C42\\u548C\\u4EFB\\u52A1\\u8D8A\\u6765\\u8D8A\\u591A\\u3002\\u6BD4\\u5982\\u6279\\u91CF\\u4E0A\\u4F20\\u56FE\\u7247\\u3001\\u8C03\\u7528\\u591A\\u4E2A API \\u63A5\\u53E3\\u3001\\u5904\\u7406\\u5927\\u6570\\u636E\\u8BA1\\u7B97\\u7B49\\u573A\\u666F\\uFF0C\\u90FD\\u53EF\\u80FD\\u6D89\\u53CA\\u5E76\\u53D1\\u95EE\\u9898\\u3002\\u5982\\u679C\\u4E0D\\u52A0\\u4EE5\\u63A7\\u5236\\uFF0C\\u65E0\\u9650\\u5236\\u7684\\u5E76\\u53D1\\u53EF\\u80FD\\u4F1A\\u5BFC\\u81F4\\u6D4F\\u89C8\\u5668\\u8D44\\u6E90\\u8017\\u5C3D\\u3001\\u6027\\u80FD\\u4E0B\\u964D\\uFF0C\\u751A\\u81F3\\u670D\\u52A1\\u5668\\u8FC7\\u8F7D\\u3002\\u90A3\\u4E48\\uFF0C\\u524D\\u7AEF\\u5982\\u4F55\\u4F18\\u96C5\\u5730\\u63A7\\u5236\\u5E76\\u53D1\\u5462\\uFF1F\\u8FD9\\u7BC7\\u6587\\u7AE0\\u5C06\\u5E26\\u4F60\\u4ECE\\u57FA\\u7840\\u5230\\u8FDB\\u9636\\uFF0C\\u5168\\u9762\\u89E3\\u6790\\u524D\\u7AEF\\u5E76\\u53D1\\u63A7\\u5236\\u7684\\u5404\\u79CD\\u65B9\\u6CD5\\uFF0C\\u5E76\\u7ED3\\u5408\\u5B9E\\u4F8B\\u63A2\\u8BA8\\u5B83\\u4EEC\\u7684\\u9002\\u7528\\u573A\\u666F\\u3002\"}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u4EC0\\u4E48\\u662F\\u5E76\\u53D1\\u63A7\\u5236\",children:(0,e.jsx)(l.a,{href:\"#\\u4EC0\\u4E48\\u662F\\u5E76\\u53D1\\u63A7\\u5236\",children:\"\\u4EC0\\u4E48\\u662F\\u5E76\\u53D1\\u63A7\\u5236?\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5E76\\u53D1\\u63A7\\u5236\\uFF0C\\u7B80\\u5355\\u6765\\u8BF4\\uFF0C\\u5C31\\u662F\\u5728\\u540C\\u4E00\\u65F6\\u95F4\\u6BB5\\u5185\\u9650\\u5236\\u540C\\u65F6\\u6267\\u884C\\u7684\\u4EFB\\u52A1\\u6570\\u91CF\\u3002\\u6BD4\\u5982\\u4F60\\u9700\\u8981\\u53D1\\u9001 100 \\u4E2A\\u7F51\\u7EDC\\u8BF7\\u6C42\\uFF0C\\u4F46\\u6D4F\\u89C8\\u5668\\u6216\\u670D\\u52A1\\u5668\\u7684\\u627F\\u8F7D\\u80FD\\u529B\\u6709\\u9650\\uFF0C\\u4F60\\u53EF\\u80FD\\u5E0C\\u671B\\u4E00\\u6B21\\u53EA\\u53D1\\u9001 5 \\u4E2A\\uFF0C\\u7B49\\u8FD9 5 \\u4E2A\\u5B8C\\u6210\\u540E\\uFF0C\\u518D\\u5904\\u7406\\u4E0B\\u4E00\\u6279\\u3002\\u8FD9\\u6837\\u7684\\u7B56\\u7565\\u4E0D\\u4EC5\\u80FD\\u907F\\u514D\\u8D44\\u6E90\\u8FC7\\u5EA6\\u5360\\u7528\\uFF0C\\u8FD8\\u80FD\\u63D0\\u5347\\u5E94\\u7528\\u7684\\u7A33\\u5B9A\\u6027\\u548C\\u7528\\u6237\\u4F53\\u9A8C\\u3002\"}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5728\\u524D\\u7AEF\\uFF0C\\u5E38\\u89C1\\u7684\\u5E76\\u53D1\\u573A\\u666F\\u5305\\u62EC\\uFF1A\"}),`\n`,(0,e.jsxs)(l.ul,{children:[`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.strong,{children:\"\\u7F51\\u7EDC\\u8BF7\\u6C42\"}),\"\\uFF1A\\u6279\\u91CF\\u83B7\\u53D6\\u6570\\u636E\\u6216\\u4E0A\\u4F20\\u6587\\u4EF6\\u3002\"]}),`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.strong,{children:\"\\u8BA1\\u7B97\\u4EFB\\u52A1\"}),\"\\uFF1A\\u5904\\u7406\\u5927\\u91CF\\u6570\\u636E\\u6216\\u590D\\u6742\\u7684 DOM \\u64CD\\u4F5C\\u3002\"]}),`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.strong,{children:\"\\u7528\\u6237\\u4EA4\\u4E92\"}),\"\\uFF1A\\u54CD\\u5E94\\u591A\\u4E2A\\u7528\\u6237\\u64CD\\u4F5C\\u4F46\\u9700\\u8981\\u6709\\u5E8F\\u5904\\u7406\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(l.p,{children:\"\\u63A5\\u4E0B\\u6765\\uFF0C\\u6211\\u4EEC\\u5C06\\u4ECE\\u57FA\\u7840\\u65B9\\u6CD5\\u5165\\u624B\\uFF0C\\u9010\\u6B65\\u6DF1\\u5165\\u63A2\\u8BA8\\u524D\\u7AEF\\u5E76\\u53D1\\u63A7\\u5236\\u7684\\u5B9E\\u73B0\\u65B9\\u5F0F\\u3002\"}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u65B9\\u6CD5\\u4E00\\u4F7F\\u7528-promise-\\u624B\\u52A8\\u63A7\\u5236\",children:(0,e.jsx)(l.a,{href:\"#\\u65B9\\u6CD5\\u4E00\\u4F7F\\u7528-promise-\\u624B\\u52A8\\u63A7\\u5236\",children:\"\\u65B9\\u6CD5\\u4E00\\uFF1A\\u4F7F\\u7528 Promise \\u624B\\u52A8\\u63A7\\u5236\"})}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"Promise\"})})})}),\" \\u662F JavaScript \\u5F02\\u6B65\\u7F16\\u7A0B\\u7684\\u57FA\\u77F3\\uFF0C\\u901A\\u8FC7\\u5B83\\u6211\\u4EEC\\u53EF\\u4EE5\\u624B\\u52A8\\u63A7\\u5236\\u5E76\\u53D1\\u3002\\u6700\\u7B80\\u5355\\u7684\\u65B9\\u5F0F\\u662F\\u501F\\u52A9 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"Promise.all\"})})})}),\"\\uFF0C\\u4F46\\u5B83\\u65E0\\u6CD5\\u9650\\u5236\\u5E76\\u53D1\\u6570\\u91CF\\uFF0C\\u6240\\u6709\\u4EFB\\u52A1\\u4F1A\\u540C\\u65F6\\u6267\\u884C\\u3002\\u5982\\u679C\\u9700\\u8981\\u9650\\u5236\\u5E76\\u53D1\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u81EA\\u5DF1\\u5C01\\u88C5\\u4E00\\u4E2A\\u5DE5\\u5177\\u51FD\\u6570\\u3002\"]}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u5B9E\\u4F8B\\u9650\\u5236\\u5E76\\u53D1\\u7684\\u7F51\\u7EDC\\u8BF7\\u6C42\",children:(0,e.jsx)(l.a,{href:\"#\\u5B9E\\u4F8B\\u9650\\u5236\\u5E76\\u53D1\\u7684\\u7F51\\u7EDC\\u8BF7\\u6C42\",children:\"\\u5B9E\\u4F8B\\uFF1A\\u9650\\u5236\\u5E76\\u53D1\\u7684\\u7F51\\u7EDC\\u8BF7\\u6C42\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5047\\u8BBE\\u6211\\u4EEC\\u6709 10 \\u4E2A API \\u8BF7\\u6C42\\u4EFB\\u52A1\\uFF0C\\u4F46\\u5E0C\\u671B\\u6700\\u591A\\u540C\\u65F6\\u6267\\u884C 3 \\u4E2A\\uFF1A\"}),`\n`,(0,e.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" tasks\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Array.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"from\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({ length: \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" }, (\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"_\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  fetch\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"`https://api.example.com/data/${\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" res.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" limitConcurrency\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"tasks\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"limit\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" results\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" executing\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" Set\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  for\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" task\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" of\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" tasks) {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" promise\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" task\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"result\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      executing.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"delete\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(promise);\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      return\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" result;\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    executing.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"add\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(promise);\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    results.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(promise);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (executing.size \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\">=\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" limit) {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      await\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"race\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(executing);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"all\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(results);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u4F7F\\u7528\"})}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"limitConcurrency\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(tasks, \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"results\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:'\"\\u6240\\u6709\\u4EFB\\u52A1\\u5B8C\\u6210\\uFF1A\"'}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", results);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u89E3\\u6790\"}),\"\\uFF1A\"]}),`\n`,(0,e.jsxs)(l.ul,{children:[`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"limitConcurrency\"})})})}),\" \\u51FD\\u6570\\u63A5\\u6536\\u4EFB\\u52A1\\u6570\\u7EC4\\u548C\\u5E76\\u53D1\\u9650\\u5236\\u6570 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"limit\"})})})}),\"\\u3002\"]}),`\n`,(0,e.jsxs)(l.li,{children:[\"\\u7528 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"Set\"})})})}),\" \\u8FFD\\u8E2A\\u5F53\\u524D\\u6267\\u884C\\u4E2D\\u7684\\u4EFB\\u52A1\\uFF0C\\u5F53\\u8FBE\\u5230\\u9650\\u5236\\u65F6\\uFF0C\\u901A\\u8FC7 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"Promise.race\"})})})}),\" \\u7B49\\u5F85\\u4EFB\\u610F\\u4E00\\u4E2A\\u4EFB\\u52A1\\u5B8C\\u6210\\u540E\\u518D\\u7EE7\\u7EED\\u3002\"]}),`\n`,(0,e.jsx)(l.li,{children:\"\\u8FD9\\u79CD\\u65B9\\u6CD5\\u7B80\\u5355\\u76F4\\u89C2\\uFF0C\\u9002\\u5408\\u4E2D\\u5C0F\\u89C4\\u6A21\\u7684\\u5E76\\u53D1\\u63A7\\u5236\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u9002\\u7528\\u573A\\u666F\"}),\"\\uFF1A\\u6279\\u91CF\\u8BF7\\u6C42\\u6570\\u636E\\u3001\\u6587\\u4EF6\\u4E0A\\u4F20\\u7B49\\u3002\"]}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u65B9\\u6CD5\\u4E8C\\u5F02\\u6B65\\u961F\\u5217\",children:(0,e.jsx)(l.a,{href:\"#\\u65B9\\u6CD5\\u4E8C\\u5F02\\u6B65\\u961F\\u5217\",children:\"\\u65B9\\u6CD5\\u4E8C\\uFF1A\\u5F02\\u6B65\\u961F\\u5217\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u624B\\u52A8\\u63A7\\u5236 Promise \\u867D\\u7136\\u7075\\u6D3B\\uFF0C\\u4F46\\u4EE3\\u7801\\u590D\\u6742\\u5EA6\\u8F83\\u9AD8\\u3002\\u5BF9\\u4E8E\\u66F4\\u7ED3\\u6784\\u5316\\u7684\\u5E76\\u53D1\\u7BA1\\u7406\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528\\u5F02\\u6B65\\u961F\\u5217\\u3002\\u961F\\u5217\\u7684\\u6838\\u5FC3\\u601D\\u60F3\\u662F\\u6309\\u987A\\u5E8F\\u5904\\u7406\\u4EFB\\u52A1\\uFF0C\\u5E76\\u9650\\u5236\\u5E76\\u53D1\\u7684\\u6570\\u91CF\\u3002\"}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u5B9E\\u4F8B\\u56FE\\u7247\\u6279\\u91CF\\u4E0A\\u4F20\\u961F\\u5217\",children:(0,e.jsx)(l.a,{href:\"#\\u5B9E\\u4F8B\\u56FE\\u7247\\u6279\\u91CF\\u4E0A\\u4F20\\u961F\\u5217\",children:\"\\u5B9E\\u4F8B\\uFF1A\\u56FE\\u7247\\u6279\\u91CF\\u4E0A\\u4F20\\u961F\\u5217\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5047\\u8BBE\\u6211\\u4EEC\\u8981\\u4E0A\\u4F20 20 \\u5F20\\u56FE\\u7247\\uFF0C\\u4F46\\u5E0C\\u671B\\u9650\\u5236\\u4E3A 2 \\u4E2A\\u5E76\\u53D1\\uFF1A\"}),`\n`,(0,e.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" AsyncQueue\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  constructor\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"limit\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"    this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".limit \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" limit;\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"    this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".running \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"    this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".queue \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  enqueue\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"task\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"reject\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"      this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".queue.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({ task, resolve, reject });\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"      this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"run\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  async\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" run\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".running \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\">=\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".limit \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"||\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".queue.\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"length\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" ===\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"    this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".running\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"++\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"task\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"reject\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".queue.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"shift\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    try\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" result\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" task\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"      resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(result);\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    } \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (error) {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"      reject\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(error);\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    } \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"finally\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"      this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".running\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"--\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"      this\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"run\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" uploadImage\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"file\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  new\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" setTimeout\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"`\\u4E0A\\u4F20 ${\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"file\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"} \\u6210\\u529F`\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"), \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"1000\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" queue\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" AsyncQueue\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" files\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Array.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"from\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({ length: \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"20\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" }, (\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"_\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" `image${\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"}.jpg`\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"files.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"forEach\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"file\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  queue.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"enqueue\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" uploadImage\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(file)).\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(console.log);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u89E3\\u6790\"}),\"\\uFF1A\"]}),`\n`,(0,e.jsxs)(l.ul,{children:[`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"AsyncQueue\"})})})}),\" \\u7C7B\\u5C01\\u88C5\\u4E86\\u4E00\\u4E2A\\u4EFB\\u52A1\\u961F\\u5217\\uFF0C\",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"limit\"})})})}),\" \\u63A7\\u5236\\u6700\\u5927\\u5E76\\u53D1\\u6570\\u3002\"]}),`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"enqueue\"})})})}),\" \\u6DFB\\u52A0\\u4EFB\\u52A1\\u5230\\u961F\\u5217\\uFF0C\",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"run\"})})})}),\" \\u65B9\\u6CD5\\u81EA\\u52A8\\u8C03\\u5EA6\\u4EFB\\u52A1\\u6267\\u884C\\u3002\"]}),`\n`,(0,e.jsxs)(l.li,{children:[\"\\u5F53\\u4E00\\u4E2A\\u4EFB\\u52A1\\u5B8C\\u6210\\u65F6\\uFF0C\",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"finally\"})})})}),\" \\u5757\\u4F1A\\u89E6\\u53D1\\u4E0B\\u4E00\\u6B21\\u8C03\\u5EA6\\u3002\"]}),`\n`]}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u9002\\u7528\\u573A\\u666F\"}),\"\\uFF1A\\u9700\\u8981\\u4E25\\u683C\\u987A\\u5E8F\\u6216\\u4F18\\u5148\\u7EA7\\u7684\\u4EFB\\u52A1\\uFF0C\\u6BD4\\u5982\\u8868\\u5355\\u63D0\\u4EA4\\u3001\\u65E5\\u5FD7\\u4E0A\\u4F20\\u3002\"]}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u65B9\\u6CD5\\u4E09\\u501F\\u52A9\\u7B2C\\u4E09\\u65B9\\u5E93\",children:(0,e.jsx)(l.a,{href:\"#\\u65B9\\u6CD5\\u4E09\\u501F\\u52A9\\u7B2C\\u4E09\\u65B9\\u5E93\",children:\"\\u65B9\\u6CD5\\u4E09\\uFF1A\\u501F\\u52A9\\u7B2C\\u4E09\\u65B9\\u5E93\"})}),`\n`,(0,e.jsxs)(l.p,{children:[\"\\u624B\\u5199\\u5E76\\u53D1\\u63A7\\u5236\\u867D\\u7136\\u80FD\\u52A0\\u6DF1\\u7406\\u89E3\\uFF0C\\u4F46\\u751F\\u4EA7\\u73AF\\u5883\\u4E2D\\u6211\\u4EEC\\u5F80\\u5F80\\u66F4\\u503E\\u5411\\u4E8E\\u4F7F\\u7528\\u6210\\u719F\\u7684\\u5E93\\uFF0C\\u6BD4\\u5982 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"p-limit\"})})})}),\" \\u6216 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"async\"})})})}),\"\\u3002\"]}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u5B9E\\u4F8B\\u4F7F\\u7528-p-limit\",children:(0,e.jsx)(l.a,{href:\"#\\u5B9E\\u4F8B\\u4F7F\\u7528-p-limit\",children:\"\\u5B9E\\u4F8B\\uFF1A\\u4F7F\\u7528 p-limit\"})}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"p-limit\"})})})}),\" \\u662F\\u4E00\\u4E2A\\u8F7B\\u91CF\\u7EA7\\u7684\\u5E76\\u53D1\\u63A7\\u5236\\u5E93\\uFF0C\\u5B89\\u88C5\\u540E\\u4F7F\\u7528\\u975E\\u5E38\\u7B80\\u5355\\uFF1A\"]}),`\n`,(0,e.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" pLimit \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:' \"p-limit\"'}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" limit\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" pLimit\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" tasks\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Array.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"from\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({ length: \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" }, (\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"_\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  limit\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"`https://api.example.com/data/${\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" res.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"()))\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"all\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(tasks).\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"results\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:'\"\\u6240\\u6709\\u7ED3\\u679C\\uFF1A\"'}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", results);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u89E3\\u6790\"}),\"\\uFF1A\"]}),`\n`,(0,e.jsxs)(l.ul,{children:[`\n`,(0,e.jsxs)(l.li,{children:[(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"pLimit(3)\"})})})}),\" \\u521B\\u5EFA\\u4E00\\u4E2A\\u6700\\u591A 3 \\u4E2A\\u5E76\\u53D1\\u7684\\u9650\\u5236\\u5668\\u3002\"]}),`\n`,(0,e.jsxs)(l.li,{children:[\"\\u6BCF\\u4E2A\\u4EFB\\u52A1\\u901A\\u8FC7 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"limit\"})})})}),\" \\u5305\\u88C5\\u540E\\u81EA\\u52A8\\u53D7\\u63A7\\u3002\"]}),`\n`,(0,e.jsx)(l.li,{children:\"\\u4EE3\\u7801\\u7B80\\u6D01\\uFF0C\\u9002\\u5408\\u5FEB\\u901F\\u96C6\\u6210\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u9002\\u7528\\u573A\\u666F\"}),\"\\uFF1A\\u5FEB\\u901F\\u5F00\\u53D1\\u3001\\u4E0D\\u60F3\\u81EA\\u5DF1\\u5B9E\\u73B0\\u5E95\\u5C42\\u903B\\u8F91\\u65F6\\u3002\"]}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u65B9\\u6CD5\\u56DB\\u5229\\u7528-web-worker\",children:(0,e.jsx)(l.a,{href:\"#\\u65B9\\u6CD5\\u56DB\\u5229\\u7528-web-worker\",children:\"\\u65B9\\u6CD5\\u56DB\\uFF1A\\u5229\\u7528 Web Worker\"})}),`\n`,(0,e.jsxs)(l.p,{children:[\"\\u5BF9\\u4E8E\\u8BA1\\u7B97\\u5BC6\\u96C6\\u578B\\u4EFB\\u52A1\\uFF08\\u6BD4\\u5982\\u56FE\\u50CF\\u5904\\u7406\\u3001\\u5927\\u6570\\u636E\\u8BA1\\u7B97\\uFF09\\uFF0C\\u7F51\\u7EDC\\u8BF7\\u6C42\\u4E4B\\u5916\\u7684\\u5E76\\u53D1\\u63A7\\u5236\\u53EF\\u4EE5\\u901A\\u8FC7 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"Web Worker\"})})})}),\" \\u5B9E\\u73B0\\u3002\\u5B83\\u5C06\\u4EFB\\u52A1\\u653E\\u5230\\u72EC\\u7ACB\\u7EBF\\u7A0B\\u8FD0\\u884C\\uFF0C\\u907F\\u514D\\u963B\\u585E\\u4E3B\\u7EBF\\u7A0B\\u3002\"]}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u5B9E\\u4F8B\\u5E76\\u884C\\u5904\\u7406\\u6570\\u7EC4\\u8BA1\\u7B97\",children:(0,e.jsx)(l.a,{href:\"#\\u5B9E\\u4F8B\\u5E76\\u884C\\u5904\\u7406\\u6570\\u7EC4\\u8BA1\\u7B97\",children:\"\\u5B9E\\u4F8B\\uFF1A\\u5E76\\u884C\\u5904\\u7406\\u6570\\u7EC4\\u8BA1\\u7B97\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5047\\u8BBE\\u6211\\u4EEC\\u8981\\u5BF9\\u4E00\\u4E2A\\u5927\\u6570\\u7EC4\\u5206\\u7247\\u5904\\u7406\\uFF1A\"}),`\n`,(0,e.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// worker.js\"})}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"self.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"onmessage\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"e\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"data\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"start\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"end\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" e.data;\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" result\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" data.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"slice\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(start, end).\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"reduce\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"sum\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"num\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" sum \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" num, \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  self.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"postMessage\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(result);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u4E3B\\u7EBF\\u7A0B\"})}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" data\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Array.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"from\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({ length: \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"1000000\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" }, (\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"_\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"i\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" i);\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" chunkSize\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Math.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"ceil\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(data.\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"length\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" /\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 4\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" workers\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" results\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"; i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"<\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 4\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"; i\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"++\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" worker\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" Worker\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:'\"worker.js\"'}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  workers.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(worker);\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  worker.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"postMessage\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    data,\"})}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    start: i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" chunkSize,\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    end: Math.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"min\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"((i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 1\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" chunkSize, data.\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"length\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"),\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  results.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    new\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      worker.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"onmessage\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\" e\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" resolve\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(e.data);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    })\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  );\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"all\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(results).\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"sums\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" total\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" sums.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"reduce\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"a\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"b\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" a \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" b, \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:'\"\\u603B\\u548C\\uFF1A\"'}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", total);\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u89E3\\u6790\"}),\"\\uFF1A\"]}),`\n`,(0,e.jsxs)(l.ul,{children:[`\n`,(0,e.jsx)(l.li,{children:\"\\u4E3B\\u7EBF\\u7A0B\\u5C06\\u6570\\u7EC4\\u5206\\u6210 4 \\u4EFD\\uFF0C\\u4EA4\\u7ED9 4 \\u4E2A Worker \\u5E76\\u884C\\u8BA1\\u7B97\\u3002\"}),`\n`,(0,e.jsxs)(l.li,{children:[\"Worker \\u5B8C\\u6210\\u540E\\u901A\\u8FC7 \",(0,e.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{children:\"postMessage\"})})})}),\" \\u8FD4\\u56DE\\u7ED3\\u679C\\u3002\"]}),`\n`,(0,e.jsx)(l.li,{children:\"\\u8FD9\\u79CD\\u65B9\\u5F0F\\u5145\\u5206\\u5229\\u7528\\u591A\\u6838 CPU\\uFF0C\\u9002\\u5408\\u9AD8\\u8BA1\\u7B97\\u4EFB\\u52A1\\u3002\"}),`\n`]}),`\n`,(0,e.jsxs)(l.p,{children:[(0,e.jsx)(l.strong,{children:\"\\u9002\\u7528\\u573A\\u666F\"}),\"\\uFF1A\\u5927\\u6570\\u636E\\u5904\\u7406\\u3001\\u56FE\\u50CF/\\u89C6\\u9891\\u5904\\u7406\\u3002\"]}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u65B9\\u6CD5\\u4E94\\u7ED3\\u5408\\u5B9E\\u9645\\u573A\\u666F\\u4F18\\u5316\",children:(0,e.jsx)(l.a,{href:\"#\\u65B9\\u6CD5\\u4E94\\u7ED3\\u5408\\u5B9E\\u9645\\u573A\\u666F\\u4F18\\u5316\",children:\"\\u65B9\\u6CD5\\u4E94\\uFF1A\\u7ED3\\u5408\\u5B9E\\u9645\\u573A\\u666F\\u4F18\\u5316\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5E76\\u53D1\\u63A7\\u5236\\u4E0D\\u4EC5\\u4EC5\\u662F\\u6280\\u672F\\u5B9E\\u73B0\\uFF0C\\u8FD8\\u8981\\u7ED3\\u5408\\u4E1A\\u52A1\\u573A\\u666F\\u4F18\\u5316\\u3002\\u6BD4\\u5982\\uFF1A\"}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u573A\\u666F\\u4E00\\u52A8\\u6001\\u8C03\\u6574\\u5E76\\u53D1\\u6570\",children:(0,e.jsx)(l.a,{href:\"#\\u573A\\u666F\\u4E00\\u52A8\\u6001\\u8C03\\u6574\\u5E76\\u53D1\\u6570\",children:\"\\u573A\\u666F\\u4E00\\uFF1A\\u52A8\\u6001\\u8C03\\u6574\\u5E76\\u53D1\\u6570\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u5728\\u7F51\\u7EDC\\u72B6\\u51B5\\u4E0D\\u4F73\\u65F6\\uFF0C\\u53EF\\u4EE5\\u52A8\\u6001\\u964D\\u4F4E\\u5E76\\u53D1\\u6570\\uFF1A\"}),`\n`,(0,e.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" concurrencyLimit \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" navigator.connection?.effectiveType \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"===\"}),(0,e.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:' \"4g\"'}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" ?\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 5\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" :\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]})})})}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u573A\\u666F\\u4E8C\\u4EFB\\u52A1\\u4F18\\u5148\\u7EA7\",children:(0,e.jsx)(l.a,{href:\"#\\u573A\\u666F\\u4E8C\\u4EFB\\u52A1\\u4F18\\u5148\\u7EA7\",children:\"\\u573A\\u666F\\u4E8C\\uFF1A\\u4EFB\\u52A1\\u4F18\\u5148\\u7EA7\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u9AD8\\u4F18\\u5148\\u7EA7\\u4EFB\\u52A1\\u63D2\\u961F\\u6267\\u884C\\uFF0C\\u53EF\\u4EE5\\u5728\\u961F\\u5217\\u4E2D\\u52A0\\u5165\\u4F18\\u5148\\u7EA7\\u5B57\\u6BB5\\u5E76\\u6392\\u5E8F\\u3002\"}),`\n`,(0,e.jsx)(l.h3,{id:\"\\u573A\\u666F\\u4E09\\u9519\\u8BEF\\u91CD\\u8BD5\",children:(0,e.jsx)(l.a,{href:\"#\\u573A\\u666F\\u4E09\\u9519\\u8BEF\\u91CD\\u8BD5\",children:\"\\u573A\\u666F\\u4E09\\uFF1A\\u9519\\u8BEF\\u91CD\\u8BD5\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u4E3A\\u6BCF\\u4E2A\\u4EFB\\u52A1\\u6DFB\\u52A0\\u91CD\\u8BD5\\u903B\\u8F91\\uFF0C\\u63D0\\u5347\\u5BB9\\u9519\\u6027\\uFF1A\"}),`\n`,(0,e.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" withRetry\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"task\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"retries\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 3\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  for\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"; i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"<\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" retries; i\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"++\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    try\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      return\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" task\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    } \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (e) {\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      if\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (i \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"===\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" retries \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 1\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"throw\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" e;\"})]}),`\n`,(0,e.jsxs)(l.span,{\"data-line\":\"\",children:[(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      await\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"r\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" setTimeout\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(r, \"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"1000\"}),(0,e.jsx)(l.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Math.\"}),(0,e.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"pow\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", i)));\"})]}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,e.jsx)(l.span,{\"data-line\":\"\",children:(0,e.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,e.jsx)(l.h2,{id:\"\\u603B\\u7ED3\",children:(0,e.jsx)(l.a,{href:\"#\\u603B\\u7ED3\",children:\"\\u603B\\u7ED3\"})}),`\n`,(0,e.jsx)(l.p,{children:\"\\u524D\\u7AEF\\u5E76\\u53D1\\u63A7\\u5236\\u662F\\u4E00\\u4E2A\\u9700\\u8981\\u6743\\u8861\\u6027\\u80FD\\u4E0E\\u590D\\u6742\\u5EA6\\u7684\\u8BFE\\u9898\\u3002\\u4ECE\\u7B80\\u5355\\u7684 Promise \\u624B\\u52A8\\u63A7\\u5236\\uFF0C\\u5230\\u7ED3\\u6784\\u5316\\u7684\\u5F02\\u6B65\\u961F\\u5217\\uFF0C\\u518D\\u5230\\u501F\\u52A9 Web Worker \\u6216\\u7B2C\\u4E09\\u65B9\\u5E93\\uFF0C\\u6BCF\\u79CD\\u65B9\\u6CD5\\u90FD\\u6709\\u5176\\u9002\\u7528\\u573A\\u666F\\u3002\\u5B9E\\u9645\\u5F00\\u53D1\\u4E2D\\uFF0C\\u53EF\\u4EE5\\u6839\\u636E\\u4EFB\\u52A1\\u7C7B\\u578B\\uFF08\\u7F51\\u7EDC\\u8BF7\\u6C42\\u8FD8\\u662F\\u8BA1\\u7B97\\uFF09\\u3001\\u89C4\\u6A21\\uFF08\\u5C0F\\u578B\\u8FD8\\u662F\\u6D77\\u91CF\\uFF09\\u3001\\u6027\\u80FD\\u9700\\u6C42\\uFF08\\u5B9E\\u65F6\\u8FD8\\u662F\\u5BB9\\u5FCD\\u5EF6\\u8FDF\\uFF09\\u9009\\u62E9\\u5408\\u9002\\u7684\\u65B9\\u6848\\u3002\"}),`\n`,(0,e.jsx)(l.p,{children:\"\\u65E0\\u8BBA\\u4F60\\u662F\\u521D\\u5B66\\u8005\\u8FD8\\u662F\\u8D44\\u6DF1\\u5F00\\u53D1\\u8005\\uFF0C\\u7406\\u89E3\\u5E76\\u53D1\\u63A7\\u5236\\u7684\\u539F\\u7406\\u548C\\u5B9E\\u8DF5\\u90FD\\u80FD\\u8BA9\\u4F60\\u7684\\u4EE3\\u7801\\u66F4\\u5065\\u58EE\\u3001\\u5E94\\u7528\\u66F4\\u6D41\\u7545\\u3002\\u5E0C\\u671B\\u8FD9\\u7BC7\\u6587\\u7AE0\\u80FD\\u4E3A\\u4F60\\u63D0\\u4F9B\\u4E00\\u4E9B\\u542F\\u53D1\\uFF0C\\u4E0B\\u6B21\\u9047\\u5230\\u5E76\\u53D1\\u95EE\\u9898\\u65F6\\uFF0C\\u4E0D\\u59A8\\u8BD5\\u8BD5\\u8FD9\\u4E9B\\u65B9\\u6CD5\\uFF0C\\u627E\\u5230\\u6700\\u9002\\u5408\\u81EA\\u5DF1\\u7684\\u89E3\\u51B3\\u65B9\\u6848\\uFF01\"}),`\n`,(0,e.jsx)(l.hr,{})]})}function h(n={}){let{wrapper:l}=n.components||{};return l?(0,e.jsx)(l,{...n,children:(0,e.jsx)(t,{...n})}):t(n)}return f(A);})();\n;return Component;"
  },
  "_id": "前端技术/性能优化/前端如何控制并发.mdx",
  "_raw": {
    "sourceFilePath": "前端技术/性能优化/前端如何控制并发.mdx",
    "sourceFileName": "前端如何控制并发.mdx",
    "sourceFileDir": "前端技术/性能优化",
    "contentType": "mdx",
    "flattenedPath": "前端技术/性能优化/前端如何控制并发"
  },
  "type": "Post",
  "url": "/blog/前端技术/性能优化/前端如何控制并发"
}