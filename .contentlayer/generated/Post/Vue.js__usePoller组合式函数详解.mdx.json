{
  "title": "Vue 3 中的高级轮询解决方案：usePoller 组合式函数详解",
  "date": "2023-09-12T00:00:00.000Z",
  "description": "深入探讨 Vue 3 中的高级轮询实现，详细解析 usePoller 组合式函数的设计与源码，提供多种实用示例。",
  "keywords": "Vue 3, Composition API, 轮询, usePoller, 前端开发, 响应式编程, JavaScript",
  "author": "晓龙",
  "image": "/images/hero/vue3-polling.jpg",
  "tags": [
    "Vue.js",
    "前端开发",
    "响应式编程"
  ],
  "views": 0,
  "likes": 0,
  "category": "Vue.js",
  "body": {
    "raw": "\nVue 3 的 Composition API 为开发者提供了强大的工具来构建可复用、可维护的逻辑。在实际开发中，轮询（Polling）是一种常见的场景，例如实时获取服务器状态、更新仪表盘数据或检查任务进度。本篇博客将深入探讨如何在 Vue 3 中实现一个高级轮询解决方案——`usePoller` 组合式函数，从需求分析到源码实现，再到实际应用，带你全面掌握这一技术。\n\n## 什么是轮询？为什么需要 usePoller？\n\n轮询是指通过定时发起请求来获取最新数据的技术。虽然 WebSocket 和 Server-Sent Events 在某些实时场景下更高效，但轮询在实现简单、对服务器要求低、兼容性强等方面仍有不可替代的优势。\n\n然而，手动实现轮询逻辑可能会导致代码冗余、难以维护。例如，你可能需要在 `setInterval` 中调用 API，手动清理定时器，还要处理暂停、恢复、错误重试等功能。`usePoller` 是一个封装好的组合式函数，旨在解决这些问题，提供开箱即用的轮询能力。\n\n## usePoller 的设计目标\n\n在深入实现之前，我们先明确 `usePoller` 的设计目标：\n\n1. **灵活性**：支持自定义轮询间隔、停止条件和回调函数。\n2. **响应式**：与 Vue 的响应式系统集成，支持动态调整参数。\n3. **生命周期管理**：自动清理定时器，避免内存泄漏。\n4. **错误处理**：内置重试机制和错误状态管理。\n5. **可控性**：提供启动、暂停、重启等控制方法。\n\n## usePoller 的基本实现\n\n让我们从一个基础版本开始，逐步扩展功能。\n\n### 基础版本代码\n\n```javascript\nimport { ref, onUnmounted } from 'vue';\n\nexport function usePoller(callback, interval = 1000) {\n  const isPolling = ref(false);\n  let timer = null;\n\n  const start = () => {\n    if (isPolling.value) return;\n    isPolling.value = true;\n    timer = setInterval(() => {\n      callback();\n    }, interval);\n  };\n\n  const stop = () => {\n    if (!isPolling.value) return;\n    isPolling.value = false;\n    clearInterval(timer);\n  };\n\n  onUnmounted(() => stop());\n\n  return { isPolling, start, stop };\n}\n```\n\n### 使用示例\n\n```javascript\nimport { usePoller } from './usePoller';\n\nexport default {\n  setup() {\n    const fetchData = () => {\n      console.log('Fetching data...');\n    };\n\n    const { isPolling, start, stop } = usePoller(fetchData, 2000);\n\n    return { isPolling, start, stop };\n  },\n};\n```\n\n在这个基础版本中：\n- `callback` 是轮询时执行的函数。\n- `interval` 是轮询间隔（默认 1000ms）。\n- `isPolling` 是一个响应式变量，表示轮询状态。\n- `start` 和 `stop` 方法分别启动和停止轮询。\n- `onUnmounted` 确保组件销毁时清理定时器。\n\n## 增强版实现：源码深度解析\n\n基础版本虽然可用，但在实际场景中远远不够。我们需要支持动态间隔、错误重试、暂停恢复等功能。下面是一个增强版的实现：\n\n```javascript\nimport { ref, reactive, onUnmounted, watch } from 'vue';\n\nexport function usePoller(callback, options = {}) {\n  // 默认配置\n  const defaultOptions = {\n    interval: 1000,           // 轮询间隔\n    immediate: false,         // 是否立即执行\n    maxRetries: 3,            // 最大重试次数\n    retryDelay: 500,          // 重试间隔\n  };\n\n  const config = { ...defaultOptions, ...options };\n\n  // 响应式状态\n  const state = reactive({\n    isPolling: false,\n    error: null,\n    retryCount: 0,\n    lastPollTime: null,\n  });\n\n  let timer = null;\n\n  // 执行轮询任务\n  const poll = async () => {\n    try {\n      state.lastPollTime = Date.now();\n      await callback();\n      state.error = null;\n      state.retryCount = 0; // 重置重试计数\n    } catch (err) {\n      state.error = err;\n      if (state.retryCount < config.maxRetries) {\n        state.retryCount++;\n        setTimeout(poll, config.retryDelay); // 重试\n      } else {\n        stop(); // 超出重试次数，停止轮询\n      }\n    }\n  };\n\n  // 启动轮询\n  const start = () => {\n    if (state.isPolling) return;\n    state.isPolling = true;\n    if (config.immediate) poll(); // 立即执行一次\n    timer = setInterval(poll, config.interval);\n  };\n\n  // 停止轮询\n  const stop = () => {\n    if (!state.isPolling) return;\n    state.isPolling = false;\n    clearInterval(timer);\n    timer = null;\n  };\n\n  // 动态调整间隔\n  watch(\n    () => config.interval,\n    (newInterval) => {\n      if (state.isPolling) {\n        stop();\n        start();\n      }\n    }\n  );\n\n  // 组件卸载时清理\n  onUnmounted(() => stop());\n\n  return {\n    isPolling: state.isPolling,\n    error: state.error,\n    retryCount: state.retryCount,\n    lastPollTime: state.lastPollTime,\n    start,\n    stop,\n  };\n}\n```\n\n### 源码解析\n\n1. **选项配置**：\n   - 使用对象解构合并默认配置和用户传入的选项，支持灵活定制。\n   - `immediate` 控制是否在启动时立即执行一次。\n   - `maxRetries` 和 `retryDelay` 用于错误重试。\n\n2. **响应式状态**：\n   - 使用 `reactive` 创建状态对象，包含轮询状态、错误信息、重试次数和上次轮询时间。\n   - 比 `ref` 更适合管理多个相关状态。\n\n3. **轮询逻辑**：\n   - `poll` 函数是核心，异步执行 `callback`，并处理成功和失败逻辑。\n   - 失败时根据重试次数决定是重试还是停止。\n\n4. **动态调整**：\n   - 使用 `watch` 监听 `interval` 变化，自动重启轮询以应用新间隔。\n\n5. **生命周期管理**：\n   - `onUnmounted` 确保定时器在组件销毁时清理。\n\n## 高级应用示例\n\n### 示例 1：动态调整轮询间隔\n\n```javascript\nimport { ref } from 'vue';\nimport { usePoller } from './usePoller';\n\nexport default {\n  setup() {\n    const interval = ref(2000);\n    const fetchData = () => {\n      console.log('Fetching data at', new Date().toLocaleTimeString());\n    };\n\n    const { start, stop, isPolling } = usePoller(fetchData, {\n      interval: interval.value,\n      immediate: true,\n    });\n\n    const changeInterval = () => {\n      interval.value = 5000; // 动态改为 5 秒\n    };\n\n    return { start, stop, isPolling, changeInterval };\n  },\n};\n```\n\n在这个例子中，用户可以通过 `changeInterval` 动态调整轮询间隔，`usePoller` 会自动重启定时器。\n\n### 示例 2：错误重试与状态监控\n\n```javascript\nimport { usePoller } from './usePoller';\n\nexport default {\n  setup() {\n    let failCount = 0;\n    const fetchData = async () => {\n      if (failCount < 2) {\n        failCount++;\n        throw new Error('Simulated failure');\n      }\n      console.log('Data fetched successfully');\n    };\n\n    const { start, error, retryCount } = usePoller(fetchData, {\n      interval: 1000,\n      maxRetries: 3,\n      retryDelay: 500,\n    });\n\n    start();\n\n    return { error, retryCount };\n  },\n};\n```\n\n这里模拟了 API 前两次失败的情况，`usePoller` 会自动重试，并在超出最大重试次数后停止。\n\n### 示例 3：与 Vuex/Pinia 集成\n\n```javascript\nimport { usePoller } from './usePoller';\nimport { useStore } from 'vuex';\n\nexport default {\n  setup() {\n    const store = useStore();\n\n    const fetchStatus = async () => {\n      const status = await api.getServerStatus();\n      store.commit('updateStatus', status);\n    };\n\n    const { start, stop } = usePoller(fetchStatus, {\n      interval: 3000,\n      immediate: true,\n    });\n\n    return { start, stop };\n  },\n};\n```\n\n这个例子展示了如何将轮询数据与状态管理库集成，适用于实时仪表盘等场景。\n\n## 性能优化与注意事项\n\n1. **避免过多定时器**：\n   - `usePoller` 确保同一实例只有一个定时器运行，但多个组件实例可能导致资源浪费。考虑将轮询逻辑提升到全局状态管理中。\n\n2. **节流与防抖**：\n   - 如果 `callback` 执行时间较长，可以结合节流或防抖优化。\n\n3. **服务器压力**：\n   - 轮询频率过高可能增加服务器负担，建议根据实际需求调整 `interval`。\n\n## 结语\n\n通过 `usePoller`，我们不仅简化了轮询逻辑的实现，还通过响应式特性、错误处理和动态调整使其更适合现代 Vue 3 应用。从基础实现到高级功能，这篇文章展示了如何利用 Composition API 构建强大且可复用的工具。希望这些代码和示例能为你的项目提供灵感！\n\n如果你有更多高级需求，比如条件停止、自定义重试策略，不妨 fork 这份代码并扩展它。欢迎在评论区分享你的实现！\n\n---",
    "code": "var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var g=(e,l)=>()=>(l||e((l={exports:{}}).exports,l),l.exports),B=(e,l)=>{for(var r in l)c(e,r,{get:l[r],enumerable:!0})},i=(e,l,r,s)=>{if(l&&typeof l==\"object\"||typeof l==\"function\")for(let a of y(l))!u.call(e,a)&&a!==r&&c(e,a,{get:()=>l[a],enumerable:!(s=E(l,a))||s.enumerable});return e};var f=(e,l,r)=>(r=e!=null?p(F(e)):{},i(l||!e||!e.__esModule?c(r,\"default\",{value:e,enumerable:!0}):r,e)),m=e=>i(c({},\"__esModule\",{value:!0}),e);var t=g((b,d)=>{d.exports=_jsx_runtime});var x={};B(x,{default:()=>h,frontmatter:()=>P});var n=f(t()),P={type:\"Post\",title:\"Vue 3 \\u4E2D\\u7684\\u9AD8\\u7EA7\\u8F6E\\u8BE2\\u89E3\\u51B3\\u65B9\\u6848\\uFF1AusePoller \\u7EC4\\u5408\\u5F0F\\u51FD\\u6570\\u8BE6\\u89E3\",date:\"2023-09-12\",description:\"\\u6DF1\\u5165\\u63A2\\u8BA8 Vue 3 \\u4E2D\\u7684\\u9AD8\\u7EA7\\u8F6E\\u8BE2\\u5B9E\\u73B0\\uFF0C\\u8BE6\\u7EC6\\u89E3\\u6790 usePoller \\u7EC4\\u5408\\u5F0F\\u51FD\\u6570\\u7684\\u8BBE\\u8BA1\\u4E0E\\u6E90\\u7801\\uFF0C\\u63D0\\u4F9B\\u591A\\u79CD\\u5B9E\\u7528\\u793A\\u4F8B\\u3002\",keywords:\"Vue 3, Composition API, \\u8F6E\\u8BE2, usePoller, \\u524D\\u7AEF\\u5F00\\u53D1, \\u54CD\\u5E94\\u5F0F\\u7F16\\u7A0B, JavaScript\",author:\"\\u6653\\u9F99\",image:\"/images/hero/vue3-polling.jpg\",tags:[\"Vue.js\",\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"\\u54CD\\u5E94\\u5F0F\\u7F16\\u7A0B\"],category:\"Vue.js\"};function o(e){let l={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",hr:\"hr\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.p,{children:[\"Vue 3 \\u7684 Composition API \\u4E3A\\u5F00\\u53D1\\u8005\\u63D0\\u4F9B\\u4E86\\u5F3A\\u5927\\u7684\\u5DE5\\u5177\\u6765\\u6784\\u5EFA\\u53EF\\u590D\\u7528\\u3001\\u53EF\\u7EF4\\u62A4\\u7684\\u903B\\u8F91\\u3002\\u5728\\u5B9E\\u9645\\u5F00\\u53D1\\u4E2D\\uFF0C\\u8F6E\\u8BE2\\uFF08Polling\\uFF09\\u662F\\u4E00\\u79CD\\u5E38\\u89C1\\u7684\\u573A\\u666F\\uFF0C\\u4F8B\\u5982\\u5B9E\\u65F6\\u83B7\\u53D6\\u670D\\u52A1\\u5668\\u72B6\\u6001\\u3001\\u66F4\\u65B0\\u4EEA\\u8868\\u76D8\\u6570\\u636E\\u6216\\u68C0\\u67E5\\u4EFB\\u52A1\\u8FDB\\u5EA6\\u3002\\u672C\\u7BC7\\u535A\\u5BA2\\u5C06\\u6DF1\\u5165\\u63A2\\u8BA8\\u5982\\u4F55\\u5728 Vue 3 \\u4E2D\\u5B9E\\u73B0\\u4E00\\u4E2A\\u9AD8\\u7EA7\\u8F6E\\u8BE2\\u89E3\\u51B3\\u65B9\\u6848\\u2014\\u2014\",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\" \\u7EC4\\u5408\\u5F0F\\u51FD\\u6570\\uFF0C\\u4ECE\\u9700\\u6C42\\u5206\\u6790\\u5230\\u6E90\\u7801\\u5B9E\\u73B0\\uFF0C\\u518D\\u5230\\u5B9E\\u9645\\u5E94\\u7528\\uFF0C\\u5E26\\u4F60\\u5168\\u9762\\u638C\\u63E1\\u8FD9\\u4E00\\u6280\\u672F\\u3002\"]}),`\n`,(0,n.jsx)(l.h2,{id:\"\\u4EC0\\u4E48\\u662F\\u8F6E\\u8BE2\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981-usepoller\",children:(0,n.jsx)(l.a,{href:\"#\\u4EC0\\u4E48\\u662F\\u8F6E\\u8BE2\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981-usepoller\",children:\"\\u4EC0\\u4E48\\u662F\\u8F6E\\u8BE2\\uFF1F\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981 usePoller\\uFF1F\"})}),`\n`,(0,n.jsx)(l.p,{children:\"\\u8F6E\\u8BE2\\u662F\\u6307\\u901A\\u8FC7\\u5B9A\\u65F6\\u53D1\\u8D77\\u8BF7\\u6C42\\u6765\\u83B7\\u53D6\\u6700\\u65B0\\u6570\\u636E\\u7684\\u6280\\u672F\\u3002\\u867D\\u7136 WebSocket \\u548C Server-Sent Events \\u5728\\u67D0\\u4E9B\\u5B9E\\u65F6\\u573A\\u666F\\u4E0B\\u66F4\\u9AD8\\u6548\\uFF0C\\u4F46\\u8F6E\\u8BE2\\u5728\\u5B9E\\u73B0\\u7B80\\u5355\\u3001\\u5BF9\\u670D\\u52A1\\u5668\\u8981\\u6C42\\u4F4E\\u3001\\u517C\\u5BB9\\u6027\\u5F3A\\u7B49\\u65B9\\u9762\\u4ECD\\u6709\\u4E0D\\u53EF\\u66FF\\u4EE3\\u7684\\u4F18\\u52BF\\u3002\"}),`\n`,(0,n.jsxs)(l.p,{children:[\"\\u7136\\u800C\\uFF0C\\u624B\\u52A8\\u5B9E\\u73B0\\u8F6E\\u8BE2\\u903B\\u8F91\\u53EF\\u80FD\\u4F1A\\u5BFC\\u81F4\\u4EE3\\u7801\\u5197\\u4F59\\u3001\\u96BE\\u4EE5\\u7EF4\\u62A4\\u3002\\u4F8B\\u5982\\uFF0C\\u4F60\\u53EF\\u80FD\\u9700\\u8981\\u5728 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"setInterval\"})})})}),\" \\u4E2D\\u8C03\\u7528 API\\uFF0C\\u624B\\u52A8\\u6E05\\u7406\\u5B9A\\u65F6\\u5668\\uFF0C\\u8FD8\\u8981\\u5904\\u7406\\u6682\\u505C\\u3001\\u6062\\u590D\\u3001\\u9519\\u8BEF\\u91CD\\u8BD5\\u7B49\\u529F\\u80FD\\u3002\",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\" \\u662F\\u4E00\\u4E2A\\u5C01\\u88C5\\u597D\\u7684\\u7EC4\\u5408\\u5F0F\\u51FD\\u6570\\uFF0C\\u65E8\\u5728\\u89E3\\u51B3\\u8FD9\\u4E9B\\u95EE\\u9898\\uFF0C\\u63D0\\u4F9B\\u5F00\\u7BB1\\u5373\\u7528\\u7684\\u8F6E\\u8BE2\\u80FD\\u529B\\u3002\"]}),`\n`,(0,n.jsx)(l.h2,{id:\"usepoller-\\u7684\\u8BBE\\u8BA1\\u76EE\\u6807\",children:(0,n.jsx)(l.a,{href:\"#usepoller-\\u7684\\u8BBE\\u8BA1\\u76EE\\u6807\",children:\"usePoller \\u7684\\u8BBE\\u8BA1\\u76EE\\u6807\"})}),`\n`,(0,n.jsxs)(l.p,{children:[\"\\u5728\\u6DF1\\u5165\\u5B9E\\u73B0\\u4E4B\\u524D\\uFF0C\\u6211\\u4EEC\\u5148\\u660E\\u786E \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\" \\u7684\\u8BBE\\u8BA1\\u76EE\\u6807\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ol,{children:[`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.strong,{children:\"\\u7075\\u6D3B\\u6027\"}),\"\\uFF1A\\u652F\\u6301\\u81EA\\u5B9A\\u4E49\\u8F6E\\u8BE2\\u95F4\\u9694\\u3001\\u505C\\u6B62\\u6761\\u4EF6\\u548C\\u56DE\\u8C03\\u51FD\\u6570\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.strong,{children:\"\\u54CD\\u5E94\\u5F0F\"}),\"\\uFF1A\\u4E0E Vue \\u7684\\u54CD\\u5E94\\u5F0F\\u7CFB\\u7EDF\\u96C6\\u6210\\uFF0C\\u652F\\u6301\\u52A8\\u6001\\u8C03\\u6574\\u53C2\\u6570\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.strong,{children:\"\\u751F\\u547D\\u5468\\u671F\\u7BA1\\u7406\"}),\"\\uFF1A\\u81EA\\u52A8\\u6E05\\u7406\\u5B9A\\u65F6\\u5668\\uFF0C\\u907F\\u514D\\u5185\\u5B58\\u6CC4\\u6F0F\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.strong,{children:\"\\u9519\\u8BEF\\u5904\\u7406\"}),\"\\uFF1A\\u5185\\u7F6E\\u91CD\\u8BD5\\u673A\\u5236\\u548C\\u9519\\u8BEF\\u72B6\\u6001\\u7BA1\\u7406\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.strong,{children:\"\\u53EF\\u63A7\\u6027\"}),\"\\uFF1A\\u63D0\\u4F9B\\u542F\\u52A8\\u3001\\u6682\\u505C\\u3001\\u91CD\\u542F\\u7B49\\u63A7\\u5236\\u65B9\\u6CD5\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(l.h2,{id:\"usepoller-\\u7684\\u57FA\\u672C\\u5B9E\\u73B0\",children:(0,n.jsx)(l.a,{href:\"#usepoller-\\u7684\\u57FA\\u672C\\u5B9E\\u73B0\",children:\"usePoller \\u7684\\u57FA\\u672C\\u5B9E\\u73B0\"})}),`\n`,(0,n.jsx)(l.p,{children:\"\\u8BA9\\u6211\\u4EEC\\u4ECE\\u4E00\\u4E2A\\u57FA\\u7840\\u7248\\u672C\\u5F00\\u59CB\\uFF0C\\u9010\\u6B65\\u6269\\u5C55\\u529F\\u80FD\\u3002\"}),`\n`,(0,n.jsx)(l.h3,{id:\"\\u57FA\\u7840\\u7248\\u672C\\u4EE3\\u7801\",children:(0,n.jsx)(l.a,{href:\"#\\u57FA\\u7840\\u7248\\u672C\\u4EE3\\u7801\",children:\"\\u57FA\\u7840\\u7248\\u672C\\u4EE3\\u7801\"})}),`\n`,(0,n.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { ref, onUnmounted } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" 'vue'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" usePoller\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"callback\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"interval\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 1000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" isPolling\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" ref\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"false\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  let\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" timer \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" null\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" start\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (isPolling.value) \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    isPolling.value \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" true\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    timer \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" setInterval\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"      callback\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    }, interval);\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" stop\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"!\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"isPolling.value) \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    isPolling.value \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" false\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"    clearInterval\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(timer);\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  onUnmounted\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"());\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { isPolling, start, stop };\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(l.h3,{id:\"\\u4F7F\\u7528\\u793A\\u4F8B\",children:(0,n.jsx)(l.a,{href:\"#\\u4F7F\\u7528\\u793A\\u4F8B\",children:\"\\u4F7F\\u7528\\u793A\\u4F8B\"})}),`\n`,(0,n.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { usePoller } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" './usePoller'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  setup\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      console.\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"'Fetching data...'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"isPolling\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"start\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" usePoller\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(fetchData, \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { isPolling, start, stop };\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsx)(l.p,{children:\"\\u5728\\u8FD9\\u4E2A\\u57FA\\u7840\\u7248\\u672C\\u4E2D\\uFF1A\"}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"callback\"})})})}),\" \\u662F\\u8F6E\\u8BE2\\u65F6\\u6267\\u884C\\u7684\\u51FD\\u6570\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"interval\"})})})}),\" \\u662F\\u8F6E\\u8BE2\\u95F4\\u9694\\uFF08\\u9ED8\\u8BA4 1000ms\\uFF09\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"isPolling\"})})})}),\" \\u662F\\u4E00\\u4E2A\\u54CD\\u5E94\\u5F0F\\u53D8\\u91CF\\uFF0C\\u8868\\u793A\\u8F6E\\u8BE2\\u72B6\\u6001\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"start\"})})})}),\" \\u548C \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"stop\"})})})}),\" \\u65B9\\u6CD5\\u5206\\u522B\\u542F\\u52A8\\u548C\\u505C\\u6B62\\u8F6E\\u8BE2\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"onUnmounted\"})})})}),\" \\u786E\\u4FDD\\u7EC4\\u4EF6\\u9500\\u6BC1\\u65F6\\u6E05\\u7406\\u5B9A\\u65F6\\u5668\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(l.h2,{id:\"\\u589E\\u5F3A\\u7248\\u5B9E\\u73B0\\u6E90\\u7801\\u6DF1\\u5EA6\\u89E3\\u6790\",children:(0,n.jsx)(l.a,{href:\"#\\u589E\\u5F3A\\u7248\\u5B9E\\u73B0\\u6E90\\u7801\\u6DF1\\u5EA6\\u89E3\\u6790\",children:\"\\u589E\\u5F3A\\u7248\\u5B9E\\u73B0\\uFF1A\\u6E90\\u7801\\u6DF1\\u5EA6\\u89E3\\u6790\"})}),`\n`,(0,n.jsx)(l.p,{children:\"\\u57FA\\u7840\\u7248\\u672C\\u867D\\u7136\\u53EF\\u7528\\uFF0C\\u4F46\\u5728\\u5B9E\\u9645\\u573A\\u666F\\u4E2D\\u8FDC\\u8FDC\\u4E0D\\u591F\\u3002\\u6211\\u4EEC\\u9700\\u8981\\u652F\\u6301\\u52A8\\u6001\\u95F4\\u9694\\u3001\\u9519\\u8BEF\\u91CD\\u8BD5\\u3001\\u6682\\u505C\\u6062\\u590D\\u7B49\\u529F\\u80FD\\u3002\\u4E0B\\u9762\\u662F\\u4E00\\u4E2A\\u589E\\u5F3A\\u7248\\u7684\\u5B9E\\u73B0\\uFF1A\"}),`\n`,(0,n.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { ref, reactive, onUnmounted, watch } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" 'vue'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" usePoller\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"callback\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"options\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {}) {\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u9ED8\\u8BA4\\u914D\\u7F6E\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" defaultOptions\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    interval: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"1000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",           \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u8F6E\\u8BE2\\u95F4\\u9694\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    immediate: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"false\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",         \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u662F\\u5426\\u7ACB\\u5373\\u6267\\u884C\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    maxRetries: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",            \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u6700\\u5927\\u91CD\\u8BD5\\u6B21\\u6570\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    retryDelay: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"500\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",          \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u91CD\\u8BD5\\u95F4\\u9694\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" config\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"...\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"defaultOptions, \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"...\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"options };\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u54CD\\u5E94\\u5F0F\\u72B6\\u6001\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" state\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" reactive\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    isPolling: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"false\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    error: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"null\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    retryCount: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    lastPollTime: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"null\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  let\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" timer \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" null\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u6267\\u884C\\u8F6E\\u8BE2\\u4EFB\\u52A1\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" poll\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    try\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      state.lastPollTime \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" Date.\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"now\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      await\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" callback\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      state.error \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" null\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      state.retryCount \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"; \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u91CD\\u7F6E\\u91CD\\u8BD5\\u8BA1\\u6570\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (err) {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      state.error \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" err;\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (state.retryCount \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"<\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" config.maxRetries) {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"        state.retryCount\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"++\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"        setTimeout\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(poll, config.retryDelay); \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u91CD\\u8BD5\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"else\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"        stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(); \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u8D85\\u51FA\\u91CD\\u8BD5\\u6B21\\u6570\\uFF0C\\u505C\\u6B62\\u8F6E\\u8BE2\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u542F\\u52A8\\u8F6E\\u8BE2\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" start\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (state.isPolling) \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    state.isPolling \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" true\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (config.immediate) \"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"poll\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(); \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u7ACB\\u5373\\u6267\\u884C\\u4E00\\u6B21\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    timer \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" setInterval\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(poll, config.interval);\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u505C\\u6B62\\u8F6E\\u8BE2\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" stop\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"!\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"state.isPolling) \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    state.isPolling \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" false\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"    clearInterval\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(timer);\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    timer \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" null\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u52A8\\u6001\\u8C03\\u6574\\u95F4\\u9694\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  watch\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" config.interval,\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    (\"}),(0,n.jsx)(l.span,{style:{color:\"#FFAB70\"},children:\"newInterval\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (state.isPolling) {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"        stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"        start\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  );\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"  // \\u7EC4\\u4EF6\\u5378\\u8F7D\\u65F6\\u6E05\\u7406\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  onUnmounted\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"());\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    isPolling: state.isPolling,\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    error: state.error,\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    retryCount: state.retryCount,\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    lastPollTime: state.lastPollTime,\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    start,\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    stop,\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(l.h3,{id:\"\\u6E90\\u7801\\u89E3\\u6790\",children:(0,n.jsx)(l.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,n.jsxs)(l.ol,{children:[`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u9009\\u9879\\u914D\\u7F6E\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsx)(l.li,{children:\"\\u4F7F\\u7528\\u5BF9\\u8C61\\u89E3\\u6784\\u5408\\u5E76\\u9ED8\\u8BA4\\u914D\\u7F6E\\u548C\\u7528\\u6237\\u4F20\\u5165\\u7684\\u9009\\u9879\\uFF0C\\u652F\\u6301\\u7075\\u6D3B\\u5B9A\\u5236\\u3002\"}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"immediate\"})})})}),\" \\u63A7\\u5236\\u662F\\u5426\\u5728\\u542F\\u52A8\\u65F6\\u7ACB\\u5373\\u6267\\u884C\\u4E00\\u6B21\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"maxRetries\"})})})}),\" \\u548C \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"retryDelay\"})})})}),\" \\u7528\\u4E8E\\u9519\\u8BEF\\u91CD\\u8BD5\\u3002\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u54CD\\u5E94\\u5F0F\\u72B6\\u6001\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[\"\\u4F7F\\u7528 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"reactive\"})})})}),\" \\u521B\\u5EFA\\u72B6\\u6001\\u5BF9\\u8C61\\uFF0C\\u5305\\u542B\\u8F6E\\u8BE2\\u72B6\\u6001\\u3001\\u9519\\u8BEF\\u4FE1\\u606F\\u3001\\u91CD\\u8BD5\\u6B21\\u6570\\u548C\\u4E0A\\u6B21\\u8F6E\\u8BE2\\u65F6\\u95F4\\u3002\"]}),`\n`,(0,n.jsxs)(l.li,{children:[\"\\u6BD4 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"ref\"})})})}),\" \\u66F4\\u9002\\u5408\\u7BA1\\u7406\\u591A\\u4E2A\\u76F8\\u5173\\u72B6\\u6001\\u3002\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u8F6E\\u8BE2\\u903B\\u8F91\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"poll\"})})})}),\" \\u51FD\\u6570\\u662F\\u6838\\u5FC3\\uFF0C\\u5F02\\u6B65\\u6267\\u884C \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"callback\"})})})}),\"\\uFF0C\\u5E76\\u5904\\u7406\\u6210\\u529F\\u548C\\u5931\\u8D25\\u903B\\u8F91\\u3002\"]}),`\n`,(0,n.jsx)(l.li,{children:\"\\u5931\\u8D25\\u65F6\\u6839\\u636E\\u91CD\\u8BD5\\u6B21\\u6570\\u51B3\\u5B9A\\u662F\\u91CD\\u8BD5\\u8FD8\\u662F\\u505C\\u6B62\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u52A8\\u6001\\u8C03\\u6574\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[\"\\u4F7F\\u7528 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"watch\"})})})}),\" \\u76D1\\u542C \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"interval\"})})})}),\" \\u53D8\\u5316\\uFF0C\\u81EA\\u52A8\\u91CD\\u542F\\u8F6E\\u8BE2\\u4EE5\\u5E94\\u7528\\u65B0\\u95F4\\u9694\\u3002\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u751F\\u547D\\u5468\\u671F\\u7BA1\\u7406\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"onUnmounted\"})})})}),\" \\u786E\\u4FDD\\u5B9A\\u65F6\\u5668\\u5728\\u7EC4\\u4EF6\\u9500\\u6BC1\\u65F6\\u6E05\\u7406\\u3002\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(l.h2,{id:\"\\u9AD8\\u7EA7\\u5E94\\u7528\\u793A\\u4F8B\",children:(0,n.jsx)(l.a,{href:\"#\\u9AD8\\u7EA7\\u5E94\\u7528\\u793A\\u4F8B\",children:\"\\u9AD8\\u7EA7\\u5E94\\u7528\\u793A\\u4F8B\"})}),`\n`,(0,n.jsx)(l.h3,{id:\"\\u793A\\u4F8B-1\\u52A8\\u6001\\u8C03\\u6574\\u8F6E\\u8BE2\\u95F4\\u9694\",children:(0,n.jsx)(l.a,{href:\"#\\u793A\\u4F8B-1\\u52A8\\u6001\\u8C03\\u6574\\u8F6E\\u8BE2\\u95F4\\u9694\",children:\"\\u793A\\u4F8B 1\\uFF1A\\u52A8\\u6001\\u8C03\\u6574\\u8F6E\\u8BE2\\u95F4\\u9694\"})}),`\n`,(0,n.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { ref } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" 'vue'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { usePoller } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" './usePoller'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  setup\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" interval\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" ref\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      console.\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"'Fetching data at'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"new\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" Date\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"toLocaleTimeString\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"());\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"start\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"isPolling\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" usePoller\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(fetchData, {\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      interval: interval.value,\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      immediate: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" changeInterval\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      interval.value \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 5000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"; \"}),(0,n.jsx)(l.span,{style:{color:\"#6A737D\"},children:\"// \\u52A8\\u6001\\u6539\\u4E3A 5 \\u79D2\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { start, stop, isPolling, changeInterval };\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsxs)(l.p,{children:[\"\\u5728\\u8FD9\\u4E2A\\u4F8B\\u5B50\\u4E2D\\uFF0C\\u7528\\u6237\\u53EF\\u4EE5\\u901A\\u8FC7 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"changeInterval\"})})})}),\" \\u52A8\\u6001\\u8C03\\u6574\\u8F6E\\u8BE2\\u95F4\\u9694\\uFF0C\",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\" \\u4F1A\\u81EA\\u52A8\\u91CD\\u542F\\u5B9A\\u65F6\\u5668\\u3002\"]}),`\n`,(0,n.jsx)(l.h3,{id:\"\\u793A\\u4F8B-2\\u9519\\u8BEF\\u91CD\\u8BD5\\u4E0E\\u72B6\\u6001\\u76D1\\u63A7\",children:(0,n.jsx)(l.a,{href:\"#\\u793A\\u4F8B-2\\u9519\\u8BEF\\u91CD\\u8BD5\\u4E0E\\u72B6\\u6001\\u76D1\\u63A7\",children:\"\\u793A\\u4F8B 2\\uFF1A\\u9519\\u8BEF\\u91CD\\u8BD5\\u4E0E\\u72B6\\u6001\\u76D1\\u63A7\"})}),`\n`,(0,n.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { usePoller } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" './usePoller'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  setup\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    let\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" failCount \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      if\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" (failCount \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"<\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"        failCount\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"++\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"        throw\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" Error\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"'Simulated failure'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      console.\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"'Data fetched successfully'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"start\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"error\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"retryCount\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" usePoller\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(fetchData, {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      interval: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"1000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      maxRetries: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      retryDelay: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"500\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"    start\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { error, retryCount };\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsxs)(l.p,{children:[\"\\u8FD9\\u91CC\\u6A21\\u62DF\\u4E86 API \\u524D\\u4E24\\u6B21\\u5931\\u8D25\\u7684\\u60C5\\u51B5\\uFF0C\",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\" \\u4F1A\\u81EA\\u52A8\\u91CD\\u8BD5\\uFF0C\\u5E76\\u5728\\u8D85\\u51FA\\u6700\\u5927\\u91CD\\u8BD5\\u6B21\\u6570\\u540E\\u505C\\u6B62\\u3002\"]}),`\n`,(0,n.jsx)(l.h3,{id:\"\\u793A\\u4F8B-3\\u4E0E-vuexpinia-\\u96C6\\u6210\",children:(0,n.jsx)(l.a,{href:\"#\\u793A\\u4F8B-3\\u4E0E-vuexpinia-\\u96C6\\u6210\",children:\"\\u793A\\u4F8B 3\\uFF1A\\u4E0E Vuex/Pinia \\u96C6\\u6210\"})}),`\n`,(0,n.jsx)(l.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(l.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { usePoller } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" './usePoller'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { useStore } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\" 'vuex'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"  setup\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" store\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" useStore\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" fetchStatus\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"      const\"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\" status\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" api.\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"getServerStatus\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      store.\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\"commit\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(l.span,{style:{color:\"#9ECBFF\"},children:\"'updateStatus'\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", status);\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"start\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"stop\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(l.span,{style:{color:\"#B392F0\"},children:\" usePoller\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"(fetchStatus, {\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      interval: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"      immediate: \"}),(0,n.jsx)(l.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(l.span,{\"data-line\":\"\",children:[(0,n.jsx)(l.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\" { start, stop };\"})]}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsx)(l.p,{children:\"\\u8FD9\\u4E2A\\u4F8B\\u5B50\\u5C55\\u793A\\u4E86\\u5982\\u4F55\\u5C06\\u8F6E\\u8BE2\\u6570\\u636E\\u4E0E\\u72B6\\u6001\\u7BA1\\u7406\\u5E93\\u96C6\\u6210\\uFF0C\\u9002\\u7528\\u4E8E\\u5B9E\\u65F6\\u4EEA\\u8868\\u76D8\\u7B49\\u573A\\u666F\\u3002\"}),`\n`,(0,n.jsx)(l.h2,{id:\"\\u6027\\u80FD\\u4F18\\u5316\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\",children:(0,n.jsx)(l.a,{href:\"#\\u6027\\u80FD\\u4F18\\u5316\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\",children:\"\\u6027\\u80FD\\u4F18\\u5316\\u4E0E\\u6CE8\\u610F\\u4E8B\\u9879\"})}),`\n`,(0,n.jsxs)(l.ol,{children:[`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u907F\\u514D\\u8FC7\\u591A\\u5B9A\\u65F6\\u5668\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\" \\u786E\\u4FDD\\u540C\\u4E00\\u5B9E\\u4F8B\\u53EA\\u6709\\u4E00\\u4E2A\\u5B9A\\u65F6\\u5668\\u8FD0\\u884C\\uFF0C\\u4F46\\u591A\\u4E2A\\u7EC4\\u4EF6\\u5B9E\\u4F8B\\u53EF\\u80FD\\u5BFC\\u81F4\\u8D44\\u6E90\\u6D6A\\u8D39\\u3002\\u8003\\u8651\\u5C06\\u8F6E\\u8BE2\\u903B\\u8F91\\u63D0\\u5347\\u5230\\u5168\\u5C40\\u72B6\\u6001\\u7BA1\\u7406\\u4E2D\\u3002\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u8282\\u6D41\\u4E0E\\u9632\\u6296\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[\"\\u5982\\u679C \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"callback\"})})})}),\" \\u6267\\u884C\\u65F6\\u95F4\\u8F83\\u957F\\uFF0C\\u53EF\\u4EE5\\u7ED3\\u5408\\u8282\\u6D41\\u6216\\u9632\\u6296\\u4F18\\u5316\\u3002\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(l.li,{children:[`\n`,(0,n.jsxs)(l.p,{children:[(0,n.jsx)(l.strong,{children:\"\\u670D\\u52A1\\u5668\\u538B\\u529B\"}),\"\\uFF1A\"]}),`\n`,(0,n.jsxs)(l.ul,{children:[`\n`,(0,n.jsxs)(l.li,{children:[\"\\u8F6E\\u8BE2\\u9891\\u7387\\u8FC7\\u9AD8\\u53EF\\u80FD\\u589E\\u52A0\\u670D\\u52A1\\u5668\\u8D1F\\u62C5\\uFF0C\\u5EFA\\u8BAE\\u6839\\u636E\\u5B9E\\u9645\\u9700\\u6C42\\u8C03\\u6574 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"interval\"})})})}),\"\\u3002\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(l.h2,{id:\"\\u7ED3\\u8BED\",children:(0,n.jsx)(l.a,{href:\"#\\u7ED3\\u8BED\",children:\"\\u7ED3\\u8BED\"})}),`\n`,(0,n.jsxs)(l.p,{children:[\"\\u901A\\u8FC7 \",(0,n.jsx)(l.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(l.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(l.span,{\"data-line\":\"\",children:(0,n.jsx)(l.span,{children:\"usePoller\"})})})}),\"\\uFF0C\\u6211\\u4EEC\\u4E0D\\u4EC5\\u7B80\\u5316\\u4E86\\u8F6E\\u8BE2\\u903B\\u8F91\\u7684\\u5B9E\\u73B0\\uFF0C\\u8FD8\\u901A\\u8FC7\\u54CD\\u5E94\\u5F0F\\u7279\\u6027\\u3001\\u9519\\u8BEF\\u5904\\u7406\\u548C\\u52A8\\u6001\\u8C03\\u6574\\u4F7F\\u5176\\u66F4\\u9002\\u5408\\u73B0\\u4EE3 Vue 3 \\u5E94\\u7528\\u3002\\u4ECE\\u57FA\\u7840\\u5B9E\\u73B0\\u5230\\u9AD8\\u7EA7\\u529F\\u80FD\\uFF0C\\u8FD9\\u7BC7\\u6587\\u7AE0\\u5C55\\u793A\\u4E86\\u5982\\u4F55\\u5229\\u7528 Composition API \\u6784\\u5EFA\\u5F3A\\u5927\\u4E14\\u53EF\\u590D\\u7528\\u7684\\u5DE5\\u5177\\u3002\\u5E0C\\u671B\\u8FD9\\u4E9B\\u4EE3\\u7801\\u548C\\u793A\\u4F8B\\u80FD\\u4E3A\\u4F60\\u7684\\u9879\\u76EE\\u63D0\\u4F9B\\u7075\\u611F\\uFF01\"]}),`\n`,(0,n.jsx)(l.p,{children:\"\\u5982\\u679C\\u4F60\\u6709\\u66F4\\u591A\\u9AD8\\u7EA7\\u9700\\u6C42\\uFF0C\\u6BD4\\u5982\\u6761\\u4EF6\\u505C\\u6B62\\u3001\\u81EA\\u5B9A\\u4E49\\u91CD\\u8BD5\\u7B56\\u7565\\uFF0C\\u4E0D\\u59A8 fork \\u8FD9\\u4EFD\\u4EE3\\u7801\\u5E76\\u6269\\u5C55\\u5B83\\u3002\\u6B22\\u8FCE\\u5728\\u8BC4\\u8BBA\\u533A\\u5206\\u4EAB\\u4F60\\u7684\\u5B9E\\u73B0\\uFF01\"}),`\n`,(0,n.jsx)(l.hr,{})]})}function h(e={}){let{wrapper:l}=e.components||{};return l?(0,n.jsx)(l,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}return m(x);})();\n;return Component;"
  },
  "_id": "Vue.js/usePoller组合式函数详解.mdx",
  "_raw": {
    "sourceFilePath": "Vue.js/usePoller组合式函数详解.mdx",
    "sourceFileName": "usePoller组合式函数详解.mdx",
    "sourceFileDir": "Vue.js",
    "contentType": "mdx",
    "flattenedPath": "Vue.js/usePoller组合式函数详解"
  },
  "type": "Post",
  "url": "/blog/Vue.js/usePoller组合式函数详解"
}