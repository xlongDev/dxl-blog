{
  "title": "Vite 避坑指南",
  "date": "2024-04-12T00:00:00.000Z",
  "description": "深入剖析 Vite 的使用技巧与常见问题，从源码层面解析其工作原理，助你避开开发中的坑。",
  "keywords": "Vite, 前端构建工具, ES Modules, Rollup, 热更新, HMR, 前端开发, 源码解析",
  "author": "晓龙",
  "image": "/images/hero/vite-guide.jpg",
  "tags": [
    "Vite",
    "前端开发",
    "构建工具"
  ],
  "views": 0,
  "likes": 0,
  "category": "Build-Tools",
  "body": {
    "raw": "\nVite 自从横空出世以来，凭借其对原生 ES Modules 的充分利用和极致的开发体验，迅速成为了前端开发者的心头好。相比传统的 Webpack，Vite 的“按需编译”和“零配置”特性让开发者直呼“真香”。然而，任何工具都不是银弹，Vite 在带来便利的同时，也隐藏着一些坑点。如果不了解其底层原理，踩坑几乎是不可避免的。\n\n本文将从实际开发经验出发，结合 Vite 的源码实现，带你全面剖析 Vite 的使用技巧和常见问题。不管你是新手还是老鸟，希望这篇指南都能让你少走弯路，甚至在面试时多一份谈资。\n\n## 什么是 Vite？简单回顾\n\nVite 是由尤雨溪（Vue 作者）主导开发的前端构建工具，它的核心理念是利用浏览器对 ES Modules（ESM）的原生支持，在开发环境下避免打包，直接让浏览器按需加载模块。而在生产环境下，Vite 则依赖 Rollup 进行打包优化，生成高效的静态资源。\n\n听起来很美好对吧？但实际用起来，你可能会遇到诸如 HMR（热更新）失效、依赖预构建失败、插件配置头疼等问题。别急，我们一步步来解剖这些“坑”。\n\n---\n\n## 一、开发环境的常见坑与应对\n\n### 1. HMR 不生效？文件路径和导入姿势要规范\n\nVite 的热更新（HMR）是其开发体验的核心亮点，但有时你会发现修改代码后页面毫无反应。别慌，这往往跟文件路径和导入方式有关。\n\n#### 问题复现\n假设你有以下项目结构：\n```\nsrc/\n  components/\n    Button.js\n  main.js\n```\n在 `main.js` 中，你这样导入：\n```javascript\nimport Button from './components/Button.js';\n```\n修改 `Button.js` 后，HMR 不生效。为什么？\n\n#### 源码解析\n我们来看 Vite 的 HMR 实现。Vite 的 HMR 基于 WebSocket，通过 `vite-plugin-hmr` 和客户端脚本监听文件变化。在 `server/ws.ts` 中，Vite 会监听文件变更并广播更新事件：\n```javascript\n// vite/src/node/server/ws.ts\nfunction handleFileChange(path: string) {\n  const mods = moduleGraph.getModulesByFile(path);\n  if (mods) {\n    hmrBoundary(mods);\n    send({\n      type: 'update',\n      updates: [...mods].map(mod => ({\n        type: 'js-update',\n        path: mod.url,\n        timestamp: Date.now(),\n      })),\n    });\n  }\n}\n```\n这里的 `moduleGraph` 是 Vite 维护的模块依赖图，路径必须精确匹配。如果你的导入路径不一致（比如带 `.js` 后缀 vs 不带），Vite 可能无法正确解析依赖关系，导致 HMR 失效。\n\n#### 解决方法\n- **统一导入风格**：推荐省略 `.js` 后缀，依靠 Vite 的自动解析。例如：\n  ```javascript\n  import Button from './components/Button';\n  ```\n- **检查大小写**：文件路径对大小写敏感，尤其在 Linux 系统上，`Button.js` 和 `button.js` 是不同的文件。\n- **启用 `strictFileSystem` 配置**：在 `vite.config.js` 中：\n  ```javascript\n  export default {\n    server: {\n      strictFileSystem: true,\n    },\n  };\n  ```\n  这会强制 Vite 检查文件路径的正确性，避免隐性错误。\n\n---\n\n### 2. 依赖预构建失败：node_modules 的“深坑”\n\nVite 在开发模式下会对 `node_modules` 中的依赖进行预构建（Pre-bundling），将 CommonJS 或 UMD 格式的模块转换为 ESM。但某些依赖可能触发奇怪的错误，比如“Cannot find module”或“SyntaxError”。\n\n#### 问题复现\n假设你安装了某个第三方库 `old-lib`，它的入口文件是 CommonJS 格式：\n```javascript\n// old-lib/index.js\nmodule.exports = { foo: 'bar' };\n```\n运行 `vite` 时，报错：\n```\n[vite] Failed to resolve entry for package \"old-lib\".\n```\n\n#### 源码解析\nVite 的预构建由 `esbuild` 驱动，具体逻辑在 `vite/src/node/optimizer/index.ts` 中：\n```javascript\nasync function optimizeDeps(config: ResolvedConfig) {\n  const deps = await scanImports(config);\n  await esbuild.build({\n    entryPoints: Object.keys(deps),\n    bundle: true,\n    format: 'esm',\n    outdir: config.cacheDir,\n  });\n}\n```\n如果依赖的 `package.json` 中 `main` 字段指向了一个不存在的文件，或者依赖内部有不符合 ESM 规范的代码，`esbuild` 就会报错。\n\n#### 解决方法\n- **手动指定入口**：在 `vite.config.js` 中配置 `optimizeDeps.include` 或 `optimizeDeps.exclude`：\n  ```javascript\n  export default {\n    optimizeDeps: {\n      include: ['old-lib'],\n      // 或强制跳过预构建\n      exclude: ['old-lib'],\n    },\n  };\n  ```\n- **检查依赖版本**：有些老旧依赖可能不兼容 Vite 的预构建，尝试升级到支持 ESM 的版本。\n- **调试预构建**：运行 `npx vite optimize --force`，强制重新预构建并查看详细日志。\n\n---\n\n## 二、生产环境的打包陷阱\n\n### 1. CSS 丢失：Rollup 的“阴谋”\n\nVite 在生产环境下使用 Rollup 打包，但有时你会发现部分 CSS 文件在最终输出中丢失，尤其是使用动态导入时。\n\n#### 问题复现\n假设你有以下代码：\n```javascript\nimport('./styles.css');\n```\n打包后，`styles.css` 并未出现在 `dist` 文件夹中。\n\n#### 源码解析\nRollup 默认只处理 JavaScript 文件，对动态导入的非 JS 资源需要额外插件支持。Vite 的打包逻辑在 `vite/src/node/build.ts` 中：\n```javascript\nasync function build(config: ResolvedConfig) {\n  const rollupOptions = config.build.rollupOptions;\n  const bundle = await rollup.rollup(rollupOptions);\n  await bundle.write(rollupOptions.output);\n}\n```\n如果没有配置对应的 CSS 处理插件，Rollup 会直接忽略这些文件。\n\n#### 解决方法\n- **使用 `vite-plugin-css-injected-by-js`**：安装插件并配置：\n  ```javascript\n  import cssInjectedByJs from 'vite-plugin-css-injected-by-js';\n\n  export default {\n    plugins: [cssInjectedByJs()],\n  };\n  ```\n- **静态导入 CSS**：将动态导入改为静态导入，确保 Rollup 能识别：\n  ```javascript\n  import './styles.css';\n  ```\n\n---\n\n### 2. Tree Shaking 不生效：别怪 Vite，要怪自己\n\nVite 宣称支持 Tree Shaking，但有时你会发现打包后的文件体积依然很大，明显有些没用到的代码没被移除。\n\n#### 问题复现\n```javascript\n// utils.js\nexport const used = () => console.log('used');\nexport const unused = () => console.log('unused');\n\n// main.js\nimport { used } from './utils.js';\nused();\n```\n打包后，`unused` 函数依然出现在输出中。\n\n#### 源码解析\nTree Shaking 依赖 Rollup 的能力，而 Rollup 要求代码必须是纯 ESM 且无副作用。Vite 在 `vite.config.js` 中通过 `build.rollupOptions` 传递配置：\n```javascript\nexport default {\n  build: {\n    rollupOptions: {\n      treeshake: true,\n    },\n  },\n};\n```\n但如果模块中有副作用（比如全局变量修改），Rollup 会保守地保留代码。\n\n#### 解决方法\n- **标记副作用**：在 `vite.config.js` 中指定哪些模块有副作用：\n  ```javascript\n  export default {\n    build: {\n      rollupOptions: {\n        treeshake: {\n          moduleSideEffects: ['**/utils.js'],\n        },\n      },\n    },\n  };\n  ```\n- **检查代码**：确保函数是纯函数，避免副作用。例如：\n  ```javascript\n  // utils.js\n  export const used = () => 'used'; // 纯函数\n  ```\n\n---\n\n## 三、插件开发的那些“坑爹”时刻\n\n### 1. 插件顺序导致冲突\n\nVite 的插件系统非常强大，但插件执行顺序不当可能导致功能失效。比如，一个插件提前修改了代码，导致后续插件无法识别。\n\n#### 问题复现\n你用了两个插件：\n```javascript\nimport pluginA from 'vite-plugin-a';\nimport pluginB from 'vite-plugin-b';\n\nexport default {\n  plugins: [pluginA(), pluginB()],\n};\n```\n结果 `pluginB` 的功能没生效。\n\n#### 源码解析\nVite 的插件执行遵循 `apply` 和 `enforce` 属性，源码在 `vite/src/node/plugins/index.ts`：\n```javascript\nfunction sortPlugins(plugins: Plugin[]) {\n  return plugins.sort((a, b) => {\n    if (a.enforce === 'pre' && b.enforce !== 'pre') return -1;\n    if (a.enforce !== 'pre' && b.enforce === 'pre') return 1;\n    return 0;\n  });\n}\n```\n默认情况下，插件按注册顺序执行，但 `enforce: 'pre'` 或 `'post'` 会改变优先级。\n\n#### 解决方法\n- **调整顺序**：明确指定插件执行顺序：\n  ```javascript\n  export default {\n    plugins: [\n      pluginA({ enforce: 'pre' }),\n      pluginB({ enforce: 'post' }),\n    ],\n  };\n  ```\n- **调试日志**：在插件中添加日志，确认执行顺序。\n\n---\n\n## 四、性能优化与调试技巧\n\n### 1. 启动慢？试试缓存和并行化\n\n项目大了之后，Vite 启动可能会变慢，尤其是在冷启动时。\n\n#### 解决方法\n- **启用缓存**：确保 `cacheDir` 未被禁用，默认在 `node_modules/.vite`。\n- **并行化预构建**：调整 `optimizeDeps.esbuildOptions`：\n  ```javascript\n  export default {\n    optimizeDeps: {\n      esbuildOptions: {\n        maxParallelFileOps: 10,\n      },\n    },\n  };\n  ```\n\n### 2. 日志太多？学会过滤\n\nVite 的默认日志很详细，有时反而干扰调试。可以通过 `logLevel` 控制：\n```javascript\nexport default {\n  logLevel: 'warn', // 只显示警告和错误\n};\n```\n\n---\n\n## 结语\n\nVite 是一个优雅且高效的构建工具，但它的优雅背后也隐藏着不少细节。通过本文，我们从 HMR、预构建、生产打包到插件开发，结合源码和实例，全面剖析了 Vite 的常见坑点。希望这些经验能帮你在使用 Vite 时少踩坑、多省心。\n\n如果你有其他疑问或踩过的坑，欢迎留言交流，毕竟“踩坑一时爽，填坑火葬场”。让我们一起在前端开发的道路上越走越远！\n```\n\n---",
    "code": "var Component=(()=>{var p=Object.create;var d=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var F=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),f=(l,e)=>{for(var a in e)d(l,a,{get:e[a],enumerable:!0})},t=(l,e,a,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of E(e))!u.call(l,r)&&r!==a&&d(l,r,{get:()=>e[r],enumerable:!(i=y(e,r))||i.enumerable});return l};var m=(l,e,a)=>(a=l!=null?p(g(l)):{},t(e||!l||!l.__esModule?d(a,\"default\",{value:l,enumerable:!0}):a,l)),b=l=>t(d({},\"__esModule\",{value:!0}),l);var s=F((j,c)=>{c.exports=_jsx_runtime});var k={};f(k,{default:()=>o,frontmatter:()=>x});var n=m(s()),x={type:\"Post\",title:\"Vite \\u907F\\u5751\\u6307\\u5357\",date:\"2024-04-12\",description:\"\\u6DF1\\u5165\\u5256\\u6790 Vite \\u7684\\u4F7F\\u7528\\u6280\\u5DE7\\u4E0E\\u5E38\\u89C1\\u95EE\\u9898\\uFF0C\\u4ECE\\u6E90\\u7801\\u5C42\\u9762\\u89E3\\u6790\\u5176\\u5DE5\\u4F5C\\u539F\\u7406\\uFF0C\\u52A9\\u4F60\\u907F\\u5F00\\u5F00\\u53D1\\u4E2D\\u7684\\u5751\\u3002\",keywords:\"Vite, \\u524D\\u7AEF\\u6784\\u5EFA\\u5DE5\\u5177, ES Modules, Rollup, \\u70ED\\u66F4\\u65B0, HMR, \\u524D\\u7AEF\\u5F00\\u53D1, \\u6E90\\u7801\\u89E3\\u6790\",author:\"\\u6653\\u9F99\",image:\"/images/hero/vite-guide.jpg\",tags:[\"Vite\",\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"\\u6784\\u5EFA\\u5DE5\\u5177\"],category:\"Build-Tools\"};function h(l){let e={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...l.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"Vite \\u81EA\\u4ECE\\u6A2A\\u7A7A\\u51FA\\u4E16\\u4EE5\\u6765\\uFF0C\\u51ED\\u501F\\u5176\\u5BF9\\u539F\\u751F ES Modules \\u7684\\u5145\\u5206\\u5229\\u7528\\u548C\\u6781\\u81F4\\u7684\\u5F00\\u53D1\\u4F53\\u9A8C\\uFF0C\\u8FC5\\u901F\\u6210\\u4E3A\\u4E86\\u524D\\u7AEF\\u5F00\\u53D1\\u8005\\u7684\\u5FC3\\u5934\\u597D\\u3002\\u76F8\\u6BD4\\u4F20\\u7EDF\\u7684 Webpack\\uFF0CVite \\u7684\\u201C\\u6309\\u9700\\u7F16\\u8BD1\\u201D\\u548C\\u201C\\u96F6\\u914D\\u7F6E\\u201D\\u7279\\u6027\\u8BA9\\u5F00\\u53D1\\u8005\\u76F4\\u547C\\u201C\\u771F\\u9999\\u201D\\u3002\\u7136\\u800C\\uFF0C\\u4EFB\\u4F55\\u5DE5\\u5177\\u90FD\\u4E0D\\u662F\\u94F6\\u5F39\\uFF0CVite \\u5728\\u5E26\\u6765\\u4FBF\\u5229\\u7684\\u540C\\u65F6\\uFF0C\\u4E5F\\u9690\\u85CF\\u7740\\u4E00\\u4E9B\\u5751\\u70B9\\u3002\\u5982\\u679C\\u4E0D\\u4E86\\u89E3\\u5176\\u5E95\\u5C42\\u539F\\u7406\\uFF0C\\u8E29\\u5751\\u51E0\\u4E4E\\u662F\\u4E0D\\u53EF\\u907F\\u514D\\u7684\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u672C\\u6587\\u5C06\\u4ECE\\u5B9E\\u9645\\u5F00\\u53D1\\u7ECF\\u9A8C\\u51FA\\u53D1\\uFF0C\\u7ED3\\u5408 Vite \\u7684\\u6E90\\u7801\\u5B9E\\u73B0\\uFF0C\\u5E26\\u4F60\\u5168\\u9762\\u5256\\u6790 Vite \\u7684\\u4F7F\\u7528\\u6280\\u5DE7\\u548C\\u5E38\\u89C1\\u95EE\\u9898\\u3002\\u4E0D\\u7BA1\\u4F60\\u662F\\u65B0\\u624B\\u8FD8\\u662F\\u8001\\u9E1F\\uFF0C\\u5E0C\\u671B\\u8FD9\\u7BC7\\u6307\\u5357\\u90FD\\u80FD\\u8BA9\\u4F60\\u5C11\\u8D70\\u5F2F\\u8DEF\\uFF0C\\u751A\\u81F3\\u5728\\u9762\\u8BD5\\u65F6\\u591A\\u4E00\\u4EFD\\u8C08\\u8D44\\u3002\"}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u4EC0\\u4E48\\u662F-vite\\u7B80\\u5355\\u56DE\\u987E\",children:(0,n.jsx)(e.a,{href:\"#\\u4EC0\\u4E48\\u662F-vite\\u7B80\\u5355\\u56DE\\u987E\",children:\"\\u4EC0\\u4E48\\u662F Vite\\uFF1F\\u7B80\\u5355\\u56DE\\u987E\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Vite \\u662F\\u7531\\u5C24\\u96E8\\u6EAA\\uFF08Vue \\u4F5C\\u8005\\uFF09\\u4E3B\\u5BFC\\u5F00\\u53D1\\u7684\\u524D\\u7AEF\\u6784\\u5EFA\\u5DE5\\u5177\\uFF0C\\u5B83\\u7684\\u6838\\u5FC3\\u7406\\u5FF5\\u662F\\u5229\\u7528\\u6D4F\\u89C8\\u5668\\u5BF9 ES Modules\\uFF08ESM\\uFF09\\u7684\\u539F\\u751F\\u652F\\u6301\\uFF0C\\u5728\\u5F00\\u53D1\\u73AF\\u5883\\u4E0B\\u907F\\u514D\\u6253\\u5305\\uFF0C\\u76F4\\u63A5\\u8BA9\\u6D4F\\u89C8\\u5668\\u6309\\u9700\\u52A0\\u8F7D\\u6A21\\u5757\\u3002\\u800C\\u5728\\u751F\\u4EA7\\u73AF\\u5883\\u4E0B\\uFF0CVite \\u5219\\u4F9D\\u8D56 Rollup \\u8FDB\\u884C\\u6253\\u5305\\u4F18\\u5316\\uFF0C\\u751F\\u6210\\u9AD8\\u6548\\u7684\\u9759\\u6001\\u8D44\\u6E90\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u542C\\u8D77\\u6765\\u5F88\\u7F8E\\u597D\\u5BF9\\u5427\\uFF1F\\u4F46\\u5B9E\\u9645\\u7528\\u8D77\\u6765\\uFF0C\\u4F60\\u53EF\\u80FD\\u4F1A\\u9047\\u5230\\u8BF8\\u5982 HMR\\uFF08\\u70ED\\u66F4\\u65B0\\uFF09\\u5931\\u6548\\u3001\\u4F9D\\u8D56\\u9884\\u6784\\u5EFA\\u5931\\u8D25\\u3001\\u63D2\\u4EF6\\u914D\\u7F6E\\u5934\\u75BC\\u7B49\\u95EE\\u9898\\u3002\\u522B\\u6025\\uFF0C\\u6211\\u4EEC\\u4E00\\u6B65\\u6B65\\u6765\\u89E3\\u5256\\u8FD9\\u4E9B\\u201C\\u5751\\u201D\\u3002\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u4E00\\u5F00\\u53D1\\u73AF\\u5883\\u7684\\u5E38\\u89C1\\u5751\\u4E0E\\u5E94\\u5BF9\",children:(0,n.jsx)(e.a,{href:\"#\\u4E00\\u5F00\\u53D1\\u73AF\\u5883\\u7684\\u5E38\\u89C1\\u5751\\u4E0E\\u5E94\\u5BF9\",children:\"\\u4E00\\u3001\\u5F00\\u53D1\\u73AF\\u5883\\u7684\\u5E38\\u89C1\\u5751\\u4E0E\\u5E94\\u5BF9\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"1-hmr-\\u4E0D\\u751F\\u6548\\u6587\\u4EF6\\u8DEF\\u5F84\\u548C\\u5BFC\\u5165\\u59FF\\u52BF\\u8981\\u89C4\\u8303\",children:(0,n.jsx)(e.a,{href:\"#1-hmr-\\u4E0D\\u751F\\u6548\\u6587\\u4EF6\\u8DEF\\u5F84\\u548C\\u5BFC\\u5165\\u59FF\\u52BF\\u8981\\u89C4\\u8303\",children:\"1. HMR \\u4E0D\\u751F\\u6548\\uFF1F\\u6587\\u4EF6\\u8DEF\\u5F84\\u548C\\u5BFC\\u5165\\u59FF\\u52BF\\u8981\\u89C4\\u8303\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Vite \\u7684\\u70ED\\u66F4\\u65B0\\uFF08HMR\\uFF09\\u662F\\u5176\\u5F00\\u53D1\\u4F53\\u9A8C\\u7684\\u6838\\u5FC3\\u4EAE\\u70B9\\uFF0C\\u4F46\\u6709\\u65F6\\u4F60\\u4F1A\\u53D1\\u73B0\\u4FEE\\u6539\\u4EE3\\u7801\\u540E\\u9875\\u9762\\u6BEB\\u65E0\\u53CD\\u5E94\\u3002\\u522B\\u614C\\uFF0C\\u8FD9\\u5F80\\u5F80\\u8DDF\\u6587\\u4EF6\\u8DEF\\u5F84\\u548C\\u5BFC\\u5165\\u65B9\\u5F0F\\u6709\\u5173\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u95EE\\u9898\\u590D\\u73B0\",children:(0,n.jsx)(e.a,{href:\"#\\u95EE\\u9898\\u590D\\u73B0\",children:\"\\u95EE\\u9898\\u590D\\u73B0\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5047\\u8BBE\\u4F60\\u6709\\u4EE5\\u4E0B\\u9879\\u76EE\\u7ED3\\u6784\\uFF1A\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"src/\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"  components/\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"    Button.js\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"  main.js\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"main.js\"})})})}),\" \\u4E2D\\uFF0C\\u4F60\\u8FD9\\u6837\\u5BFC\\u5165\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Button \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" './components/Button.js'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]})})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u4FEE\\u6539 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"Button.js\"})})})}),\" \\u540E\\uFF0CHMR \\u4E0D\\u751F\\u6548\\u3002\\u4E3A\\u4EC0\\u4E48\\uFF1F\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u6E90\\u7801\\u89E3\\u6790\",children:(0,n.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u6211\\u4EEC\\u6765\\u770B Vite \\u7684 HMR \\u5B9E\\u73B0\\u3002Vite \\u7684 HMR \\u57FA\\u4E8E WebSocket\\uFF0C\\u901A\\u8FC7 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite-plugin-hmr\"})})})}),\" \\u548C\\u5BA2\\u6237\\u7AEF\\u811A\\u672C\\u76D1\\u542C\\u6587\\u4EF6\\u53D8\\u5316\\u3002\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"server/ws.ts\"})})})}),\" \\u4E2D\\uFF0CVite \\u4F1A\\u76D1\\u542C\\u6587\\u4EF6\\u53D8\\u66F4\\u5E76\\u5E7F\\u64AD\\u66F4\\u65B0\\u4E8B\\u4EF6\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// vite/src/node/server/ws.ts\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"function\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" handleFileChange\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"path\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" string\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" mods\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" moduleGraph.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"getModulesByFile\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(path);\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (mods) {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"    hmrBoundary\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(mods);\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"    send\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      type: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'update'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      updates: [\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"...\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"mods].\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"map\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"mod\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" ({\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        type: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'js-update'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        path: mod.url,\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        timestamp: Date.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"now\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(),\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      })),\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u91CC\\u7684 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"moduleGraph\"})})})}),\" \\u662F Vite \\u7EF4\\u62A4\\u7684\\u6A21\\u5757\\u4F9D\\u8D56\\u56FE\\uFF0C\\u8DEF\\u5F84\\u5FC5\\u987B\\u7CBE\\u786E\\u5339\\u914D\\u3002\\u5982\\u679C\\u4F60\\u7684\\u5BFC\\u5165\\u8DEF\\u5F84\\u4E0D\\u4E00\\u81F4\\uFF08\\u6BD4\\u5982\\u5E26 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\".js\"})})})}),\" \\u540E\\u7F00 vs \\u4E0D\\u5E26\\uFF09\\uFF0CVite \\u53EF\\u80FD\\u65E0\\u6CD5\\u6B63\\u786E\\u89E3\\u6790\\u4F9D\\u8D56\\u5173\\u7CFB\\uFF0C\\u5BFC\\u81F4 HMR \\u5931\\u6548\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5\",children:(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5\",children:\"\\u89E3\\u51B3\\u65B9\\u6CD5\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u7EDF\\u4E00\\u5BFC\\u5165\\u98CE\\u683C\"}),\"\\uFF1A\\u63A8\\u8350\\u7701\\u7565 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\".js\"})})})}),\" \\u540E\\u7F00\\uFF0C\\u4F9D\\u9760 Vite \\u7684\\u81EA\\u52A8\\u89E3\\u6790\\u3002\\u4F8B\\u5982\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Button \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" './components/Button'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]})})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u68C0\\u67E5\\u5927\\u5C0F\\u5199\"}),\"\\uFF1A\\u6587\\u4EF6\\u8DEF\\u5F84\\u5BF9\\u5927\\u5C0F\\u5199\\u654F\\u611F\\uFF0C\\u5C24\\u5176\\u5728 Linux \\u7CFB\\u7EDF\\u4E0A\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"Button.js\"})})})}),\" \\u548C \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"button.js\"})})})}),\" \\u662F\\u4E0D\\u540C\\u7684\\u6587\\u4EF6\\u3002\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.strong,{children:[\"\\u542F\\u7528 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"strictFileSystem\"})})})}),\" \\u914D\\u7F6E\"]}),\"\\uFF1A\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite.config.js\"})})})}),\" \\u4E2D\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  server: {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    strictFileSystem: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,\"\\u8FD9\\u4F1A\\u5F3A\\u5236 Vite \\u68C0\\u67E5\\u6587\\u4EF6\\u8DEF\\u5F84\\u7684\\u6B63\\u786E\\u6027\\uFF0C\\u907F\\u514D\\u9690\\u6027\\u9519\\u8BEF\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h3,{id:\"2-\\u4F9D\\u8D56\\u9884\\u6784\\u5EFA\\u5931\\u8D25node_modules-\\u7684\\u6DF1\\u5751\",children:(0,n.jsx)(e.a,{href:\"#2-\\u4F9D\\u8D56\\u9884\\u6784\\u5EFA\\u5931\\u8D25node_modules-\\u7684\\u6DF1\\u5751\",children:\"2. \\u4F9D\\u8D56\\u9884\\u6784\\u5EFA\\u5931\\u8D25\\uFF1Anode_modules \\u7684\\u201C\\u6DF1\\u5751\\u201D\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vite \\u5728\\u5F00\\u53D1\\u6A21\\u5F0F\\u4E0B\\u4F1A\\u5BF9 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"node_modules\"})})})}),\" \\u4E2D\\u7684\\u4F9D\\u8D56\\u8FDB\\u884C\\u9884\\u6784\\u5EFA\\uFF08Pre-bundling\\uFF09\\uFF0C\\u5C06 CommonJS \\u6216 UMD \\u683C\\u5F0F\\u7684\\u6A21\\u5757\\u8F6C\\u6362\\u4E3A ESM\\u3002\\u4F46\\u67D0\\u4E9B\\u4F9D\\u8D56\\u53EF\\u80FD\\u89E6\\u53D1\\u5947\\u602A\\u7684\\u9519\\u8BEF\\uFF0C\\u6BD4\\u5982\\u201CCannot find module\\u201D\\u6216\\u201CSyntaxError\\u201D\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u95EE\\u9898\\u590D\\u73B0-1\",children:(0,n.jsx)(e.a,{href:\"#\\u95EE\\u9898\\u590D\\u73B0-1\",children:\"\\u95EE\\u9898\\u590D\\u73B0\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5047\\u8BBE\\u4F60\\u5B89\\u88C5\\u4E86\\u67D0\\u4E2A\\u7B2C\\u4E09\\u65B9\\u5E93 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"old-lib\"})})})}),\"\\uFF0C\\u5B83\\u7684\\u5165\\u53E3\\u6587\\u4EF6\\u662F CommonJS \\u683C\\u5F0F\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// old-lib/index.js\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"exports\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" { foo: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'bar'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" };\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u8FD0\\u884C \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite\"})})})}),\" \\u65F6\\uFF0C\\u62A5\\u9519\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:'[vite] Failed to resolve entry for package \"old-lib\".'})})})})}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u6E90\\u7801\\u89E3\\u6790-1\",children:(0,n.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-1\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vite \\u7684\\u9884\\u6784\\u5EFA\\u7531 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"esbuild\"})})})}),\" \\u9A71\\u52A8\\uFF0C\\u5177\\u4F53\\u903B\\u8F91\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite/src/node/optimizer/index.ts\"})})})}),\" \\u4E2D\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" optimizeDeps\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"config\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" ResolvedConfig\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" deps\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" scanImports\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(config);\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  await\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" esbuild.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"build\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    entryPoints: Object.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"keys\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(deps),\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    bundle: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    format: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'esm'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    outdir: config.cacheDir,\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u4F9D\\u8D56\\u7684 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"package.json\"})})})}),\" \\u4E2D \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"main\"})})})}),\" \\u5B57\\u6BB5\\u6307\\u5411\\u4E86\\u4E00\\u4E2A\\u4E0D\\u5B58\\u5728\\u7684\\u6587\\u4EF6\\uFF0C\\u6216\\u8005\\u4F9D\\u8D56\\u5185\\u90E8\\u6709\\u4E0D\\u7B26\\u5408 ESM \\u89C4\\u8303\\u7684\\u4EE3\\u7801\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"esbuild\"})})})}),\" \\u5C31\\u4F1A\\u62A5\\u9519\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5-1\",children:(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5-1\",children:\"\\u89E3\\u51B3\\u65B9\\u6CD5\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u624B\\u52A8\\u6307\\u5B9A\\u5165\\u53E3\"}),\"\\uFF1A\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite.config.js\"})})})}),\" \\u4E2D\\u914D\\u7F6E \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"optimizeDeps.include\"})})})}),\" \\u6216 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"optimizeDeps.exclude\"})})})}),\"\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  optimizeDeps: {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    include: [\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'old-lib'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"],\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    // \\u6216\\u5F3A\\u5236\\u8DF3\\u8FC7\\u9884\\u6784\\u5EFA\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    exclude: [\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'old-lib'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"],\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u68C0\\u67E5\\u4F9D\\u8D56\\u7248\\u672C\"}),\"\\uFF1A\\u6709\\u4E9B\\u8001\\u65E7\\u4F9D\\u8D56\\u53EF\\u80FD\\u4E0D\\u517C\\u5BB9 Vite \\u7684\\u9884\\u6784\\u5EFA\\uFF0C\\u5C1D\\u8BD5\\u5347\\u7EA7\\u5230\\u652F\\u6301 ESM \\u7684\\u7248\\u672C\\u3002\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u8C03\\u8BD5\\u9884\\u6784\\u5EFA\"}),\"\\uFF1A\\u8FD0\\u884C \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"npx vite optimize --force\"})})})}),\"\\uFF0C\\u5F3A\\u5236\\u91CD\\u65B0\\u9884\\u6784\\u5EFA\\u5E76\\u67E5\\u770B\\u8BE6\\u7EC6\\u65E5\\u5FD7\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u4E8C\\u751F\\u4EA7\\u73AF\\u5883\\u7684\\u6253\\u5305\\u9677\\u9631\",children:(0,n.jsx)(e.a,{href:\"#\\u4E8C\\u751F\\u4EA7\\u73AF\\u5883\\u7684\\u6253\\u5305\\u9677\\u9631\",children:\"\\u4E8C\\u3001\\u751F\\u4EA7\\u73AF\\u5883\\u7684\\u6253\\u5305\\u9677\\u9631\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"1-css-\\u4E22\\u5931rollup-\\u7684\\u9634\\u8C0B\",children:(0,n.jsx)(e.a,{href:\"#1-css-\\u4E22\\u5931rollup-\\u7684\\u9634\\u8C0B\",children:\"1. CSS \\u4E22\\u5931\\uFF1ARollup \\u7684\\u201C\\u9634\\u8C0B\\u201D\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Vite \\u5728\\u751F\\u4EA7\\u73AF\\u5883\\u4E0B\\u4F7F\\u7528 Rollup \\u6253\\u5305\\uFF0C\\u4F46\\u6709\\u65F6\\u4F60\\u4F1A\\u53D1\\u73B0\\u90E8\\u5206 CSS \\u6587\\u4EF6\\u5728\\u6700\\u7EC8\\u8F93\\u51FA\\u4E2D\\u4E22\\u5931\\uFF0C\\u5C24\\u5176\\u662F\\u4F7F\\u7528\\u52A8\\u6001\\u5BFC\\u5165\\u65F6\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u95EE\\u9898\\u590D\\u73B0-2\",children:(0,n.jsx)(e.a,{href:\"#\\u95EE\\u9898\\u590D\\u73B0-2\",children:\"\\u95EE\\u9898\\u590D\\u73B0\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5047\\u8BBE\\u4F60\\u6709\\u4EE5\\u4E0B\\u4EE3\\u7801\\uFF1A\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'./styles.css'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u6253\\u5305\\u540E\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"styles.css\"})})})}),\" \\u5E76\\u672A\\u51FA\\u73B0\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"dist\"})})})}),\" \\u6587\\u4EF6\\u5939\\u4E2D\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u6E90\\u7801\\u89E3\\u6790-2\",children:(0,n.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-2\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Rollup \\u9ED8\\u8BA4\\u53EA\\u5904\\u7406 JavaScript \\u6587\\u4EF6\\uFF0C\\u5BF9\\u52A8\\u6001\\u5BFC\\u5165\\u7684\\u975E JS \\u8D44\\u6E90\\u9700\\u8981\\u989D\\u5916\\u63D2\\u4EF6\\u652F\\u6301\\u3002Vite \\u7684\\u6253\\u5305\\u903B\\u8F91\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite/src/node/build.ts\"})})})}),\" \\u4E2D\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" function\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" build\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"config\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" ResolvedConfig\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" rollupOptions\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" config.build.rollupOptions;\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" bundle\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" rollup.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"rollup\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(rollupOptions);\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  await\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" bundle.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"write\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(rollupOptions.output);\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5982\\u679C\\u6CA1\\u6709\\u914D\\u7F6E\\u5BF9\\u5E94\\u7684 CSS \\u5904\\u7406\\u63D2\\u4EF6\\uFF0CRollup \\u4F1A\\u76F4\\u63A5\\u5FFD\\u7565\\u8FD9\\u4E9B\\u6587\\u4EF6\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5-2\",children:(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5-2\",children:\"\\u89E3\\u51B3\\u65B9\\u6CD5\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.strong,{children:[\"\\u4F7F\\u7528 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite-plugin-css-injected-by-js\"})})})})]}),\"\\uFF1A\\u5B89\\u88C5\\u63D2\\u4EF6\\u5E76\\u914D\\u7F6E\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" cssInjectedByJs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'vite-plugin-css-injected-by-js'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  plugins: [\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"cssInjectedByJs\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()],\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u9759\\u6001\\u5BFC\\u5165 CSS\"}),\"\\uFF1A\\u5C06\\u52A8\\u6001\\u5BFC\\u5165\\u6539\\u4E3A\\u9759\\u6001\\u5BFC\\u5165\\uFF0C\\u786E\\u4FDD Rollup \\u80FD\\u8BC6\\u522B\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" './styles.css'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]})})})}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h3,{id:\"2-tree-shaking-\\u4E0D\\u751F\\u6548\\u522B\\u602A-vite\\u8981\\u602A\\u81EA\\u5DF1\",children:(0,n.jsx)(e.a,{href:\"#2-tree-shaking-\\u4E0D\\u751F\\u6548\\u522B\\u602A-vite\\u8981\\u602A\\u81EA\\u5DF1\",children:\"2. Tree Shaking \\u4E0D\\u751F\\u6548\\uFF1A\\u522B\\u602A Vite\\uFF0C\\u8981\\u602A\\u81EA\\u5DF1\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Vite \\u5BA3\\u79F0\\u652F\\u6301 Tree Shaking\\uFF0C\\u4F46\\u6709\\u65F6\\u4F60\\u4F1A\\u53D1\\u73B0\\u6253\\u5305\\u540E\\u7684\\u6587\\u4EF6\\u4F53\\u79EF\\u4F9D\\u7136\\u5F88\\u5927\\uFF0C\\u660E\\u663E\\u6709\\u4E9B\\u6CA1\\u7528\\u5230\\u7684\\u4EE3\\u7801\\u6CA1\\u88AB\\u79FB\\u9664\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u95EE\\u9898\\u590D\\u73B0-3\",children:(0,n.jsx)(e.a,{href:\"#\\u95EE\\u9898\\u590D\\u73B0-3\",children:\"\\u95EE\\u9898\\u590D\\u73B0\"})}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// utils.js\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" const\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" used\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'used'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" const\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" unused\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'unused'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// main.js\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" { used } \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" './utils.js'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"used\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u6253\\u5305\\u540E\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"unused\"})})})}),\" \\u51FD\\u6570\\u4F9D\\u7136\\u51FA\\u73B0\\u5728\\u8F93\\u51FA\\u4E2D\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u6E90\\u7801\\u89E3\\u6790-3\",children:(0,n.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-3\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Tree Shaking \\u4F9D\\u8D56 Rollup \\u7684\\u80FD\\u529B\\uFF0C\\u800C Rollup \\u8981\\u6C42\\u4EE3\\u7801\\u5FC5\\u987B\\u662F\\u7EAF ESM \\u4E14\\u65E0\\u526F\\u4F5C\\u7528\\u3002Vite \\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite.config.js\"})})})}),\" \\u4E2D\\u901A\\u8FC7 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"build.rollupOptions\"})})})}),\" \\u4F20\\u9012\\u914D\\u7F6E\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  build: {\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    rollupOptions: {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      treeshake: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"true\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4F46\\u5982\\u679C\\u6A21\\u5757\\u4E2D\\u6709\\u526F\\u4F5C\\u7528\\uFF08\\u6BD4\\u5982\\u5168\\u5C40\\u53D8\\u91CF\\u4FEE\\u6539\\uFF09\\uFF0CRollup \\u4F1A\\u4FDD\\u5B88\\u5730\\u4FDD\\u7559\\u4EE3\\u7801\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5-3\",children:(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5-3\",children:\"\\u89E3\\u51B3\\u65B9\\u6CD5\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u6807\\u8BB0\\u526F\\u4F5C\\u7528\"}),\"\\uFF1A\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite.config.js\"})})})}),\" \\u4E2D\\u6307\\u5B9A\\u54EA\\u4E9B\\u6A21\\u5757\\u6709\\u526F\\u4F5C\\u7528\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  build: {\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    rollupOptions: {\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      treeshake: {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        moduleSideEffects: [\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'**/utils.js'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"],\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u68C0\\u67E5\\u4EE3\\u7801\"}),\"\\uFF1A\\u786E\\u4FDD\\u51FD\\u6570\\u662F\\u7EAF\\u51FD\\u6570\\uFF0C\\u907F\\u514D\\u526F\\u4F5C\\u7528\\u3002\\u4F8B\\u5982\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// utils.js\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" const\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" used\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'used'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"; \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u7EAF\\u51FD\\u6570\"})]})]})})}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u4E09\\u63D2\\u4EF6\\u5F00\\u53D1\\u7684\\u90A3\\u4E9B\\u5751\\u7239\\u65F6\\u523B\",children:(0,n.jsx)(e.a,{href:\"#\\u4E09\\u63D2\\u4EF6\\u5F00\\u53D1\\u7684\\u90A3\\u4E9B\\u5751\\u7239\\u65F6\\u523B\",children:\"\\u4E09\\u3001\\u63D2\\u4EF6\\u5F00\\u53D1\\u7684\\u90A3\\u4E9B\\u201C\\u5751\\u7239\\u201D\\u65F6\\u523B\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"1-\\u63D2\\u4EF6\\u987A\\u5E8F\\u5BFC\\u81F4\\u51B2\\u7A81\",children:(0,n.jsx)(e.a,{href:\"#1-\\u63D2\\u4EF6\\u987A\\u5E8F\\u5BFC\\u81F4\\u51B2\\u7A81\",children:\"1. \\u63D2\\u4EF6\\u987A\\u5E8F\\u5BFC\\u81F4\\u51B2\\u7A81\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Vite \\u7684\\u63D2\\u4EF6\\u7CFB\\u7EDF\\u975E\\u5E38\\u5F3A\\u5927\\uFF0C\\u4F46\\u63D2\\u4EF6\\u6267\\u884C\\u987A\\u5E8F\\u4E0D\\u5F53\\u53EF\\u80FD\\u5BFC\\u81F4\\u529F\\u80FD\\u5931\\u6548\\u3002\\u6BD4\\u5982\\uFF0C\\u4E00\\u4E2A\\u63D2\\u4EF6\\u63D0\\u524D\\u4FEE\\u6539\\u4E86\\u4EE3\\u7801\\uFF0C\\u5BFC\\u81F4\\u540E\\u7EED\\u63D2\\u4EF6\\u65E0\\u6CD5\\u8BC6\\u522B\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u95EE\\u9898\\u590D\\u73B0-4\",children:(0,n.jsx)(e.a,{href:\"#\\u95EE\\u9898\\u590D\\u73B0-4\",children:\"\\u95EE\\u9898\\u590D\\u73B0\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4F60\\u7528\\u4E86\\u4E24\\u4E2A\\u63D2\\u4EF6\\uFF1A\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" pluginA \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'vite-plugin-a'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" pluginB \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'vite-plugin-b'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  plugins: [\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"pluginA\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(), \"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"pluginB\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()],\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u7ED3\\u679C \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"pluginB\"})})})}),\" \\u7684\\u529F\\u80FD\\u6CA1\\u751F\\u6548\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u6E90\\u7801\\u89E3\\u6790-4\",children:(0,n.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-4\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vite \\u7684\\u63D2\\u4EF6\\u6267\\u884C\\u9075\\u5FAA \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"apply\"})})})}),\" \\u548C \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"enforce\"})})})}),\" \\u5C5E\\u6027\\uFF0C\\u6E90\\u7801\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"vite/src/node/plugins/index.ts\"})})})}),\"\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"function\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" sortPlugins\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"plugins\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Plugin\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"[]) {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" plugins.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"sort\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"a\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"b\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (a.enforce \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"===\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'pre'\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" &&\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" b.enforce \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"!==\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'pre'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (a.enforce \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"!==\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'pre'\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" &&\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" b.enforce \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"===\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" 'pre'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"return\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u9ED8\\u8BA4\\u60C5\\u51B5\\u4E0B\\uFF0C\\u63D2\\u4EF6\\u6309\\u6CE8\\u518C\\u987A\\u5E8F\\u6267\\u884C\\uFF0C\\u4F46 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"enforce: 'pre'\"})})})}),\" \\u6216 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"'post'\"})})})}),\" \\u4F1A\\u6539\\u53D8\\u4F18\\u5148\\u7EA7\\u3002\"]}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5-4\",children:(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5-4\",children:\"\\u89E3\\u51B3\\u65B9\\u6CD5\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u8C03\\u6574\\u987A\\u5E8F\"}),\"\\uFF1A\\u660E\\u786E\\u6307\\u5B9A\\u63D2\\u4EF6\\u6267\\u884C\\u987A\\u5E8F\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  plugins: [\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"    pluginA\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({ enforce: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'pre'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" }),\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"    pluginB\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({ enforce: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'post'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" }),\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  ],\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u8C03\\u8BD5\\u65E5\\u5FD7\"}),\"\\uFF1A\\u5728\\u63D2\\u4EF6\\u4E2D\\u6DFB\\u52A0\\u65E5\\u5FD7\\uFF0C\\u786E\\u8BA4\\u6267\\u884C\\u987A\\u5E8F\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u56DB\\u6027\\u80FD\\u4F18\\u5316\\u4E0E\\u8C03\\u8BD5\\u6280\\u5DE7\",children:(0,n.jsx)(e.a,{href:\"#\\u56DB\\u6027\\u80FD\\u4F18\\u5316\\u4E0E\\u8C03\\u8BD5\\u6280\\u5DE7\",children:\"\\u56DB\\u3001\\u6027\\u80FD\\u4F18\\u5316\\u4E0E\\u8C03\\u8BD5\\u6280\\u5DE7\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"1-\\u542F\\u52A8\\u6162\\u8BD5\\u8BD5\\u7F13\\u5B58\\u548C\\u5E76\\u884C\\u5316\",children:(0,n.jsx)(e.a,{href:\"#1-\\u542F\\u52A8\\u6162\\u8BD5\\u8BD5\\u7F13\\u5B58\\u548C\\u5E76\\u884C\\u5316\",children:\"1. \\u542F\\u52A8\\u6162\\uFF1F\\u8BD5\\u8BD5\\u7F13\\u5B58\\u548C\\u5E76\\u884C\\u5316\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u9879\\u76EE\\u5927\\u4E86\\u4E4B\\u540E\\uFF0CVite \\u542F\\u52A8\\u53EF\\u80FD\\u4F1A\\u53D8\\u6162\\uFF0C\\u5C24\\u5176\\u662F\\u5728\\u51B7\\u542F\\u52A8\\u65F6\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{id:\"\\u89E3\\u51B3\\u65B9\\u6CD5-5\",children:(0,n.jsx)(e.a,{href:\"#\\u89E3\\u51B3\\u65B9\\u6CD5-5\",children:\"\\u89E3\\u51B3\\u65B9\\u6CD5\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u542F\\u7528\\u7F13\\u5B58\"}),\"\\uFF1A\\u786E\\u4FDD \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"cacheDir\"})})})}),\" \\u672A\\u88AB\\u7981\\u7528\\uFF0C\\u9ED8\\u8BA4\\u5728 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"node_modules/.vite\"})})})}),\"\\u3002\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u5E76\\u884C\\u5316\\u9884\\u6784\\u5EFA\"}),\"\\uFF1A\\u8C03\\u6574 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"optimizeDeps.esbuildOptions\"})})})}),\"\\uFF1A\",`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  optimizeDeps: {\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    esbuildOptions: {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      maxParallelFileOps: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  },\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.h3,{id:\"2-\\u65E5\\u5FD7\\u592A\\u591A\\u5B66\\u4F1A\\u8FC7\\u6EE4\",children:(0,n.jsx)(e.a,{href:\"#2-\\u65E5\\u5FD7\\u592A\\u591A\\u5B66\\u4F1A\\u8FC7\\u6EE4\",children:\"2. \\u65E5\\u5FD7\\u592A\\u591A\\uFF1F\\u5B66\\u4F1A\\u8FC7\\u6EE4\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vite \\u7684\\u9ED8\\u8BA4\\u65E5\\u5FD7\\u5F88\\u8BE6\\u7EC6\\uFF0C\\u6709\\u65F6\\u53CD\\u800C\\u5E72\\u6270\\u8C03\\u8BD5\\u3002\\u53EF\\u4EE5\\u901A\\u8FC7 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"logLevel\"})})})}),\" \\u63A7\\u5236\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" default\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  logLevel: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'warn'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u53EA\\u663E\\u793A\\u8B66\\u544A\\u548C\\u9519\\u8BEF\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u7ED3\\u8BED\",children:(0,n.jsx)(e.a,{href:\"#\\u7ED3\\u8BED\",children:\"\\u7ED3\\u8BED\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Vite \\u662F\\u4E00\\u4E2A\\u4F18\\u96C5\\u4E14\\u9AD8\\u6548\\u7684\\u6784\\u5EFA\\u5DE5\\u5177\\uFF0C\\u4F46\\u5B83\\u7684\\u4F18\\u96C5\\u80CC\\u540E\\u4E5F\\u9690\\u85CF\\u7740\\u4E0D\\u5C11\\u7EC6\\u8282\\u3002\\u901A\\u8FC7\\u672C\\u6587\\uFF0C\\u6211\\u4EEC\\u4ECE HMR\\u3001\\u9884\\u6784\\u5EFA\\u3001\\u751F\\u4EA7\\u6253\\u5305\\u5230\\u63D2\\u4EF6\\u5F00\\u53D1\\uFF0C\\u7ED3\\u5408\\u6E90\\u7801\\u548C\\u5B9E\\u4F8B\\uFF0C\\u5168\\u9762\\u5256\\u6790\\u4E86 Vite \\u7684\\u5E38\\u89C1\\u5751\\u70B9\\u3002\\u5E0C\\u671B\\u8FD9\\u4E9B\\u7ECF\\u9A8C\\u80FD\\u5E2E\\u4F60\\u5728\\u4F7F\\u7528 Vite \\u65F6\\u5C11\\u8E29\\u5751\\u3001\\u591A\\u7701\\u5FC3\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5982\\u679C\\u4F60\\u6709\\u5176\\u4ED6\\u7591\\u95EE\\u6216\\u8E29\\u8FC7\\u7684\\u5751\\uFF0C\\u6B22\\u8FCE\\u7559\\u8A00\\u4EA4\\u6D41\\uFF0C\\u6BD5\\u7ADF\\u201C\\u8E29\\u5751\\u4E00\\u65F6\\u723D\\uFF0C\\u586B\\u5751\\u706B\\u846C\\u573A\\u201D\\u3002\\u8BA9\\u6211\\u4EEC\\u4E00\\u8D77\\u5728\\u524D\\u7AEF\\u5F00\\u53D1\\u7684\\u9053\\u8DEF\\u4E0A\\u8D8A\\u8D70\\u8D8A\\u8FDC\\uFF01\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"---\"})})]})})})]})}function o(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,{...l,children:(0,n.jsx)(h,{...l})}):h(l)}return b(k);})();\n;return Component;"
  },
  "_id": "Build-Tools/Vite避坑指南.mdx",
  "_raw": {
    "sourceFilePath": "Build-Tools/Vite避坑指南.mdx",
    "sourceFileName": "Vite避坑指南.mdx",
    "sourceFileDir": "Build-Tools",
    "contentType": "mdx",
    "flattenedPath": "Build-Tools/Vite避坑指南"
  },
  "type": "Post",
  "url": "/blog/Build-Tools/Vite避坑指南"
}