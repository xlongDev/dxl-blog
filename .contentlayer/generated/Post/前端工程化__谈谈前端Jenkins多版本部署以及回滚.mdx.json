{
  "title": "è°ˆè°ˆå‰ç«¯ Jenkins å¤šç‰ˆæœ¬éƒ¨ç½²ä»¥åŠå›žæ»š",
  "date": "2023-02-02T00:00:00.000Z",
  "description": "æ·±å…¥æŽ¢è®¨å‰ç«¯é¡¹ç›®å¦‚ä½•åˆ©ç”¨ Jenkins å®žçŽ°å¤šç‰ˆæœ¬éƒ¨ç½²ä¸Žå›žæ»šï¼Œå‰–æžåŽŸç†ï¼Œåˆ†äº«æœ€ä½³å®žè·µï¼Œå¸¦ä½ ä»Žå®¹åº”å¯¹ç”Ÿäº§çŽ¯å¢ƒçš„æŒ‘æˆ˜ã€‚",
  "keywords": "Jenkins, å‰ç«¯éƒ¨ç½², å¤šç‰ˆæœ¬éƒ¨ç½², å›žæ»š, CI/CD, è‡ªåŠ¨åŒ–éƒ¨ç½², DevOps, å‰ç«¯å·¥ç¨‹åŒ–",
  "author": "æ™“é¾™",
  "image": "/images/hero/jenkins-deployment.jpg",
  "tags": [
    "Jenkins",
    "å‰ç«¯å¼€å‘",
    "CI/CD",
    "DevOps"
  ],
  "views": 0,
  "likes": 0,
  "category": "å‰ç«¯å·¥ç¨‹åŒ–",
  "body": {
    "raw": "\nåœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œéƒ¨ç½²ä»Žæ¥ä¸æ˜¯ä¸€ä»¶å°äº‹ã€‚å°¤å…¶æ˜¯å½“é¡¹ç›®è§„æ¨¡å˜å¤§ã€è¿­ä»£é¢‘ç¹ã€å›¢é˜Ÿåä½œå¤æ‚æ—¶ï¼Œå¦‚ä½•ç¡®ä¿ä»£ç å¹³ç¨³ä¸Šçº¿ï¼Œåˆèƒ½åœ¨å‡ºé”™æ—¶å¿«é€Ÿå›žæ»šï¼Œæˆäº†æ¯ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆå’Œ DevOps å°ä¼™ä¼´å¿ƒä¸­çš„â€œç»ˆæžå‘½é¢˜â€ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œä½ èŠèŠå¦‚ä½•å€ŸåŠ© Jenkins è¿™ä¸ªâ€œè€æœ‹å‹â€ï¼Œå®žçŽ°å‰ç«¯é¡¹ç›®çš„å¤šç‰ˆæœ¬éƒ¨ç½²ä¸Žå›žæ»šã€‚ä¸ä»…ä¼šæ·±å…¥åŽŸç†ï¼Œè¿˜ä¼šç»“åˆæˆ‘çš„ç»éªŒï¼ŒæŠ›å‡ºä¸€äº›å®žç”¨æŠ€å·§å’Œè¸©å‘è®°å½•ï¼Œå¸¦ç‚¹ emoji è°ƒå‰‚ä¸€ä¸‹æ°”æ°› ðŸ˜Žã€‚\n\n## ä¸ºä»€ä¹ˆéœ€è¦å¤šç‰ˆæœ¬éƒ¨ç½²ï¼Ÿ\n\næƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä¸ªåŽ¨å¸ˆï¼Œåˆšåšäº†ä¸€é“æ–°èœç«¯ä¸Šæ¡Œï¼Œé¡¾å®¢å°äº†ä¸€å£è¯´ï¼šâ€œè¿™å•¥å‘€ï¼Œå¤ªå’¸äº†ï¼â€ ä½ æ€»ä¸èƒ½ç›´æŽ¥æŠŠèœæ‰”äº†é‡åšå§ï¼Ÿèªæ˜Žçš„åšæ³•æ˜¯ï¼Œæ—è¾¹å¤‡ç€ä¸Šä¸€é“â€œé è°±â€çš„èœï¼Œéšæ—¶å¯ä»¥ç«¯ä¸Šæ¥æ•‘åœºã€‚è¿™å°±æ˜¯å¤šç‰ˆæœ¬éƒ¨ç½²çš„æ„ä¹‰â€”â€”**è®©æ–°ç‰ˆæœ¬å’Œæ—§ç‰ˆæœ¬å…±å­˜ï¼Œæ—¢èƒ½å¤§èƒ†å°è¯•æ–°åŠŸèƒ½ï¼Œåˆèƒ½åœ¨é—®é¢˜å‡ºçŽ°æ—¶è¿…é€Ÿåˆ‡æ¢å›žç¨³å®šç‰ˆæœ¬**ã€‚\n\nåœ¨å‰ç«¯é¢†åŸŸï¼Œå¤šç‰ˆæœ¬éƒ¨ç½²å¸¸è§äºŽä»¥ä¸‹åœºæ™¯ï¼š\n- **ç°åº¦å‘å¸ƒ**ï¼šåªè®©ä¸€éƒ¨åˆ†ç”¨æˆ·çœ‹åˆ°æ–°ç‰ˆæœ¬ï¼ŒéªŒè¯æ²¡é—®é¢˜å†å…¨é‡ä¸Šçº¿ã€‚\n- **å¿«é€Ÿå›žæ»š**ï¼šæ–°ç‰ˆæœ¬ä¸Šçº¿åŽå‘çŽ° bugï¼Œèƒ½ç«‹åˆ»åˆ‡å›žæ—§ç‰ˆæœ¬ã€‚\n- **A/B æµ‹è¯•**ï¼šåŒæ—¶è¿è¡Œå¤šä¸ªç‰ˆæœ¬ï¼Œæ¯”è¾ƒç”¨æˆ·ä½“éªŒæˆ–è½¬åŒ–çŽ‡ã€‚\n\nJenkins ä½œä¸º CI/CD çš„â€œç‘žå£«å†›åˆ€â€ï¼Œå¤©ç„¶é€‚åˆå¹²è¿™ä¸ªæ´»å„¿ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»ŽåŽŸç†åˆ°å®žè·µï¼Œä¸€æ­¥æ­¥æ‹†è§£ã€‚\n\n---\n\n## Jenkins å¤šç‰ˆæœ¬éƒ¨ç½²çš„åŽŸç†\n\nJenkins çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥ä½œæµå¼•æ“Žï¼Œé€šè¿‡ Pipelineï¼ˆæµæ°´çº¿ï¼‰ä¸²è”èµ·ä»£ç æž„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ç­‰æ­¥éª¤ã€‚è¦å®žçŽ°å¤šç‰ˆæœ¬éƒ¨ç½²ï¼Œå…³é”®åœ¨äºŽä»¥ä¸‹å‡ ç‚¹ï¼š\n\n### 1. ç‰ˆæœ¬åŒ–æž„å»ºè¾“å‡º\næ¯æ¬¡æž„å»ºæ—¶ï¼ŒJenkins éœ€è¦ä¸ºå‰ç«¯é¡¹ç›®ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰ç‰ˆæœ¬å·çš„é™æ€èµ„æºåŒ…ã€‚æ¯”å¦‚ `dist-v1.0.0/`ã€`dist-v1.0.1/`ï¼Œè¿™æ ·ä¸åŒçš„ç‰ˆæœ¬å¯ä»¥ç‹¬ç«‹å­˜å‚¨ï¼Œä¸ä¼šäº’ç›¸è¦†ç›–ã€‚\n\n### 2. æœåŠ¡å™¨ä¸Šçš„ç‰ˆæœ¬ç®¡ç†\næž„å»ºå¥½çš„èµ„æºéœ€è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆæ¯”å¦‚ Nginxï¼‰ï¼Œå¹¶é€šè¿‡æŸç§æœºåˆ¶ï¼ˆå¦‚ç¬¦å·é“¾æŽ¥æˆ–è·¯ç”±é…ç½®ï¼‰æŒ‡å®šå½“å‰â€œæ´»è·ƒâ€ç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼š\n- `/var/www/app/current` æŒ‡å‘ `dist-v1.0.0/`ã€‚\n- æ–°ç‰ˆæœ¬ä¸Šçº¿åŽï¼Œ`current` åˆ‡æ¢åˆ° `dist-v1.0.1/`ã€‚\n\n### 3. å›žæ»šæœºåˆ¶\nå›žæ»šæœ¬è´¨ä¸Šæ˜¯â€œç‰ˆæœ¬åˆ‡æ¢â€ã€‚Jenkins éœ€è¦è®°å½•åŽ†å²ç‰ˆæœ¬ï¼Œå¹¶åœ¨éœ€è¦æ—¶å¿«é€Ÿè°ƒæ•´æœåŠ¡å™¨é…ç½®ï¼ŒæŒ‡å‘æ—§ç‰ˆæœ¬ã€‚\n\nè¿™å¬èµ·æ¥åƒä¸åƒåœ¨çŽ©â€œä¿„ç½—æ–¯å¥—å¨ƒâ€ï¼Ÿä¸€å±‚å¥—ä¸€å±‚ï¼Œä½†æ¯å±‚éƒ½æœ‰è‡ªå·±çš„ç¼–å·ï¼Œéšæ—¶å¯ä»¥æ‹Žå‡ºæ¥ç”¨ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å…·ä½“æ€Žä¹ˆå®žçŽ°ã€‚\n\n---\n\n## å®žçŽ°å¤šç‰ˆæœ¬éƒ¨ç½²çš„æ­¥éª¤\n\nå‡è®¾æˆ‘ä»¬æœ‰ä¸ª React é¡¹ç›®ï¼Œç”¨ Jenkins éƒ¨ç½²åˆ°ä¸€å° Nginx æœåŠ¡å™¨ä¸Šã€‚ä¸‹é¢æ˜¯æˆ‘çš„å®žæˆ˜æµç¨‹ï¼Œå°½é‡è¯¦ç»†ï¼Œå¸¦ç‚¹ä»£ç å’Œä¾‹å­ã€‚\n\n### 1. é…ç½® Jenkins Pipeline\nJenkins çš„ Pipeline å¯ä»¥ç”¨ `Jenkinsfile` å†™æˆå£°æ˜Žå¼è„šæœ¬ã€‚æˆ‘é€šå¸¸ä¼šè¿™ä¹ˆç»„ç»‡ï¼š\n\n```groovy\npipeline {\n  agent any\n  environment {\n    VERSION = \"${env.BUILD_NUMBER}\" // ç”¨æž„å»ºå·ä½œä¸ºç‰ˆæœ¬å·ï¼Œæ¯”å¦‚ 101\n    DEPLOY_DIR = \"/var/www/app/dist-v${VERSION}\"\n    CURRENT_DIR = \"/var/www/app/current\"\n  }\n  stages {\n    stage('Install') {\n      steps {\n        sh 'npm install'\n      }\n    }\n    stage('Build') {\n      steps {\n        sh 'npm run build'\n        sh \"mv dist ${DEPLOY_DIR}\" // é‡å‘½åè¾“å‡ºç›®å½•å¸¦ç‰ˆæœ¬å·\n      }\n    }\n    stage('Deploy') {\n      steps {\n        sh \"scp -r ${DEPLOY_DIR} user@server:/var/www/app/\"\n        sh \"ssh user@server 'ln -sfn ${DEPLOY_DIR} ${CURRENT_DIR}'\" // æ›´æ–°ç¬¦å·é“¾æŽ¥\n      }\n    }\n  }\n}\n```\n\nè¿™é‡Œç”¨äº† `BUILD_NUMBER` ä½œä¸ºç‰ˆæœ¬å·ï¼Œæ¯æ¬¡æž„å»ºè‡ªåŠ¨é€’å¢žã€‚`ln -sfn` æ˜¯ Linux çš„ç¬¦å·é“¾æŽ¥å‘½ä»¤ï¼Œ`-f` è¡¨ç¤ºå¼ºåˆ¶è¦†ç›–ï¼Œ`-n` ç¡®ä¿ç›®æ ‡æ˜¯ä¸ªç›®å½•æ—¶ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚\n\n### 2. Nginx é…ç½®\næœåŠ¡å™¨ä¸Šï¼ŒNginx éœ€è¦æŒ‡å‘ `current` ç›®å½•ï¼š\n\n```nginx\nserver {\n  listen 80;\n  server_name example.com;\n\n  location / {\n    root /var/www/app/current;\n    try_files $uri $uri/ /index.html; // æ”¯æŒå‰ç«¯è·¯ç”±\n  }\n}\n```\n\nä¸Šçº¿æ–°ç‰ˆæœ¬æ—¶ï¼Œç¬¦å·é“¾æŽ¥ä¸€å˜ï¼ŒNginx ç«‹åˆ»åˆ‡æ¢åˆ°æ–°èµ„æºï¼Œæ— éœ€é‡å¯æœåŠ¡ï¼Œä¸æ»‘å¾—åƒå–äº†ä¸€å£å†°å¯ä¹ ðŸ¥¤ã€‚\n\n### 3. å›žæ»šçš„å®žçŽ°\nå›žæ»šçš„æ ¸å¿ƒæ˜¯åˆ‡æ¢ `current` æŒ‡å‘æ—§ç‰ˆæœ¬ã€‚æˆ‘ä¼šåœ¨ Jenkins ä¸­åŠ ä¸€ä¸ªâ€œå›žæ»šä»»åŠ¡â€ï¼Œç”¨å‚æ•°åŒ–æž„å»ºï¼ˆParameterized Buildï¼‰å®žçŽ°ï¼š\n\n```groovy\npipeline {\n  agent any\n  parameters {\n    string(name: 'ROLLBACK_VERSION', defaultValue: '', description: 'è¦å›žæ»šçš„ç‰ˆæœ¬å·')\n  }\n  stages {\n    stage('Rollback') {\n      steps {\n        sh \"ssh user@server 'ln -sfn /var/www/app/dist-v${params.ROLLBACK_VERSION} /var/www/app/current'\"\n        sh \"ssh user@server 'nginx -s reload'\" // å¯é€‰ï¼Œé‡è½½ Nginx é…ç½®\n      }\n    }\n  }\n}\n```\n\nè§¦å‘å›žæ»šæ—¶ï¼Œè¾“å…¥ç›®æ ‡ç‰ˆæœ¬å·ï¼ˆæ¯”å¦‚ `100`ï¼‰ï¼ŒJenkins å°±å¸®ä½ æžå®šã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒâ€œæ—¶å…‰æœºâ€ï¼Ÿä¸€é”®å›žåˆ°è¿‡åŽ» ðŸ˜„ã€‚\n\n---\n\n## æœ€ä½³å®žè·µä¸Žç»éªŒåˆ†äº«\n\nå…‰æœ‰æµç¨‹è¿˜ä¸å¤Ÿï¼Œå®žé™…æ“ä½œä¸­æ€»ä¼šé‡åˆ°å„ç§â€œå‘â€ã€‚ä»¥ä¸‹æ˜¯æˆ‘è¸©è¿‡å‘åŽæ€»ç»“çš„ä¸€äº›ç»éªŒï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç”¨ï¼š\n\n### 1. ä¿ç•™åŽ†å²ç‰ˆæœ¬ï¼Œä½†åˆ«å¤ªå¤š\næœåŠ¡å™¨ç©ºé—´ä¸æ˜¯æ— é™çš„ï¼Œæ¯æ¬¡æž„å»ºéƒ½ç•™ä¸€ä»½ `dist-vX.X.X`ï¼Œæ—¶é—´é•¿äº†ä¼šçˆ†ç›˜ã€‚æˆ‘çš„å»ºè®®æ˜¯ä¿ç•™æœ€è¿‘ 5 ä¸ªç‰ˆæœ¬ï¼Œè¶…å‡ºçš„ç”¨è„šæœ¬æ¸…ç†ï¼š\n\n```bash\nls -d /var/www/app/dist-v* | sort -Vr | tail -n +6 | xargs rm -rf\n```\n\n`sort -Vr` æ˜¯æŒ‰ç‰ˆæœ¬å·é™åºï¼Œ`tail -n +6` å–ç¬¬ 6 ä¸ªåŠä¹‹åŽçš„ç›®å½•ï¼Œå¹²å‡€åˆ©è½ã€‚\n\n### 2. åŠ ä¸Šç‰ˆæœ¬åˆ‡æ¢å‰çš„å¥åº·æ£€æŸ¥\næ–°ç‰ˆæœ¬ä¸Šçº¿å‰ï¼Œæœ€å¥½åŠ ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•æˆ–å¥åº·æ£€æŸ¥ã€‚æ¯”å¦‚ç”¨ `curl` æ£€æŸ¥é¦–é¡µæ˜¯å¦æ­£å¸¸è¿”å›ž 200ï¼š\n\n```bash\ncurl -s -o /dev/null -w \"%{http_code}\" http://example.com | grep 200 || exit 1\n```\n\nå¦‚æžœæ£€æŸ¥å¤±è´¥ï¼ŒPipeline å°±ä¸­æ­¢ï¼Œé¿å…æŠŠæœ‰é—®é¢˜çš„ç‰ˆæœ¬æŽ¨ä¸ŠåŽ»ã€‚\n\n### 3. æ—¥å¿—è®°å½•æ˜¯æ•‘å‘½ç¨»è‰\næ¯æ¬¡éƒ¨ç½²å’Œå›žæ»šï¼Œè®°å¾—è®°å½•æ“ä½œæ—¥å¿—ã€‚æ¯”å¦‚ï¼š\n\n```bash\necho \"$(date) - Deployed version ${VERSION}\" >> /var/www/app/deploy.log\n```\n\nå‡ºé—®é¢˜æ—¶ç¿»æ—¥å¿—ï¼Œèƒ½å¿«é€Ÿå®šä½æ˜¯å“ªæ¬¡éƒ¨ç½²å‡ºäº†å²”å­ã€‚\n\n### 4. ç°åº¦å‘å¸ƒçš„â€œå°å¿ƒæœºâ€\nå¦‚æžœè¦åšç°åº¦å‘å¸ƒï¼Œå¯ä»¥ç”¨ Nginx çš„ `split_clients` æ¨¡å—ï¼Œæ ¹æ®ç”¨æˆ· IP æˆ– Cookie åˆ†æµï¼š\n\n```nginx\nsplit_clients \"${remote_addr}\" $version {\n  10% /var/www/app/dist-v1.0.1;\n  *   /var/www/app/dist-v1.0.0;\n}\n```\n\n10% çš„ç”¨æˆ·çœ‹åˆ°æ–°ç‰ˆæœ¬ï¼Œå…¶ä½™èµ°æ—§ç‰ˆæœ¬ã€‚ç®€å•åˆé«˜æ•ˆã€‚\n\n---\n\n## æ·±å…¥ä¸€ç‚¹ï¼šå¤šç‰ˆæœ¬éƒ¨ç½²çš„æŒ‘æˆ˜ä¸Žä¼˜åŒ–\n\n### ç¼“å­˜é—®é¢˜\nå‰ç«¯é™æ€èµ„æºé€šå¸¸æœ‰ç¼“å­˜ï¼ˆæ¯”å¦‚ CDNï¼‰ã€‚æ–°ç‰ˆæœ¬ä¸Šçº¿åŽï¼Œç”¨æˆ·å¯èƒ½è¿˜åœ¨ç”¨æ—§çš„ JSã€CSSï¼Œæ€Žä¹ˆç ´ï¼Ÿæˆ‘ä¸€èˆ¬ä¼šåœ¨æž„å»ºæ—¶ç»™æ–‡ä»¶ååŠ  hashï¼ˆwebpack æˆ– vite éƒ½æ”¯æŒï¼‰ï¼Œæ¯”å¦‚ `main.123abc.js`ï¼Œå¼ºåˆ¶æµè§ˆå™¨åŠ è½½æ–°æ–‡ä»¶ã€‚\n\n### æ•°æ®åº“å…¼å®¹æ€§\nå¦‚æžœå‰ç«¯æ–°ç‰ˆæœ¬ä¾èµ–åŽç«¯ API çš„æ–°å­—æ®µï¼Œè€ŒåŽç«¯è¿˜æ²¡è·Ÿä¸Šæ€Žä¹ˆåŠžï¼Ÿè¿™å°±éœ€è¦ç‰ˆæœ¬ä¹‹é—´åšå¥½å…¼å®¹æ€§è®¾è®¡ã€‚æ¯”å¦‚ç”¨å¯é€‰é“¾ï¼ˆ`?.`ï¼‰å¤„ç†æ–°å­—æ®µï¼Œæˆ–è€…åœ¨ Jenkins ä¸­åŠ ä¸ªâ€œç­‰å¾…åŽç«¯éƒ¨ç½²â€çš„æ­¥éª¤ã€‚\n\n### å¹¶å‘éƒ¨ç½²\nå¤šäººåŒæ—¶è§¦å‘æž„å»ºï¼Œå¯èƒ½å¯¼è‡´ç‰ˆæœ¬æ··ä¹±ã€‚æˆ‘çš„è§£å†³åŠžæ³•æ˜¯ç»™ Pipeline åŠ é”ï¼ˆJenkins çš„ `lock` æ’ä»¶ï¼‰ï¼ŒåŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªéƒ¨ç½²ä»»åŠ¡è·‘ã€‚\n\n---\n\n## ä¸€ä¸ªçœŸå®žçš„è¸©å‘æ¡ˆä¾‹\n\næœ‰æ¬¡ä¸Šçº¿æ–°ç‰ˆæœ¬ï¼Œå¿˜äº†æ£€æŸ¥ CDN ç¼“å­˜ï¼Œç»“æžœéƒ¨åˆ†ç”¨æˆ·åŠ è½½çš„æ˜¯æ—§ JSï¼Œæ–° HTMLï¼Œé¡µé¢ç›´æŽ¥ç™½å±ã€‚åŽæ¥æˆ‘åŠ äº†ä¸ªâ€œCDN é¢„çƒ­â€æ­¥éª¤ï¼Œéƒ¨ç½²åŽç”¨è„šæœ¬åˆ·ä¸€éå…³é”®è·¯å¾„çš„ç¼“å­˜ï¼Œæ‰ç®—è§£å†³ã€‚è¿™è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°ï¼š**éƒ¨ç½²ä¸ä»…æ˜¯ä»£ç çš„äº‹å„¿ï¼Œæ›´æ˜¯æ•´ä¸ªç³»ç»Ÿçš„åä½œ**ã€‚\n\n---\n\n## æ€»ç»“\n\nJenkins çš„å¤šç‰ˆæœ¬éƒ¨ç½²å’Œå›žæ»šï¼Œå°±åƒç»™å‰ç«¯é¡¹ç›®åŠ äº†ä¸ªâ€œå®‰å…¨å¸¦â€ã€‚é€šè¿‡ç‰ˆæœ¬åŒ–æž„å»ºã€ç¬¦å·é“¾æŽ¥åˆ‡æ¢ã€å¥åº·æ£€æŸ¥ç­‰æ‰‹æ®µï¼Œæˆ‘ä»¬æ—¢èƒ½å¿«é€Ÿè¿­ä»£ï¼Œåˆä¸æ€•ç¿»è½¦ã€‚åŠ ä¸Šä¸€äº›æœ€ä½³å®žè·µï¼ˆæ—¥å¿—ã€æ¸…ç†ã€ç°åº¦ï¼‰ï¼Œæ•´ä¸ªæµç¨‹ä¼šæ›´ç¨³å¥ã€‚\n\nå½“ç„¶ï¼Œæ¯ä¸ªé¡¹ç›®çš„æƒ…å†µéƒ½ä¸ä¸€æ ·ï¼Œå·¥å…·åªæ˜¯æ‰‹æ®µï¼Œå…³é”®è¿˜æ˜¯ç†è§£èƒŒåŽçš„é€»è¾‘ã€‚å¸Œæœ›è¿™ç¯‡åšå®¢èƒ½ç»™ä½ ä¸€äº›å¯å‘ï¼Œä¸‹æ¬¡éƒ¨ç½²æ—¶å°‘è¸©ç‚¹å‘ï¼Œå¤šç‚¹ä»Žå®¹ ðŸ˜Šã€‚æœ‰å•¥æƒ³æ³•æˆ–é—®é¢˜ï¼Œæ¬¢è¿Žç•™è¨€ï¼Œå’±ä»¬ä¸€èµ·èŠèŠï¼\n\n---",
    "code": "var Component=(()=>{var o=Object.create;var d=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var F=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),f=(l,e)=>{for(var a in e)d(l,a,{get:e[a],enumerable:!0})},c=(l,e,a,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of y(e))!u.call(l,r)&&r!==a&&d(l,r,{get:()=>e[r],enumerable:!(i=E(e,r))||i.enumerable});return l};var m=(l,e,a)=>(a=l!=null?o(g(l)):{},c(e||!l||!l.__esModule?d(a,\"default\",{value:l,enumerable:!0}):a,l)),B=l=>c(d({},\"__esModule\",{value:!0}),l);var h=F((C,t)=>{t.exports=_jsx_runtime});var x={};f(x,{default:()=>p,frontmatter:()=>k});var n=m(h()),k={type:\"Post\",title:\"\\u8C08\\u8C08\\u524D\\u7AEF Jenkins \\u591A\\u7248\\u672C\\u90E8\\u7F72\\u4EE5\\u53CA\\u56DE\\u6EDA\",date:\"2023-02-02\",description:\"\\u6DF1\\u5165\\u63A2\\u8BA8\\u524D\\u7AEF\\u9879\\u76EE\\u5982\\u4F55\\u5229\\u7528 Jenkins \\u5B9E\\u73B0\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u4E0E\\u56DE\\u6EDA\\uFF0C\\u5256\\u6790\\u539F\\u7406\\uFF0C\\u5206\\u4EAB\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF0C\\u5E26\\u4F60\\u4ECE\\u5BB9\\u5E94\\u5BF9\\u751F\\u4EA7\\u73AF\\u5883\\u7684\\u6311\\u6218\\u3002\",keywords:\"Jenkins, \\u524D\\u7AEF\\u90E8\\u7F72, \\u591A\\u7248\\u672C\\u90E8\\u7F72, \\u56DE\\u6EDA, CI/CD, \\u81EA\\u52A8\\u5316\\u90E8\\u7F72, DevOps, \\u524D\\u7AEF\\u5DE5\\u7A0B\\u5316\",author:\"\\u6653\\u9F99\",image:\"/images/hero/jenkins-deployment.jpg\",tags:[\"Jenkins\",\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"CI/CD\",\"DevOps\"],category:\"\\u524D\\u7AEF\\u5DE5\\u7A0B\\u5316\"};function s(l){let e={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",hr:\"hr\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...l.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"\\u5728\\u524D\\u7AEF\\u5F00\\u53D1\\u4E2D\\uFF0C\\u90E8\\u7F72\\u4ECE\\u6765\\u4E0D\\u662F\\u4E00\\u4EF6\\u5C0F\\u4E8B\\u3002\\u5C24\\u5176\\u662F\\u5F53\\u9879\\u76EE\\u89C4\\u6A21\\u53D8\\u5927\\u3001\\u8FED\\u4EE3\\u9891\\u7E41\\u3001\\u56E2\\u961F\\u534F\\u4F5C\\u590D\\u6742\\u65F6\\uFF0C\\u5982\\u4F55\\u786E\\u4FDD\\u4EE3\\u7801\\u5E73\\u7A33\\u4E0A\\u7EBF\\uFF0C\\u53C8\\u80FD\\u5728\\u51FA\\u9519\\u65F6\\u5FEB\\u901F\\u56DE\\u6EDA\\uFF0C\\u6210\\u4E86\\u6BCF\\u4E2A\\u524D\\u7AEF\\u5DE5\\u7A0B\\u5E08\\u548C DevOps \\u5C0F\\u4F19\\u4F34\\u5FC3\\u4E2D\\u7684\\u201C\\u7EC8\\u6781\\u547D\\u9898\\u201D\\u3002\\u4ECA\\u5929\\uFF0C\\u6211\\u60F3\\u548C\\u4F60\\u804A\\u804A\\u5982\\u4F55\\u501F\\u52A9 Jenkins \\u8FD9\\u4E2A\\u201C\\u8001\\u670B\\u53CB\\u201D\\uFF0C\\u5B9E\\u73B0\\u524D\\u7AEF\\u9879\\u76EE\\u7684\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u4E0E\\u56DE\\u6EDA\\u3002\\u4E0D\\u4EC5\\u4F1A\\u6DF1\\u5165\\u539F\\u7406\\uFF0C\\u8FD8\\u4F1A\\u7ED3\\u5408\\u6211\\u7684\\u7ECF\\u9A8C\\uFF0C\\u629B\\u51FA\\u4E00\\u4E9B\\u5B9E\\u7528\\u6280\\u5DE7\\u548C\\u8E29\\u5751\\u8BB0\\u5F55\\uFF0C\\u5E26\\u70B9 emoji \\u8C03\\u5242\\u4E00\\u4E0B\\u6C14\\u6C1B \\u{1F60E}\\u3002\"}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981\\u591A\\u7248\\u672C\\u90E8\\u7F72\",children:(0,n.jsx)(e.a,{href:\"#\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981\\u591A\\u7248\\u672C\\u90E8\\u7F72\",children:\"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981\\u591A\\u7248\\u672C\\u90E8\\u7F72\\uFF1F\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u60F3\\u8C61\\u4E00\\u4E0B\\uFF0C\\u4F60\\u662F\\u4E00\\u4E2A\\u53A8\\u5E08\\uFF0C\\u521A\\u505A\\u4E86\\u4E00\\u9053\\u65B0\\u83DC\\u7AEF\\u4E0A\\u684C\\uFF0C\\u987E\\u5BA2\\u5C1D\\u4E86\\u4E00\\u53E3\\u8BF4\\uFF1A\\u201C\\u8FD9\\u5565\\u5440\\uFF0C\\u592A\\u54B8\\u4E86\\uFF01\\u201D \\u4F60\\u603B\\u4E0D\\u80FD\\u76F4\\u63A5\\u628A\\u83DC\\u6254\\u4E86\\u91CD\\u505A\\u5427\\uFF1F\\u806A\\u660E\\u7684\\u505A\\u6CD5\\u662F\\uFF0C\\u65C1\\u8FB9\\u5907\\u7740\\u4E0A\\u4E00\\u9053\\u201C\\u9760\\u8C31\\u201D\\u7684\\u83DC\\uFF0C\\u968F\\u65F6\\u53EF\\u4EE5\\u7AEF\\u4E0A\\u6765\\u6551\\u573A\\u3002\\u8FD9\\u5C31\\u662F\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u610F\\u4E49\\u2014\\u2014\",(0,n.jsx)(e.strong,{children:\"\\u8BA9\\u65B0\\u7248\\u672C\\u548C\\u65E7\\u7248\\u672C\\u5171\\u5B58\\uFF0C\\u65E2\\u80FD\\u5927\\u80C6\\u5C1D\\u8BD5\\u65B0\\u529F\\u80FD\\uFF0C\\u53C8\\u80FD\\u5728\\u95EE\\u9898\\u51FA\\u73B0\\u65F6\\u8FC5\\u901F\\u5207\\u6362\\u56DE\\u7A33\\u5B9A\\u7248\\u672C\"}),\"\\u3002\"]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5728\\u524D\\u7AEF\\u9886\\u57DF\\uFF0C\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u5E38\\u89C1\\u4E8E\\u4EE5\\u4E0B\\u573A\\u666F\\uFF1A\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u7070\\u5EA6\\u53D1\\u5E03\"}),\"\\uFF1A\\u53EA\\u8BA9\\u4E00\\u90E8\\u5206\\u7528\\u6237\\u770B\\u5230\\u65B0\\u7248\\u672C\\uFF0C\\u9A8C\\u8BC1\\u6CA1\\u95EE\\u9898\\u518D\\u5168\\u91CF\\u4E0A\\u7EBF\\u3002\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"\\u5FEB\\u901F\\u56DE\\u6EDA\"}),\"\\uFF1A\\u65B0\\u7248\\u672C\\u4E0A\\u7EBF\\u540E\\u53D1\\u73B0 bug\\uFF0C\\u80FD\\u7ACB\\u523B\\u5207\\u56DE\\u65E7\\u7248\\u672C\\u3002\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"A/B \\u6D4B\\u8BD5\"}),\"\\uFF1A\\u540C\\u65F6\\u8FD0\\u884C\\u591A\\u4E2A\\u7248\\u672C\\uFF0C\\u6BD4\\u8F83\\u7528\\u6237\\u4F53\\u9A8C\\u6216\\u8F6C\\u5316\\u7387\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Jenkins \\u4F5C\\u4E3A CI/CD \\u7684\\u201C\\u745E\\u58EB\\u519B\\u5200\\u201D\\uFF0C\\u5929\\u7136\\u9002\\u5408\\u5E72\\u8FD9\\u4E2A\\u6D3B\\u513F\\u3002\\u63A5\\u4E0B\\u6765\\uFF0C\\u6211\\u4EEC\\u4ECE\\u539F\\u7406\\u5230\\u5B9E\\u8DF5\\uFF0C\\u4E00\\u6B65\\u6B65\\u62C6\\u89E3\\u3002\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"jenkins-\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u539F\\u7406\",children:(0,n.jsx)(e.a,{href:\"#jenkins-\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u539F\\u7406\",children:\"Jenkins \\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u539F\\u7406\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Jenkins \\u7684\\u6838\\u5FC3\\u662F\\u4E00\\u4E2A\\u81EA\\u52A8\\u5316\\u5DE5\\u4F5C\\u6D41\\u5F15\\u64CE\\uFF0C\\u901A\\u8FC7 Pipeline\\uFF08\\u6D41\\u6C34\\u7EBF\\uFF09\\u4E32\\u8054\\u8D77\\u4EE3\\u7801\\u6784\\u5EFA\\u3001\\u6D4B\\u8BD5\\u3001\\u90E8\\u7F72\\u7B49\\u6B65\\u9AA4\\u3002\\u8981\\u5B9E\\u73B0\\u591A\\u7248\\u672C\\u90E8\\u7F72\\uFF0C\\u5173\\u952E\\u5728\\u4E8E\\u4EE5\\u4E0B\\u51E0\\u70B9\\uFF1A\"}),`\n`,(0,n.jsx)(e.h3,{id:\"1-\\u7248\\u672C\\u5316\\u6784\\u5EFA\\u8F93\\u51FA\",children:(0,n.jsx)(e.a,{href:\"#1-\\u7248\\u672C\\u5316\\u6784\\u5EFA\\u8F93\\u51FA\",children:\"1. \\u7248\\u672C\\u5316\\u6784\\u5EFA\\u8F93\\u51FA\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u6BCF\\u6B21\\u6784\\u5EFA\\u65F6\\uFF0CJenkins \\u9700\\u8981\\u4E3A\\u524D\\u7AEF\\u9879\\u76EE\\u751F\\u6210\\u4E00\\u4E2A\\u5E26\\u6709\\u7248\\u672C\\u53F7\\u7684\\u9759\\u6001\\u8D44\\u6E90\\u5305\\u3002\\u6BD4\\u5982 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"dist-v1.0.0/\"})})})}),\"\\u3001\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"dist-v1.0.1/\"})})})}),\"\\uFF0C\\u8FD9\\u6837\\u4E0D\\u540C\\u7684\\u7248\\u672C\\u53EF\\u4EE5\\u72EC\\u7ACB\\u5B58\\u50A8\\uFF0C\\u4E0D\\u4F1A\\u4E92\\u76F8\\u8986\\u76D6\\u3002\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"2-\\u670D\\u52A1\\u5668\\u4E0A\\u7684\\u7248\\u672C\\u7BA1\\u7406\",children:(0,n.jsx)(e.a,{href:\"#2-\\u670D\\u52A1\\u5668\\u4E0A\\u7684\\u7248\\u672C\\u7BA1\\u7406\",children:\"2. \\u670D\\u52A1\\u5668\\u4E0A\\u7684\\u7248\\u672C\\u7BA1\\u7406\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u6784\\u5EFA\\u597D\\u7684\\u8D44\\u6E90\\u9700\\u8981\\u4E0A\\u4F20\\u5230\\u670D\\u52A1\\u5668\\uFF08\\u6BD4\\u5982 Nginx\\uFF09\\uFF0C\\u5E76\\u901A\\u8FC7\\u67D0\\u79CD\\u673A\\u5236\\uFF08\\u5982\\u7B26\\u53F7\\u94FE\\u63A5\\u6216\\u8DEF\\u7531\\u914D\\u7F6E\\uFF09\\u6307\\u5B9A\\u5F53\\u524D\\u201C\\u6D3B\\u8DC3\\u201D\\u7248\\u672C\\u3002\\u6BD4\\u5982\\uFF1A\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"/var/www/app/current\"})})})}),\" \\u6307\\u5411 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"dist-v1.0.0/\"})})})}),\"\\u3002\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"\\u65B0\\u7248\\u672C\\u4E0A\\u7EBF\\u540E\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"current\"})})})}),\" \\u5207\\u6362\\u5230 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"dist-v1.0.1/\"})})})}),\"\\u3002\"]}),`\n`]}),`\n`,(0,n.jsx)(e.h3,{id:\"3-\\u56DE\\u6EDA\\u673A\\u5236\",children:(0,n.jsx)(e.a,{href:\"#3-\\u56DE\\u6EDA\\u673A\\u5236\",children:\"3. \\u56DE\\u6EDA\\u673A\\u5236\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u56DE\\u6EDA\\u672C\\u8D28\\u4E0A\\u662F\\u201C\\u7248\\u672C\\u5207\\u6362\\u201D\\u3002Jenkins \\u9700\\u8981\\u8BB0\\u5F55\\u5386\\u53F2\\u7248\\u672C\\uFF0C\\u5E76\\u5728\\u9700\\u8981\\u65F6\\u5FEB\\u901F\\u8C03\\u6574\\u670D\\u52A1\\u5668\\u914D\\u7F6E\\uFF0C\\u6307\\u5411\\u65E7\\u7248\\u672C\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u8FD9\\u542C\\u8D77\\u6765\\u50CF\\u4E0D\\u50CF\\u5728\\u73A9\\u201C\\u4FC4\\u7F57\\u65AF\\u5957\\u5A03\\u201D\\uFF1F\\u4E00\\u5C42\\u5957\\u4E00\\u5C42\\uFF0C\\u4F46\\u6BCF\\u5C42\\u90FD\\u6709\\u81EA\\u5DF1\\u7684\\u7F16\\u53F7\\uFF0C\\u968F\\u65F6\\u53EF\\u4EE5\\u62CE\\u51FA\\u6765\\u7528\\u3002\\u63A5\\u4E0B\\u6765\\uFF0C\\u6211\\u4EEC\\u770B\\u770B\\u5177\\u4F53\\u600E\\u4E48\\u5B9E\\u73B0\\u3002\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u5B9E\\u73B0\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u6B65\\u9AA4\",children:(0,n.jsx)(e.a,{href:\"#\\u5B9E\\u73B0\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u6B65\\u9AA4\",children:\"\\u5B9E\\u73B0\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u6B65\\u9AA4\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5047\\u8BBE\\u6211\\u4EEC\\u6709\\u4E2A React \\u9879\\u76EE\\uFF0C\\u7528 Jenkins \\u90E8\\u7F72\\u5230\\u4E00\\u53F0 Nginx \\u670D\\u52A1\\u5668\\u4E0A\\u3002\\u4E0B\\u9762\\u662F\\u6211\\u7684\\u5B9E\\u6218\\u6D41\\u7A0B\\uFF0C\\u5C3D\\u91CF\\u8BE6\\u7EC6\\uFF0C\\u5E26\\u70B9\\u4EE3\\u7801\\u548C\\u4F8B\\u5B50\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{id:\"1-\\u914D\\u7F6E-jenkins-pipeline\",children:(0,n.jsx)(e.a,{href:\"#1-\\u914D\\u7F6E-jenkins-pipeline\",children:\"1. \\u914D\\u7F6E Jenkins Pipeline\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Jenkins \\u7684 Pipeline \\u53EF\\u4EE5\\u7528 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"Jenkinsfile\"})})})}),\" \\u5199\\u6210\\u58F0\\u660E\\u5F0F\\u811A\\u672C\\u3002\\u6211\\u901A\\u5E38\\u4F1A\\u8FD9\\u4E48\\u7EC4\\u7EC7\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"groovy\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"groovy\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"pipeline {\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  agent any\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  environment {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"    VERSION\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"${env.BUILD_NUMBER}\"'}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\" // \\u7528\\u6784\\u5EFA\\u53F7\\u4F5C\\u4E3A\\u7248\\u672C\\u53F7\\uFF0C\\u6BD4\\u5982 101\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"    DEPLOY_DIR\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"/var/www/app/dist-v${VERSION}\"'})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"    CURRENT_DIR\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"/var/www/app/current\"'})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  stages {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    stage(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Install'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      steps {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'npm install'\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    stage(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Build'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      steps {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'npm run build'\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"mv dist ${DEPLOY_DIR}\"'}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\" // \\u91CD\\u547D\\u540D\\u8F93\\u51FA\\u76EE\\u5F55\\u5E26\\u7248\\u672C\\u53F7\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    stage(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Deploy'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      steps {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"scp -r ${DEPLOY_DIR} user@server:/var/www/app/\"'})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"\\\"ssh user@server 'ln -sfn ${DEPLOY_DIR} ${CURRENT_DIR}'\\\"\"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\" // \\u66F4\\u65B0\\u7B26\\u53F7\\u94FE\\u63A5\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u91CC\\u7528\\u4E86 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"BUILD_NUMBER\"})})})}),\" \\u4F5C\\u4E3A\\u7248\\u672C\\u53F7\\uFF0C\\u6BCF\\u6B21\\u6784\\u5EFA\\u81EA\\u52A8\\u9012\\u589E\\u3002\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"ln -sfn\"})})})}),\" \\u662F Linux \\u7684\\u7B26\\u53F7\\u94FE\\u63A5\\u547D\\u4EE4\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"-f\"})})})}),\" \\u8868\\u793A\\u5F3A\\u5236\\u8986\\u76D6\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"-n\"})})})}),\" \\u786E\\u4FDD\\u76EE\\u6807\\u662F\\u4E2A\\u76EE\\u5F55\\u65F6\\u4E5F\\u80FD\\u6B63\\u5E38\\u5DE5\\u4F5C\\u3002\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"2-nginx-\\u914D\\u7F6E\",children:(0,n.jsx)(e.a,{href:\"#2-nginx-\\u914D\\u7F6E\",children:\"2. Nginx \\u914D\\u7F6E\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u670D\\u52A1\\u5668\\u4E0A\\uFF0CNginx \\u9700\\u8981\\u6307\\u5411 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"current\"})})})}),\" \\u76EE\\u5F55\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"nginx\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"nginx\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"server\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  listen \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"80\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  server_name \"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"example.com;\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  location\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" / \"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"{\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    root \"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"/var/www/app/current;\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    try_files \"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"$uri $uri/ /index.html; // \\u652F\\u6301\\u524D\\u7AEF\\u8DEF\\u7531\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4E0A\\u7EBF\\u65B0\\u7248\\u672C\\u65F6\\uFF0C\\u7B26\\u53F7\\u94FE\\u63A5\\u4E00\\u53D8\\uFF0CNginx \\u7ACB\\u523B\\u5207\\u6362\\u5230\\u65B0\\u8D44\\u6E90\\uFF0C\\u65E0\\u9700\\u91CD\\u542F\\u670D\\u52A1\\uFF0C\\u4E1D\\u6ED1\\u5F97\\u50CF\\u559D\\u4E86\\u4E00\\u53E3\\u51B0\\u53EF\\u4E50 \\u{1F964}\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{id:\"3-\\u56DE\\u6EDA\\u7684\\u5B9E\\u73B0\",children:(0,n.jsx)(e.a,{href:\"#3-\\u56DE\\u6EDA\\u7684\\u5B9E\\u73B0\",children:\"3. \\u56DE\\u6EDA\\u7684\\u5B9E\\u73B0\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u56DE\\u6EDA\\u7684\\u6838\\u5FC3\\u662F\\u5207\\u6362 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"current\"})})})}),\" \\u6307\\u5411\\u65E7\\u7248\\u672C\\u3002\\u6211\\u4F1A\\u5728 Jenkins \\u4E2D\\u52A0\\u4E00\\u4E2A\\u201C\\u56DE\\u6EDA\\u4EFB\\u52A1\\u201D\\uFF0C\\u7528\\u53C2\\u6570\\u5316\\u6784\\u5EFA\\uFF08Parameterized Build\\uFF09\\u5B9E\\u73B0\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"groovy\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"groovy\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"pipeline {\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  agent any\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  parameters {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    string(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"name\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'ROLLBACK_VERSION'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"defaultValue\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"''\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"description\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u8981\\u56DE\\u6EDA\\u7684\\u7248\\u672C\\u53F7'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  stages {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    stage(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'Rollback'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      steps {\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:`\"ssh user@server 'ln -sfn /var/www/app/dist-v\\${params.ROLLBACK_VERSION} /var/www/app/current'\"`})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        sh \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:`\"ssh user@server 'nginx -s reload'\"`}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\" // \\u53EF\\u9009\\uFF0C\\u91CD\\u8F7D Nginx \\u914D\\u7F6E\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u89E6\\u53D1\\u56DE\\u6EDA\\u65F6\\uFF0C\\u8F93\\u5165\\u76EE\\u6807\\u7248\\u672C\\u53F7\\uFF08\\u6BD4\\u5982 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"100\"})})})}),\"\\uFF09\\uFF0CJenkins \\u5C31\\u5E2E\\u4F60\\u641E\\u5B9A\\u3002\\u662F\\u4E0D\\u662F\\u6709\\u70B9\\u50CF\\u201C\\u65F6\\u5149\\u673A\\u201D\\uFF1F\\u4E00\\u952E\\u56DE\\u5230\\u8FC7\\u53BB \\u{1F604}\\u3002\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u7ECF\\u9A8C\\u5206\\u4EAB\",children:(0,n.jsx)(e.a,{href:\"#\\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u7ECF\\u9A8C\\u5206\\u4EAB\",children:\"\\u6700\\u4F73\\u5B9E\\u8DF5\\u4E0E\\u7ECF\\u9A8C\\u5206\\u4EAB\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5149\\u6709\\u6D41\\u7A0B\\u8FD8\\u4E0D\\u591F\\uFF0C\\u5B9E\\u9645\\u64CD\\u4F5C\\u4E2D\\u603B\\u4F1A\\u9047\\u5230\\u5404\\u79CD\\u201C\\u5751\\u201D\\u3002\\u4EE5\\u4E0B\\u662F\\u6211\\u8E29\\u8FC7\\u5751\\u540E\\u603B\\u7ED3\\u7684\\u4E00\\u4E9B\\u7ECF\\u9A8C\\uFF0C\\u5E0C\\u671B\\u5BF9\\u4F60\\u6709\\u7528\\uFF1A\"}),`\n`,(0,n.jsx)(e.h3,{id:\"1-\\u4FDD\\u7559\\u5386\\u53F2\\u7248\\u672C\\u4F46\\u522B\\u592A\\u591A\",children:(0,n.jsx)(e.a,{href:\"#1-\\u4FDD\\u7559\\u5386\\u53F2\\u7248\\u672C\\u4F46\\u522B\\u592A\\u591A\",children:\"1. \\u4FDD\\u7559\\u5386\\u53F2\\u7248\\u672C\\uFF0C\\u4F46\\u522B\\u592A\\u591A\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u670D\\u52A1\\u5668\\u7A7A\\u95F4\\u4E0D\\u662F\\u65E0\\u9650\\u7684\\uFF0C\\u6BCF\\u6B21\\u6784\\u5EFA\\u90FD\\u7559\\u4E00\\u4EFD \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"dist-vX.X.X\"})})})}),\"\\uFF0C\\u65F6\\u95F4\\u957F\\u4E86\\u4F1A\\u7206\\u76D8\\u3002\\u6211\\u7684\\u5EFA\\u8BAE\\u662F\\u4FDD\\u7559\\u6700\\u8FD1 5 \\u4E2A\\u7248\\u672C\\uFF0C\\u8D85\\u51FA\\u7684\\u7528\\u811A\\u672C\\u6E05\\u7406\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"ls\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -d\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" /var/www/app/dist-v\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" |\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" sort\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -Vr\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" |\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" tail\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -n\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" +6\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" |\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" xargs\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" rm\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -rf\"})]})})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"sort -Vr\"})})})}),\" \\u662F\\u6309\\u7248\\u672C\\u53F7\\u964D\\u5E8F\\uFF0C\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"tail -n +6\"})})})}),\" \\u53D6\\u7B2C 6 \\u4E2A\\u53CA\\u4E4B\\u540E\\u7684\\u76EE\\u5F55\\uFF0C\\u5E72\\u51C0\\u5229\\u843D\\u3002\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"2-\\u52A0\\u4E0A\\u7248\\u672C\\u5207\\u6362\\u524D\\u7684\\u5065\\u5EB7\\u68C0\\u67E5\",children:(0,n.jsx)(e.a,{href:\"#2-\\u52A0\\u4E0A\\u7248\\u672C\\u5207\\u6362\\u524D\\u7684\\u5065\\u5EB7\\u68C0\\u67E5\",children:\"2. \\u52A0\\u4E0A\\u7248\\u672C\\u5207\\u6362\\u524D\\u7684\\u5065\\u5EB7\\u68C0\\u67E5\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u65B0\\u7248\\u672C\\u4E0A\\u7EBF\\u524D\\uFF0C\\u6700\\u597D\\u52A0\\u4E2A\\u81EA\\u52A8\\u5316\\u6D4B\\u8BD5\\u6216\\u5065\\u5EB7\\u68C0\\u67E5\\u3002\\u6BD4\\u5982\\u7528 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"curl\"})})})}),\" \\u68C0\\u67E5\\u9996\\u9875\\u662F\\u5426\\u6B63\\u5E38\\u8FD4\\u56DE 200\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"curl\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -s\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -o\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" /dev/null\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" -w\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"%{http_code}\"'}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" http://example.com\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" |\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" grep\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 200\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" ||\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" exit\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 1\"})]})})})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5982\\u679C\\u68C0\\u67E5\\u5931\\u8D25\\uFF0CPipeline \\u5C31\\u4E2D\\u6B62\\uFF0C\\u907F\\u514D\\u628A\\u6709\\u95EE\\u9898\\u7684\\u7248\\u672C\\u63A8\\u4E0A\\u53BB\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{id:\"3-\\u65E5\\u5FD7\\u8BB0\\u5F55\\u662F\\u6551\\u547D\\u7A3B\\u8349\",children:(0,n.jsx)(e.a,{href:\"#3-\\u65E5\\u5FD7\\u8BB0\\u5F55\\u662F\\u6551\\u547D\\u7A3B\\u8349\",children:\"3. \\u65E5\\u5FD7\\u8BB0\\u5F55\\u662F\\u6551\\u547D\\u7A3B\\u8349\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u6BCF\\u6B21\\u90E8\\u7F72\\u548C\\u56DE\\u6EDA\\uFF0C\\u8BB0\\u5F97\\u8BB0\\u5F55\\u64CD\\u4F5C\\u65E5\\u5FD7\\u3002\\u6BD4\\u5982\\uFF1A\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"echo\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"$('}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"date\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\") - Deployed version ${\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"VERSION\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'}\"'}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" >>\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\" /var/www/app/deploy.log\"})]})})})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u51FA\\u95EE\\u9898\\u65F6\\u7FFB\\u65E5\\u5FD7\\uFF0C\\u80FD\\u5FEB\\u901F\\u5B9A\\u4F4D\\u662F\\u54EA\\u6B21\\u90E8\\u7F72\\u51FA\\u4E86\\u5C94\\u5B50\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{id:\"4-\\u7070\\u5EA6\\u53D1\\u5E03\\u7684\\u5C0F\\u5FC3\\u673A\",children:(0,n.jsx)(e.a,{href:\"#4-\\u7070\\u5EA6\\u53D1\\u5E03\\u7684\\u5C0F\\u5FC3\\u673A\",children:\"4. \\u7070\\u5EA6\\u53D1\\u5E03\\u7684\\u201C\\u5C0F\\u5FC3\\u673A\\u201D\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u8981\\u505A\\u7070\\u5EA6\\u53D1\\u5E03\\uFF0C\\u53EF\\u4EE5\\u7528 Nginx \\u7684 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"split_clients\"})})})}),\" \\u6A21\\u5757\\uFF0C\\u6839\\u636E\\u7528\\u6237 IP \\u6216 Cookie \\u5206\\u6D41\\uFF1A\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"nginx\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"nginx\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"split_clients \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"${'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"remote_addr\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'}\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" $version {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  10% /var/www/app/dist-v1.0.1;\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  *   /\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"var/www\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"/app/dist-v1.0.0;\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"10% \\u7684\\u7528\\u6237\\u770B\\u5230\\u65B0\\u7248\\u672C\\uFF0C\\u5176\\u4F59\\u8D70\\u65E7\\u7248\\u672C\\u3002\\u7B80\\u5355\\u53C8\\u9AD8\\u6548\\u3002\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u6DF1\\u5165\\u4E00\\u70B9\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u6311\\u6218\\u4E0E\\u4F18\\u5316\",children:(0,n.jsx)(e.a,{href:\"#\\u6DF1\\u5165\\u4E00\\u70B9\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u6311\\u6218\\u4E0E\\u4F18\\u5316\",children:\"\\u6DF1\\u5165\\u4E00\\u70B9\\uFF1A\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u7684\\u6311\\u6218\\u4E0E\\u4F18\\u5316\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"\\u7F13\\u5B58\\u95EE\\u9898\",children:(0,n.jsx)(e.a,{href:\"#\\u7F13\\u5B58\\u95EE\\u9898\",children:\"\\u7F13\\u5B58\\u95EE\\u9898\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u524D\\u7AEF\\u9759\\u6001\\u8D44\\u6E90\\u901A\\u5E38\\u6709\\u7F13\\u5B58\\uFF08\\u6BD4\\u5982 CDN\\uFF09\\u3002\\u65B0\\u7248\\u672C\\u4E0A\\u7EBF\\u540E\\uFF0C\\u7528\\u6237\\u53EF\\u80FD\\u8FD8\\u5728\\u7528\\u65E7\\u7684 JS\\u3001CSS\\uFF0C\\u600E\\u4E48\\u7834\\uFF1F\\u6211\\u4E00\\u822C\\u4F1A\\u5728\\u6784\\u5EFA\\u65F6\\u7ED9\\u6587\\u4EF6\\u540D\\u52A0 hash\\uFF08webpack \\u6216 vite \\u90FD\\u652F\\u6301\\uFF09\\uFF0C\\u6BD4\\u5982 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"main.123abc.js\"})})})}),\"\\uFF0C\\u5F3A\\u5236\\u6D4F\\u89C8\\u5668\\u52A0\\u8F7D\\u65B0\\u6587\\u4EF6\\u3002\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"\\u6570\\u636E\\u5E93\\u517C\\u5BB9\\u6027\",children:(0,n.jsx)(e.a,{href:\"#\\u6570\\u636E\\u5E93\\u517C\\u5BB9\\u6027\",children:\"\\u6570\\u636E\\u5E93\\u517C\\u5BB9\\u6027\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u524D\\u7AEF\\u65B0\\u7248\\u672C\\u4F9D\\u8D56\\u540E\\u7AEF API \\u7684\\u65B0\\u5B57\\u6BB5\\uFF0C\\u800C\\u540E\\u7AEF\\u8FD8\\u6CA1\\u8DDF\\u4E0A\\u600E\\u4E48\\u529E\\uFF1F\\u8FD9\\u5C31\\u9700\\u8981\\u7248\\u672C\\u4E4B\\u95F4\\u505A\\u597D\\u517C\\u5BB9\\u6027\\u8BBE\\u8BA1\\u3002\\u6BD4\\u5982\\u7528\\u53EF\\u9009\\u94FE\\uFF08\",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"?.\"})})})}),\"\\uFF09\\u5904\\u7406\\u65B0\\u5B57\\u6BB5\\uFF0C\\u6216\\u8005\\u5728 Jenkins \\u4E2D\\u52A0\\u4E2A\\u201C\\u7B49\\u5F85\\u540E\\u7AEF\\u90E8\\u7F72\\u201D\\u7684\\u6B65\\u9AA4\\u3002\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"\\u5E76\\u53D1\\u90E8\\u7F72\",children:(0,n.jsx)(e.a,{href:\"#\\u5E76\\u53D1\\u90E8\\u7F72\",children:\"\\u5E76\\u53D1\\u90E8\\u7F72\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u591A\\u4EBA\\u540C\\u65F6\\u89E6\\u53D1\\u6784\\u5EFA\\uFF0C\\u53EF\\u80FD\\u5BFC\\u81F4\\u7248\\u672C\\u6DF7\\u4E71\\u3002\\u6211\\u7684\\u89E3\\u51B3\\u529E\\u6CD5\\u662F\\u7ED9 Pipeline \\u52A0\\u9501\\uFF08Jenkins \\u7684 \",(0,n.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{children:\"lock\"})})})}),\" \\u63D2\\u4EF6\\uFF09\\uFF0C\\u540C\\u4E00\\u65F6\\u95F4\\u53EA\\u5141\\u8BB8\\u4E00\\u4E2A\\u90E8\\u7F72\\u4EFB\\u52A1\\u8DD1\\u3002\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u4E00\\u4E2A\\u771F\\u5B9E\\u7684\\u8E29\\u5751\\u6848\\u4F8B\",children:(0,n.jsx)(e.a,{href:\"#\\u4E00\\u4E2A\\u771F\\u5B9E\\u7684\\u8E29\\u5751\\u6848\\u4F8B\",children:\"\\u4E00\\u4E2A\\u771F\\u5B9E\\u7684\\u8E29\\u5751\\u6848\\u4F8B\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u6709\\u6B21\\u4E0A\\u7EBF\\u65B0\\u7248\\u672C\\uFF0C\\u5FD8\\u4E86\\u68C0\\u67E5 CDN \\u7F13\\u5B58\\uFF0C\\u7ED3\\u679C\\u90E8\\u5206\\u7528\\u6237\\u52A0\\u8F7D\\u7684\\u662F\\u65E7 JS\\uFF0C\\u65B0 HTML\\uFF0C\\u9875\\u9762\\u76F4\\u63A5\\u767D\\u5C4F\\u3002\\u540E\\u6765\\u6211\\u52A0\\u4E86\\u4E2A\\u201CCDN \\u9884\\u70ED\\u201D\\u6B65\\u9AA4\\uFF0C\\u90E8\\u7F72\\u540E\\u7528\\u811A\\u672C\\u5237\\u4E00\\u904D\\u5173\\u952E\\u8DEF\\u5F84\\u7684\\u7F13\\u5B58\\uFF0C\\u624D\\u7B97\\u89E3\\u51B3\\u3002\\u8FD9\\u8BA9\\u6211\\u6DF1\\u523B\\u4F53\\u4F1A\\u5230\\uFF1A\",(0,n.jsx)(e.strong,{children:\"\\u90E8\\u7F72\\u4E0D\\u4EC5\\u662F\\u4EE3\\u7801\\u7684\\u4E8B\\u513F\\uFF0C\\u66F4\\u662F\\u6574\\u4E2A\\u7CFB\\u7EDF\\u7684\\u534F\\u4F5C\"}),\"\\u3002\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{id:\"\\u603B\\u7ED3\",children:(0,n.jsx)(e.a,{href:\"#\\u603B\\u7ED3\",children:\"\\u603B\\u7ED3\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Jenkins \\u7684\\u591A\\u7248\\u672C\\u90E8\\u7F72\\u548C\\u56DE\\u6EDA\\uFF0C\\u5C31\\u50CF\\u7ED9\\u524D\\u7AEF\\u9879\\u76EE\\u52A0\\u4E86\\u4E2A\\u201C\\u5B89\\u5168\\u5E26\\u201D\\u3002\\u901A\\u8FC7\\u7248\\u672C\\u5316\\u6784\\u5EFA\\u3001\\u7B26\\u53F7\\u94FE\\u63A5\\u5207\\u6362\\u3001\\u5065\\u5EB7\\u68C0\\u67E5\\u7B49\\u624B\\u6BB5\\uFF0C\\u6211\\u4EEC\\u65E2\\u80FD\\u5FEB\\u901F\\u8FED\\u4EE3\\uFF0C\\u53C8\\u4E0D\\u6015\\u7FFB\\u8F66\\u3002\\u52A0\\u4E0A\\u4E00\\u4E9B\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF08\\u65E5\\u5FD7\\u3001\\u6E05\\u7406\\u3001\\u7070\\u5EA6\\uFF09\\uFF0C\\u6574\\u4E2A\\u6D41\\u7A0B\\u4F1A\\u66F4\\u7A33\\u5065\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5F53\\u7136\\uFF0C\\u6BCF\\u4E2A\\u9879\\u76EE\\u7684\\u60C5\\u51B5\\u90FD\\u4E0D\\u4E00\\u6837\\uFF0C\\u5DE5\\u5177\\u53EA\\u662F\\u624B\\u6BB5\\uFF0C\\u5173\\u952E\\u8FD8\\u662F\\u7406\\u89E3\\u80CC\\u540E\\u7684\\u903B\\u8F91\\u3002\\u5E0C\\u671B\\u8FD9\\u7BC7\\u535A\\u5BA2\\u80FD\\u7ED9\\u4F60\\u4E00\\u4E9B\\u542F\\u53D1\\uFF0C\\u4E0B\\u6B21\\u90E8\\u7F72\\u65F6\\u5C11\\u8E29\\u70B9\\u5751\\uFF0C\\u591A\\u70B9\\u4ECE\\u5BB9 \\u{1F60A}\\u3002\\u6709\\u5565\\u60F3\\u6CD5\\u6216\\u95EE\\u9898\\uFF0C\\u6B22\\u8FCE\\u7559\\u8A00\\uFF0C\\u54B1\\u4EEC\\u4E00\\u8D77\\u804A\\u804A\\uFF01\"}),`\n`,(0,n.jsx)(e.hr,{})]})}function p(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,{...l,children:(0,n.jsx)(s,{...l})}):s(l)}return B(x);})();\n;return Component;"
  },
  "_id": "å‰ç«¯å·¥ç¨‹åŒ–/è°ˆè°ˆå‰ç«¯Jenkinså¤šç‰ˆæœ¬éƒ¨ç½²ä»¥åŠå›žæ»š.mdx",
  "_raw": {
    "sourceFilePath": "å‰ç«¯å·¥ç¨‹åŒ–/è°ˆè°ˆå‰ç«¯Jenkinså¤šç‰ˆæœ¬éƒ¨ç½²ä»¥åŠå›žæ»š.mdx",
    "sourceFileName": "è°ˆè°ˆå‰ç«¯Jenkinså¤šç‰ˆæœ¬éƒ¨ç½²ä»¥åŠå›žæ»š.mdx",
    "sourceFileDir": "å‰ç«¯å·¥ç¨‹åŒ–",
    "contentType": "mdx",
    "flattenedPath": "å‰ç«¯å·¥ç¨‹åŒ–/è°ˆè°ˆå‰ç«¯Jenkinså¤šç‰ˆæœ¬éƒ¨ç½²ä»¥åŠå›žæ»š"
  },
  "type": "Post",
  "url": "/blog/å‰ç«¯å·¥ç¨‹åŒ–/è°ˆè°ˆå‰ç«¯Jenkinså¤šç‰ˆæœ¬éƒ¨ç½²ä»¥åŠå›žæ»š"
}