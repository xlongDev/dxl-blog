{
  "title": "聊聊即时通讯 - 短轮询、长轮询、长连接、WebSocket",
  "date": "2024-04-11T00:00:00.000Z",
  "description": "深入探讨即时通讯的四种核心技术：短轮询、长轮询、长连接和 WebSocket，从原理到源码层面全面解析，带你理解现代实时通信的实现方式。",
  "keywords": "即时通讯, 短轮询, 长轮询, 长连接, WebSocket, 实时通信, HTTP, TCP, 源码解析",
  "author": "晓龙",
  "image": "/images/hero/instant-messaging.jpg",
  "tags": [
    "即时通讯",
    "网络编程",
    "WebSocket",
    "前端开发",
    "后端开发"
  ],
  "views": 0,
  "likes": 0,
  "category": "Network",
  "body": {
    "raw": "\n即时通讯（Instant Messaging, IM）是现代应用不可或缺的一部分。从聊天应用到实时通知，再到在线游戏，实时性成为了用户体验的核心。而实现即时通讯的技术手段多种多样，其中短轮询（Short Polling）、长轮询（Long Polling）、长连接（Long Connection）和 WebSocket 是最常见且最具代表性的四种方式。本文将从原理、优缺点、使用场景到源码层面，逐一深度解析这四种技术，带你彻底搞懂即时通讯的实现。\n\n## 1. 短轮询（Short Polling）\n\n### 原理\n\n短轮询是最简单、最早期的实时通信方式。客户端通过定期发送 HTTP 请求（如每隔 1 秒）到服务器，询问是否有新数据。服务器收到请求后立即返回结果，无论是否有更新。\n\n这种方式本质上是基于 HTTP 的“拉”（Pull）模型，依赖客户端主动发起请求。\n\n### 优缺点\n\n- **优点**：\n  - 实现简单，基于标准的 HTTP 协议。\n  - 兼容性强，适用于所有浏览器和服务器。\n- **缺点**：\n  - 实时性差，受轮询间隔限制。\n  - 频繁请求导致服务器负载高，资源浪费严重。\n  - 数据更新可能存在延迟。\n\n### 使用场景\n\n短轮询适合对实时性要求不高、数据更新频率较低的场景，例如天气查询、股票价格定时刷新等。\n\n### 源码示例\n\n以下是一个简单的短轮询实现，前端使用 JavaScript，后端使用 Node.js。\n\n#### 前端代码\n```javascript\nfunction pollServer() {\n  fetch('/api/messages')\n    .then(response => response.json())\n    .then(data => {\n      console.log('收到消息:', data);\n      setTimeout(pollServer, 1000); // 每隔1秒轮询\n    })\n    .catch(error => console.error('轮询失败:', error));\n}\n\npollServer();\n```\n\n#### 后端代码 (Node.js + Express)\n```javascript\nconst express = require('express');\nconst app = express();\n\nlet messages = [];\n\napp.get('/api/messages', (req, res) => {\n  res.json(messages); // 立即返回当前消息\n});\n\napp.post('/api/messages', (req, res) => {\n  const newMessage = req.body.message;\n  messages.push(newMessage);\n  res.status(201).send('消息已添加');\n});\n\napp.listen(3000, () => console.log('服务器运行在 3000 端口'));\n```\n\n### 源码解析\n\n- **客户端**：`fetch` 请求服务器的 `/api/messages` 端点，收到响应后通过 `setTimeout` 递归调用，形成轮询。\n- **服务端**：收到 `GET` 请求后立即返回 `messages` 数组，无需等待新数据。\n\n这种实现简单，但如果客户端数量增加或轮询频率提高，服务器将面临大量无意义的请求。\n\n---\n\n## 2. 长轮询（Long Polling）\n\n### 原理\n\n长轮询是对短轮询的改进。客户端发起 HTTP 请求后，服务器并不立即响应，而是“挂起”请求，直到有新数据时才返回。客户端收到响应后立即发起下一次请求，形成循环。\n\n长轮询仍然基于 HTTP，但通过延迟响应减少了无效请求。\n\n### 优缺点\n\n- **优点**：\n  - 相比短轮询，实时性更高。\n  - 减少了无效请求，节省带宽。\n- **缺点**：\n  - 服务器需要维护大量挂起的连接，占用资源。\n  - 仍依赖 HTTP 请求-响应模型，效率不如长连接。\n\n### 使用场景\n\n长轮询适合对实时性有一定要求但无法使用 WebSocket 的场景，例如旧浏览器环境下的聊天应用。\n\n### 源码示例\n\n#### 前端代码\n```javascript\nfunction longPoll() {\n  fetch('/api/long-poll')\n    .then(response => response.json())\n    .then(data => {\n      console.log('收到新消息:', data);\n      longPoll(); // 收到响应后立即再次请求\n    })\n    .catch(error => console.error('长轮询失败:', error));\n}\n\nlongPoll();\n```\n\n#### 后端代码 (Node.js + Express)\n```javascript\nconst express = require('express');\nconst app = express();\n\nlet subscribers = [];\nlet messages = [];\n\napp.get('/api/long-poll', (req, res) => {\n  subscribers.push(res); // 将响应挂起\n});\n\napp.post('/api/messages', (req, res) => {\n  const newMessage = req.body.message;\n  messages.push(newMessage);\n  subscribers.forEach(sub => sub.json(messages)); // 推送给所有挂起的客户端\n  subscribers = []; // 清空订阅者\n  res.status(201).send('消息已添加');\n});\n\napp.listen(3000, () => console.log('服务器运行在 3000 端口'));\n```\n\n### 源码解析\n\n- **客户端**：发起请求后等待服务器响应，收到后立即再次请求。\n- **服务端**：将每个 `GET` 请求的 `res` 对象存入 `subscribers` 数组，等待新消息到来时统一推送。推送后清空订阅者列表。\n\n长轮询的关键在于服务器端的“挂起”逻辑，Node.js 的异步特性非常适合这种实现。但当客户端数量增加时，挂起的连接会显著增加内存和 CPU 消耗。\n\n---\n\n## 3. 长连接（Long Connection）\n\n### 原理\n\n长连接通常指基于 TCP 的持久连接，客户端与服务器建立连接后保持不断开，通过该连接双向传输数据。HTTP/1.1 的 `keep-alive` 和 Server-Sent Events (SSE) 是长连接的典型应用。\n\nSSE 是 HTML5 提供的一种技术，基于 HTTP，通过 `text/event-stream` 类型实现服务器到客户端的单向推送。\n\n### 优缺点\n\n- **优点**：\n  - 连接复用，减少了建立/关闭连接的开销。\n  - SSE 实现简单，适合服务器主动推送场景。\n- **缺点**：\n  - SSE 是单向通信，客户端无法通过同一连接发送数据。\n  - 仍受限于 HTTP 协议，功能不如 WebSocket 强大。\n\n### 使用场景\n\n长连接适用于服务器主动推送的场景，例如实时通知、日志流传输等。\n\n### 源码示例 (SSE)\n\n#### 前端代码\n```javascript\nconst eventSource = new EventSource('/api/sse');\neventSource.onmessage = (event) => {\n  console.log('收到消息:', event.data);\n};\neventSource.onerror = () => {\n  console.error('SSE 连接失败');\n};\n```\n\n#### 后端代码 (Node.js + Express)\n```javascript\nconst express = require('express');\nconst app = express();\n\napp.get('/api/sse', (req, res) => {\n  res.set({\n    'Content-Type': 'text/event-stream',\n    'Cache-Control': 'no-cache',\n    'Connection': 'keep-alive'\n  });\n\n  // 每隔2秒推送一条消息\n  const interval = setInterval(() => {\n    res.write(`data: ${new Date().toISOString()}\\n\\n`);\n  }, 2000);\n\n  req.on('close', () => {\n    clearInterval(interval);\n    res.end();\n  });\n});\n\napp.listen(3000, () => console.log('服务器运行在 3000 端口'));\n```\n\n### 源码解析\n\n- **客户端**：使用 `EventSource` API 建立 SSE 连接，监听 `onmessage` 事件接收数据。\n- **服务端**：设置响应头为 `text/event-stream`，通过 `res.write` 持续推送数据。`req.on('close')` 确保客户端断开时清理资源。\n\nSSE 的核心在于 `keep-alive` 的 TCP 连接和流式数据推送，适合简单的单向通信。\n\n---\n\n## 4. WebSocket\n\n### 原理\n\nWebSocket 是一种基于 TCP 的全双工通信协议，通过一次 HTTP 握手升级为 WebSocket 连接后，客户端和服务器可以双向实时通信。它突破了 HTTP 的请求-响应限制，真正实现了“推”（Push）模型。\n\n握手过程如下：\n1. 客户端发送带有 `Upgrade: websocket` 的 HTTP 请求。\n2. 服务器返回 `101 Switching Protocols`，连接升级为 WebSocket。\n\n### 优缺点\n\n- **优点**：\n  - 全双工通信，效率高，实时性强。\n  - 减少协议开销，适合高频数据传输。\n- **缺点**：\n  - 实现复杂度较高。\n  - 需要服务器和客户端都支持 WebSocket。\n\n### 使用场景\n\nWebSocket 适用于高实时性、双向通信的场景，例如在线聊天、实时游戏、协作编辑等。\n\n### 源码示例\n\n#### 前端代码\n```javascript\nconst socket = new WebSocket('ws://localhost:3000');\n\nsocket.onopen = () => {\n  console.log('WebSocket 连接已建立');\n  socket.send('你好，服务器！');\n};\n\nsocket.onmessage = (event) => {\n  console.log('收到消息:', event.data);\n};\n\nsocket.onclose = () => {\n  console.log('WebSocket 连接已关闭');\n};\n\nsocket.onerror = (error) => {\n  console.error('WebSocket 错误:', error);\n};\n```\n\n#### 后端代码 (Node.js + ws)\n```javascript\nconst WebSocket = require('ws');\nconst server = new WebSocket.Server({ port: 3000 });\n\nserver.on('connection', (ws) => {\n  console.log('客户端已连接');\n\n  ws.on('message', (message) => {\n    console.log('收到消息:', message);\n    ws.send(`服务器回复: ${message}`); // 回显消息\n  });\n\n  ws.on('close', () => {\n    console.log('客户端已断开');\n  });\n});\n\nconsole.log('WebSocket 服务器运行在 3000 端口');\n```\n\n### 源码解析\n\n- **客户端**：通过 `WebSocket` 对象建立连接，监听 `onopen`、`onmessage` 等事件。\n- **服务端**：使用 `ws` 库创建 WebSocket 服务器，处理 `connection` 和 `message` 事件，实现双向通信。\n\nWebSocket 的核心在于握手后的持久连接和帧格式（Frame Format），数据以二进制帧传输，效率远超 HTTP。\n\n---\n\n## 技术对比\n\n| 技术       | 实时性 | 双向通信 | 资源消耗 | 复杂度 | 适用场景           |\n|------------|--------|----------|----------|--------|--------------------|\n| 短轮询     | 低     | 否       | 高       | 低     | 低频更新           |\n| 长轮询     | 中     | 否       | 中       | 中     | 中等实时性         |\n| 长连接(SSE)| 中     | 否       | 中       | 低     | 服务器推送         |\n| WebSocket  | 高     | 是       | 低       | 高     | 高频双向通信       |\n\n---\n\n## 总结\n\n- **短轮询**：简单但低效，适合初学者入门或低实时性场景。\n- **长轮询**：在 HTTP 框架下优化了实时性，但资源占用仍较高。\n- **长连接（SSE）**：轻量级推送方案，适合单向通信。\n- **WebSocket**：现代即时通讯的首选，功能强大但需权衡实现成本。\n\n每种技术都有其适用场景，选择时需根据实时性、双向性、服务器负载和兼容性等因素综合考虑。希望本文的源码解析和示例能帮助你深入理解即时通讯的本质，并在实际项目中灵活运用这些技术！",
    "code": "var Component=(()=>{var p=Object.create;var s=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var u=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),B=(n,e)=>{for(var r in e)s(n,r,{get:e[r],enumerable:!0})},d=(n,e,r,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of y(e))!g.call(n,c)&&c!==r&&s(n,c,{get:()=>e[c],enumerable:!(a=E(e,c))||a.enumerable});return n};var b=(n,e,r)=>(r=n!=null?p(F(n)):{},d(e||!n||!n.__esModule?s(r,\"default\",{value:n,enumerable:!0}):r,n)),f=n=>d(s({},\"__esModule\",{value:!0}),n);var i=u((x,o)=>{o.exports=_jsx_runtime});var k={};B(k,{default:()=>h,frontmatter:()=>m});var l=b(i()),m={type:\"Post\",title:\"\\u804A\\u804A\\u5373\\u65F6\\u901A\\u8BAF - \\u77ED\\u8F6E\\u8BE2\\u3001\\u957F\\u8F6E\\u8BE2\\u3001\\u957F\\u8FDE\\u63A5\\u3001WebSocket\",date:\"2024-04-11\",description:\"\\u6DF1\\u5165\\u63A2\\u8BA8\\u5373\\u65F6\\u901A\\u8BAF\\u7684\\u56DB\\u79CD\\u6838\\u5FC3\\u6280\\u672F\\uFF1A\\u77ED\\u8F6E\\u8BE2\\u3001\\u957F\\u8F6E\\u8BE2\\u3001\\u957F\\u8FDE\\u63A5\\u548C WebSocket\\uFF0C\\u4ECE\\u539F\\u7406\\u5230\\u6E90\\u7801\\u5C42\\u9762\\u5168\\u9762\\u89E3\\u6790\\uFF0C\\u5E26\\u4F60\\u7406\\u89E3\\u73B0\\u4EE3\\u5B9E\\u65F6\\u901A\\u4FE1\\u7684\\u5B9E\\u73B0\\u65B9\\u5F0F\\u3002\",keywords:\"\\u5373\\u65F6\\u901A\\u8BAF, \\u77ED\\u8F6E\\u8BE2, \\u957F\\u8F6E\\u8BE2, \\u957F\\u8FDE\\u63A5, WebSocket, \\u5B9E\\u65F6\\u901A\\u4FE1, HTTP, TCP, \\u6E90\\u7801\\u89E3\\u6790\",author:\"\\u6653\\u9F99\",image:\"/images/hero/instant-messaging.jpg\",tags:[\"\\u5373\\u65F6\\u901A\\u8BAF\",\"\\u7F51\\u7EDC\\u7F16\\u7A0B\",\"WebSocket\",\"\\u524D\\u7AEF\\u5F00\\u53D1\",\"\\u540E\\u7AEF\\u5F00\\u53D1\"],category:\"Network\"};function t(n){let e={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.p,{children:\"\\u5373\\u65F6\\u901A\\u8BAF\\uFF08Instant Messaging, IM\\uFF09\\u662F\\u73B0\\u4EE3\\u5E94\\u7528\\u4E0D\\u53EF\\u6216\\u7F3A\\u7684\\u4E00\\u90E8\\u5206\\u3002\\u4ECE\\u804A\\u5929\\u5E94\\u7528\\u5230\\u5B9E\\u65F6\\u901A\\u77E5\\uFF0C\\u518D\\u5230\\u5728\\u7EBF\\u6E38\\u620F\\uFF0C\\u5B9E\\u65F6\\u6027\\u6210\\u4E3A\\u4E86\\u7528\\u6237\\u4F53\\u9A8C\\u7684\\u6838\\u5FC3\\u3002\\u800C\\u5B9E\\u73B0\\u5373\\u65F6\\u901A\\u8BAF\\u7684\\u6280\\u672F\\u624B\\u6BB5\\u591A\\u79CD\\u591A\\u6837\\uFF0C\\u5176\\u4E2D\\u77ED\\u8F6E\\u8BE2\\uFF08Short Polling\\uFF09\\u3001\\u957F\\u8F6E\\u8BE2\\uFF08Long Polling\\uFF09\\u3001\\u957F\\u8FDE\\u63A5\\uFF08Long Connection\\uFF09\\u548C WebSocket \\u662F\\u6700\\u5E38\\u89C1\\u4E14\\u6700\\u5177\\u4EE3\\u8868\\u6027\\u7684\\u56DB\\u79CD\\u65B9\\u5F0F\\u3002\\u672C\\u6587\\u5C06\\u4ECE\\u539F\\u7406\\u3001\\u4F18\\u7F3A\\u70B9\\u3001\\u4F7F\\u7528\\u573A\\u666F\\u5230\\u6E90\\u7801\\u5C42\\u9762\\uFF0C\\u9010\\u4E00\\u6DF1\\u5EA6\\u89E3\\u6790\\u8FD9\\u56DB\\u79CD\\u6280\\u672F\\uFF0C\\u5E26\\u4F60\\u5F7B\\u5E95\\u641E\\u61C2\\u5373\\u65F6\\u901A\\u8BAF\\u7684\\u5B9E\\u73B0\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"1-\\u77ED\\u8F6E\\u8BE2short-polling\",children:(0,l.jsx)(e.a,{href:\"#1-\\u77ED\\u8F6E\\u8BE2short-polling\",children:\"1. \\u77ED\\u8F6E\\u8BE2\\uFF08Short Polling\\uFF09\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u539F\\u7406\",children:(0,l.jsx)(e.a,{href:\"#\\u539F\\u7406\",children:\"\\u539F\\u7406\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u77ED\\u8F6E\\u8BE2\\u662F\\u6700\\u7B80\\u5355\\u3001\\u6700\\u65E9\\u671F\\u7684\\u5B9E\\u65F6\\u901A\\u4FE1\\u65B9\\u5F0F\\u3002\\u5BA2\\u6237\\u7AEF\\u901A\\u8FC7\\u5B9A\\u671F\\u53D1\\u9001 HTTP \\u8BF7\\u6C42\\uFF08\\u5982\\u6BCF\\u9694 1 \\u79D2\\uFF09\\u5230\\u670D\\u52A1\\u5668\\uFF0C\\u8BE2\\u95EE\\u662F\\u5426\\u6709\\u65B0\\u6570\\u636E\\u3002\\u670D\\u52A1\\u5668\\u6536\\u5230\\u8BF7\\u6C42\\u540E\\u7ACB\\u5373\\u8FD4\\u56DE\\u7ED3\\u679C\\uFF0C\\u65E0\\u8BBA\\u662F\\u5426\\u6709\\u66F4\\u65B0\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u8FD9\\u79CD\\u65B9\\u5F0F\\u672C\\u8D28\\u4E0A\\u662F\\u57FA\\u4E8E HTTP \\u7684\\u201C\\u62C9\\u201D\\uFF08Pull\\uFF09\\u6A21\\u578B\\uFF0C\\u4F9D\\u8D56\\u5BA2\\u6237\\u7AEF\\u4E3B\\u52A8\\u53D1\\u8D77\\u8BF7\\u6C42\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F18\\u7F3A\\u70B9\",children:(0,l.jsx)(e.a,{href:\"#\\u4F18\\u7F3A\\u70B9\",children:\"\\u4F18\\u7F3A\\u70B9\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u4F18\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u5B9E\\u73B0\\u7B80\\u5355\\uFF0C\\u57FA\\u4E8E\\u6807\\u51C6\\u7684 HTTP \\u534F\\u8BAE\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u517C\\u5BB9\\u6027\\u5F3A\\uFF0C\\u9002\\u7528\\u4E8E\\u6240\\u6709\\u6D4F\\u89C8\\u5668\\u548C\\u670D\\u52A1\\u5668\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u7F3A\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u5B9E\\u65F6\\u6027\\u5DEE\\uFF0C\\u53D7\\u8F6E\\u8BE2\\u95F4\\u9694\\u9650\\u5236\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u9891\\u7E41\\u8BF7\\u6C42\\u5BFC\\u81F4\\u670D\\u52A1\\u5668\\u8D1F\\u8F7D\\u9AD8\\uFF0C\\u8D44\\u6E90\\u6D6A\\u8D39\\u4E25\\u91CD\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u6570\\u636E\\u66F4\\u65B0\\u53EF\\u80FD\\u5B58\\u5728\\u5EF6\\u8FDF\\u3002\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F7F\\u7528\\u573A\\u666F\",children:(0,l.jsx)(e.a,{href:\"#\\u4F7F\\u7528\\u573A\\u666F\",children:\"\\u4F7F\\u7528\\u573A\\u666F\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u77ED\\u8F6E\\u8BE2\\u9002\\u5408\\u5BF9\\u5B9E\\u65F6\\u6027\\u8981\\u6C42\\u4E0D\\u9AD8\\u3001\\u6570\\u636E\\u66F4\\u65B0\\u9891\\u7387\\u8F83\\u4F4E\\u7684\\u573A\\u666F\\uFF0C\\u4F8B\\u5982\\u5929\\u6C14\\u67E5\\u8BE2\\u3001\\u80A1\\u7968\\u4EF7\\u683C\\u5B9A\\u65F6\\u5237\\u65B0\\u7B49\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u793A\\u4F8B\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u793A\\u4F8B\",children:\"\\u6E90\\u7801\\u793A\\u4F8B\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u4EE5\\u4E0B\\u662F\\u4E00\\u4E2A\\u7B80\\u5355\\u7684\\u77ED\\u8F6E\\u8BE2\\u5B9E\\u73B0\\uFF0C\\u524D\\u7AEF\\u4F7F\\u7528 JavaScript\\uFF0C\\u540E\\u7AEF\\u4F7F\\u7528 Node.js\\u3002\"}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u524D\\u7AEF\\u4EE3\\u7801\",children:(0,l.jsx)(e.a,{href:\"#\\u524D\\u7AEF\\u4EE3\\u7801\",children:\"\\u524D\\u7AEF\\u4EE3\\u7801\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"function\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" pollServer\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"  fetch\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/messages'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"response\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"data\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6536\\u5230\\u6D88\\u606F:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", data);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"      setTimeout\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(pollServer, \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u6BCF\\u96941\\u79D2\\u8F6E\\u8BE2\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    })\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"catch\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u8F6E\\u8BE2\\u5931\\u8D25:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", error));\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"pollServer\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]})]})})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--express\",children:(0,l.jsx)(e.a,{href:\"#\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--express\",children:\"\\u540E\\u7AEF\\u4EE3\\u7801 (Node.js + Express)\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'express'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" app\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" messages \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/messages'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(messages); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u7ACB\\u5373\\u8FD4\\u56DE\\u5F53\\u524D\\u6D88\\u606F\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"post\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/messages'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" newMessage\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" req.body.message;\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  messages.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(newMessage);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"201\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6D88\\u606F\\u5DF2\\u6DFB\\u52A0'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"listen\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u670D\\u52A1\\u5668\\u8FD0\\u884C\\u5728 3000 \\u7AEF\\u53E3'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]})]})})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u89E3\\u6790\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u5BA2\\u6237\\u7AEF\"}),\"\\uFF1A\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"fetch\"})})})}),\" \\u8BF7\\u6C42\\u670D\\u52A1\\u5668\\u7684 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"/api/messages\"})})})}),\" \\u7AEF\\u70B9\\uFF0C\\u6536\\u5230\\u54CD\\u5E94\\u540E\\u901A\\u8FC7 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"setTimeout\"})})})}),\" \\u9012\\u5F52\\u8C03\\u7528\\uFF0C\\u5F62\\u6210\\u8F6E\\u8BE2\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u670D\\u52A1\\u7AEF\"}),\"\\uFF1A\\u6536\\u5230 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"GET\"})})})}),\" \\u8BF7\\u6C42\\u540E\\u7ACB\\u5373\\u8FD4\\u56DE \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"messages\"})})})}),\" \\u6570\\u7EC4\\uFF0C\\u65E0\\u9700\\u7B49\\u5F85\\u65B0\\u6570\\u636E\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u8FD9\\u79CD\\u5B9E\\u73B0\\u7B80\\u5355\\uFF0C\\u4F46\\u5982\\u679C\\u5BA2\\u6237\\u7AEF\\u6570\\u91CF\\u589E\\u52A0\\u6216\\u8F6E\\u8BE2\\u9891\\u7387\\u63D0\\u9AD8\\uFF0C\\u670D\\u52A1\\u5668\\u5C06\\u9762\\u4E34\\u5927\\u91CF\\u65E0\\u610F\\u4E49\\u7684\\u8BF7\\u6C42\\u3002\"}),`\n`,(0,l.jsx)(e.hr,{}),`\n`,(0,l.jsx)(e.h2,{id:\"2-\\u957F\\u8F6E\\u8BE2long-polling\",children:(0,l.jsx)(e.a,{href:\"#2-\\u957F\\u8F6E\\u8BE2long-polling\",children:\"2. \\u957F\\u8F6E\\u8BE2\\uFF08Long Polling\\uFF09\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u539F\\u7406-1\",children:(0,l.jsx)(e.a,{href:\"#\\u539F\\u7406-1\",children:\"\\u539F\\u7406\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u957F\\u8F6E\\u8BE2\\u662F\\u5BF9\\u77ED\\u8F6E\\u8BE2\\u7684\\u6539\\u8FDB\\u3002\\u5BA2\\u6237\\u7AEF\\u53D1\\u8D77 HTTP \\u8BF7\\u6C42\\u540E\\uFF0C\\u670D\\u52A1\\u5668\\u5E76\\u4E0D\\u7ACB\\u5373\\u54CD\\u5E94\\uFF0C\\u800C\\u662F\\u201C\\u6302\\u8D77\\u201D\\u8BF7\\u6C42\\uFF0C\\u76F4\\u5230\\u6709\\u65B0\\u6570\\u636E\\u65F6\\u624D\\u8FD4\\u56DE\\u3002\\u5BA2\\u6237\\u7AEF\\u6536\\u5230\\u54CD\\u5E94\\u540E\\u7ACB\\u5373\\u53D1\\u8D77\\u4E0B\\u4E00\\u6B21\\u8BF7\\u6C42\\uFF0C\\u5F62\\u6210\\u5FAA\\u73AF\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u957F\\u8F6E\\u8BE2\\u4ECD\\u7136\\u57FA\\u4E8E HTTP\\uFF0C\\u4F46\\u901A\\u8FC7\\u5EF6\\u8FDF\\u54CD\\u5E94\\u51CF\\u5C11\\u4E86\\u65E0\\u6548\\u8BF7\\u6C42\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F18\\u7F3A\\u70B9-1\",children:(0,l.jsx)(e.a,{href:\"#\\u4F18\\u7F3A\\u70B9-1\",children:\"\\u4F18\\u7F3A\\u70B9\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u4F18\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u76F8\\u6BD4\\u77ED\\u8F6E\\u8BE2\\uFF0C\\u5B9E\\u65F6\\u6027\\u66F4\\u9AD8\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u51CF\\u5C11\\u4E86\\u65E0\\u6548\\u8BF7\\u6C42\\uFF0C\\u8282\\u7701\\u5E26\\u5BBD\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u7F3A\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u670D\\u52A1\\u5668\\u9700\\u8981\\u7EF4\\u62A4\\u5927\\u91CF\\u6302\\u8D77\\u7684\\u8FDE\\u63A5\\uFF0C\\u5360\\u7528\\u8D44\\u6E90\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u4ECD\\u4F9D\\u8D56 HTTP \\u8BF7\\u6C42-\\u54CD\\u5E94\\u6A21\\u578B\\uFF0C\\u6548\\u7387\\u4E0D\\u5982\\u957F\\u8FDE\\u63A5\\u3002\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F7F\\u7528\\u573A\\u666F-1\",children:(0,l.jsx)(e.a,{href:\"#\\u4F7F\\u7528\\u573A\\u666F-1\",children:\"\\u4F7F\\u7528\\u573A\\u666F\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u957F\\u8F6E\\u8BE2\\u9002\\u5408\\u5BF9\\u5B9E\\u65F6\\u6027\\u6709\\u4E00\\u5B9A\\u8981\\u6C42\\u4F46\\u65E0\\u6CD5\\u4F7F\\u7528 WebSocket \\u7684\\u573A\\u666F\\uFF0C\\u4F8B\\u5982\\u65E7\\u6D4F\\u89C8\\u5668\\u73AF\\u5883\\u4E0B\\u7684\\u804A\\u5929\\u5E94\\u7528\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u793A\\u4F8B-1\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u793A\\u4F8B-1\",children:\"\\u6E90\\u7801\\u793A\\u4F8B\"})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u524D\\u7AEF\\u4EE3\\u7801-1\",children:(0,l.jsx)(e.a,{href:\"#\\u524D\\u7AEF\\u4EE3\\u7801-1\",children:\"\\u524D\\u7AEF\\u4EE3\\u7801\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"function\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" longPoll\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"() {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"  fetch\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/long-poll'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"response\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"then\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"data\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"      console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6536\\u5230\\u65B0\\u6D88\\u606F:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", data);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"      longPoll\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u6536\\u5230\\u54CD\\u5E94\\u540E\\u7ACB\\u5373\\u518D\\u6B21\\u8BF7\\u6C42\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    })\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"catch\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u957F\\u8F6E\\u8BE2\\u5931\\u8D25:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", error));\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"longPoll\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]})]})})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--express-1\",children:(0,l.jsx)(e.a,{href:\"#\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--express-1\",children:\"\\u540E\\u7AEF\\u4EE3\\u7801 (Node.js + Express)\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'express'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" app\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" subscribers \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" messages \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" [];\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/long-poll'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  subscribers.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(res); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u5C06\\u54CD\\u5E94\\u6302\\u8D77\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"post\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/messages'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" newMessage\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" req.body.message;\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  messages.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"push\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(newMessage);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  subscribers.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"forEach\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"sub\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sub.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"json\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(messages)); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u63A8\\u9001\\u7ED9\\u6240\\u6709\\u6302\\u8D77\\u7684\\u5BA2\\u6237\\u7AEF\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  subscribers \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []; \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u6E05\\u7A7A\\u8BA2\\u9605\\u8005\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"status\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"201\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6D88\\u606F\\u5DF2\\u6DFB\\u52A0'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"listen\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u670D\\u52A1\\u5668\\u8FD0\\u884C\\u5728 3000 \\u7AEF\\u53E3'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]})]})})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u89E3\\u6790-1\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-1\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u5BA2\\u6237\\u7AEF\"}),\"\\uFF1A\\u53D1\\u8D77\\u8BF7\\u6C42\\u540E\\u7B49\\u5F85\\u670D\\u52A1\\u5668\\u54CD\\u5E94\\uFF0C\\u6536\\u5230\\u540E\\u7ACB\\u5373\\u518D\\u6B21\\u8BF7\\u6C42\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u670D\\u52A1\\u7AEF\"}),\"\\uFF1A\\u5C06\\u6BCF\\u4E2A \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"GET\"})})})}),\" \\u8BF7\\u6C42\\u7684 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"res\"})})})}),\" \\u5BF9\\u8C61\\u5B58\\u5165 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"subscribers\"})})})}),\" \\u6570\\u7EC4\\uFF0C\\u7B49\\u5F85\\u65B0\\u6D88\\u606F\\u5230\\u6765\\u65F6\\u7EDF\\u4E00\\u63A8\\u9001\\u3002\\u63A8\\u9001\\u540E\\u6E05\\u7A7A\\u8BA2\\u9605\\u8005\\u5217\\u8868\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u957F\\u8F6E\\u8BE2\\u7684\\u5173\\u952E\\u5728\\u4E8E\\u670D\\u52A1\\u5668\\u7AEF\\u7684\\u201C\\u6302\\u8D77\\u201D\\u903B\\u8F91\\uFF0CNode.js \\u7684\\u5F02\\u6B65\\u7279\\u6027\\u975E\\u5E38\\u9002\\u5408\\u8FD9\\u79CD\\u5B9E\\u73B0\\u3002\\u4F46\\u5F53\\u5BA2\\u6237\\u7AEF\\u6570\\u91CF\\u589E\\u52A0\\u65F6\\uFF0C\\u6302\\u8D77\\u7684\\u8FDE\\u63A5\\u4F1A\\u663E\\u8457\\u589E\\u52A0\\u5185\\u5B58\\u548C CPU \\u6D88\\u8017\\u3002\"}),`\n`,(0,l.jsx)(e.hr,{}),`\n`,(0,l.jsx)(e.h2,{id:\"3-\\u957F\\u8FDE\\u63A5long-connection\",children:(0,l.jsx)(e.a,{href:\"#3-\\u957F\\u8FDE\\u63A5long-connection\",children:\"3. \\u957F\\u8FDE\\u63A5\\uFF08Long Connection\\uFF09\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u539F\\u7406-2\",children:(0,l.jsx)(e.a,{href:\"#\\u539F\\u7406-2\",children:\"\\u539F\\u7406\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u957F\\u8FDE\\u63A5\\u901A\\u5E38\\u6307\\u57FA\\u4E8E TCP \\u7684\\u6301\\u4E45\\u8FDE\\u63A5\\uFF0C\\u5BA2\\u6237\\u7AEF\\u4E0E\\u670D\\u52A1\\u5668\\u5EFA\\u7ACB\\u8FDE\\u63A5\\u540E\\u4FDD\\u6301\\u4E0D\\u65AD\\u5F00\\uFF0C\\u901A\\u8FC7\\u8BE5\\u8FDE\\u63A5\\u53CC\\u5411\\u4F20\\u8F93\\u6570\\u636E\\u3002HTTP/1.1 \\u7684 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"keep-alive\"})})})}),\" \\u548C Server-Sent Events (SSE) \\u662F\\u957F\\u8FDE\\u63A5\\u7684\\u5178\\u578B\\u5E94\\u7528\\u3002\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"SSE \\u662F HTML5 \\u63D0\\u4F9B\\u7684\\u4E00\\u79CD\\u6280\\u672F\\uFF0C\\u57FA\\u4E8E HTTP\\uFF0C\\u901A\\u8FC7 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"text/event-stream\"})})})}),\" \\u7C7B\\u578B\\u5B9E\\u73B0\\u670D\\u52A1\\u5668\\u5230\\u5BA2\\u6237\\u7AEF\\u7684\\u5355\\u5411\\u63A8\\u9001\\u3002\"]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F18\\u7F3A\\u70B9-2\",children:(0,l.jsx)(e.a,{href:\"#\\u4F18\\u7F3A\\u70B9-2\",children:\"\\u4F18\\u7F3A\\u70B9\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u4F18\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u8FDE\\u63A5\\u590D\\u7528\\uFF0C\\u51CF\\u5C11\\u4E86\\u5EFA\\u7ACB/\\u5173\\u95ED\\u8FDE\\u63A5\\u7684\\u5F00\\u9500\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"SSE \\u5B9E\\u73B0\\u7B80\\u5355\\uFF0C\\u9002\\u5408\\u670D\\u52A1\\u5668\\u4E3B\\u52A8\\u63A8\\u9001\\u573A\\u666F\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u7F3A\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"SSE \\u662F\\u5355\\u5411\\u901A\\u4FE1\\uFF0C\\u5BA2\\u6237\\u7AEF\\u65E0\\u6CD5\\u901A\\u8FC7\\u540C\\u4E00\\u8FDE\\u63A5\\u53D1\\u9001\\u6570\\u636E\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u4ECD\\u53D7\\u9650\\u4E8E HTTP \\u534F\\u8BAE\\uFF0C\\u529F\\u80FD\\u4E0D\\u5982 WebSocket \\u5F3A\\u5927\\u3002\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F7F\\u7528\\u573A\\u666F-2\",children:(0,l.jsx)(e.a,{href:\"#\\u4F7F\\u7528\\u573A\\u666F-2\",children:\"\\u4F7F\\u7528\\u573A\\u666F\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u957F\\u8FDE\\u63A5\\u9002\\u7528\\u4E8E\\u670D\\u52A1\\u5668\\u4E3B\\u52A8\\u63A8\\u9001\\u7684\\u573A\\u666F\\uFF0C\\u4F8B\\u5982\\u5B9E\\u65F6\\u901A\\u77E5\\u3001\\u65E5\\u5FD7\\u6D41\\u4F20\\u8F93\\u7B49\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u793A\\u4F8B-sse\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u793A\\u4F8B-sse\",children:\"\\u6E90\\u7801\\u793A\\u4F8B (SSE)\"})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u524D\\u7AEF\\u4EE3\\u7801-2\",children:(0,l.jsx)(e.a,{href:\"#\\u524D\\u7AEF\\u4EE3\\u7801-2\",children:\"\\u524D\\u7AEF\\u4EE3\\u7801\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" eventSource\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" EventSource\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/sse'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"eventSource.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"onmessage\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"event\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6536\\u5230\\u6D88\\u606F:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", event.data);\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"eventSource.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"onerror\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'SSE \\u8FDE\\u63A5\\u5931\\u8D25'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--express-2\",children:(0,l.jsx)(e.a,{href:\"#\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--express-2\",children:\"\\u540E\\u7AEF\\u4EE3\\u7801 (Node.js + Express)\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'express'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" app\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'/api/sse'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"set\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    'Content-Type'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'text/event-stream'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    'Cache-Control'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'no-cache'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    'Connection'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'keep-alive'\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"  // \\u6BCF\\u96942\\u79D2\\u63A8\\u9001\\u4E00\\u6761\\u6D88\\u606F\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" interval\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" setInterval\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"write\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`data: ${\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"new\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Date\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"().\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"toISOString\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"()\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"\\\\n\\\\n\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  }, \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  req.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"on\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'close'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"    clearInterval\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(interval);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"end\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"listen\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u670D\\u52A1\\u5668\\u8FD0\\u884C\\u5728 3000 \\u7AEF\\u53E3'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]})]})})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u89E3\\u6790-2\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-2\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u5BA2\\u6237\\u7AEF\"}),\"\\uFF1A\\u4F7F\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"EventSource\"})})})}),\" API \\u5EFA\\u7ACB SSE \\u8FDE\\u63A5\\uFF0C\\u76D1\\u542C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"onmessage\"})})})}),\" \\u4E8B\\u4EF6\\u63A5\\u6536\\u6570\\u636E\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u670D\\u52A1\\u7AEF\"}),\"\\uFF1A\\u8BBE\\u7F6E\\u54CD\\u5E94\\u5934\\u4E3A \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"text/event-stream\"})})})}),\"\\uFF0C\\u901A\\u8FC7 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"res.write\"})})})}),\" \\u6301\\u7EED\\u63A8\\u9001\\u6570\\u636E\\u3002\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"req.on('close')\"})})})}),\" \\u786E\\u4FDD\\u5BA2\\u6237\\u7AEF\\u65AD\\u5F00\\u65F6\\u6E05\\u7406\\u8D44\\u6E90\\u3002\"]}),`\n`]}),`\n`,(0,l.jsxs)(e.p,{children:[\"SSE \\u7684\\u6838\\u5FC3\\u5728\\u4E8E \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"keep-alive\"})})})}),\" \\u7684 TCP \\u8FDE\\u63A5\\u548C\\u6D41\\u5F0F\\u6570\\u636E\\u63A8\\u9001\\uFF0C\\u9002\\u5408\\u7B80\\u5355\\u7684\\u5355\\u5411\\u901A\\u4FE1\\u3002\"]}),`\n`,(0,l.jsx)(e.hr,{}),`\n`,(0,l.jsx)(e.h2,{id:\"4-websocket\",children:(0,l.jsx)(e.a,{href:\"#4-websocket\",children:\"4. WebSocket\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u539F\\u7406-3\",children:(0,l.jsx)(e.a,{href:\"#\\u539F\\u7406-3\",children:\"\\u539F\\u7406\"})}),`\n`,(0,l.jsx)(e.p,{children:\"WebSocket \\u662F\\u4E00\\u79CD\\u57FA\\u4E8E TCP \\u7684\\u5168\\u53CC\\u5DE5\\u901A\\u4FE1\\u534F\\u8BAE\\uFF0C\\u901A\\u8FC7\\u4E00\\u6B21 HTTP \\u63E1\\u624B\\u5347\\u7EA7\\u4E3A WebSocket \\u8FDE\\u63A5\\u540E\\uFF0C\\u5BA2\\u6237\\u7AEF\\u548C\\u670D\\u52A1\\u5668\\u53EF\\u4EE5\\u53CC\\u5411\\u5B9E\\u65F6\\u901A\\u4FE1\\u3002\\u5B83\\u7A81\\u7834\\u4E86 HTTP \\u7684\\u8BF7\\u6C42-\\u54CD\\u5E94\\u9650\\u5236\\uFF0C\\u771F\\u6B63\\u5B9E\\u73B0\\u4E86\\u201C\\u63A8\\u201D\\uFF08Push\\uFF09\\u6A21\\u578B\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u63E1\\u624B\\u8FC7\\u7A0B\\u5982\\u4E0B\\uFF1A\"}),`\n`,(0,l.jsxs)(e.ol,{children:[`\n`,(0,l.jsxs)(e.li,{children:[\"\\u5BA2\\u6237\\u7AEF\\u53D1\\u9001\\u5E26\\u6709 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"Upgrade: websocket\"})})})}),\" \\u7684 HTTP \\u8BF7\\u6C42\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[\"\\u670D\\u52A1\\u5668\\u8FD4\\u56DE \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"101 Switching Protocols\"})})})}),\"\\uFF0C\\u8FDE\\u63A5\\u5347\\u7EA7\\u4E3A WebSocket\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F18\\u7F3A\\u70B9-3\",children:(0,l.jsx)(e.a,{href:\"#\\u4F18\\u7F3A\\u70B9-3\",children:\"\\u4F18\\u7F3A\\u70B9\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u4F18\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u5168\\u53CC\\u5DE5\\u901A\\u4FE1\\uFF0C\\u6548\\u7387\\u9AD8\\uFF0C\\u5B9E\\u65F6\\u6027\\u5F3A\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u51CF\\u5C11\\u534F\\u8BAE\\u5F00\\u9500\\uFF0C\\u9002\\u5408\\u9AD8\\u9891\\u6570\\u636E\\u4F20\\u8F93\\u3002\"}),`\n`]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u7F3A\\u70B9\"}),\"\\uFF1A\",`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"\\u5B9E\\u73B0\\u590D\\u6742\\u5EA6\\u8F83\\u9AD8\\u3002\"}),`\n`,(0,l.jsx)(e.li,{children:\"\\u9700\\u8981\\u670D\\u52A1\\u5668\\u548C\\u5BA2\\u6237\\u7AEF\\u90FD\\u652F\\u6301 WebSocket\\u3002\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4F7F\\u7528\\u573A\\u666F-3\",children:(0,l.jsx)(e.a,{href:\"#\\u4F7F\\u7528\\u573A\\u666F-3\",children:\"\\u4F7F\\u7528\\u573A\\u666F\"})}),`\n`,(0,l.jsx)(e.p,{children:\"WebSocket \\u9002\\u7528\\u4E8E\\u9AD8\\u5B9E\\u65F6\\u6027\\u3001\\u53CC\\u5411\\u901A\\u4FE1\\u7684\\u573A\\u666F\\uFF0C\\u4F8B\\u5982\\u5728\\u7EBF\\u804A\\u5929\\u3001\\u5B9E\\u65F6\\u6E38\\u620F\\u3001\\u534F\\u4F5C\\u7F16\\u8F91\\u7B49\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u793A\\u4F8B-2\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u793A\\u4F8B-2\",children:\"\\u6E90\\u7801\\u793A\\u4F8B\"})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u524D\\u7AEF\\u4EE3\\u7801-3\",children:(0,l.jsx)(e.a,{href:\"#\\u524D\\u7AEF\\u4EE3\\u7801-3\",children:\"\\u524D\\u7AEF\\u4EE3\\u7801\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" socket\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" WebSocket\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'ws://localhost:3000'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"socket.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"onopen\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'WebSocket \\u8FDE\\u63A5\\u5DF2\\u5EFA\\u7ACB'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  socket.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u4F60\\u597D\\uFF0C\\u670D\\u52A1\\u5668\\uFF01'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"socket.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"onmessage\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"event\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6536\\u5230\\u6D88\\u606F:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", event.data);\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"socket.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"onclose\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'WebSocket \\u8FDE\\u63A5\\u5DF2\\u5173\\u95ED'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"socket.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"onerror\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'WebSocket \\u9519\\u8BEF:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", error);\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,l.jsx)(e.h4,{id:\"\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--ws\",children:(0,l.jsx)(e.a,{href:\"#\\u540E\\u7AEF\\u4EE3\\u7801-nodejs--ws\",children:\"\\u540E\\u7AEF\\u4EE3\\u7801 (Node.js + ws)\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" WebSocket\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'ws'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" server\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" WebSocket.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Server\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({ port: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"server.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"on\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'connection'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"ws\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u5BA2\\u6237\\u7AEF\\u5DF2\\u8FDE\\u63A5'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  ws.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"on\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'message'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"message\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u6536\\u5230\\u6D88\\u606F:'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", message);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    ws.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`\\u670D\\u52A1\\u5668\\u56DE\\u590D: ${\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"message\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u56DE\\u663E\\u6D88\\u606F\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  ws.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"on\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'close'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'\\u5BA2\\u6237\\u7AEF\\u5DF2\\u65AD\\u5F00'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'WebSocket \\u670D\\u52A1\\u5668\\u8FD0\\u884C\\u5728 3000 \\u7AEF\\u53E3'\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})]})})}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u6E90\\u7801\\u89E3\\u6790-3\",children:(0,l.jsx)(e.a,{href:\"#\\u6E90\\u7801\\u89E3\\u6790-3\",children:\"\\u6E90\\u7801\\u89E3\\u6790\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u5BA2\\u6237\\u7AEF\"}),\"\\uFF1A\\u901A\\u8FC7 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"WebSocket\"})})})}),\" \\u5BF9\\u8C61\\u5EFA\\u7ACB\\u8FDE\\u63A5\\uFF0C\\u76D1\\u542C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"onopen\"})})})}),\"\\u3001\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"onmessage\"})})})}),\" \\u7B49\\u4E8B\\u4EF6\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u670D\\u52A1\\u7AEF\"}),\"\\uFF1A\\u4F7F\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"ws\"})})})}),\" \\u5E93\\u521B\\u5EFA WebSocket \\u670D\\u52A1\\u5668\\uFF0C\\u5904\\u7406 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"connection\"})})})}),\" \\u548C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"message\"})})})}),\" \\u4E8B\\u4EF6\\uFF0C\\u5B9E\\u73B0\\u53CC\\u5411\\u901A\\u4FE1\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"WebSocket \\u7684\\u6838\\u5FC3\\u5728\\u4E8E\\u63E1\\u624B\\u540E\\u7684\\u6301\\u4E45\\u8FDE\\u63A5\\u548C\\u5E27\\u683C\\u5F0F\\uFF08Frame Format\\uFF09\\uFF0C\\u6570\\u636E\\u4EE5\\u4E8C\\u8FDB\\u5236\\u5E27\\u4F20\\u8F93\\uFF0C\\u6548\\u7387\\u8FDC\\u8D85 HTTP\\u3002\"}),`\n`,(0,l.jsx)(e.hr,{}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u6280\\u672F\\u5BF9\\u6BD4\",children:(0,l.jsx)(e.a,{href:\"#\\u6280\\u672F\\u5BF9\\u6BD4\",children:\"\\u6280\\u672F\\u5BF9\\u6BD4\"})}),`\n`,(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:\"\\u6280\\u672F\"}),(0,l.jsx)(e.th,{children:\"\\u5B9E\\u65F6\\u6027\"}),(0,l.jsx)(e.th,{children:\"\\u53CC\\u5411\\u901A\\u4FE1\"}),(0,l.jsx)(e.th,{children:\"\\u8D44\\u6E90\\u6D88\\u8017\"}),(0,l.jsx)(e.th,{children:\"\\u590D\\u6742\\u5EA6\"}),(0,l.jsx)(e.th,{children:\"\\u9002\\u7528\\u573A\\u666F\"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u77ED\\u8F6E\\u8BE2\"}),(0,l.jsx)(e.td,{children:\"\\u4F4E\"}),(0,l.jsx)(e.td,{children:\"\\u5426\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\"}),(0,l.jsx)(e.td,{children:\"\\u4F4E\"}),(0,l.jsx)(e.td,{children:\"\\u4F4E\\u9891\\u66F4\\u65B0\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u957F\\u8F6E\\u8BE2\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u5426\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\\u7B49\\u5B9E\\u65F6\\u6027\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"\\u957F\\u8FDE\\u63A5(SSE)\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u5426\"}),(0,l.jsx)(e.td,{children:\"\\u4E2D\"}),(0,l.jsx)(e.td,{children:\"\\u4F4E\"}),(0,l.jsx)(e.td,{children:\"\\u670D\\u52A1\\u5668\\u63A8\\u9001\"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:\"WebSocket\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\"}),(0,l.jsx)(e.td,{children:\"\\u662F\"}),(0,l.jsx)(e.td,{children:\"\\u4F4E\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\"}),(0,l.jsx)(e.td,{children:\"\\u9AD8\\u9891\\u53CC\\u5411\\u901A\\u4FE1\"})]})]})]}),`\n`,(0,l.jsx)(e.hr,{}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u603B\\u7ED3\",children:(0,l.jsx)(e.a,{href:\"#\\u603B\\u7ED3\",children:\"\\u603B\\u7ED3\"})}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u77ED\\u8F6E\\u8BE2\"}),\"\\uFF1A\\u7B80\\u5355\\u4F46\\u4F4E\\u6548\\uFF0C\\u9002\\u5408\\u521D\\u5B66\\u8005\\u5165\\u95E8\\u6216\\u4F4E\\u5B9E\\u65F6\\u6027\\u573A\\u666F\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u957F\\u8F6E\\u8BE2\"}),\"\\uFF1A\\u5728 HTTP \\u6846\\u67B6\\u4E0B\\u4F18\\u5316\\u4E86\\u5B9E\\u65F6\\u6027\\uFF0C\\u4F46\\u8D44\\u6E90\\u5360\\u7528\\u4ECD\\u8F83\\u9AD8\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u957F\\u8FDE\\u63A5\\uFF08SSE\\uFF09\"}),\"\\uFF1A\\u8F7B\\u91CF\\u7EA7\\u63A8\\u9001\\u65B9\\u6848\\uFF0C\\u9002\\u5408\\u5355\\u5411\\u901A\\u4FE1\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"WebSocket\"}),\"\\uFF1A\\u73B0\\u4EE3\\u5373\\u65F6\\u901A\\u8BAF\\u7684\\u9996\\u9009\\uFF0C\\u529F\\u80FD\\u5F3A\\u5927\\u4F46\\u9700\\u6743\\u8861\\u5B9E\\u73B0\\u6210\\u672C\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u6BCF\\u79CD\\u6280\\u672F\\u90FD\\u6709\\u5176\\u9002\\u7528\\u573A\\u666F\\uFF0C\\u9009\\u62E9\\u65F6\\u9700\\u6839\\u636E\\u5B9E\\u65F6\\u6027\\u3001\\u53CC\\u5411\\u6027\\u3001\\u670D\\u52A1\\u5668\\u8D1F\\u8F7D\\u548C\\u517C\\u5BB9\\u6027\\u7B49\\u56E0\\u7D20\\u7EFC\\u5408\\u8003\\u8651\\u3002\\u5E0C\\u671B\\u672C\\u6587\\u7684\\u6E90\\u7801\\u89E3\\u6790\\u548C\\u793A\\u4F8B\\u80FD\\u5E2E\\u52A9\\u4F60\\u6DF1\\u5165\\u7406\\u89E3\\u5373\\u65F6\\u901A\\u8BAF\\u7684\\u672C\\u8D28\\uFF0C\\u5E76\\u5728\\u5B9E\\u9645\\u9879\\u76EE\\u4E2D\\u7075\\u6D3B\\u8FD0\\u7528\\u8FD9\\u4E9B\\u6280\\u672F\\uFF01\"})]})}function h(n={}){let{wrapper:e}=n.components||{};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(t,{...n})}):t(n)}return f(k);})();\n;return Component;"
  },
  "_id": "Network/即时通讯.mdx",
  "_raw": {
    "sourceFilePath": "Network/即时通讯.mdx",
    "sourceFileName": "即时通讯.mdx",
    "sourceFileDir": "Network",
    "contentType": "mdx",
    "flattenedPath": "Network/即时通讯"
  },
  "type": "Post",
  "url": "/blog/Network/即时通讯"
}