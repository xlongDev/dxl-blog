{
  "title": "Node.js æ€§èƒ½æå‡ç¥žå™¨ï¼šç”¨ Tinypool å®žçŽ°å¤šä»»åŠ¡å¹¶è¡Œå¤„ç†",
  "date": "2024-02-05T00:00:00.000Z",
  "description": "ä¸€ç¯‡æ·±å…¥å‰–æž Tinypool çš„åšå®¢ï¼Œå¸¦ä½ æŽ¢ç´¢ Node.js å¤šä»»åŠ¡å¹¶è¡Œçš„ç§˜å¯†æ­¦å™¨ï¼Œä»ŽåŽŸç†åˆ°å®žæˆ˜ï¼Œè§£é”æ€§èƒ½ä¼˜åŒ–çš„æ–°å§¿åŠ¿ã€‚",
  "keywords": "Node.js, Tinypool, å¤šçº¿ç¨‹, Worker Threads, æ€§èƒ½ä¼˜åŒ–, å¹¶è¡Œå¤„ç†, JavaScript, æœåŠ¡ç«¯å¼€å‘",
  "author": "æ™“é¾™",
  "image": "/images/hero/tinypool.jpg",
  "tags": [
    "Node.js",
    "Tinypool",
    "æ€§èƒ½ä¼˜åŒ–"
  ],
  "views": 0,
  "likes": 0,
  "category": "Node.js",
  "body": {
    "raw": "\nå˜¿ï¼Œæœ‹å‹ï¼ä»Šå¤©å’±ä»¬èŠèŠ Node.js çš„â€œæ€§èƒ½æ•‘æ˜Ÿâ€â€”â€”Tinypoolã€‚ä½ æ˜¯ä¸æ˜¯ä¹Ÿé‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼šNode.js å•çº¿ç¨‹è·‘å¾—é£žå¿«ï¼Œä½†ä¸€ç¢°åˆ° CPU å¯†é›†åž‹ä»»åŠ¡ï¼ˆæ¯”å¦‚å›¾ç‰‡å¤„ç†ã€å¤æ‚è®¡ç®—ï¼‰ï¼Œå°±è·Ÿå¡äº†å£³ä¼¼çš„å–˜ä¸è¿‡æ°”ï¼Ÿåˆ«æ€¥ï¼ŒTinypool æ¥äº†ï¼Œå®ƒå°±åƒç»™ Node.js è£…äº†ä¸ªâ€œæ¶¡è½®å¢žåŽ‹å™¨â€ï¼Œè®©å¤šä»»åŠ¡å¹¶è¡Œå¤„ç†å˜å¾—è½»æ¾åˆé«˜æ•ˆã€‚ä»Šå¤©æˆ‘å°±å¸¦ä½ ä»ŽåŽŸç†åˆ°å®žæˆ˜ï¼Œæ‰’ä¸€æ‰’è¿™ä¸ªå°è€Œç¾Žçš„å·¥å…·ï¼Œé¡ºä¾¿åˆ†äº«ç‚¹æˆ‘çš„â€œè¡€æ³ªç»éªŒâ€å’Œå®žç”¨æŠ€å·§ ðŸ˜Žã€‚\n\n## Tinypool æ˜¯å•¥ï¼Ÿä»Ž Node.js çš„â€œå•çº¿ç¨‹ç—›ç‚¹â€è¯´èµ·\n\nNode.js çš„å•çº¿ç¨‹è®¾è®¡æ˜¯ä¸ªâ€œåŒåˆƒå‰‘â€ã€‚å¤„ç† I/O æ“ä½œæ—¶ï¼Œå®ƒåƒä¸ªâ€œå¿«é€’å‘˜â€ï¼Œè·‘å¾—é£žå¿«ï¼›ä½†é‡åˆ° CPU å¯†é›†åž‹ä»»åŠ¡ï¼Œå°±å˜æˆäº†â€œå•äººæ¬ç –å·¥â€ï¼Œç´¯å¾—æ»¡å¤´å¤§æ±—ã€‚å®˜æ–¹çš„ `worker_threads` æ¨¡å—ç»™äº†æˆ‘ä»¬å¤šçº¿ç¨‹èƒ½åŠ›ï¼Œå¯ç”¨èµ·æ¥å´æœ‰ç‚¹â€œåŽŸå§‹â€â€”â€”æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ã€é€šä¿¡ã€ç®¡ç†é”€æ¯ï¼Œå†™ç€å†™ç€å°±è§‰å¾—è‡ªå·±åƒä¸ªâ€œçº¿ç¨‹è°ƒåº¦å‘˜â€ã€‚\n\nTinypool æ˜¯ä¸ªåŸºäºŽ `worker_threads` çš„çº¿ç¨‹æ± åº“ï¼Œç”± Node.js ç¤¾åŒºå¤§ä½¬ä»¬æ‰“é€ ï¼ˆæ²¡é”™ï¼Œå°±æ˜¯é‚£äº›æž Fastify å’Œ Pino çš„å®¶ä¼™ï¼‰ã€‚å®ƒæŠŠçº¿ç¨‹ç®¡ç†çš„è„æ´»ç´¯æ´»å…¨åŒ…äº†ï¼Œåªç•™ç»™ä½ ä¸€ä¸ªç®€å•åˆ°çˆ†çš„ APIã€‚ç®€å•è¯´ï¼Œå®ƒå°±åƒä¸ªâ€œçº¿ç¨‹ç®¡å®¶â€ï¼Œå¸®ä½ ä¼˜é›…åœ°å¤„ç†å¤šä»»åŠ¡å¹¶è¡Œã€‚\n\næœ€ç®€å•çš„ç”¨æ³•é•¿è¿™æ ·ï¼š\n\n```javascript\nconst Tinypool = require(\"tinypool\");\nconst pool = new Tinypool({\n    filename: \"./worker.js\",\n});\n\n(async () => {\n    const result = await pool.run({ task: \"compute\", value: 42 });\n    console.log(result); // è¾“å‡ºç»“æžœ\n})();\n```\n\n`worker.js`ï¼š\n\n```javascript\nmodule.exports = ({ task, value }) => {\n    if (task === \"compute\") {\n        let sum = 0;\n        for (let i = 0; i < 1e8; i++) sum += i; // æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡\n        return sum + value;\n    }\n};\n```\n\nå‡ è¡Œä»£ç ï¼Œä»»åŠ¡å°±æ‰”åˆ°çº¿ç¨‹æ± é‡Œè·‘äº†ï¼Œä¸»çº¿ç¨‹ä¸€ç‚¹ä¸å µã€‚æ˜¯ä¸æ˜¯æœ‰ç§â€œè§£æ”¾åŒæ‰‹â€çš„å¿«æ„Ÿï¼Ÿ\n\n## Tinypool çš„åŽŸç†ï¼šçº¿ç¨‹æ± çš„â€œé­”æ³•è°ƒåº¦â€\n\nTinypool çš„æ ¸å¿ƒæ˜¯ä¸ª**çº¿ç¨‹æ± **ã€‚å•¥æ˜¯çº¿ç¨‹æ± ï¼Ÿæƒ³è±¡ä¸€ä¸ªâ€œå¤–åŒ…å…¬å¸â€ï¼šä½ æœ‰ä»»åŠ¡å°±ä¸¢ç»™å®ƒï¼Œå®ƒä»Žæ‰‹åº•ä¸‹çš„ä¸€å †å·¥äººï¼ˆçº¿ç¨‹ï¼‰é‡ŒæŒ‘ä¸€ä¸ªå¹²æ´»ï¼Œå¹²å®Œå†æŠŠç»“æžœè¿˜ç»™ä½ ã€‚å·¥äººä¸å¤Ÿç”¨ï¼Ÿå®ƒä¼šä¸´æ—¶æ‹›äººï¼›å¤ªå¤šé—²ç€æ²¡äº‹å¹²ï¼Ÿå®ƒä¼šè£å‘˜ã€‚Tinypool å°±æ˜¯è¿™ä¹ˆä¸ªâ€œèªæ˜Žç®¡å®¶â€ã€‚\n\n### å·¥ä½œæµç¨‹æ‹†è§£\n\n1. **åˆå§‹åŒ–**ï¼šä½ åˆ›å»º `Tinypool` å®žä¾‹æ—¶ï¼ŒæŒ‡å®šä¸€ä¸ª worker æ–‡ä»¶ï¼ˆ`filename`ï¼‰å’Œçº¿ç¨‹æ•°ï¼ˆé»˜è®¤æ˜¯ CPU æ ¸å¿ƒæ•°ï¼‰ã€‚\n2. **ä»»åŠ¡æäº¤**ï¼šè°ƒç”¨ `pool.run()`ï¼Œä»»åŠ¡è¢«ä¸¢è¿›é˜Ÿåˆ—ã€‚\n3. **çº¿ç¨‹åˆ†é…**ï¼šTinypool ä»Žæ± å­é‡ŒæŒ‘ä¸€ä¸ªç©ºé—²çº¿ç¨‹æ‰§è¡Œï¼Œæ²¡ç©ºé—²çš„å°±æŽ’é˜Ÿç­‰ã€‚\n4. **é€šä¿¡**ï¼šä¸»çº¿ç¨‹å’Œ worker é€šè¿‡ `postMessage` ä¼ é€’æ•°æ®ï¼Œç»“æžœå›žæ¥åŽåŒ…è£…æˆ Promiseã€‚\n5. **å›žæ”¶ç®¡ç†**ï¼šä»»åŠ¡å®ŒæˆåŽï¼Œçº¿ç¨‹å›žåˆ°æ± å­å¾…å‘½ï¼Œè¶…æ—¶çš„çº¿ç¨‹ä¼šè¢«æ¸…ç†ã€‚\n\næºç é‡Œï¼ŒTinypool ç”¨äº†ä¸ªå« `WorkerFarm` çš„ä¸œè¥¿ç®¡ç†çº¿ç¨‹ï¼Œé…åˆäº‹ä»¶ç›‘å¬å’Œé˜Ÿåˆ—è°ƒåº¦ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸æ»‘å¾—åƒåœ¨â€œè·³èˆžâ€ã€‚ç›¸æ¯”åŽŸç”Ÿ `worker_threads`ï¼Œå®ƒçœåŽ»äº†æ‰‹åŠ¨ `new Worker` å’Œç›‘å¬ `message` çš„éº»çƒ¦ï¼Œç®€ç›´æ˜¯æ‡’äººç¦éŸ³ã€‚\n\n### ä¸ºå•¥æ¯”åŽŸç”Ÿå¿«ï¼Ÿ\n\nåŽŸç”Ÿ `worker_threads` æ¯æ¬¡åˆ›å»ºçº¿ç¨‹éƒ½æœ‰å¼€é”€ï¼ˆå‡ åæ¯«ç§’ï¼‰ï¼Œè€Œ Tinypool çš„çº¿ç¨‹æ˜¯é¢„åˆ›å»ºçš„ï¼Œå¤ç”¨çŽ‡é«˜ï¼Œå¼€é”€å‡ ä¹Žä¸ºé›¶ã€‚å†åŠ ä¸Šå®ƒçš„é˜Ÿåˆ—ç®¡ç†å’Œè´Ÿè½½å‡è¡¡ï¼Œä»»åŠ¡åˆ†é…æ•ˆçŽ‡é«˜å¾—åƒå¼€äº†æŒ‚ã€‚\n\n## å®žæˆ˜ä¾‹å­ï¼šä»Žâ€œå¡é¡¿â€åˆ°â€œé£žèµ·â€\n\nå’±ä»¬æ¥ä¸ªå®žé™…åœºæ™¯ï¼šæ‰¹é‡å¤„ç†å›¾ç‰‡ç¼©æ”¾ã€‚å‡è®¾ä½ æœ‰ä¸ª APIï¼Œè¦åŒæ—¶å¤„ç† 10 å¼ å›¾ç‰‡ï¼Œç”¨å•çº¿ç¨‹è‚¯å®šå¡æ­»ã€‚\n\n### å•çº¿ç¨‹ç‰ˆï¼ˆç¾éš¾çŽ°åœºï¼‰\n\n```javascript\nconst sharp = require(\"sharp\");\nconst express = require(\"express\");\nconst app = express();\n\napp.get(\"/resize\", async (req, res) => {\n    const tasks = Array(10).fill(null).map(async (_, i) => {\n        await sharp(`image-${i}.jpg`)\n            .resize(100, 100)\n            .toFile(`output-${i}.jpg`);\n    });\n    await Promise.all(tasks);\n    res.send(\"Done\");\n});\n\napp.listen(3000);\n```\n\nè·‘èµ·æ¥ï¼Œä¸»çº¿ç¨‹ç›´æŽ¥â€œç½¢å·¥â€ï¼Œåˆ«çš„è¯·æ±‚å…¨å¾—æŽ’é˜Ÿç­‰ï¼Œä½“éªŒå·®åˆ°çˆ†ã€‚\n\n### Tinypool ç‰ˆï¼ˆæ€§èƒ½é£žå‡ï¼‰\n\n```javascript\nconst Tinypool = require(\"tinypool\");\nconst express = require(\"express\");\nconst app = express();\n\nconst pool = new Tinypool({\n    filename: \"./worker.js\",\n    maxThreads: 4, // é™åˆ¶ 4 ä¸ªçº¿ç¨‹ï¼Œåˆ«æŠŠ CPU æ¦¨å¹²\n});\n\napp.get(\"/resize\", async (req, res) => {\n    const tasks = Array(10)\n        .fill(null)\n        .map((_, i) =>\n            pool.run({ input: `image-${i}.jpg`, output: `output-${i}.jpg` })\n        );\n    await Promise.all(tasks);\n    res.send(\"Done\");\n});\n\napp.listen(3000);\n```\n\n`worker.js`ï¼š\n\n```javascript\nconst sharp = require(\"sharp\");\n\nmodule.exports = async ({ input, output }) => {\n    await sharp(input).resize(100, 100).toFile(output);\n    return \"success\";\n};\n```\n\nè¿™å›žï¼Œä¸»çº¿ç¨‹è½»æ¾è‡ªå¦‚ï¼Œå›¾ç‰‡å¤„ç†å…¨æ‰”ç»™çº¿ç¨‹æ± ï¼Œå“åº”é€Ÿåº¦å¿«å¾—åƒåäº†ç«ç®­ ðŸš€ã€‚10 å¼ å›¾ç‰‡å¹¶è¡Œè·‘ï¼ŒCPU åˆ©ç”¨çŽ‡ä¹Ÿæ›´å‡è¡¡ã€‚\n\n## é…ç½®è°ƒä¼˜ï¼šè®© Tinypool â€œå¬è¯â€\n\nTinypool çš„é»˜è®¤é…ç½®å·²ç»å¤Ÿèªæ˜Žï¼Œä½†ä½ è¿˜èƒ½æ‰‹åŠ¨è°ƒæ•™ï¼š\n\n- **`minThreads` å’Œ `maxThreads`**ï¼šæŽ§åˆ¶çº¿ç¨‹æ± å¤§å°ã€‚æ¯”å¦‚æœºå™¨æ˜¯ 8 æ ¸ï¼Œè®¾ `maxThreads: 8` æ»¡è½½è·‘ï¼Œ`minThreads: 2` çœèµ„æºã€‚\n- **`idleTimeout`**ï¼šçº¿ç¨‹ç©ºé—²å¤šä¹…é”€æ¯ï¼Œé»˜è®¤ 30 ç§’ï¼Œè°ƒå°ç‚¹èƒ½çœå†…å­˜ã€‚\n- **`maxQueue`**ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸Šé™ï¼Œæ»¡äº†å°±æŠ›å¼‚å¸¸ï¼Œé˜²æ­¢å†…å­˜çˆ†æŽ‰ã€‚\n\nä¾‹å­ï¼š\n\n```javascript\nconst pool = new Tinypool({\n    filename: \"./worker.js\",\n    minThreads: 2,\n    maxThreads: 8,\n    idleTimeout: 10, // 10 ç§’æ²¡æ´»å¹²å°±é”€æ¯\n    maxQueue: 100, // æœ€å¤šæŽ’é˜Ÿ 100 ä¸ªä»»åŠ¡\n});\n```\n\nè°ƒè¿™äº›å‚æ•°å°±åƒâ€œè°ƒéŸ³å“â€â€”â€”å¾—æ ¹æ®ä½ çš„æœºå™¨å’Œä»»åŠ¡é‡æ‰¾æœ€ä½³å¹³è¡¡ç‚¹ã€‚\n\n## æœ€ä½³å®žè·µï¼šç”¨å¥½ Tinypool çš„â€œè¶…èƒ½åŠ›â€\n\nå¹²äº†å‡ å¹´ Node.jsï¼Œæˆ‘å‘çŽ° Tinypool åœ¨è¿™äº›åœºæ™¯ç‰¹åˆ«å¥½ä½¿ï¼š\n\n1. **CPU å¯†é›†åž‹ä»»åŠ¡**  \n   å›¾ç‰‡å¤„ç†ã€è§†é¢‘è½¬ç ã€æ•°å­¦è®¡ç®—ï¼Œæ‰”ç»™ Tinypool å‡†æ²¡é”™ã€‚\n\n2. **æ‰¹å¤„ç†**  \n   æ¯”å¦‚æ‰¹é‡ç”Ÿæˆ PDFï¼Œç›´æŽ¥ç”¨çº¿ç¨‹æ± åˆ†æ‹…ï¼Œä¸»çº¿ç¨‹åªç®¡æ”¶ç»“æžœã€‚\n\n3. **é”™è¯¯å¤„ç†è¦åˆ°ä½**  \n   Tinypool çš„ä»»åŠ¡å¯èƒ½æŠ›å¼‚å¸¸ï¼ŒåŒ…ä¸ª try-catchï¼š\n\n   ```javascript\n   try {\n       const result = await pool.run({ task: \"fail\" });\n   } catch (err) {\n       console.error(\"çº¿ç¨‹ç‚¸äº†:\", err);\n   }\n   ```\n\n4. **åˆ«æ»¥ç”¨**  \n   I/O å¯†é›†åž‹ä»»åŠ¡ï¼ˆæ¯”å¦‚è¯»æ•°æ®åº“ï¼‰ç”¨ä¸ç€ Tinypoolï¼ŒNode.js è‡ªå¸¦çš„å¼‚æ­¥å°±å¤Ÿäº†ã€‚\n\n5. **ç›‘æŽ§çº¿ç¨‹çŠ¶æ€**  \n   ç”¨ `pool.threads` å’Œ `pool.queue` æ£€æŸ¥çº¿ç¨‹æ± å’Œé˜Ÿåˆ—ï¼Œç”Ÿäº§çŽ¯å¢ƒåˆ«è®©å®ƒâ€œè¶…è½½â€ã€‚\n\n   ```javascript\n   console.log(\"å¿™ç¢Œçº¿ç¨‹:\", pool.threads.length);\n   console.log(\"æŽ’é˜Ÿä»»åŠ¡:\", pool.queue.length);\n   ```\n\n## ç±»æ¯”ï¼šTinypool åƒä¸ªâ€œæ–½å·¥é˜Ÿâ€\n\næˆ‘è§‰å¾— Tinypool ç‰¹åˆ«åƒä¸ªæ–½å·¥é˜Ÿã€‚ä½ ï¼ˆä¸»çº¿ç¨‹ï¼‰æ˜¯â€œåŒ…å·¥å¤´â€ï¼Œæœ‰æ´»å„¿ï¼ˆä»»åŠ¡ï¼‰å°±ä¸¢ç»™æ–½å·¥é˜Ÿï¼ˆçº¿ç¨‹æ± ï¼‰ï¼Œå·¥äººï¼ˆçº¿ç¨‹ï¼‰å¹²å®Œæ´»æŠŠæˆæžœäº¤å›žæ¥ã€‚ä½ ä¸ç”¨ç®¡è°å¹²çš„ã€æ€Žä¹ˆå¹²çš„ï¼Œåªç®¡åç­‰éªŒæ”¶ã€‚æ´»å„¿å¤šçš„æ—¶å€™ï¼Œå®ƒè¿˜èƒ½â€œåŠ ç­åŠ ç‚¹â€ï¼Œæ•ˆçŽ‡é«˜å¾—é£žèµ·ã€‚\n\n## æ€§èƒ½å¯¹æ¯”ï¼šTinypool vs åŽŸç”Ÿ Worker\n\næˆ‘åšè¿‡ä¸ªå°æµ‹è¯•ï¼Œè·‘ 100 ä¸ªè€—æ—¶è®¡ç®—ä»»åŠ¡ï¼š\n\n- **åŽŸç”Ÿ `worker_threads`**ï¼šæ¯æ¬¡ `new Worker`ï¼Œæ€»è€—æ—¶ ~12 ç§’ã€‚\n- **Tinypool**ï¼šçº¿ç¨‹å¤ç”¨ï¼Œæ€»è€—æ—¶ ~8 ç§’ã€‚\n\nå·®è·ä¸å¤§ï¼Ÿä»»åŠ¡é‡ä¸ŠåƒåŽï¼ŒTinypool çš„ä¼˜åŠ¿å°±æ˜Žæ˜¾äº†ï¼Œå¼€é”€ä½Žã€è°ƒåº¦å¿«ï¼Œç®€ç›´æ˜¯â€œæ€§èƒ½æ€ªå…½â€ã€‚\n\n## ç»“å°¾ï¼šTinypool çš„æ±Ÿæ¹–åœ°ä½\n\nTinypool è™½ç„¶ä¸åƒ Expressã€Koa é‚£ä¹ˆâ€œå®¶å–»æˆ·æ™“â€ï¼Œä½†åœ¨ Node.js æ€§èƒ½ä¼˜åŒ–åœˆå­é‡Œï¼Œå®ƒç»å¯¹æ˜¯ä¸ªâ€œéšè—å¤§ä½¬â€ã€‚å®ƒä¸è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œä½†ä¸“æ²» CPU å¯†é›†åž‹ä»»åŠ¡çš„â€œå¡é¡¿ç—…â€ã€‚æœªæ¥ï¼Œå®ƒå¯èƒ½ä¼šæ›´æ™ºèƒ½ï¼Œæ¯”å¦‚åŠ¨æ€è°ƒæ•´çº¿ç¨‹æ•°ï¼Œæˆ–è€…é›†æˆæ›´å¼ºçš„è°ƒè¯•å·¥å…·ã€‚\n\nç”¨ Tinypool å†™ä»£ç ï¼Œæœ‰ç§â€œæŒ‡ç‚¹æ±Ÿå±±â€çš„çˆ½æ„Ÿâ€”â€”ä»»åŠ¡ä¸€æ‰”ï¼Œæ€§èƒ½èµ·é£žï¼Œçœå¿ƒåˆé«˜æ•ˆã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ å¯¹å®ƒæœ‰ç‚¹â€œå¿ƒåŠ¨â€ï¼Œä¸‹æ¬¡é¡¹ç›®å¡æ€§èƒ½æ—¶ï¼Œè¯•è¯•è¿™ä¸ªå°ç¥žå™¨ï¼Œä¿å‡†ä¸åŽæ‚”ï¼ðŸ˜‰\n\næœ‰å•¥æƒ³èŠçš„ï¼Œæ¬¢è¿Žç•™è¨€ï¼Œå’±ä»¬ä¸€èµ·æŠ˜è…¾ï¼ðŸš€\n\n---",
    "code": "var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var u=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),B=(n,e)=>{for(var r in e)c(n,r,{get:e[r],enumerable:!0})},o=(n,e,r,s)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of y(e))!g.call(n,a)&&a!==r&&c(n,a,{get:()=>e[a],enumerable:!(s=E(e,a))||s.enumerable});return n};var m=(n,e,r)=>(r=n!=null?p(F(n)):{},o(e||!n||!n.__esModule?c(r,\"default\",{value:n,enumerable:!0}):r,n)),f=n=>o(c({},\"__esModule\",{value:!0}),n);var i=u((j,d)=>{d.exports=_jsx_runtime});var x={};B(x,{default:()=>h,frontmatter:()=>k});var l=m(i()),k={type:\"Post\",title:\"Node.js \\u6027\\u80FD\\u63D0\\u5347\\u795E\\u5668\\uFF1A\\u7528 Tinypool \\u5B9E\\u73B0\\u591A\\u4EFB\\u52A1\\u5E76\\u884C\\u5904\\u7406\",date:\"2024-02-05\",description:\"\\u4E00\\u7BC7\\u6DF1\\u5165\\u5256\\u6790 Tinypool \\u7684\\u535A\\u5BA2\\uFF0C\\u5E26\\u4F60\\u63A2\\u7D22 Node.js \\u591A\\u4EFB\\u52A1\\u5E76\\u884C\\u7684\\u79D8\\u5BC6\\u6B66\\u5668\\uFF0C\\u4ECE\\u539F\\u7406\\u5230\\u5B9E\\u6218\\uFF0C\\u89E3\\u9501\\u6027\\u80FD\\u4F18\\u5316\\u7684\\u65B0\\u59FF\\u52BF\\u3002\",keywords:\"Node.js, Tinypool, \\u591A\\u7EBF\\u7A0B, Worker Threads, \\u6027\\u80FD\\u4F18\\u5316, \\u5E76\\u884C\\u5904\\u7406, JavaScript, \\u670D\\u52A1\\u7AEF\\u5F00\\u53D1\",author:\"\\u6653\\u9F99\",image:\"/images/hero/tinypool.jpg\",tags:[\"Node.js\",\"Tinypool\",\"\\u6027\\u80FD\\u4F18\\u5316\"],category:\"Node.js\"};function t(n){let e={a:\"a\",br:\"br\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",hr:\"hr\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.p,{children:\"\\u563F\\uFF0C\\u670B\\u53CB\\uFF01\\u4ECA\\u5929\\u54B1\\u4EEC\\u804A\\u804A Node.js \\u7684\\u201C\\u6027\\u80FD\\u6551\\u661F\\u201D\\u2014\\u2014Tinypool\\u3002\\u4F60\\u662F\\u4E0D\\u662F\\u4E5F\\u9047\\u5230\\u8FC7\\u8FD9\\u79CD\\u60C5\\u51B5\\uFF1ANode.js \\u5355\\u7EBF\\u7A0B\\u8DD1\\u5F97\\u98DE\\u5FEB\\uFF0C\\u4F46\\u4E00\\u78B0\\u5230 CPU \\u5BC6\\u96C6\\u578B\\u4EFB\\u52A1\\uFF08\\u6BD4\\u5982\\u56FE\\u7247\\u5904\\u7406\\u3001\\u590D\\u6742\\u8BA1\\u7B97\\uFF09\\uFF0C\\u5C31\\u8DDF\\u5361\\u4E86\\u58F3\\u4F3C\\u7684\\u5598\\u4E0D\\u8FC7\\u6C14\\uFF1F\\u522B\\u6025\\uFF0CTinypool \\u6765\\u4E86\\uFF0C\\u5B83\\u5C31\\u50CF\\u7ED9 Node.js \\u88C5\\u4E86\\u4E2A\\u201C\\u6DA1\\u8F6E\\u589E\\u538B\\u5668\\u201D\\uFF0C\\u8BA9\\u591A\\u4EFB\\u52A1\\u5E76\\u884C\\u5904\\u7406\\u53D8\\u5F97\\u8F7B\\u677E\\u53C8\\u9AD8\\u6548\\u3002\\u4ECA\\u5929\\u6211\\u5C31\\u5E26\\u4F60\\u4ECE\\u539F\\u7406\\u5230\\u5B9E\\u6218\\uFF0C\\u6252\\u4E00\\u6252\\u8FD9\\u4E2A\\u5C0F\\u800C\\u7F8E\\u7684\\u5DE5\\u5177\\uFF0C\\u987A\\u4FBF\\u5206\\u4EAB\\u70B9\\u6211\\u7684\\u201C\\u8840\\u6CEA\\u7ECF\\u9A8C\\u201D\\u548C\\u5B9E\\u7528\\u6280\\u5DE7 \\u{1F60E}\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"tinypool-\\u662F\\u5565\\u4ECE-nodejs-\\u7684\\u5355\\u7EBF\\u7A0B\\u75DB\\u70B9\\u8BF4\\u8D77\",children:(0,l.jsx)(e.a,{href:\"#tinypool-\\u662F\\u5565\\u4ECE-nodejs-\\u7684\\u5355\\u7EBF\\u7A0B\\u75DB\\u70B9\\u8BF4\\u8D77\",children:\"Tinypool \\u662F\\u5565\\uFF1F\\u4ECE Node.js \\u7684\\u201C\\u5355\\u7EBF\\u7A0B\\u75DB\\u70B9\\u201D\\u8BF4\\u8D77\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"Node.js \\u7684\\u5355\\u7EBF\\u7A0B\\u8BBE\\u8BA1\\u662F\\u4E2A\\u201C\\u53CC\\u5203\\u5251\\u201D\\u3002\\u5904\\u7406 I/O \\u64CD\\u4F5C\\u65F6\\uFF0C\\u5B83\\u50CF\\u4E2A\\u201C\\u5FEB\\u9012\\u5458\\u201D\\uFF0C\\u8DD1\\u5F97\\u98DE\\u5FEB\\uFF1B\\u4F46\\u9047\\u5230 CPU \\u5BC6\\u96C6\\u578B\\u4EFB\\u52A1\\uFF0C\\u5C31\\u53D8\\u6210\\u4E86\\u201C\\u5355\\u4EBA\\u642C\\u7816\\u5DE5\\u201D\\uFF0C\\u7D2F\\u5F97\\u6EE1\\u5934\\u5927\\u6C57\\u3002\\u5B98\\u65B9\\u7684 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker_threads\"})})})}),\" \\u6A21\\u5757\\u7ED9\\u4E86\\u6211\\u4EEC\\u591A\\u7EBF\\u7A0B\\u80FD\\u529B\\uFF0C\\u53EF\\u7528\\u8D77\\u6765\\u5374\\u6709\\u70B9\\u201C\\u539F\\u59CB\\u201D\\u2014\\u2014\\u624B\\u52A8\\u521B\\u5EFA\\u7EBF\\u7A0B\\u3001\\u901A\\u4FE1\\u3001\\u7BA1\\u7406\\u9500\\u6BC1\\uFF0C\\u5199\\u7740\\u5199\\u7740\\u5C31\\u89C9\\u5F97\\u81EA\\u5DF1\\u50CF\\u4E2A\\u201C\\u7EBF\\u7A0B\\u8C03\\u5EA6\\u5458\\u201D\\u3002\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Tinypool \\u662F\\u4E2A\\u57FA\\u4E8E \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker_threads\"})})})}),\" \\u7684\\u7EBF\\u7A0B\\u6C60\\u5E93\\uFF0C\\u7531 Node.js \\u793E\\u533A\\u5927\\u4F6C\\u4EEC\\u6253\\u9020\\uFF08\\u6CA1\\u9519\\uFF0C\\u5C31\\u662F\\u90A3\\u4E9B\\u641E Fastify \\u548C Pino \\u7684\\u5BB6\\u4F19\\uFF09\\u3002\\u5B83\\u628A\\u7EBF\\u7A0B\\u7BA1\\u7406\\u7684\\u810F\\u6D3B\\u7D2F\\u6D3B\\u5168\\u5305\\u4E86\\uFF0C\\u53EA\\u7559\\u7ED9\\u4F60\\u4E00\\u4E2A\\u7B80\\u5355\\u5230\\u7206\\u7684 API\\u3002\\u7B80\\u5355\\u8BF4\\uFF0C\\u5B83\\u5C31\\u50CF\\u4E2A\\u201C\\u7EBF\\u7A0B\\u7BA1\\u5BB6\\u201D\\uFF0C\\u5E2E\\u4F60\\u4F18\\u96C5\\u5730\\u5904\\u7406\\u591A\\u4EFB\\u52A1\\u5E76\\u884C\\u3002\"]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u6700\\u7B80\\u5355\\u7684\\u7528\\u6CD5\\u957F\\u8FD9\\u6837\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" Tinypool\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"tinypool\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" pool\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Tinypool\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    filename: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"./worker.js\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" result\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" pool.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({ task: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"compute\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", value: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"42\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(result); \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u8F93\\u51FA\\u7ED3\\u679C\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"})();\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker.js\"})})})}),\"\\uFF1A\"]}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"module\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"exports\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" ({ \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"task\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"value\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" }) \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (task \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"===\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"compute\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        let\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sum \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"let\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"; i \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 1e8\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"; i\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"++\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") sum \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+=\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i; \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u6A21\\u62DF\\u8017\\u65F6\\u4EFB\\u52A1\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sum \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" value;\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    }\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u51E0\\u884C\\u4EE3\\u7801\\uFF0C\\u4EFB\\u52A1\\u5C31\\u6254\\u5230\\u7EBF\\u7A0B\\u6C60\\u91CC\\u8DD1\\u4E86\\uFF0C\\u4E3B\\u7EBF\\u7A0B\\u4E00\\u70B9\\u4E0D\\u5835\\u3002\\u662F\\u4E0D\\u662F\\u6709\\u79CD\\u201C\\u89E3\\u653E\\u53CC\\u624B\\u201D\\u7684\\u5FEB\\u611F\\uFF1F\"}),`\n`,(0,l.jsx)(e.h2,{id:\"tinypool-\\u7684\\u539F\\u7406\\u7EBF\\u7A0B\\u6C60\\u7684\\u9B54\\u6CD5\\u8C03\\u5EA6\",children:(0,l.jsx)(e.a,{href:\"#tinypool-\\u7684\\u539F\\u7406\\u7EBF\\u7A0B\\u6C60\\u7684\\u9B54\\u6CD5\\u8C03\\u5EA6\",children:\"Tinypool \\u7684\\u539F\\u7406\\uFF1A\\u7EBF\\u7A0B\\u6C60\\u7684\\u201C\\u9B54\\u6CD5\\u8C03\\u5EA6\\u201D\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"Tinypool \\u7684\\u6838\\u5FC3\\u662F\\u4E2A\",(0,l.jsx)(e.strong,{children:\"\\u7EBF\\u7A0B\\u6C60\"}),\"\\u3002\\u5565\\u662F\\u7EBF\\u7A0B\\u6C60\\uFF1F\\u60F3\\u8C61\\u4E00\\u4E2A\\u201C\\u5916\\u5305\\u516C\\u53F8\\u201D\\uFF1A\\u4F60\\u6709\\u4EFB\\u52A1\\u5C31\\u4E22\\u7ED9\\u5B83\\uFF0C\\u5B83\\u4ECE\\u624B\\u5E95\\u4E0B\\u7684\\u4E00\\u5806\\u5DE5\\u4EBA\\uFF08\\u7EBF\\u7A0B\\uFF09\\u91CC\\u6311\\u4E00\\u4E2A\\u5E72\\u6D3B\\uFF0C\\u5E72\\u5B8C\\u518D\\u628A\\u7ED3\\u679C\\u8FD8\\u7ED9\\u4F60\\u3002\\u5DE5\\u4EBA\\u4E0D\\u591F\\u7528\\uFF1F\\u5B83\\u4F1A\\u4E34\\u65F6\\u62DB\\u4EBA\\uFF1B\\u592A\\u591A\\u95F2\\u7740\\u6CA1\\u4E8B\\u5E72\\uFF1F\\u5B83\\u4F1A\\u88C1\\u5458\\u3002Tinypool \\u5C31\\u662F\\u8FD9\\u4E48\\u4E2A\\u201C\\u806A\\u660E\\u7BA1\\u5BB6\\u201D\\u3002\"]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u5DE5\\u4F5C\\u6D41\\u7A0B\\u62C6\\u89E3\",children:(0,l.jsx)(e.a,{href:\"#\\u5DE5\\u4F5C\\u6D41\\u7A0B\\u62C6\\u89E3\",children:\"\\u5DE5\\u4F5C\\u6D41\\u7A0B\\u62C6\\u89E3\"})}),`\n`,(0,l.jsxs)(e.ol,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u521D\\u59CB\\u5316\"}),\"\\uFF1A\\u4F60\\u521B\\u5EFA \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"Tinypool\"})})})}),\" \\u5B9E\\u4F8B\\u65F6\\uFF0C\\u6307\\u5B9A\\u4E00\\u4E2A worker \\u6587\\u4EF6\\uFF08\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"filename\"})})})}),\"\\uFF09\\u548C\\u7EBF\\u7A0B\\u6570\\uFF08\\u9ED8\\u8BA4\\u662F CPU \\u6838\\u5FC3\\u6570\\uFF09\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u4EFB\\u52A1\\u63D0\\u4EA4\"}),\"\\uFF1A\\u8C03\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"pool.run()\"})})})}),\"\\uFF0C\\u4EFB\\u52A1\\u88AB\\u4E22\\u8FDB\\u961F\\u5217\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u7EBF\\u7A0B\\u5206\\u914D\"}),\"\\uFF1ATinypool \\u4ECE\\u6C60\\u5B50\\u91CC\\u6311\\u4E00\\u4E2A\\u7A7A\\u95F2\\u7EBF\\u7A0B\\u6267\\u884C\\uFF0C\\u6CA1\\u7A7A\\u95F2\\u7684\\u5C31\\u6392\\u961F\\u7B49\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u901A\\u4FE1\"}),\"\\uFF1A\\u4E3B\\u7EBF\\u7A0B\\u548C worker \\u901A\\u8FC7 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"postMessage\"})})})}),\" \\u4F20\\u9012\\u6570\\u636E\\uFF0C\\u7ED3\\u679C\\u56DE\\u6765\\u540E\\u5305\\u88C5\\u6210 Promise\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"\\u56DE\\u6536\\u7BA1\\u7406\"}),\"\\uFF1A\\u4EFB\\u52A1\\u5B8C\\u6210\\u540E\\uFF0C\\u7EBF\\u7A0B\\u56DE\\u5230\\u6C60\\u5B50\\u5F85\\u547D\\uFF0C\\u8D85\\u65F6\\u7684\\u7EBF\\u7A0B\\u4F1A\\u88AB\\u6E05\\u7406\\u3002\"]}),`\n`]}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u6E90\\u7801\\u91CC\\uFF0CTinypool \\u7528\\u4E86\\u4E2A\\u53EB \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"WorkerFarm\"})})})}),\" \\u7684\\u4E1C\\u897F\\u7BA1\\u7406\\u7EBF\\u7A0B\\uFF0C\\u914D\\u5408\\u4E8B\\u4EF6\\u76D1\\u542C\\u548C\\u961F\\u5217\\u8C03\\u5EA6\\uFF0C\\u6574\\u4E2A\\u8FC7\\u7A0B\\u4E1D\\u6ED1\\u5F97\\u50CF\\u5728\\u201C\\u8DF3\\u821E\\u201D\\u3002\\u76F8\\u6BD4\\u539F\\u751F \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker_threads\"})})})}),\"\\uFF0C\\u5B83\\u7701\\u53BB\\u4E86\\u624B\\u52A8 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"new Worker\"})})})}),\" \\u548C\\u76D1\\u542C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"message\"})})})}),\" \\u7684\\u9EBB\\u70E6\\uFF0C\\u7B80\\u76F4\\u662F\\u61D2\\u4EBA\\u798F\\u97F3\\u3002\"]}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u4E3A\\u5565\\u6BD4\\u539F\\u751F\\u5FEB\",children:(0,l.jsx)(e.a,{href:\"#\\u4E3A\\u5565\\u6BD4\\u539F\\u751F\\u5FEB\",children:\"\\u4E3A\\u5565\\u6BD4\\u539F\\u751F\\u5FEB\\uFF1F\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"\\u539F\\u751F \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker_threads\"})})})}),\" \\u6BCF\\u6B21\\u521B\\u5EFA\\u7EBF\\u7A0B\\u90FD\\u6709\\u5F00\\u9500\\uFF08\\u51E0\\u5341\\u6BEB\\u79D2\\uFF09\\uFF0C\\u800C Tinypool \\u7684\\u7EBF\\u7A0B\\u662F\\u9884\\u521B\\u5EFA\\u7684\\uFF0C\\u590D\\u7528\\u7387\\u9AD8\\uFF0C\\u5F00\\u9500\\u51E0\\u4E4E\\u4E3A\\u96F6\\u3002\\u518D\\u52A0\\u4E0A\\u5B83\\u7684\\u961F\\u5217\\u7BA1\\u7406\\u548C\\u8D1F\\u8F7D\\u5747\\u8861\\uFF0C\\u4EFB\\u52A1\\u5206\\u914D\\u6548\\u7387\\u9AD8\\u5F97\\u50CF\\u5F00\\u4E86\\u6302\\u3002\"]}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u5B9E\\u6218\\u4F8B\\u5B50\\u4ECE\\u5361\\u987F\\u5230\\u98DE\\u8D77\",children:(0,l.jsx)(e.a,{href:\"#\\u5B9E\\u6218\\u4F8B\\u5B50\\u4ECE\\u5361\\u987F\\u5230\\u98DE\\u8D77\",children:\"\\u5B9E\\u6218\\u4F8B\\u5B50\\uFF1A\\u4ECE\\u201C\\u5361\\u987F\\u201D\\u5230\\u201C\\u98DE\\u8D77\\u201D\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u54B1\\u4EEC\\u6765\\u4E2A\\u5B9E\\u9645\\u573A\\u666F\\uFF1A\\u6279\\u91CF\\u5904\\u7406\\u56FE\\u7247\\u7F29\\u653E\\u3002\\u5047\\u8BBE\\u4F60\\u6709\\u4E2A API\\uFF0C\\u8981\\u540C\\u65F6\\u5904\\u7406 10 \\u5F20\\u56FE\\u7247\\uFF0C\\u7528\\u5355\\u7EBF\\u7A0B\\u80AF\\u5B9A\\u5361\\u6B7B\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"\\u5355\\u7EBF\\u7A0B\\u7248\\u707E\\u96BE\\u73B0\\u573A\",children:(0,l.jsx)(e.a,{href:\"#\\u5355\\u7EBF\\u7A0B\\u7248\\u707E\\u96BE\\u73B0\\u573A\",children:\"\\u5355\\u7EBF\\u7A0B\\u7248\\uFF08\\u707E\\u96BE\\u73B0\\u573A\\uFF09\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" sharp\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"sharp\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"express\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" app\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/resize\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" tasks\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Array\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"fill\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"null\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"i\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        await\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" sharp\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`image-${\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"}.jpg`\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"resize\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"toFile\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`output-${\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"}.jpg`\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    await\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"all\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(tasks);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"Done\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"listen\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u8DD1\\u8D77\\u6765\\uFF0C\\u4E3B\\u7EBF\\u7A0B\\u76F4\\u63A5\\u201C\\u7F62\\u5DE5\\u201D\\uFF0C\\u522B\\u7684\\u8BF7\\u6C42\\u5168\\u5F97\\u6392\\u961F\\u7B49\\uFF0C\\u4F53\\u9A8C\\u5DEE\\u5230\\u7206\\u3002\"}),`\n`,(0,l.jsx)(e.h3,{id:\"tinypool-\\u7248\\u6027\\u80FD\\u98DE\\u5347\",children:(0,l.jsx)(e.a,{href:\"#tinypool-\\u7248\\u6027\\u80FD\\u98DE\\u5347\",children:\"Tinypool \\u7248\\uFF08\\u6027\\u80FD\\u98DE\\u5347\\uFF09\"})}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" Tinypool\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"tinypool\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"express\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" app\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" express\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" pool\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Tinypool\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    filename: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"./worker.js\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    maxThreads: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"4\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u9650\\u5236 4 \\u4E2A\\u7EBF\\u7A0B\\uFF0C\\u522B\\u628A CPU \\u69A8\\u5E72\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"get\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/resize\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"async\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"req\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"res\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" tasks\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Array\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"fill\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"null\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        .\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"map\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"_\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"i\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            pool.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({ input: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`image-${\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"}.jpg`\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", output: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"`output-${\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"i\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"}.jpg`\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" })\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        );\"})}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    await\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" Promise\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"all\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(tasks);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    res.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"send\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"Done\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"app.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"listen\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3000\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker.js\"})})})}),\"\\uFF1A\"]}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" sharp\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" require\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"sharp\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"module\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"exports\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" async\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" ({ \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"input\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"output\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" }) \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=>\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    await\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" sharp\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(input).\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"resize\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"toFile\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(output);\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:' \"success\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u8FD9\\u56DE\\uFF0C\\u4E3B\\u7EBF\\u7A0B\\u8F7B\\u677E\\u81EA\\u5982\\uFF0C\\u56FE\\u7247\\u5904\\u7406\\u5168\\u6254\\u7ED9\\u7EBF\\u7A0B\\u6C60\\uFF0C\\u54CD\\u5E94\\u901F\\u5EA6\\u5FEB\\u5F97\\u50CF\\u5750\\u4E86\\u706B\\u7BAD \\u{1F680}\\u300210 \\u5F20\\u56FE\\u7247\\u5E76\\u884C\\u8DD1\\uFF0CCPU \\u5229\\u7528\\u7387\\u4E5F\\u66F4\\u5747\\u8861\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u914D\\u7F6E\\u8C03\\u4F18\\u8BA9-tinypool-\\u542C\\u8BDD\",children:(0,l.jsx)(e.a,{href:\"#\\u914D\\u7F6E\\u8C03\\u4F18\\u8BA9-tinypool-\\u542C\\u8BDD\",children:\"\\u914D\\u7F6E\\u8C03\\u4F18\\uFF1A\\u8BA9 Tinypool \\u201C\\u542C\\u8BDD\\u201D\"})}),`\n`,(0,l.jsx)(e.p,{children:\"Tinypool \\u7684\\u9ED8\\u8BA4\\u914D\\u7F6E\\u5DF2\\u7ECF\\u591F\\u806A\\u660E\\uFF0C\\u4F46\\u4F60\\u8FD8\\u80FD\\u624B\\u52A8\\u8C03\\u6559\\uFF1A\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsxs)(e.strong,{children:[(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"minThreads\"})})})}),\" \\u548C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"maxThreads\"})})})})]}),\"\\uFF1A\\u63A7\\u5236\\u7EBF\\u7A0B\\u6C60\\u5927\\u5C0F\\u3002\\u6BD4\\u5982\\u673A\\u5668\\u662F 8 \\u6838\\uFF0C\\u8BBE \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"maxThreads: 8\"})})})}),\" \\u6EE1\\u8F7D\\u8DD1\\uFF0C\",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"minThreads: 2\"})})})}),\" \\u7701\\u8D44\\u6E90\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"idleTimeout\"})})})})}),\"\\uFF1A\\u7EBF\\u7A0B\\u7A7A\\u95F2\\u591A\\u4E45\\u9500\\u6BC1\\uFF0C\\u9ED8\\u8BA4 30 \\u79D2\\uFF0C\\u8C03\\u5C0F\\u70B9\\u80FD\\u7701\\u5185\\u5B58\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"maxQueue\"})})})})}),\"\\uFF1A\\u4EFB\\u52A1\\u961F\\u5217\\u4E0A\\u9650\\uFF0C\\u6EE1\\u4E86\\u5C31\\u629B\\u5F02\\u5E38\\uFF0C\\u9632\\u6B62\\u5185\\u5B58\\u7206\\u6389\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u4F8B\\u5B50\\uFF1A\"}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" pool\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" Tinypool\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    filename: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"./worker.js\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    minThreads: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    maxThreads: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"8\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    idleTimeout: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// 10 \\u79D2\\u6CA1\\u6D3B\\u5E72\\u5C31\\u9500\\u6BC1\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    maxQueue: \"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,l.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// \\u6700\\u591A\\u6392\\u961F 100 \\u4E2A\\u4EFB\\u52A1\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u8C03\\u8FD9\\u4E9B\\u53C2\\u6570\\u5C31\\u50CF\\u201C\\u8C03\\u97F3\\u54CD\\u201D\\u2014\\u2014\\u5F97\\u6839\\u636E\\u4F60\\u7684\\u673A\\u5668\\u548C\\u4EFB\\u52A1\\u91CF\\u627E\\u6700\\u4F73\\u5E73\\u8861\\u70B9\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u6700\\u4F73\\u5B9E\\u8DF5\\u7528\\u597D-tinypool-\\u7684\\u8D85\\u80FD\\u529B\",children:(0,l.jsx)(e.a,{href:\"#\\u6700\\u4F73\\u5B9E\\u8DF5\\u7528\\u597D-tinypool-\\u7684\\u8D85\\u80FD\\u529B\",children:\"\\u6700\\u4F73\\u5B9E\\u8DF5\\uFF1A\\u7528\\u597D Tinypool \\u7684\\u201C\\u8D85\\u80FD\\u529B\\u201D\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u5E72\\u4E86\\u51E0\\u5E74 Node.js\\uFF0C\\u6211\\u53D1\\u73B0 Tinypool \\u5728\\u8FD9\\u4E9B\\u573A\\u666F\\u7279\\u522B\\u597D\\u4F7F\\uFF1A\"}),`\n`,(0,l.jsxs)(e.ol,{children:[`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:\"CPU \\u5BC6\\u96C6\\u578B\\u4EFB\\u52A1\"}),(0,l.jsx)(e.br,{}),`\n`,\"\\u56FE\\u7247\\u5904\\u7406\\u3001\\u89C6\\u9891\\u8F6C\\u7801\\u3001\\u6570\\u5B66\\u8BA1\\u7B97\\uFF0C\\u6254\\u7ED9 Tinypool \\u51C6\\u6CA1\\u9519\\u3002\"]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:\"\\u6279\\u5904\\u7406\"}),(0,l.jsx)(e.br,{}),`\n`,\"\\u6BD4\\u5982\\u6279\\u91CF\\u751F\\u6210 PDF\\uFF0C\\u76F4\\u63A5\\u7528\\u7EBF\\u7A0B\\u6C60\\u5206\\u62C5\\uFF0C\\u4E3B\\u7EBF\\u7A0B\\u53EA\\u7BA1\\u6536\\u7ED3\\u679C\\u3002\"]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:\"\\u9519\\u8BEF\\u5904\\u7406\\u8981\\u5230\\u4F4D\"}),(0,l.jsx)(e.br,{}),`\n`,\"Tinypool \\u7684\\u4EFB\\u52A1\\u53EF\\u80FD\\u629B\\u5F02\\u5E38\\uFF0C\\u5305\\u4E2A try-catch\\uFF1A\"]}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"try\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    const\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" result\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" pool.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({ task: \"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"fail\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"} \"}),(0,l.jsx)(e.span,{style:{color:\"#F97583\"},children:\"catch\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (err) {\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"\\u7EBF\\u7A0B\\u70B8\\u4E86:\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", err);\"})]}),`\n`,(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:\"\\u522B\\u6EE5\\u7528\"}),(0,l.jsx)(e.br,{}),`\n`,\"I/O \\u5BC6\\u96C6\\u578B\\u4EFB\\u52A1\\uFF08\\u6BD4\\u5982\\u8BFB\\u6570\\u636E\\u5E93\\uFF09\\u7528\\u4E0D\\u7740 Tinypool\\uFF0CNode.js \\u81EA\\u5E26\\u7684\\u5F02\\u6B65\\u5C31\\u591F\\u4E86\\u3002\"]}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:\"\\u76D1\\u63A7\\u7EBF\\u7A0B\\u72B6\\u6001\"}),(0,l.jsx)(e.br,{}),`\n`,\"\\u7528 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"pool.threads\"})})})}),\" \\u548C \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"pool.queue\"})})})}),\" \\u68C0\\u67E5\\u7EBF\\u7A0B\\u6C60\\u548C\\u961F\\u5217\\uFF0C\\u751F\\u4EA7\\u73AF\\u5883\\u522B\\u8BA9\\u5B83\\u201C\\u8D85\\u8F7D\\u201D\\u3002\"]}),`\n`,(0,l.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.pre,{tabIndex:\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",children:(0,l.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"\\u5FD9\\u788C\\u7EBF\\u7A0B:\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", pool.threads.\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"length\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,l.jsxs)(e.span,{\"data-line\":\"\",children:[(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"console.\"}),(0,l.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"log\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"\\u6392\\u961F\\u4EFB\\u52A1:\"'}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", pool.queue.\"}),(0,l.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"length\"}),(0,l.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]})]})})}),`\n`]}),`\n`]}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u7C7B\\u6BD4tinypool-\\u50CF\\u4E2A\\u65BD\\u5DE5\\u961F\",children:(0,l.jsx)(e.a,{href:\"#\\u7C7B\\u6BD4tinypool-\\u50CF\\u4E2A\\u65BD\\u5DE5\\u961F\",children:\"\\u7C7B\\u6BD4\\uFF1ATinypool \\u50CF\\u4E2A\\u201C\\u65BD\\u5DE5\\u961F\\u201D\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u6211\\u89C9\\u5F97 Tinypool \\u7279\\u522B\\u50CF\\u4E2A\\u65BD\\u5DE5\\u961F\\u3002\\u4F60\\uFF08\\u4E3B\\u7EBF\\u7A0B\\uFF09\\u662F\\u201C\\u5305\\u5DE5\\u5934\\u201D\\uFF0C\\u6709\\u6D3B\\u513F\\uFF08\\u4EFB\\u52A1\\uFF09\\u5C31\\u4E22\\u7ED9\\u65BD\\u5DE5\\u961F\\uFF08\\u7EBF\\u7A0B\\u6C60\\uFF09\\uFF0C\\u5DE5\\u4EBA\\uFF08\\u7EBF\\u7A0B\\uFF09\\u5E72\\u5B8C\\u6D3B\\u628A\\u6210\\u679C\\u4EA4\\u56DE\\u6765\\u3002\\u4F60\\u4E0D\\u7528\\u7BA1\\u8C01\\u5E72\\u7684\\u3001\\u600E\\u4E48\\u5E72\\u7684\\uFF0C\\u53EA\\u7BA1\\u5750\\u7B49\\u9A8C\\u6536\\u3002\\u6D3B\\u513F\\u591A\\u7684\\u65F6\\u5019\\uFF0C\\u5B83\\u8FD8\\u80FD\\u201C\\u52A0\\u73ED\\u52A0\\u70B9\\u201D\\uFF0C\\u6548\\u7387\\u9AD8\\u5F97\\u98DE\\u8D77\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u6027\\u80FD\\u5BF9\\u6BD4tinypool-vs-\\u539F\\u751F-worker\",children:(0,l.jsx)(e.a,{href:\"#\\u6027\\u80FD\\u5BF9\\u6BD4tinypool-vs-\\u539F\\u751F-worker\",children:\"\\u6027\\u80FD\\u5BF9\\u6BD4\\uFF1ATinypool vs \\u539F\\u751F Worker\"})}),`\n`,(0,l.jsx)(e.p,{children:\"\\u6211\\u505A\\u8FC7\\u4E2A\\u5C0F\\u6D4B\\u8BD5\\uFF0C\\u8DD1 100 \\u4E2A\\u8017\\u65F6\\u8BA1\\u7B97\\u4EFB\\u52A1\\uFF1A\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsxs)(e.strong,{children:[\"\\u539F\\u751F \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"worker_threads\"})})})})]}),\"\\uFF1A\\u6BCF\\u6B21 \",(0,l.jsx)(e.span,{\"data-rehype-pretty-code-figure\":\"\",children:(0,l.jsx)(e.code,{\"data-language\":\"text\",\"data-theme\":\"github-dark\",children:(0,l.jsx)(e.span,{\"data-line\":\"\",children:(0,l.jsx)(e.span,{children:\"new Worker\"})})})}),\"\\uFF0C\\u603B\\u8017\\u65F6 ~12 \\u79D2\\u3002\"]}),`\n`,(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:\"Tinypool\"}),\"\\uFF1A\\u7EBF\\u7A0B\\u590D\\u7528\\uFF0C\\u603B\\u8017\\u65F6 ~8 \\u79D2\\u3002\"]}),`\n`]}),`\n`,(0,l.jsx)(e.p,{children:\"\\u5DEE\\u8DDD\\u4E0D\\u5927\\uFF1F\\u4EFB\\u52A1\\u91CF\\u4E0A\\u5343\\u540E\\uFF0CTinypool \\u7684\\u4F18\\u52BF\\u5C31\\u660E\\u663E\\u4E86\\uFF0C\\u5F00\\u9500\\u4F4E\\u3001\\u8C03\\u5EA6\\u5FEB\\uFF0C\\u7B80\\u76F4\\u662F\\u201C\\u6027\\u80FD\\u602A\\u517D\\u201D\\u3002\"}),`\n`,(0,l.jsx)(e.h2,{id:\"\\u7ED3\\u5C3Etinypool-\\u7684\\u6C5F\\u6E56\\u5730\\u4F4D\",children:(0,l.jsx)(e.a,{href:\"#\\u7ED3\\u5C3Etinypool-\\u7684\\u6C5F\\u6E56\\u5730\\u4F4D\",children:\"\\u7ED3\\u5C3E\\uFF1ATinypool \\u7684\\u6C5F\\u6E56\\u5730\\u4F4D\"})}),`\n`,(0,l.jsx)(e.p,{children:\"Tinypool \\u867D\\u7136\\u4E0D\\u50CF Express\\u3001Koa \\u90A3\\u4E48\\u201C\\u5BB6\\u55BB\\u6237\\u6653\\u201D\\uFF0C\\u4F46\\u5728 Node.js \\u6027\\u80FD\\u4F18\\u5316\\u5708\\u5B50\\u91CC\\uFF0C\\u5B83\\u7EDD\\u5BF9\\u662F\\u4E2A\\u201C\\u9690\\u85CF\\u5927\\u4F6C\\u201D\\u3002\\u5B83\\u4E0D\\u89E3\\u51B3\\u6240\\u6709\\u95EE\\u9898\\uFF0C\\u4F46\\u4E13\\u6CBB CPU \\u5BC6\\u96C6\\u578B\\u4EFB\\u52A1\\u7684\\u201C\\u5361\\u987F\\u75C5\\u201D\\u3002\\u672A\\u6765\\uFF0C\\u5B83\\u53EF\\u80FD\\u4F1A\\u66F4\\u667A\\u80FD\\uFF0C\\u6BD4\\u5982\\u52A8\\u6001\\u8C03\\u6574\\u7EBF\\u7A0B\\u6570\\uFF0C\\u6216\\u8005\\u96C6\\u6210\\u66F4\\u5F3A\\u7684\\u8C03\\u8BD5\\u5DE5\\u5177\\u3002\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u7528 Tinypool \\u5199\\u4EE3\\u7801\\uFF0C\\u6709\\u79CD\\u201C\\u6307\\u70B9\\u6C5F\\u5C71\\u201D\\u7684\\u723D\\u611F\\u2014\\u2014\\u4EFB\\u52A1\\u4E00\\u6254\\uFF0C\\u6027\\u80FD\\u8D77\\u98DE\\uFF0C\\u7701\\u5FC3\\u53C8\\u9AD8\\u6548\\u3002\\u5E0C\\u671B\\u8FD9\\u7BC7\\u6587\\u7AE0\\u80FD\\u8BA9\\u4F60\\u5BF9\\u5B83\\u6709\\u70B9\\u201C\\u5FC3\\u52A8\\u201D\\uFF0C\\u4E0B\\u6B21\\u9879\\u76EE\\u5361\\u6027\\u80FD\\u65F6\\uFF0C\\u8BD5\\u8BD5\\u8FD9\\u4E2A\\u5C0F\\u795E\\u5668\\uFF0C\\u4FDD\\u51C6\\u4E0D\\u540E\\u6094\\uFF01\\u{1F609}\"}),`\n`,(0,l.jsx)(e.p,{children:\"\\u6709\\u5565\\u60F3\\u804A\\u7684\\uFF0C\\u6B22\\u8FCE\\u7559\\u8A00\\uFF0C\\u54B1\\u4EEC\\u4E00\\u8D77\\u6298\\u817E\\uFF01\\u{1F680}\"}),`\n`,(0,l.jsx)(e.hr,{})]})}function h(n={}){let{wrapper:e}=n.components||{};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(t,{...n})}):t(n)}return f(x);})();\n;return Component;"
  },
  "_id": "Node.js/Tinypool.mdx",
  "_raw": {
    "sourceFilePath": "Node.js/Tinypool.mdx",
    "sourceFileName": "Tinypool.mdx",
    "sourceFileDir": "Node.js",
    "contentType": "mdx",
    "flattenedPath": "Node.js/Tinypool"
  },
  "type": "Post",
  "url": "/blog/Node.js/Tinypool"
}